<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>sshç™»å½•linuxåŠå¤±è´¥è§£å†³æ–¹æ¡ˆ</title>
      <link href="2021/08/29/ssh-login-linux/"/>
      <url>2021/08/29/ssh-login-linux/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://jinbaotang.cn/2021/08/29/use-vscode-debug-ecu/">ä½¿ç”¨vscodeå¯è§†åŒ–è°ƒè¯•ECU</a>ä¸­æåˆ°ï¼Œæˆ‘æœ€è¿‘ä¸€ç›´åœ¨macé€šè¿‡vscodeç™»å½•åˆ°linuxæ¥è¿›è¡Œä»£ç å¼€å‘ã€‚</p></blockquote><h1 id="ä¸€ã€vscodeè¿œç¨‹åˆ°linuxä¸Šå¼€å‘"><a href="#ä¸€ã€vscodeè¿œç¨‹åˆ°linuxä¸Šå¼€å‘" class="headerlink" title="ä¸€ã€vscodeè¿œç¨‹åˆ°linuxä¸Šå¼€å‘"></a>ä¸€ã€vscodeè¿œç¨‹åˆ°linuxä¸Šå¼€å‘</h1><p>&emsp;&emsp;åœ¨vscodeä¸Šè£…ä¸ŠRemote-SSHï¼Œå¹¶åœ¨linuxä¸Šè£…vscode severå°±å¯ä»¥åœ¨å…¶ä»–ç”µè„‘ä¸Šï¼ˆmacï¼Œlinuxï¼Œwindowsï¼‰æ¥æ— æ„Ÿçš„è¿›è¡Œâ€è¿œç¨‹å¼€å‘äº†â€œã€‚æ—¢ç„¶æ˜¯é€šè¿‡sshçš„æ–¹å¼ç™»å½•åˆ°è¿œç¨‹ï¼Œé»˜è®¤å°±æœ‰ä¸¤ç§æ–¹å¼äº†ï¼Œä¸€ä¸ªæ˜¯å¯†ç çš„æ–¹å¼ï¼Œä¸€ä¸ªsshå…¬é’¥ç§é’¥çš„æ–¹å¼äº†ï¼Œå‰è€…å¾ˆç®€å•ï¼Œåªè¦ä¸è¦å°†sshdçš„å¯†ç ç™»å½•ç¦ç”¨ï¼ˆé»˜è®¤ä¸ç¦ç”¨ï¼‰ï¼Œå¯ä»¥åœ¨linux<code>/etc/ssh/sshd_config</code>æŸ¥çœ‹<code>PasswordAuthentication</code>è·å–æ˜¯å¦ç¦ç”¨ã€‚</p><h1 id="äºŒã€é—®é¢˜è§£å†³"><a href="#äºŒã€é—®é¢˜è§£å†³" class="headerlink" title="äºŒã€é—®é¢˜è§£å†³"></a>äºŒã€é—®é¢˜è§£å†³</h1><p>&emsp;&emsp;åœ¨å››ä¸ªæœˆä»¥å‰æˆ‘å°±æƒ³é€šè¿‡vscode sshç§é’¥å…¬é’¥çš„æ–¹å¼æ¥ç™»å½•linuxï¼Œä½†æ˜¯é‡åˆ°äº†ä¸å°‘é—®é¢˜ï¼Œå½“æ—¶å¼€å‘ä»»åŠ¡åˆæ¯”è¾ƒç´§å¼ ï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡æœ‰å»æŠ˜è…¾äº†ã€‚è®°å¾—å‰æ®µæ—¶é—´æˆ‘ä»¬çš„ä¸€ä¸ªæœåŠ¡å™¨å´©äº†ï¼Œé‡è£…äº†ç³»ç»Ÿäº†ï¼Œåœ¨æŸå¤©å¿ƒè¡€æ¥æ½®ï¼Œåˆè¯•äº†ä¸€ä¸‹ï¼Œè¯¶å±…ç„¶å¯ä»¥äº†ã€‚ä½†æ˜¯åé¢æœ‰ä¸€å°æœåŠ¡å™¨è¿˜æ˜¯ä¸è¡Œï¼Œå› ä¸ºæœ‰æˆåŠŸçš„æ¡ˆä¾‹ï¼Œæœ¬ç€æ‰“ç ´ç ‚é”…é—®åˆ°åº•çš„ç²¾ç¥ï¼ŒæŸä¸ªç©ºé—²æ—¶é—´ï¼Œåˆå»æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œé‡åˆ°é—®é¢˜æ‰ä¼šå­¦åˆ°è‡ªå·±å¿½ç•¥çš„çŸ¥è¯†ç‚¹ï¼Œç»è¿‡è¿™æ¬¡æŠ˜è…¾ï¼Œæ€»ç®—å¼„æ‡‚äº†ä¸€ç‚¹sshç™»å½•çš„é—¨é“äº†ã€‚</p><h2 id="1-å¦‚ä½•é€šè¿‡sshå…¬é’¥ç§é’¥ç™»å½•"><a href="#1-å¦‚ä½•é€šè¿‡sshå…¬é’¥ç§é’¥ç™»å½•" class="headerlink" title="1. å¦‚ä½•é€šè¿‡sshå…¬é’¥ç§é’¥ç™»å½•"></a>1. å¦‚ä½•é€šè¿‡sshå…¬é’¥ç§é’¥ç™»å½•</h2><p>&emsp;&emsp;å¦‚æœæ²¡å‡ºæ„å¤–ï¼Œè¿™ä¸ªçœŸçš„æ˜¯å·¨ç®€å•ï¼Œé¦–å…ˆåœ¨è‡ªå·±çš„æœºå™¨ä¸Šé€šè¿‡<code>ssh-keygen -t RSA -C yourname</code>ç”Ÿæˆå¯†é’¥ï¼Œä¸€è·¯å›è½¦å°±å¥½äº†ã€‚æœ€ç»ˆä¼šç”Ÿæˆä¸€å¯¹å…¬ç§é’¥åœ¨ä½ çš„ç”¨æˆ·ç›®å½•çš„.sshä¸‹ã€‚<br>å…³äºå…¬ç§é’¥çš„ä½ç½®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">1. windowsï¼š2. macï¼š&#x2F;Users&#x2F;youraccount&#x2F;.ssh3. linux &#x2F;home&#x2F;youraccout&#x2F;.ssh or ~&#x2F;.ssh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ç”Ÿæˆå…¬ç§é’¥ä¹‹åï¼š</p><ol><li>å¦‚æœç›®æ ‡æœºå™¨æ˜¯macæˆ–è€…linuxå°±å¯ä»¥å°†å…¬é’¥æ‹·è´åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œç„¶åé€šè¿‡<code>cat id_rsa.pub &gt;&gt; xxxx/.ssh/authorized_keys</code>ï¼Œå»ºè®®ä½¿ç”¨<code>&gt;&gt;</code>è€Œä¸æ˜¯<code>&gt;</code>ï¼Œå‰è€…æ˜¯è¿½åŠ ï¼Œåè€…æ˜¯è¦†ç›–ï¼Œæœ‰æ—¶æœ‰å¤šä¸ªæœºå™¨æƒ³è¿ä¸€ä¸ªæœºå™¨æ—¶ï¼Œä¸å¯é¿å…éœ€è¦å¤šä¸ªå…±å­˜ã€‚<code>xxxx</code>ä»£è¡¨æ˜¯ç”¨æˆ·è·¯å¾„ï¼Œæ¯”å¦‚<code>/home/jinbao</code>ï¼Œå¦‚æœæ˜¯è‡ªå·±çš„ç‹¬æœ‰çš„æœºå™¨æˆ–è€…ä¸æ€•è¢«æ‰“ï¼Œ<code>xxxx</code>ä¹Ÿå¯ä»¥æ˜¯<code>/root</code>.</li><li>å¦‚æœç›®æ ‡æœºå™¨æ˜¯windowsï¼Œå°±æ›´ç®€å•äº†ï¼Œåœ¨ç”¨æˆ·ç›®å½•ä¸‹çš„.sshï¼ˆæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªauthorized_keysæ–‡ä»¶ï¼Œæ‰“å¼€å°†å‰é¢ç”Ÿæˆçš„id_rsa.pubæ‹·è´å‡ºæ¥é‡Œé¢çš„å†…å®¹ï¼Œå¤åˆ¶åˆ°authorized_keysï¼Œå°±okäº†ã€‚</li></ol><p>&emsp;&emsp;åé¢åœ¨è‡ªå·±çš„æœºå™¨ä¸Šï¼ˆç”Ÿæˆäº†å¯†é’¥çš„æœºå™¨ä¸Šï¼‰é€šè¿‡<code>ssh yourname@target host ip</code>ï¼Œä¼šå‘ç°ä¸ç”¨è¾“å…¥å¯†ç äº†ã€‚å½“ç„¶å¯ä»¥åœ¨å„ä¸ªç³»ç»Ÿä¸Šè®¾ç½®<strong>åˆ«å</strong>æ¥ç¼©çŸ­sshçš„å‘½ä»¤ï¼Œæ¯”å¦‚æˆ‘macä¸Šçš„<code>.bash_profile</code>å¢åŠ äº†<code>alias sshironman=&#39;ssh ironman@172.20.1.1&#39;</code>ï¼Œåé¢æˆ‘è¦ç™»å½•ironmanï¼Œå°±åªéœ€è¦è¾“å…¥<code>sshironmman</code>å°±å¥½äº†ã€‚</p><h2 id="2-æƒ³ä¸ªæ€§è‡ªå·±sshå¯†é’¥è·¯å¾„"><a href="#2-æƒ³ä¸ªæ€§è‡ªå·±sshå¯†é’¥è·¯å¾„" class="headerlink" title="2. æƒ³ä¸ªæ€§è‡ªå·±sshå¯†é’¥è·¯å¾„"></a>2. æƒ³ä¸ªæ€§è‡ªå·±sshå¯†é’¥è·¯å¾„</h2><p>&emsp;&emsp;sshçš„å¯†é’¥ç”¨å¤„å¾ˆå¤šï¼Œå¯ä»¥ç”¨åœ¨gitä»“åº“ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åŠ è§£å¯†è‡ªå·±çš„<strong>ç§˜å¯†æ–‡ä»¶å¤¹</strong>ã€‚ä¸ºäº†å®‰å…¨æˆ–è€…æ–¹ä¾¿ç®¡ç†ï¼Œå°±æƒ³ç€gitä¸€å¥—ç§˜é’¥ã€ç™»å½•linuxä¸€å¥—å¯†é’¥ï¼Œä½†æ˜¯é»˜è®¤è·¯å¾„åªæœ‰ä¸€ä¸ªï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><ol><li>æ›´æ”¹æ¯ä¸ªå…¬ç§é’¥çš„åå­—ï¼Œæ›´æ”¹åŠ è§£å¯†æ¨¡å—çš„é…ç½®</li><li>æŒ‡å®šä¸åŒçš„hostç”¨ä¸åŒè·¯å¾„ä¸‹çš„å¯†é’¥ã€‚</li></ol><p>&emsp;&emsp;ä¸Šé¢è¿™ä¸ªä¹Ÿæ˜¯æˆ‘åœ¨é‡åˆ°é—®é¢˜æœ€åæ€»ç»“å‡ºæ¥çš„ã€‚å¦‚æœè¦å®ç°ä¸Šè¿°æ“ä½œï¼Œå¯ä»¥åœ¨è‡ªå·±çš„æœºå™¨ä¸Šåˆ›å»ºä¸€ä¸ª<code>config</code>æ–‡ä»¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/medias/use-ssh-login/sshconfig.png" alt="sshé…ç½®æ–‡ä»¶"><br>å›¾ä¸Šå«ä¹‰è§£é‡Š:</p><ol><li>Host-&gt;å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªæ ‡é¢˜ï¼Œæ¯”å¦‚<code>ssh 10.110.16.208</code>ç­‰åŒäº<code>ssh jinbao@10.110.16.208</code>ï¼Œå½“ç„¶ä½ å¯ä»¥æŠŠ<code>10.110.16.208</code>æ¢æˆä»»æ„çš„å­—ç¬¦ï¼Œegï¼šfuck.</li><li>HostName-&gt;å³ç›®æ ‡æœºå™¨çš„ipæˆ–è€…åŸŸå</li><li>User-&gt;ä½ åœ¨ç›®æ ‡æœºå™¨çš„ç”¨æˆ·å</li><li>Idetiyfile-&gt;ä¸å…¬é’¥åŒ¹é…çš„ç§é’¥ï¼Œ</li><li>è¿˜å¯ä»¥æŒ‡å®š<code>Port</code>ï¼Œä¸æŒ‡å®šä½¿ç”¨é»˜è®¤çš„22ç«¯å£ã€‚</li></ol><p>&emsp;&emsp;ç”±äºç§é’¥å¯ä»¥æŒ‡å®šï¼Œæ‰€ä»¥å°±æ„å‘³ç€æˆ‘å¯ä»¥æŠŠæˆ‘çš„å¯†é’¥ç”Ÿæˆåœ¨èƒ½å¤Ÿè®¿é—®åˆ°çš„ä»»ä½•åœ°æ–¹<br>&emsp;&emsp;å¦‚æœæœºå™¨æ˜¯è‡ªå·±ç‹¬å çš„ï¼Œä½ è¿˜å¯ä»¥å»æŠ˜è…¾/etc/ssh/sshd_configï¼Œå¯ä»¥é…ç½®æŒºå¤šç©æ³•çš„ï¼Œå°±çœ‹è‡ªå·±å»æ‘¸ç´¢äº†ã€‚å¦‚æœå¤§å®¶å…±ç”¨ï¼Œè®°å¾—å…ˆå¤‡ä»½å†æŠ˜è…¾ï¼ŒæŠ˜è…¾å®Œè®°å¾—å¤åŸï¼Œæˆ‘å°±æ˜¯å¿˜è®°å¤åŸï¼Œè¢«äºº<strong>é€®ä½</strong>äº†ã€‚</p><h2 id="3-æ€»æ˜¯åå·"><a href="#3-æ€»æ˜¯åå·" class="headerlink" title="3. æ€»æ˜¯åå·"></a>3. æ€»æ˜¯åå·</h2><blockquote><p>åªè¦é‡åˆ°äº†é—®é¢˜ï¼Œæ‰èƒ½åœ¨ç®€å•æ“ä½œä¸­æ‰èƒ½å­¦åˆ°ä¸œè¥¿.</p></blockquote><p>&emsp;&emsp;å¦‚æœä¸æ˜¯åœ¨æŸå°æœºå™¨ä¸Šç™»å½•å¤±è´¥äº†ï¼Œæˆ‘æ°¸è¿œä¸ä¼šçŸ¥é“è¿˜èƒ½é€šè¿‡configæŒ‡å®šç§é’¥ï¼Œä¹Ÿä¸ä¼šçŸ¥é“åŸæ¥sshè¿˜èƒ½é€šè¿‡æ‰“å°ä¿¡æ¯æ¥debugã€‚å…ˆç›´æ¥ç»™<strong>è§£å†³æ–¹æ¡ˆ</strong>å§ï¼š</p><ol><li>å¦‚æœä½ å‘ç°å¼„å®Œä¸Šé¢çš„ç¬¬ä¸€æ­¥ï¼Œä¾ç„¶è¿˜éœ€è¦è¾“å…¥å¯†ç ï¼Œé‚£å°±çœ‹ç€æ”¹æ”¹*/etc/ssh/sshd_config*ä¸Šçš„é…ç½®ï¼Œæ¯”å¦‚æŒ‡å®šauthorized_keysï¼Œ<code>PubkeyAuthentication</code>æ˜¾ç¤ºçš„è®¾ç½®ä¸ºyesç­‰æ“ä½œ</li><li>ä¸Šé¢ä¸è¡Œï¼Œå°±å°†ç”¨æˆ·ç›®å½•ä¸‹çš„.sshæƒé™æ”¹ä¸º600-&gt;<code>chmod 600 .ssh</code></li><li>2ä¸è¡Œï¼Œå°±å°†è‡ªå·±çš„ç”¨æˆ·ç›®å½•æ”¹ä¸º600-&gt;<code>chmod 600 /home/youraccount</code></li><li>3ä¸è¡Œï¼Œæˆ–è€…æƒ³çŸ¥é“æ€ä¹ˆçŸ¥é“æ˜¯2ä¸è¡Œè¿˜æ˜¯3ä¸è¡Œçš„ï¼Œéƒ½å¯ä»¥å¾€ä¸‹çœ‹ã€‚</li></ol><p>è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘åœ¨ç½‘ä¸ŠæŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åè‡ªå·±åŠ å·¥æ€»ç»“å¦‚ä¸‹ã€‚<br>&emsp;&emsp;è§£å†³ä¸Šé¢é—®é¢˜çš„ä¸»è¦æ€è·¯æ—¶ï¼Œåˆ©ç”¨sshç¨‹åºè‡ªå·±è¾“å‡ºçš„æ—¥å¿—æ¥å®šä½é—®é¢˜ï¼Œåœ¨æœåŠ¡å™¨aï¼ˆä¹Ÿå°±æ˜¯è‡ªå·±çš„å¼€å‘æœºå™¨ï¼‰å’Œåœ¨ç›®æ ‡æœºå™¨ï¼ˆæœåŠ¡å™¨bï¼‰ä¸Šåˆ†åˆ«æ˜¾å¼çš„ã€å‰å°çš„è¿è¡Œsshï¼Œç„¶åå¯ä»¥è·Ÿç€æ—¥å¿—çš„è¿‡ç¨‹æ¥åˆ†æé—®é¢˜å‡ºåœ¨å“ªé‡Œã€‚æ‰€ä»¥éœ€è¦è‡³å°‘å¼€ä¸¤ä¸ªçª—å£ï¼Œæœ€å¥½å¼€ä¸‰ä¸ªï¼Œå…¶ä¸­ä¸¤ä¸ªé€šè¿‡å¯†ç ç™»å½•åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œå¦ä¸€ä¸ªé€šè¿‡sshè¿æ¥ç›®æ ‡æœºå™¨ã€‚<br>Açª—å£ï¼šé€šè¿‡ssh+passwdçš„æ–¹å¼ç™»å½•è¿›å»ï¼Œä»€ä¹ˆä¹Ÿä¸åšâ€”<strong>ä¸ºäº†ä¿é™©</strong></p><p>Bçª—å£ï¼šé€šè¿‡é€šè¿‡ssh+passwdçš„æ–¹å¼ç™»å½•è¿›å»ï¼Œç„¶åï¼š</p><ol><li><code>sudo su</code></li><li><code>ssh service stop</code></li><li><code>/usr/sbin/sshd -d </code>debugæ–¹å¼è¿è¡Œsshdd</li></ol><p>Cçª—å£ï¼š<code>ssh -v yourname@hostip</code>ï¼Œæ¯”å¦‚å½“æ—¶æˆ‘æ˜¯<code>ssh -v jinbao@10.110.16.239</code></p><p>ç„¶ååˆ†åˆ«è§‚å¯ŸBçª—å£å’ŒCçª—å£æ‰“å°çš„ä¸œè¥¿ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°Bçª—å£å€’æ•°ç¬¬å››è¡Œæ˜¾ç¤ºæ˜¯æƒé™é—®é¢˜ï¼Œåªè¦å°†ä¸Šé¢æåˆ°çš„æ–‡ä»¶å¤¹æ”¹æˆ<code>600 or 700 or 755</code>,ä¸€èˆ¬è¯¥æ–‡ä»¶å¤¹ä¸º755ï¼Œ<strong>å†æ¥ä¸€éï¼Œå‘ç°ä¸ç”¨å¯†ç æˆåŠŸç™»å½•äº†</strong>ï¼Œè‡³äºä¸ºä»€ä¹ˆé‚£ä¸ªæ–‡ä»¶å¤¹ä¼šæ˜¯å…¶ä»–æƒé™ï¼Œæˆ‘å°±æ²¡å»ç®¡äº†ã€‚å…¶å®Cçª—å£è¿‡ç¨‹ä¹Ÿè›®æœ‰æ„æ€çš„ï¼Œä¸€å¼€å§‹ä½¿ç”¨<strong>id_rsa</strong>çš„ç§é’¥å°è¯•ä¸€ä¸‹ï¼Œåé¢æœ‰ç”¨å…¶ä»–çš„å°è¯•ä¸€ä¸‹ï¼Œç›´åˆ°æ‰€æœ‰çš„éƒ½ä¸è¡Œï¼Œå°±å‘Šè¯‰ä½ ç”¨å¯†ç ç™»å½•å§ã€‚ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ç§é’¥çš„é—®é¢˜ï¼Œæˆ‘æŠŠè¿‡ç¨‹ä¸­å°è¯•çš„æ‰€æœ‰å¯†é’¥éƒ½è¯•äº†ä¸€éï¼Œç„¶åçœ‹åˆ°äº†Bçª—å£çš„æ—¥å¿—ã€‚ã€‚ã€‚ã€‚</p><pre class="line-numbers language-Bçª—å£æ—¥å¿—" data-language="Bçª—å£æ—¥å¿—"><code class="language-Bçª—å£æ—¥å¿—">root@nio:&#x2F;home&#x2F;jinbao# &#x2F;usr&#x2F;sbin&#x2F;sshd -ddebug1: sshd version OpenSSH_7.2, OpenSSL 1.0.2g  1 Mar 2016debug1: private host key #0: ssh-rsa SHA256:1sJu9KkQVl&#x2F;GGTO6&#x2F;iECw7XLev7tk+iK&#x2F;DuHbyy1Y0Mdebug1: private host key #1: ssh-dss SHA256:ASXArytwxggfDbf1gjuL1D4gRdNt58VlBh+hG9JcS3odebug1: private host key #2: ecdsa-sha2-nistp256 SHA256:01M0FdZZcYtT+jYHI0SLdrwVChWR8jmMs4KPFcrZiKkdebug1: private host key #3: ssh-ed25519 SHA256:H69XeL&#x2F;L7QtUxj85tedNm4YeBHFu6L5MZS3Quv0bjf0debug1: rexec_argv[0]&#x3D;&#39;&#x2F;usr&#x2F;sbin&#x2F;sshd&#39;debug1: rexec_argv[1]&#x3D;&#39;-d&#39;debug1: Set &#x2F;proc&#x2F;self&#x2F;oom_score_adj from 0 to -1000debug1: Bind to port 22 on 0.0.0.0.Server listening on 0.0.0.0 port 22.debug1: Bind to port 22 on ::.Server listening on :: port 22.debug1: Server will not fork when running in debugging mode.debug1: rexec start in 5 out 5 newsock 5 pipe -1 sock 8debug1: inetd sockets after dupping: 3, 3Connection from 10.110.218.140 port 53227 on 10.110.16.239 port 22debug1: Client protocol version 2.0; client software version OpenSSH_8.1debug1: match: OpenSSH_8.1 pat OpenSSH* compat 0x04000000debug1: Enabling compatibility mode for protocol 2.0debug1: Local version string SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.10debug1: permanently_set_uid: 121&#x2F;65534 [preauth]debug1: list_hostkey_types: ssh-rsa,rsa-sha2-512,rsa-sha2-256,ecdsa-sha2-nistp256,ssh-ed25519 [preauth]debug1: SSH2_MSG_KEXINIT sent [preauth]debug1: SSH2_MSG_KEXINIT received [preauth]debug1: kex: algorithm: curve25519-sha256@libssh.org [preauth]debug1: kex: host key algorithm: ecdsa-sha2-nistp256 [preauth]debug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none [preauth]debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: none [preauth]debug1: expecting SSH2_MSG_KEX_ECDH_INIT [preauth]debug1: rekey after 134217728 blocks [preauth]debug1: SSH2_MSG_NEWKEYS sent [preauth]debug1: expecting SSH2_MSG_NEWKEYS [preauth]debug1: SSH2_MSG_NEWKEYS received [preauth]debug1: rekey after 134217728 blocks [preauth]debug1: KEX done [preauth]debug1: userauth-request for user jinbao service ssh-connection method none [preauth]debug1: attempt 0 failures 0 [preauth]debug1: PAM: initializing for &quot;jinbao&quot;debug1: PAM: setting PAM_RHOST to &quot;10.110.218.140&quot;debug1: PAM: setting PAM_TTY to &quot;ssh&quot;debug1: userauth-request for user jinbao service ssh-connection method publickey [preauth]debug1: attempt 1 failures 0 [preauth]debug1: userauth_pubkey: test whether pkalg&#x2F;pkblob are acceptable for RSA SHA256:6YbMfwVKZaQtvUroMXgxTn4qjvCSswzJU21eVfUtSJ8 [preauth]debug1: temporarily_use_uid: 1003&#x2F;1003 (e&#x3D;0&#x2F;0)debug1: trying public key file &#x2F;home&#x2F;jinbao&#x2F;.ssh&#x2F;authorized_keysdebug1: fd 4 clearing O_NONBLOCKAuthentication refused: bad ownership or modes for directory &#x2F;home&#x2F;jinbaodebug1: restore_uid: 0&#x2F;0Failed publickey for jinbao from 10.110.218.140 port 53227 ssh2: RSA SHA256:6YbMfwVKZaQtvUroMXgxTn4qjvCSswzJU21eVfUtSJ8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-Cçª—å£æ—¥å¿—" data-language="Cçª—å£æ—¥å¿—"><code class="language-Cçª—å£æ—¥å¿—">MBC02FC42FQ05P:~ tangjinbao$ ssh -v jinbao@10.110.16.239OpenSSH_8.1p1, LibreSSL 2.7.3debug1: Reading configuration data &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;configdebug1: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;config line 9: Applying options for 10.110.16.239debug1: Reading configuration data &#x2F;etc&#x2F;ssh&#x2F;ssh_configdebug1: &#x2F;etc&#x2F;ssh&#x2F;ssh_config line 47: Applying options for *debug1: Connecting to 10.110.16.239 [10.110.16.239] port 22.debug1: Connection established.debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_rsa type 0debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_rsa-cert type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_dsa type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_dsa-cert type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ecdsa type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ecdsa-cert type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ed25519 type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ed25519-cert type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_xmss type -1debug1: identity file &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_xmss-cert type -1debug1: Local version string SSH-2.0-OpenSSH_8.1debug1: Remote protocol version 2.0, remote software version OpenSSH_7.2p2 Ubuntu-4ubuntu2.10debug1: match: OpenSSH_7.2p2 Ubuntu-4ubuntu2.10 pat OpenSSH_7.0*,OpenSSH_7.1*,OpenSSH_7.2*,OpenSSH_7.3*,OpenSSH_7.4*,OpenSSH_7.5*,OpenSSH_7.6*,OpenSSH_7.7* compat 0x04000002debug1: Authenticating to 10.110.16.239:22 as &#39;jinbao&#39;debug1: SSH2_MSG_KEXINIT sentdebug1: SSH2_MSG_KEXINIT receiveddebug1: kex: algorithm: curve25519-sha256@libssh.orgdebug1: kex: host key algorithm: ecdsa-sha2-nistp256debug1: kex: server-&gt;client cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: nonedebug1: kex: client-&gt;server cipher: chacha20-poly1305@openssh.com MAC: &lt;implicit&gt; compression: nonedebug1: expecting SSH2_MSG_KEX_ECDH_REPLYdebug1: Server host key: ecdsa-sha2-nistp256 SHA256:01M0FdZZcYtT+jYHI0SLdrwVChWR8jmMs4KPFcrZiKkdebug1: Host &#39;10.110.16.239&#39; is known and matches the ECDSA host key.debug1: Found key in &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;known_hosts:9debug1: rekey out after 134217728 blocksdebug1: SSH2_MSG_NEWKEYS sentdebug1: expecting SSH2_MSG_NEWKEYSdebug1: SSH2_MSG_NEWKEYS receiveddebug1: rekey in after 134217728 blocksdebug1: Will attempt key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_rsa RSA SHA256:6YbMfwVKZaQtvUroMXgxTn4qjvCSswzJU21eVfUtSJ8debug1: Will attempt key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_dsadebug1: Will attempt key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ecdsadebug1: Will attempt key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ed25519debug1: Will attempt key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_xmssdebug1: SSH2_MSG_EXT_INFO receiveddebug1: kex_input_ext_info: server-sig-algs&#x3D;&lt;rsa-sha2-256,rsa-sha2-512&gt;debug1: SSH2_MSG_SERVICE_ACCEPT receiveddebug1: Authentications that can continue: publickey,passworddebug1: Next authentication method: publickeydebug1: Offering public key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_rsa RSA SHA256:6YbMfwVKZaQtvUroMXgxTn4qjvCSswzJU21eVfUtSJ8debug1: Authentications that can continue: publickey,passworddebug1: Trying private key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_dsadebug1: Trying private key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ecdsadebug1: Trying private key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_ed25519debug1: Trying private key: &#x2F;Users&#x2F;tangjinbao&#x2F;.ssh&#x2F;id_xmssdebug1: Next authentication method: passwordjinbao@10.110.16.239&#39;s password:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šè¿°åªæ˜¯å‘ç°äº†æ–‡ä»¶æƒé™çš„é—®é¢˜ï¼Œå…¶å®é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥æ‰¾å‡ºå…¶ä»–å¤±è´¥çš„åŸå› ï¼Œæˆäººä»¥æ¸”ï¼Œé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œå°±çœ‹è‡ªå·±æ‘¸ç´¢äº†ã€‚</p><h1 id="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥"><a href="#æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥" class="headerlink" title="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥"></a>æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥</h1><h1 id="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥-1"><a href="#æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥-1" class="headerlink" title="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥"></a>æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥</h1><h1 id="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥-2"><a href="#æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥-2" class="headerlink" title="æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥"></a>æœ€åæé†’ï¼Œè§£å†³å®Œäº†åƒä¸‡åˆ«å¿˜è®°å°†æœåŠ¡å™¨bï¼ˆç›®æ ‡æœåŠ¡å™¨ï¼‰çš„sshå†å¯åŠ¨èµ·æ¥</h1><h1 id="ä¸‰ã€æ­»é‡Œé€ƒç”Ÿ"><a href="#ä¸‰ã€æ­»é‡Œé€ƒç”Ÿ" class="headerlink" title="ä¸‰ã€æ­»é‡Œé€ƒç”Ÿ"></a>ä¸‰ã€æ­»é‡Œé€ƒç”Ÿ</h1><p>&emsp;&emsp;æˆ‘å¼„å®ŒæˆåŠŸä¹‹åï¼Œé¡ºæ‰‹å°±æŠŠbçª—å£ç»™å…³äº†ï¼Œç„¶åå‘ç°sshæ–¹å¼æ²¡æ³•ç™»å½•ï¼Œçªç„¶æ„è¯†åˆ°äº†é—®é¢˜çš„ä¸¥é‡æ€§ï¼Œæˆ‘å·²ç»åšå¥½äº†æ‹¿ç€æ˜¾ç¤ºå™¨ã€é”®ç›˜ã€é¼ æ ‡å»æœåŠ¡å™¨è¾¹ä¸Šï¼Œæ‰‹åŠ¨èµ·æ¥çš„å‡†å¤‡äº†ã€‚ç„¶åæˆ‘å‘ç°äº†<strong>å±äºæˆ‘çš„Açª—å£</strong>ï¼ŒäºŒè¯ä¸è¯´èµ¶ç´§æŠŠsshé‡æ–°å¯åŠ¨â€“<code>service ssh start</code>ã€‚<br>å› ä¸ºæˆ‘ä»¬çš„æœåŠ¡å‡ºè¿‡ä¸€æ¬¡é‡å¤§äº‹æ•…ï¼Œæ‰€ä»¥æˆ‘å˜å¾—å¼‚å¸¸æ•æ„Ÿï¼Œç”Ÿæ€•å†å‡ºå¹ºè›¾å­ï¼Œæ‰€ä»¥å»ºè®®è‡³å°‘å¤šå¼€ä¸€ä¸ªçª—å£å¤‡ç”¨å“¦ï¼Œä»¥å…è‡ªå·±å¤ªé«˜å…´æŠŠçª—å£å…³äº†ï¼Œç„¶åè¢«åŒäº‹ç»™æäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯è§†åŒ–debug linuxç³»ç»Ÿçš„ECU</title>
      <link href="2021/08/29/use-vscode-debug-ecu/"/>
      <url>2021/08/29/use-vscode-debug-ecu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å‰æ®µæ—¶é—´çœŸçš„æ˜¯å¤ªæ²¡æ—¶é—´äº†ï¼Œè€½è¯¯äº†å¥½ä¹…ï¼Œè¿˜è®°å¾—æœ‰ä¸¤ä¸ªåšå®¢æ²¡å†™å®Œçš„ï¼Œä¸€ä¸ªå°±æ˜¯<a href="https://jinbaotang.cn/2021/06/06/tls-socket2/">åŸºäºopensslå®ç°tls+socketçš„å®‰å…¨é€šä¿¡-2</a>ï¼›è¿˜æœ‰å°±æ˜¯ä¸€ä¸ª<a href="https://jinbaotang.cn/2021/06/06/how-mcu2linux/">æˆ‘æ˜¯å¦‚ä½•ä»MCUå¼€å‘è½¬åˆ°linuxå¼€å‘</a>ï¼Œè¿˜æƒ³è¶ç€å†™è¿™ç¯‡æ–‡ç« å†å›é¡¾ä¸€ä¸‹ç¼–è¯‘é“¾æ¥çš„åŸç†ã€‚å‰å‡ ä¸ªæœˆåŸºæœ¬éƒ½æ˜¯â€œçº¯è½¯ä»¶å¼€å‘â€ï¼Œè¿™å‘¨å¼€å§‹äº†è¦å¼€å§‹åœ¨ECUä¸Šå®é™…è¿è¡Œäº†ï¼Œè™½ç„¶æˆ‘ä¹‹å‰åœ¨linuxæœåŠ¡å™¨å·²ç»æµ‹è¯•è¿‡äº†ï¼Œä½†å¶å°”è¿˜æ˜¯ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚coredumpã€‚è§£å†³è¿™ä¸ªé—®é¢˜æ²¡æœ‰æ¯”debugæ›´å¥½ç”¨çš„æ–¹æ³•äº†ã€‚</p></blockquote><h1 id="ä¸€ã€-å…³äºvscode"><a href="#ä¸€ã€-å…³äºvscode" class="headerlink" title="ä¸€ã€ å…³äºvscode"></a>ä¸€ã€ å…³äºvscode</h1><p>&emsp;&emsp;Visual Studio Codeï¼ˆç®€ç§°VSCode/vscodeï¼‰æ˜¯ä¸€æ¬¾ç”±å¾®è½¯å¼€å‘ä¸”è·¨å¹³å°çš„å…è´¹æºä»£ç ç¼–è¾‘å™¨ã€‚vscodeå®åœ¨å¤ªå¥½ç”¨äº†ï¼Œç¬¬äºŒä»½å·¥ä½œä»¥å‰ä¸€ç›´åœ¨ç”¨Source Insightï¼Œæ¥è§¦åˆ°vscodeåï¼Œå°±ä¸ºäº†AUTOSARæºç æ—¶æ—¶ç”¨è¿‡ä¸€æ¬¡äº†ï¼Œä¸»è¦æ˜¯vscodeæœ‰å„ç§æ’ä»¶ï¼Œåœ¨å·¥ç¨‹ä¸å¤§æ—¶ï¼Œæœç´¢ã€gotoç®€ç›´ä¸è¦å¤ªå¥½ç”¨ï¼Œè¿˜å¯ä»¥å¾ˆç®€å•çš„åœ¨å„ä¸ªå¹³å°debugç¨‹åºã€‚</p><h1 id="äºŒã€-æˆ‘çš„debugä¹‹è·¯"><a href="#äºŒã€-æˆ‘çš„debugä¹‹è·¯" class="headerlink" title="äºŒã€ æˆ‘çš„debugä¹‹è·¯"></a>äºŒã€ æˆ‘çš„debugä¹‹è·¯</h1><p>&emsp;&emsp;å…³äºIDEï¼Œæˆ‘æ˜¯å•ç‰‡æœºå¼€å‘å‡ºèº«ï¼Œæœ¬èº«æ˜¯ä»¥IDEç¼–è¯‘è°ƒè¯•ä¸ºä¸»ï¼ˆæœ€è¿‘çœ‹å¾ˆå¤šä¹Ÿå¼€å§‹ä½¿ç”¨Makefileäº†ï¼‰ï¼ŒåŸºæœ¬ä¸Šå¸‚é¢ä¸Šçš„åµŒå…¥å¼IDEéƒ½å¤šå¤šå°‘å°‘ç”¨è¿‡äº†ï¼Œä½†æ˜¯æˆ‘è§‰å¾—visual studioï¼ˆç®€ç§°vsï¼‰æ˜¯ç‹¬ä¸€æ¡£çš„ï¼Œä»¥å‰é¢†å¯¼è¦æ±‚ä»£ç éƒ½è‡³å°‘éœ€è¦å…·å¤‡è·¨linuxã€windowså¹³å°ï¼Œæ‰€ä»¥æˆ‘éƒ½æ˜¯ç°åœ¨windowsä¸Šä½¿ç”¨å¼€å‘ã€è°ƒè¯•å¥½åï¼Œç›´æ¥å†æ¬åˆ°linuxç®€å•æµ‹è¯•ã€ä¿®æ”¹å°±okã€‚vsè°ƒè¯•å¤šçº¿ç¨‹å®åœ¨å¤ªæ–¹ä¾¿äº†ï¼Œå•æ­¥è°ƒè¯•æ—¶ä¸ä¼šå› ä¸ºå¤šçº¿ç¨‹çè·‘ï¼Œï¼Œæ›´å…³é”®çš„æ˜¯vsè¿˜å¯ä»¥è¿œç¨‹è°ƒè¯•linuxç¨‹åºï¼Œè€Œä¸”åŸºæœ¬ä¸Šå’Œè°ƒè¯•windowsç¯å¢ƒä¸‹çš„æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œè¿˜æœ‰å°±æ˜¯å˜é‡æ”¹å˜è§¦å‘ç¨‹åºåœæ­¢ç”¨æ¥è°ƒè¯•å¼‚å¸¸ç®€ç›´å¤ªæ— æ•Œã€‚æˆ‘æ„¿ç§°vsä¸Šå¼€å‘ä»£ç æ˜¯ã€‚å½“ç„¶å³é£æœºå¯¼å¼¹ä½¿åœ¨windowsä¸Šæˆ‘ä»¥ç»å¸¸vscodeçœ‹ä»£ç ï¼Œå°¤å…¶ä¸æ˜¯è‡ªå·±çš„å†™ä»£ç ã€‚<br>&emsp;&emsp;æ–°å…¬å¸é…çš„æ˜¯macbookproï¼Œè™½ç„¶ä¹Ÿç”³è¯·äº†windowsç”µè„‘ï¼Œä½†æ˜¯æ€§èƒ½å®åœ¨å¤ªæ¸£ï¼Œå¹¶ä¸”è·¨linuxã€windowsä¼˜å…ˆçº§ä¸é«˜ï¼Œæ‰€ä»¥å°±æ…¢æ…¢è¿˜æ˜¯ç”¨vscodeæ¥å¼€å‘ã€è°ƒè¯•ä»£ç ï¼Œä¸€ç›´ä½¿ç”¨çš„vscodeè¿œç¨‹ç™»å½•åˆ°linuxæœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨gdbæ¥è°ƒè¯•ã€‚è¿™ä¸ªç›¸å¯¹vsæ¥è¯´å°±å¼±å¤šäº†ï¼Œåªæœ‰å˜é‡ç›‘æ§ã€æ–­ç‚¹ç­‰æå°‘çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å˜é‡è¿˜ä¸èƒ½å¾ˆæ–¹ä¾¿çš„é€‰æ‹©16è¿›åˆ¶æ˜¾ç¤ºè¿˜æ˜¯10è¿›åˆ¶æ˜¾ç¤ºï¼Œè¦æƒ³16è¿›åˆ¶æ˜¾ç¤ºå˜é‡ï¼Œå¿…é¡»æ‰‹åŠ¨å°†å˜é‡(åŒ…æ‹¬å±€éƒ¨å˜é‡)<code>add watchï¼Œç„¶ååœ¨å˜é‡åé¢åŠ ä¸Š,hæˆ–åˆ™,x</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/medias/use-vscode-debug/decimal.png" alt="10è¿›åˆ¶æ˜¾ç¤ºå˜é‡"> <img src="/medias/use-vscode-debug/hex.png" alt="16è¿›åˆ¶æ˜¾ç¤ºå˜é‡"><br>è™½ç„¶æ¯”ä¸ä¸Švs debugä¸Šçš„é£æœºå¯¼å¼¹ï¼Œè€Œä¸”å¤šçº¿ç¨‹å•æ­¥è°ƒè¯•è¿·ä¹‹è·³è½¬ä¹Ÿæ˜¯å¾ˆæ— è¯­ï¼Œä½†æ˜¯ç”¨èµ·æ¥è¿˜æ˜¯ä¸é”™çš„ï¼Œæ€ä¹ˆä¹Ÿç®—çš„å¦å…‹é£æœºäº†ã€‚<br>&emsp;&emsp;è¿™å‘¨åˆšæŠŠä»£ç æ”¾åˆ°æ¿å­ä¸Šå°±coredumpäº†ï¼Œï¼Œ<code>gdb exe core</code>è™½ç„¶çœ‹åˆ°äº†coredumpçš„ä½ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰å¤´ç»ªï¼Œå› ä¸ºå‡ºç°coredumpçš„åœ°æ–¹æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ã€‚å…ˆæ˜¯gdbå‘½ä»¤è¡Œè°ƒè¯•ï¼Œå‘½ä»¤è¡Œè®¾æ–­ç‚¹ã€å•æ­¥è¿è¡Œï¼Œå°ç±³åŠ æ­¥æªçœŸæ˜¯å¤ªéš¾äº†ï¼Œä½†æ˜¯å¬è¯´å¤§ç¥éƒ½æ˜¯è¿™æ ·æ¥è°ƒè¯•çš„Orzï¼›æ‰€ä»¥åé¢åˆåœ¨linuxæœåŠ¡å™¨å‡†å¤‡æµ‹è¯•æ¡ä»¶ä¸Šé‡æ–°å¤ç°äº†ä¸€éï¼Œè§£å†³äº†é—®é¢˜ã€‚æ˜¾ç„¶æˆ‘æ˜¯ä¸èƒ½åœ¨ECUä¸Šè£…ä¸ªvscode serveräº†ï¼Œæˆ‘æ€•é¢†å¯¼çŸ¥é“äº†æŠŠæˆ‘æ‰“æ­»ï¼Œä¸è¿‡å¥½åœ¨å¤©ç”Ÿä¹è§‚ï¼Œåšå¥½äº†æˆ‘è¦æˆä¸ºgdbå‘½ä»¤è°ƒè¯•å¤§ç¥çš„å‡†å¤‡ï¼Œå®åœ¨ä¸è¡Œå°±æ—¥å¿—è°ƒè¯•æ³•ã€‚ä½†æ˜¯åœ¨æŸä¸ªæ™šä¸Šï¼Œçªç„¶æƒ³èµ·äº†ï¼Œæ—¢ç„¶windowsä¸‹çš„vsçš„èƒ½å¤Ÿè¿œç¨‹è°ƒè¯•linuxï¼Œé‚£linuxæ˜¯ä¸æ˜¯ä¹Ÿèƒ½è¿œç¨‹è°ƒè¯•linuxå‘¢ï¼Ÿç»è¿‡ç®€å•åˆ†æï¼Œåªè¦ECUä¸Šèƒ½å¤Ÿè¿è¡Œgdb serverï¼ŒlinuxæœåŠ¡å™¨è¿œç¨‹clientï¼Œä¸å°±æˆäº†ã€‚å…ˆæ˜¯åœ¨æ¿å­ä¸Šæœäº†ä¸€ä¸‹ï¼Œå˜¿ï¼Œå¥½å®¶ä¼™ï¼Œæ¿å­ä¸Šè¿˜æ˜¯æœ‰çš„ã€‚<br><img src="/medias/use-vscode-debug/gdbserver.png" alt="ECUä¸Šçš„gdbserveråœ¨å‘å…‰"></p><h2 id="1-vscodeè°ƒè¯•ECUéªŒè¯"><a href="#1-vscodeè°ƒè¯•ECUéªŒè¯" class="headerlink" title="1. vscodeè°ƒè¯•ECUéªŒè¯"></a>1. vscodeè°ƒè¯•ECUéªŒè¯</h2><p>&emsp;&emsp;æœ‰äº†ä¸Šé¢æƒ³æ³•åï¼Œæˆ‘åˆç»è¿‡è¿›ä¸€æ­¥çš„åˆ†æï¼ŒçœŸçš„æ˜¯å¯è¡Œçš„ï¼Œæ˜¾ç¤ºåœ¨Googleæœç´¢äº†ä¸€ç•ªï¼ŒéªŒè¯äº†å¯è¡Œæ€§ï¼Œç„¶ååˆå¼€å§‹æ‰¾åº”è¯¥å¦‚ä½•åšã€‚ä¼°è®¡è¿™æ ·åšçš„äººå¹¶ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°æœ‰æ¯”è¾ƒå¥½çš„æ•™ç¨‹ã€‚æˆ‘çŸ¥é“è°ƒè¯•ç›¸å…³çš„é…ç½®éƒ½æ˜¯åœ¨launch.jsonä¸Šï¼Œæ‰€ä»¥æˆ‘åˆå»vscodeå®˜ç½‘å»äº†æ‰¾launch.jsonçš„è¯´æ˜ï¼Œçœ‹åˆ°äº†ä¸‹å›¾ï¼Œæˆ‘å°±å¼€å§‹é…ç½®äº†ã€‚<img src="/medias/use-vscode-debug/debugcfg.png" alt="Customizing GDB or LLDB"><br>ä¸Šå›¾å®˜ç½‘é“¾æ¥:<a href="https://code.visualstudio.com/docs/cpp/launch-json-reference">launch-json-reference</a>.</p><h2 id="2-vscodeè°ƒè¯•ECUé…ç½®"><a href="#2-vscodeè°ƒè¯•ECUé…ç½®" class="headerlink" title="2. vscodeè°ƒè¯•ECUé…ç½®"></a>2. vscodeè°ƒè¯•ECUé…ç½®</h2><p>&emsp;&emsp;æˆ‘å…ˆæ˜¯é…ç½®å¥½äº†gdbserverï¼Œæ¯•ç«Ÿåœ¨ECUä¸Š<code>gdbserver --help</code>ä¸€ä¸‹å°±éƒ½æœ‰äº†ï¼Œ<img src="/medias/use-vscode-debug/gdbservercfg.png" alt="gdbserver --help">.<br>æ‰€ä»¥æˆ‘ä¸€ä¸‹å°±è®²ecuç«¯çš„ç»™é…ç½®å¥½äº†:<code>gdbserver 172.20.1.199:21314 udsd</code>ï¼Œè¿è¡Œåå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/medias/use-vscode-debug/rungdbserver.png" alt="rungdbserver"><br>ç„¶åå°±æ˜¯é…ç½®vscodeç«¯äº†ï¼Œä¹Ÿå°±æ˜¯gbd clientç«¯ï¼ŒæœŸé—´ä¹Ÿæœ‰å¾ˆå¥½å¤šæ¬¡çš„è¯•é”™ï¼Œå…·ä½“è¿‡ç¨‹ä¸è¡¨äº†ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p><ol><li>gdbserver â€“helpå›¾ä¸­æ˜¾ç¤ºçš„HOSTæ˜¯clientç«¯çš„IPï¼Œè€Œä¸æ˜¯gdbserverç«¯çš„IPã€‚</li><li>miDebuggerPathä¸­çš„è·¯å¾„æ˜¯æŒ‡çš„vscodeå®é™…è¿è¡Œçš„æœºå™¨ä¸Šçš„å·¥å…·ï¼Œè€Œä¸æ˜¯ECUç«¯èƒ½å¤Ÿè¿è¡Œçš„å·¥å…·ï¼Œäº¤å‰ç¼–è¯‘ç¯å¢ƒä¸‹éœ€è¦åŠå…¶çš„æ³¨æ„è¿™ä¸€ç‚¹ã€‚ps:æˆ‘è‡ªå·±ç”¨æºç ç¼–è¯‘å‡ºæ¥çš„å·¥å…·ä¹Ÿæ²¡æˆåŠŸï¼Œæœ€åæ‰¾ä¾›åº”å•†ç”¨yoctoåˆ¶ä½œå‡ºæ¥çš„å·¥å…·é“¾ä¸Šå¸¦çš„x86_64çš„å·¥å…·å°±å¯ä»¥äº†ã€‚<br>vscodeä¸Šçš„é…ç½®å¦‚ä¸‹å›¾ï¼Œé»˜è®¤è¯»è€…å·²ç»ä¼švscodeä¸Šçš„debugäº†ï¼š<img src="/medias/use-vscode-debug/gdbclientcfg.png" alt="vscode gbdé…ç½®">.</li></ol><h2 id="3-è°ƒè¯•å‰çš„æœ€åéšœç¢"><a href="#3-è°ƒè¯•å‰çš„æœ€åéšœç¢" class="headerlink" title="3. è°ƒè¯•å‰çš„æœ€åéšœç¢"></a>3. è°ƒè¯•å‰çš„æœ€åéšœç¢</h2><p>&emsp;&emsp;åšå®Œä¸Šé¢çš„é…ç½®åï¼Œæˆ‘ä»¥ä¸ºè¿™ä¹ˆç®€å•å°±å¯ä»¥debugäº†ã€‚å‘ç°åªèƒ½è¿è¡Œä½†æ˜¯ä¸èƒ½æ‰“æ–­ç‚¹ï¼Œçœ‹äº†ä¸‹cmakeç”Ÿæˆçš„Makefileï¼Œå‘ç°ç”Ÿæˆçš„Makefileä¸Šflagæ˜¾ç¤ºçš„æ˜¯NDEBUGï¼š<img src="/medias/use-vscode-debug/NDEBUG.png" alt="makefile NDEBUG">ã€‚ä½†æ˜¯æˆ‘å·²ç»åœ¨CMakeLists.txtä¸Šé…ç½®<code>set(CMAKE_BUILD_TYPE Debug)</code>ï¼Œä¾ç„¶æ²¡æœ‰ç”Ÿæ•ˆã€‚åé¢æˆ‘å°±ä½¿ç”¨äº†ï¼Œ<code>add_definitions(&quot;-g&quot;)</code>å¼ºåˆ¶æ¥åŠ ä¸Š-gé€‰é¡¹ï¼Œæœç„¶å¯ä»¥debugäº†ã€‚åˆ°è¿™å°±å¤§åŠŸææˆäº†ï¼Œé¢†å¯¼å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘æ•ˆç‡ä¸é«˜äº†ã€‚</p><h2 id="4-æœ€åéšœç¢çš„åˆ¨æ ¹é—®åº•"><a href="#4-æœ€åéšœç¢çš„åˆ¨æ ¹é—®åº•" class="headerlink" title="4. æœ€åéšœç¢çš„åˆ¨æ ¹é—®åº•"></a>4. æœ€åéšœç¢çš„åˆ¨æ ¹é—®åº•</h2><p>&emsp;&emsp;ä½œä¸ºæœ‰æŠ€æœ¯æ´ç™–ï¼ˆè‡ªå¤§ï¼‰çš„äººï¼Œä¸å¤ªèƒ½å¿å—ä¸Šé¢çš„â€œè‚®è„â€è§£å†³åŠæ³•ï¼Œå°±å»äº†é—®äº†å¤§ç¥Rickyï¼ˆè¤’ä¹‰è¯çš„å…¨èƒ½ç¥ï¼‰ï¼Œå¥½å®¶ä¼™å¥½å®¶ä¼™ï¼Œå¤§ç¥æ•²é”®ç›˜çš„é€Ÿåº¦ï¼Œåœ¨æˆ‘æè¿°å®Œé—®é¢˜ä¹‹å‰å°±æŠŠå¼•å‘é—®é¢˜çš„åœ°æ–¹æ‰“å¼€å¹¶ä¸”æ¼”ç¤ºå®Œæ¯•äº†ã€‚<code>é€Ÿåº¦å¤ªå¿«äº†ï¼Œæˆ‘ä¸æƒ³å¿äº†ã€‚</code>åœ¨å¤§ç¥çš„è§£é‡Šä¸‹ï¼ŒåŸå› å°±æ˜¯äº¤å‰ç¼–è¯‘æ—¶ä¼šä½¿ç”¨toolchainä¸Šçš„cmakeé…ç½®ï¼Œå³å°†äº¤å‰ç¼–è¯‘å¿…é¡»çš„ä¸€äº›é€‰é¡¹é…ç½®å¥½ï¼Œè€Œtoolchainä¸Šé»˜è®¤æ˜¯å‘å¸ƒçš„releaseç‰ˆæœ¬è€Œä¸æ˜¯debugï¼Œå¹¶ä¸”ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œæ‰€ä»¥ä¼šè¦†ç›–è‡ªå·±åœ¨cmakeä¸Šçš„é…ç½®ã€‚toolchain.cmakeé…ç½®å¦‚ä¸‹å›¾ï¼š<img src="/medias/use-vscode-debug/cmakendebug.png" alt="toolchain.cmake NDEBUG"></p><h1 id="ä¸‰ã€æœ€åå‘¢"><a href="#ä¸‰ã€æœ€åå‘¢" class="headerlink" title="ä¸‰ã€æœ€åå‘¢"></a>ä¸‰ã€æœ€åå‘¢</h1><p>&emsp;&emsp;è¿™ç¯‡æ–‡ç« æ ‡å¿—ç€æˆ‘è¦å¼€å§‹åœ¨ECUä¸Šè°ƒè¯•äº†ï¼Œä¹Ÿæš—ç¤ºç€æˆ‘4 5ä¸ªæœˆçš„é‡æ„å¼€å§‹è¿›å…¥äº†æœ€åé˜¶æ®µäº†ã€‚è¿™å‡ ä¸ªæœˆå…¶å®å‹åŠ›è¿˜æ˜¯è›®å¤§çš„ï¼Œç»Ÿè®¡äº†ä¸‹ä»£ç é‡ï¼Œ17000è¡Œçš„ä»£ç è¶…è¿‡äº†æˆ‘å»å¹´ä¸€å¹´çš„ä»£ç é‡ï¼Œç›®å‰æ¥çœ‹æ˜¯è¾¾åˆ°äº†è·³æ§½çš„ç›®çš„ï¼Œæ”¾å¼ƒteam leaderè¿˜æ˜¯å¾ˆå€¼å½“çš„ã€‚å¹¶ä¸”ç†Ÿèƒ½ç”Ÿå·§ï¼Œå‰æ®µæ—¶é—´æ²¡å¤ªæœ‰æ—¶é—´å°±æ˜¯å› ä¸ºæˆ‘è‡ªå·±å†™å®Œäº†ä¹Ÿä¼šå†æ€è€ƒæ€è€ƒè¿˜æœ‰æ²¡æœ‰æ”¹è¿›çš„ç©ºé—´ï¼Œä»£ç é‡ä¸Šæ¥äº†ï¼Œå…³äºç»“æ„ã€è€¦åˆæ€§æ˜¯ä¼šä¸ç”±è‡ªä¸»å°±å»è€ƒè™‘çš„ã€‚ç°åœ¨è¿›å…¥äº†æ–°é˜¶æ®µï¼Œè¡Œç™¾é‡Œè€…åŠä¹åï¼Œå¸Œæœ›èƒ½æœ‰ä¸ªå¥½çš„ç»“æœã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vscode </tag>
            
            <tag> gdb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cmake--åŠ¨æ€åº“ä¹‹é…ç½®ï¼ˆç¬¬ä¸€ç¯‡ï¼‰</title>
      <link href="2021/06/20/cmake1/"/>
      <url>2021/06/20/cmake1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è®°å½•æœ€è¿‘ä½¿ç”¨cmakeé‡åˆ°å’Œè§£å†³çš„é—®é¢˜</p></blockquote><h1 id="ä¸€ã€-å…³äºcmake"><a href="#ä¸€ã€-å…³äºcmake" class="headerlink" title="ä¸€ã€ å…³äºcmake"></a>ä¸€ã€ å…³äºcmake</h1><blockquote><p>cmakeæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å®‰è£…ï¼ˆç¼–è¯‘ï¼‰å·¥å…·ï¼Œå¯ä»¥ç”¨ç®€å•çš„è¯­å¥æ¥æè¿°æ‰€æœ‰å¹³å°çš„å®‰è£…(ç¼–è¯‘è¿‡ç¨‹)ã€‚èƒ½å¤Ÿè¾“å‡ºå„ç§å„æ ·çš„makefileæˆ–è€…projectæ–‡ä»¶ï¼Œèƒ½æµ‹è¯•ç¼–è¯‘å™¨æ‰€æ”¯æŒçš„C++ç‰¹æ€§,ç±»ä¼¼UNIXä¸‹çš„automakeã€‚åªæ˜¯ CMake çš„ç»„æ€æ¡£å–åä¸º <em>CMakeLists.txt</em>ã€‚Cmake å¹¶ä¸ç›´æ¥å»ºæ„å‡ºæœ€ç»ˆçš„è½¯ä»¶ï¼Œè€Œæ˜¯äº§ç”Ÿæ ‡å‡†çš„å»ºæ„æ¡£ï¼ˆå¦‚ Unix çš„ Makefile æˆ– Windows Visual C++ çš„ projects/workspacesï¼‰ï¼Œç„¶åå†ä¾ä¸€èˆ¬çš„å»ºæ„æ–¹å¼ä½¿ç”¨ã€‚</p></blockquote><p>&emsp;&emsp;ä¸Šé¢æ˜¯æˆ‘éšä¾¿æŠ„çš„ï¼Œå› ä¸ºæˆ‘å†™ä¸å‡ºè¿™ä¹ˆè¨€ç®€æ„èµ…çš„å®šä¹‰ã€‚ä½†æ˜¯ä½ è®©åšmcuçš„äººçœ‹äº†ä¸Šè¿°å®šä¹‰å°±å¤§æ¦‚ç‡ç­‰äºç™½è¯´ã€‚å¤§éƒ¨åˆ†mcuçš„å¼€å‘è€…éƒ½æ˜¯åŸºäºå•†ä¸šçš„IDEï¼ˆç ´è§£æ˜¯è¿æ³•çš„å“¦ï¼‰æ¥ç¼–è¯‘ã€é“¾æ¥ç”šè‡³è°ƒè¯•ï¼Œè™½ç„¶ç°åœ¨å¾ˆå¤šmcuä¹Ÿå¼€å§‹ä½¿ç”¨makefileæ— ç•Œé¢çš„å½¢å¼æ¥æ‰§è¡Œç¼–è¯‘ï¼Œä½†æ˜¯ä¾ç„¶å¾ˆå¤šäººä¸çŸ¥é“Makefileã€‚ä½†æ˜¯ç”¨ideï¼Œä½ ä¾ç„¶éœ€è¦é…ç½®å¤´æ–‡ä»¶è·¯å¾„å•Šï¼Œç¼–è¯‘ç­‰çº§å•Šï¼Œè¾“å‡ºçš„è·¯å¾„ä»¥åŠåå­—å•Šï¼Œç”Ÿæˆåº“ï¼ˆåŸºæœ¬éƒ½æ˜¯é™æ€åº“ï¼‰è¿˜æ˜¯å¯æ‰§è¡Œæ–‡ä»¶å•Šï¼Œç­‰ç­‰ã€‚æ•´å®Œè¿™äº›é…ç½®å¥½ï¼Œæ‰¾ä¸ªğŸ”¨ï¼ˆbuildï¼‰ï¼Œä¸€ç‚¹ï¼Œå°±å¼€å§‹ç¼–è¯‘ï¼Œä¸æˆåŠŸï¼Œæ”¹æ”¹é…ç½®æ”¹æ”¹ä»£ç ï¼Œç›´åˆ°ç¼–è¯‘é€šè¿‡ï¼Œå¾ˆå°‘æœ‰äººä¼šå…³ç³»IDEåšäº†é‚£äº›äº‹ã€‚<br>&emsp;&emsp;é‚£IDEåˆ°åº•åšäº†é‚£äº›äº‹å‘¢ï¼Œåœ¨äº¤å‰ç¼–è¯‘ï¼ˆæš‚ä¸”è¿™ä¹ˆç†è§£å§ï¼Œæ¯•ç«Ÿéƒ½æ˜¯åœ¨windowså¹³å°ç¼–è¯‘æˆmcuå¯æ‰§è¡Œçš„æ–‡ä»¶äº†ï¼‰ä¹‹å‰ï¼ŒIDEå¾ˆé‡è¦çš„ä¸€ä»¶äº‹å°±æ˜¯æ ¹æ®ä½ ä¸Šé¢çš„ä¸€å †é…ç½®ï¼Œç”ŸæˆMakefileæ–‡ä»¶æˆ–è€…Makefileæ–‡ä»¶ï¼Œç„¶åæ‰æ˜¯ç¼–è¯‘ã€é“¾æ¥ã€è¾“å‡ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚åŒæ ·çš„cmakeä¸€ä¸ªå¾ˆé‡è¦çš„åŠŸèƒ½å°±æ˜¯ç”¨é‚£ä¸ªæ¥ç”ŸæˆMakefileæ–‡ä»¶æˆ–è€…projectæ–‡ä»¶ï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–ä½œç”¨ï¼Œå½“ç„¶è¿˜æœ‰äº†ï¼Œæ¯”å¦‚è®©å®ƒç”Ÿæˆshellè„šæœ¬ä¹‹ç±»ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯é«˜çº§ç”¨æ³•ï¼Œåé¢ç”¨åˆ°ï¼Œè¿˜ä¼šç»§ç»­å±•å¼€çš„ã€‚</p><h2 id="cmakeæ€ä¹ˆå­¦"><a href="#cmakeæ€ä¹ˆå­¦" class="headerlink" title="cmakeæ€ä¹ˆå­¦"></a>cmakeæ€ä¹ˆå­¦</h2><p>&emsp;&emsp;ä¸€å¥è¯ï¼šåŠå…¶å®¹æ˜“å…¥é—¨ï¼Œä½†æ˜¯æ·±å…¥ä½¿ç”¨æœ‰éš¾åº¦ã€‚æˆ‘forkäº†ä¸€ä¸ª<a href="https://github.com/jinbaotang/cmake-examples">githubä»“åº“â€“cmake-examples</a>ï¼Œå¯¹ç€ä¸Šé¢çš„ç¤ºä¾‹ï¼ŒåŸºæœ¬ä¸ŠæŠŠé‚£å¤©å°±ä»æ— çŸ¥åˆ°æ•¢å†™é‡äº§ä»£ç é‡Œäº†ï¼Œçœ‹ä¸‹ä¸‹é¢çš„ç¤ºä¾‹ï¼Œåé¢ä½ å°±èƒ½<code>cmake</code>,<code>make</code>,<code>ç¼–è¯‘æˆåŠŸ</code>ï¼Œæ˜¯ä¸æ˜¯ç®€ç›´ä¸è¦å¤ªç®€å•ã€‚å¦‚æœæ˜¯å·²ç»å·¥ä½œäº†çš„å°å“¥/å°å¦¹æˆ–è€…æƒ³å¿«é€Ÿä¸Šæ‰‹çš„å­¦ç”Ÿï¼Œçœ‹å®Œ01/02å°±å·²ç»å…¥é—¨äº†ï¼Œ03ä»¥åè®²çš„çš„å•¥ï¼Œæˆ‘ä¹Ÿæ²¡çœ‹è¿‡ï¼Œä½†è¿™å¹¶ä¸å½±å“æˆ‘å†™ä»£ç ã€å†™<em>CMakeLists.txt</em>ã€‚å› ä¸ºæ®è¯´ï¼Œå‰é¢ä¸¤ç« åªè®²äº†20%çš„çŸ¥è¯†ï¼Œä½†æ˜¯å´å¯ä»¥è¦†ç›–80%çš„åº”ç”¨åœºæ™¯ã€‚æˆ‘å­¦å®Œå‰ä¸¤ç« åï¼Œå°±å¼€å§‹å¹²æ´»äº†ï¼Œé‡åˆ°äº†ä¸ä¼šçš„ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ç™¾åº¦äº†ã€‚æ‰€ä»¥å»ºè®®å…ˆå­¦å‰ä¸¤ç« ï¼Œå‰©ä¸‹çš„å¯ä»¥åœ¨å·¥ä½œé¡¹ç›®å®æ“ä¸­æ…¢æ…¢é”»ç‚¼ï¼Œæ…¢æ…¢å­¦ä¹ ï¼›å¦‚æœæ˜¯æ—¶é—´å……è¶³çš„å­¦ç”Ÿï¼Œæˆ‘è§‰å¾—æ•´ä¸ªä¸€èµ·å­¦å®Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„äº‹æƒ…ã€‚</p><pre class="line-numbers language-cmake" data-language="cmake"><code class="language-cmake"><span class="token comment"># Set the minimum version of CMake that can be used</span><span class="token comment"># To find the cmake version run</span><span class="token comment"># $ cmake --version</span><span class="token keyword">cmake_minimum_required</span><span class="token punctuation">(</span><span class="token property">VERSION</span> <span class="token number">3.5</span><span class="token punctuation">)</span><span class="token comment"># Set the project name</span><span class="token keyword">project</span> <span class="token punctuation">(</span>hello_cmake<span class="token punctuation">)</span><span class="token comment"># Add an executable</span><span class="token keyword">add_executable</span><span class="token punctuation">(</span>hello_cmake main.cpp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ä¸€å¼€å§‹ï¼Œæˆ‘ä¸€ä¸ªåœ¨linuxå¼€å‘çš„åŒäº‹ï¼Œæ¨èæˆ‘ç”¨cmakeæ¥ç€ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å–œæ¬¢åœ¨<em>visual studio</em>ï¼Œå¦‚æœæ˜¯linuxï¼Œæˆ‘å°±<strong>vs</strong>çš„sshè¿œç¨‹è°ƒè¯•ã€‚ç­‰åé¢è‡ªå·±æ•´vsomeipæ—¶ï¼Œä¸å¾—ä¸é¢å¯¹cmakeï¼Œ<strong>å¯çœŸé¦™</strong>ï¼Œæœ‰éœ€æ±‚çš„åŒäº‹å°½å¿«ç”¨èµ·æ¥å§ã€‚å¦å¤–ï¼Œç”±äºcmakeç‰ˆæœ¬æ›´æ–°å¾ˆå¿«ï¼Œä¸€äº›å†·é—¨ç”¨æ³•ä¹Ÿä¸è¦æ­»è®°ç¡¬èƒŒäº†ï¼Œèƒ½ä¸ç”¨ä¹Ÿå°½é‡ä¸ç”¨äº†ï¼Œä¸ç„¶ç»™åˆ«äººç”¨æ—¶ï¼Œå®¹æ˜“å‡ºç°å…¼å®¹æ€§é—®é¢˜ã€‚</p><h1 id="äºŒã€-è¿™ç¯‡çš„ä¸»é¢˜"><a href="#äºŒã€-è¿™ç¯‡çš„ä¸»é¢˜" class="headerlink" title="äºŒã€ è¿™ç¯‡çš„ä¸»é¢˜"></a>äºŒã€ è¿™ç¯‡çš„ä¸»é¢˜</h1><p>&emsp;&emsp;è¿™ç¯‡ä¸»é¢˜ä¸»è¦æ˜¯åœ¨ç”¨cmakeæ„å»ºåŠ¨æ€åº“æ—¶ï¼Œé‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œè§£å†³æ€è·¯ï¼ŒåŸºæœ¬éƒ½æ˜¯å¯¼å‡ºgoogle/baiduæ‰¾çš„ï¼Œå†™å‡ºæ¥ä¸€æ–¹é¢æ˜¯ä¸ºäº†è®°å½•ï¼Œä¸€æ–¹é¢æ˜¯åšä¸ªé—®é¢˜é›†ã€‚</p><h2 id="1-å…³äº-fPIC"><a href="#1-å…³äº-fPIC" class="headerlink" title="1. å…³äº-fPIC"></a>1. å…³äº-fPIC</h2><pre class="line-numbers language-gnuæ‰‹å†Œ" data-language="gnuæ‰‹å†Œ"><code class="language-gnuæ‰‹å†Œ">-fpicGenerate position-independent code (PIC) suitable for use in a shared library, if supported for the target machine. Such code accesses all constant addresses through a global offset table (GOT). The dynamic loader resolves the GOT entries when the program starts (the dynamic loader is not part of GCC; it is part of the operating system). If the GOT size for the linked executable exceeds a machine-specific maximum size, you get an error message from the linker indicating that -fpic does not work; in that case, recompile with -fPIC instead. (These maximums are 8k on the SPARC, 28k on AArch64 and 32k on the m68k and RS&#x2F;6000. The x86 has no such limit.)Position-independent code requires special support, and therefore works only on certain machines. For the x86, GCC supports PIC for System V but not for the Sun 386i. Code generated for the IBM RS&#x2F;6000 is always position-independent.When this flag is set, the macros __pic__ and __PIC__ are defined to 1.-fPICIf supported for the target machine, emit position-independent code, suitable for dynamic linking and avoiding any limit on the size of the global offset table. This option makes a difference on AArch64, m68k, PowerPC and SPARC.Position-independent code requires special support, and therefore works only on certain machines.When this flag is set, the macros __pic__ and __PIC__ are defined to 2.-fpie-fPIEThese options are similar to -fpic and -fPIC, but the generated position-independent code can be only linked into executables. Usually these options are used to compile code that will be linked using the -pie GCC option.-fpie and -fPIE both define the macros __pie__ and __PIE__. The macros have the value 1 for -fpie and 2 for -fPIE.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;-fPICä¸-fpicéƒ½æ˜¯åœ¨ç¼–è¯‘æ—¶åŠ å…¥çš„é€‰é¡¹ï¼Œç”¨äºç”Ÿæˆä½ç½®æ— å…³çš„ä»£ç (Position-Independent-Code)ã€‚è¿™ä¸¤ä¸ªé€‰é¡¹éƒ½æ˜¯å¯ä»¥ä½¿ä»£ç åœ¨åŠ è½½åˆ°å†…å­˜æ—¶ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼Œæ‰€æœ‰å¯¹å›ºå®šåœ°å€çš„è®¿é—®éƒ½é€šè¿‡å…¨å±€åç§»è¡¨(GOT)æ¥å®ç°ã€‚-fPICå’Œ-fpicæœ€å¤§çš„åŒºåˆ«åœ¨äºæ˜¯å¦å¯¹GOTçš„å¤§å°æœ‰é™åˆ¶ã€‚-fPICå¯¹GOTè¡¨å¤§å°æ— é™åˆ¶ï¼Œæ‰€ä»¥å¦‚æœåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨-fPICæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ä½†æ˜¯å¦‚æœä½ è¦åŠ¨æ€åº“é“¾æ¥é™æ€åº“æ—¶ï¼Œæ˜¯éœ€è¦æŠŠè¿™ä¸ªå–æ¶ˆçš„ï¼Œä¸ç„¶ç¼–è¯‘å°±ä¼šå‡ºé”™äº†ï¼ŒåŸå› æ˜¯é™æ€åº“æœ¬è´¨ä¸Šæ˜¯ä¸€å †**.o*<em>æ–‡ä»¶çš„é›†åˆï¼Œåœ°å€ç©ºé—´æ˜¯ç»å¯¹ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¯</em>position-independent code (PIC)*çš„ï¼Œæ‰€ä»¥å¦‚æœåŠ¨æ€åº“åŠ ä¸Š-fPICè‡ªç„¶ä¼šå¯¼è‡´ç¼–è¯‘å‡ºé”™ï¼Œå‡ºé”™å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">relocation R_X86_64_PC32 against symbol &#96;xxxxxxx&#39; can not be used when making a shared object; recompile with -fPICfinal link failed: Bad value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœéœ€è¦åœ¨åŠ ä¸Š-fPICçš„è¯ï¼Œå°±å¯ä»¥åœ¨<em>CMakeLists.txt</em>ä¸­åŠ ä¸Šè¿™å¥å°±å¥½äº†ï¼š<code>set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -fPIC&quot;)</code>.<br>ä¸Šé¢æ˜¯å…³äº-fPICçš„ç›¸å…³çŸ¥è¯†ä»¥åŠcmakeè¦å¦‚ä½•é…ç½®ï¼Œä½†æ˜¯æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬åº“ä¸Šçš„æŸä¸ªæ¨¡å—é»˜è®¤ç¼–è¯‘å‡ºæ¥çš„æ˜¯é™æ€åº“ï¼Œä½†æ˜¯æˆ‘çš„åŠ¨æ€åº“å¹¶ä¸”å³ä½¿æˆ‘çš„<em>CMakeLists.txt</em>ä¸Šæ²¡æœ‰åŠ ä¸Š-fPICè¿™ä¸ªflagï¼Œåœ¨ç”Ÿæˆçš„Makefileé‡Œä¾ç„¶æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™å¯¼è‡´æˆ‘åé¢é“¾æ¥æ—¶å°±ä¼šå‡ºç°å‰é¢æåˆ°çš„-fPICé”™è¯¯äº†ã€‚<img src="/medias/cmake1/makefile_fPIC.png" alt="makefile -fPIC"><br>ç›´åˆ°ç°åœ¨ï¼ˆ2021.06.21ï¼‰å¹¶æ²¡æœ‰æ‰¾åˆ°åŸå› åœ¨å“ªé‡Œã€‚ç„¶åè§£å†³åŠæ³•æ—¶ï¼Œè®©åº“ä¸Šçš„æ¨¡å—ç”Ÿæˆåå­—ç›¸åŒçš„åŠ¨æ€åº“å’Œæˆé™æ€åº“ï¼Œç„¶ååœ¨<em>CMakeLists.txt</em>é‡ŒæŒ‡å®šä½¿ç”¨åŠ¨æ€åº“ã€‚<br>ç½‘ä¸Šæˆ‘çœ‹å¥½å¤šäººè¯´ï¼Œå¦‚æœä½¿ç”¨<code>target_link_libraries()</code>ä¸æŒ‡å®šåº“çš„ç±»å‹ï¼Œä¼˜å…ˆé“¾æ¥åŠ¨æ€åº“ï¼ˆä¹Ÿæœ‰äººè¯´ä¼˜å…ˆé™æ€åº“ï¼‰ï¼Œä¸çŸ¥é“æ˜¯å¦ä¸ªç‰ˆæœ¬æœ‰å…³è¿˜æ˜¯ç½‘å‹è¯¯è§£äº†ï¼Œä»å®˜ç½‘æˆ‘ä¹Ÿæ²¡æ‰¾åˆ°å¯¹åº”çš„ä¾æ®ï¼Œåœ¨æˆ‘çš„<code>cmake 3.10.2</code>ä¸­ï¼Œä¸æ˜¾ç¤ºæŒ‡å®šåº“çš„ç±»å‹ï¼Œé»˜è®¤æ˜¯ä¼˜å…ˆé“¾æ¥é™æ€åº“çš„ã€‚</p><h2 id="2-å¦‚ä½•æŒ‡å®šcmakeé“¾æ¥åº“çš„ç±»å‹"><a href="#2-å¦‚ä½•æŒ‡å®šcmakeé“¾æ¥åº“çš„ç±»å‹" class="headerlink" title="2. å¦‚ä½•æŒ‡å®šcmakeé“¾æ¥åº“çš„ç±»å‹"></a>2. å¦‚ä½•æŒ‡å®šcmakeé“¾æ¥åº“çš„ç±»å‹</h2><p>å¦‚æœè¦æ˜¾ç¤ºçš„åˆ¶å®šé“¾æ¥é™æ€åº“è¿˜æ˜¯åŠ¨æ€åº“ï¼Œåªéœ€è¦åŠ ä¸Šåç¼€å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-cmake" data-language="cmake"><code class="language-cmake"><span class="token comment">#```````linux ``````````</span><span class="token comment">#Dynamic library </span><span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx demo.so<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx libdemo.so<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx -ldemo.so<span class="token punctuation">)</span> <span class="token comment">#staic library </span><span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx demo.a<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx libdemo.a<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx -ldemo.a<span class="token punctuation">)</span> <span class="token comment">#```````windows(msvc) ``````````</span><span class="token comment">#Dynamic library </span><span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx demo.dll<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx libdemo.dll<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx -ldemo.dll<span class="token punctuation">)</span> <span class="token comment">#staic library </span><span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx demo.lib<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx libdemo.lib<span class="token punctuation">)</span> <span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>xxx -ldemo.lib<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-å³ç”Ÿæˆé™æ€åº“ä¹Ÿç”ŸæˆåŠ¨æ€åº“"><a href="#3-å³ç”Ÿæˆé™æ€åº“ä¹Ÿç”ŸæˆåŠ¨æ€åº“" class="headerlink" title="3. å³ç”Ÿæˆé™æ€åº“ä¹Ÿç”ŸæˆåŠ¨æ€åº“"></a>3. å³ç”Ÿæˆé™æ€åº“ä¹Ÿç”ŸæˆåŠ¨æ€åº“</h2><p>&emsp;&emsp;åœ¨ç¬¬ä¸€èŠ‚æåˆ°äº†ï¼Œé’ˆå¯¹-fPICçš„é‚£ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å³ç”ŸæˆåŠ¨æ€åº“ä¹Ÿç”Ÿæˆé™æ€åº“ã€‚é‚£å¦‚ä½•æ‰èƒ½å³ç”Ÿæˆé™æ€åº“åˆç”ŸæˆåŠ¨æ€åº“å‘¢ï¼Œå¦‚æœç›´æ¥å†™ä¸Šï¼Œ<em>æ³¨ï¼š <code>add_library</code>å¦‚æœä¸åŠ ä»»ä½•é€‰é¡¹ï¼Œé»˜è®¤ç”Ÿæˆé™æ€åº“</em>ï¼š</p><pre class="line-numbers language-none"><code class="language-none">add_library($&#123;PROJECT_NAME&#125; demo.c)add_library($&#123;PROJECT_NAME&#125; SHARED demo.c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ˜¯ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯çš„:<img src="/medias/cmake1/cmake_shared_static_error.png" alt="cmake error"><br>å› ä¸ºå®˜æ–¹æ–‡æ¡£å·²ç»æè¿°çš„å¾ˆæ¸…æ¥šäº†ï¼Œæ„æ€å°±æ˜¯ï¼Œä½¿ç”¨ add_library(<name> â€¦) ç”Ÿæˆç›®æ ‡æ–‡ä»¶æ—¶ä¸èƒ½ä½¿ç”¨ç›¸åŒ <name>ã€‚ï¼š</p><pre class="line-numbers language-none"><code class="language-none">add_library(&lt;name&gt; [STATIC | SHARED | MODULE]            [EXCLUDE_FROM_ALL]            [source1] [source2 ...])            Adds a library target called &lt;name&gt; to be built from the source files listed in the command invocation. (The source files can be omitted here if they are added later using target_sources().) The &lt;name&gt; corresponds to the logical target name and must be globally unique within a project. The actual file name of the library built is constructed based on conventions of the native platform (such as lib&lt;name&gt;.a or &lt;name&gt;.lib).<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥è§£å†³æ–¹æ¡ˆæ˜¯ï¼šé¦–å…ˆç”Ÿæˆ<strong>libdemo-static.a</strong>ï¼Œç„¶åä½¿ç”¨ set_target_properties() æŒ‡ä»¤çš„ OUTPUT_NAME å‚æ•°ï¼Œå°†<strong>libdemo-static.a</strong> é‡å‘½åä¸º libdemo.aï¼Œå³å¯ç”Ÿæˆåå­—ç›¸åŒçš„åŠ¨æ€åº“å’Œæˆé™æ€åº“ã€‚<br>å…·ä½“å°±æ˜¯å¦‚ä¸‹æ‰€ç¤º(æœªæµ‹è¯•)ï¼š</p><pre class="line-numbers language-cmake" data-language="cmake"><code class="language-cmake"><span class="token keyword">cmake_minimum_required</span><span class="token punctuation">(</span><span class="token property">VERSION</span> <span class="token number">3.0</span><span class="token punctuation">)</span><span class="token keyword">project</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span><span class="token keyword">add_library</span><span class="token punctuation">(</span>demo SHARE demo.c<span class="token punctuation">)</span><span class="token keyword">add_library</span><span class="token punctuation">(</span>demo-static tigerLogging.c<span class="token punctuation">)</span><span class="token function">SET_TARGET_PROPERTIES</span><span class="token punctuation">(</span>demo-static <span class="token namespace">PROPERTIES</span> <span class="token property">OUTPUT_NAME</span> <span class="token string">"demo"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-å…³äº-Wl-no-undefined"><a href="#4-å…³äº-Wl-no-undefined" class="headerlink" title="4. å…³äº-Wl,--no-undefined"></a>4. å…³äº<code>-Wl,--no-undefined</code></h2><h3 id="åŠ¨æ€åº“å’Œé™æ€åº“â€“éšä¾¿è°ˆè°ˆ"><a href="#åŠ¨æ€åº“å’Œé™æ€åº“â€“éšä¾¿è°ˆè°ˆ" class="headerlink" title="åŠ¨æ€åº“å’Œé™æ€åº“â€“éšä¾¿è°ˆè°ˆ"></a>åŠ¨æ€åº“å’Œé™æ€åº“â€“éšä¾¿è°ˆè°ˆ</h3><p>&emsp;&emsp;é™æ€åº“å’ŒåŠ¨æ€åº“çš„åŒºåˆ«ï¼Œæˆ‘è®¡åˆ’ä½¿ç”¨ä¸€ç¯‡æ–‡ç« ï¼ˆæˆ–è€…ä¸€ä¸ªå¤§ç« èŠ‚ï¼‰æ¥è®°å½•ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å±•å¼€è®²è§£äº†ã€‚<br><strong>é™æ€åº“</strong>ï¼šæœ¬è´¨ä¸Šå’Œ*.o*æ–‡ä»¶çš„å‹ç¼©åŒ…æ²¡å•¥åŒºåˆ«ã€‚<br><strong>é™æ€åº“</strong>ï¼šç‰¹åˆ«æ¥è¿‘ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ–è€…ç¼–è¯‘é“¾æ¥æ—¶å°±å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¯è¡Œæ–‡ä»¶ã€‚</p><p>&emsp;&emsp;åŸºäºä¸Šé¢é™æ€åº“å’ŒåŠ¨æ€åº“çš„ç‰¹æ€§ï¼Œè½¯ä»¶æ¨¡å—ç¼–è¯‘æˆåº“æ—¶ï¼Œæˆ‘åŸºæœ¬éƒ½ä¼šå°†è½¯ä»¶æ¨¡å—ç¼–è¯‘æˆåŠ¨æ€åº“è€Œä¸æ˜¯é™æ€åº“ï¼Œæœ€åç»™åˆ«äººç”¨æ—¶ï¼Œæ˜¯ä½¿ç”¨é™æ€åº“è¿˜æ˜¯åŠ¨æ€åº“ï¼Œå°±å…·ä½“æƒ…å†µå…·ä½“åˆ†æäº†ã€‚è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥ä¿è¯ä½ çš„è½¯ä»¶æ¨¡å—æœ€å¤§ç¨‹åº¦çš„å’Œåˆ«äººè§£è€¦ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªé“¾æ¥çš„è¿‡ç¨‹ã€‚ä½†æ˜¯ä½†æ˜¯å¦‚æœç¼–è¯‘åŠ¨æ€åº“æ—¶ï¼Œæ²¡æœ‰åŠ ä¸Š<code>-Wl,--no-undefined</code>è¿™ä¸ªé€‰é¡¹ï¼Œå°±ä¼šå¯¼è‡´ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°åªæœ‰å£°æ˜ï¼Œæ²¡æœ‰å®šä¹‰ï¼Œä¹Ÿèƒ½æ­£ç¡®çš„ç”ŸæˆåŠ¨æ€åº“ï¼Œä½†åˆ°æœ€åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶åï¼ŒåŠ è½½é˜¶æ®µå€Ÿå›æŠ¥<code>undefined reference to `xxxx` </code>ã€‚ä¸ºäº†è®©é”™è¯¯åœ¨ç¼–è¯‘åŠ¨æ€åº“æ—¶å³æŠ¥å‡ºæ¥ï¼Œè¿™æ ·åœ¨å›¢é˜Ÿåˆä½œå¼€å‘å°±å¯ä»¥æ›´é¡ºç•…äº†ï¼Œå°±å¯ä»¥åœ¨åŠ ä¸Š<code>-Wl,--no-undefined</code>ï¼Œè¿™ä¸ªé€‰é¡¹çš„æ„æ€æ˜¯ï¼šå¦‚æœsoé‡Œæœ‰æœªå®šä¹‰ç¬¦å·ï¼Œåˆ™ç¼–è¯‘ä¸é€šè¿‡ã€‚åœ¨<em>CMakeLists.txt</em>ä¸ŠåŠ ä¸Šå¦‚ä¸‹è¯­å¥ï¼š</p><pre class="line-numbers language-none"><code class="language-none">set(CMAKE_SHARED_LINKER_FLAGS &quot;-Wl,--no-undefined&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="ä¸‰ã€-å†™åœ¨æœ€å"><a href="#ä¸‰ã€-å†™åœ¨æœ€å" class="headerlink" title="ä¸‰ã€ å†™åœ¨æœ€å"></a>ä¸‰ã€ å†™åœ¨æœ€å</h1><p>&emsp;&emsp;æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œcmakeæˆ‘ä¹Ÿæ˜¯è¾¹ç”¨è¾¹å­¦ã€‚ä½†æ˜¯å…¶å®è¿™å°±è¦æ±‚ä½ å¾—æœ‰ä¸€å®šçš„å…¶ä»–linuxåŸºç¡€ï¼Œæ¯”å¦‚Makefile/gccåŸºç¡€ï¼Œè¿™æ ·å°±èƒ½çŸ¥é“ç¼–è¯‘æ—¶è¿˜æœ‰è¿™äº›é€‰é¡¹ï¼Œåœ¨é‡åˆ°é—®é¢˜æ—¶æ‰ä¼šæƒ³èµ·å»æœåœ¨cmakeè¦å¦‚ä½•å®ç°ï¼›å½“ç„¶å¦‚æœåŸºç¡€çŸ¥è¯†è¶³å¤Ÿç‰¢å›ºï¼Œæ¯”å¦‚å¯¹åŠ¨æ€åº“å®šä¹‰ç†è§£éå¸¸åˆ°ä½ï¼Œä¹Ÿèƒ½å¯¹ç¬¬äºŒç« ç¬¬4èŠ‚æåˆ°ä¸œè¥¿ï¼Œä¼šæœ‰å¾ˆé«˜çš„æŠ€æœ¯æ•æ„Ÿåº¦ï¼Œæ­¤åˆ»å°±ä¼šæ¨¡ç³Šæœç´¢ï¼Œæˆ–è€…å°†è‡ªå·±çš„å¤§è‡´ç–‘æƒ‘å‘åˆ«äººæè¿°ï¼Œä»¥è·å¾—å¸®åŠ©ã€‚æ‰€ä»¥å¯¹æˆ‘æ¥è¯´ï¼Œæˆ‘åŸºæœ¬ä¸æŒ‘çŸ¥è¯†å’Œæ–¹å‘ï¼Œå•¥éƒ½çœ‹çœ‹ï¼Œå•¥éƒ½å­¦å­¦ï¼Œè¿™æ ·æ‰èƒ½åœ¨é‡åˆ°é—®é¢˜æ—¶ï¼Œä¿æŒå¾ˆé«˜çš„æ•æ„Ÿåº¦ï¼ŒçŒœæµ‹å‡ºå¤§è‡´çš„è§£å†³æ–¹å‘/æ–¹æ¡ˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cmake </category>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cmake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘æ˜¯å¦‚ä½•ä»MCUå¼€å‘è½¬åˆ°linuxå¼€å‘</title>
      <link href="2021/06/06/how-mcu2linux/"/>
      <url>2021/06/06/how-mcu2linux/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä»å¤§äºŒå¼€å§‹ç©å•ç‰‡æœºï¼Œ2019å¹´æƒ³è½¬linuxå¼€å‘ï¼Œä½†æ˜¯æ— ä»ä¸‹æ‰‹ï¼›åœ¨å·¥ä½œä¸­ï¼Œç»ˆäºåœ¨2020å¹´ä¸­æ— ç¼ã€å¹³æ»‘è¿‡æ¸¡åˆ°linuxä¸Šå¼€å‘ï¼Œæƒ³ä¼šè®®ä¸‹è‡ªå·±è½¬å˜ä¹‹è·¯ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›åé¢è‡ªå·±è¿›ä¸€æ­¥æˆé•¿åï¼Œç°åœ¨çš„è®¤çŸ¥æ˜¯å¯¹ï¼Œç„¶åèƒ½å¤Ÿå¸®åŠ©åŒæ ·è¿·æƒ‘å°ä¼™ä¼´ã€‚è‡³äºlinuxè½¬mcuï¼Œå‰ä¸¤å¹´åˆä½œçš„å°ä¼™ä¼´å°±æ˜¯çº¯linuxå‡ºç”Ÿï¼Œæ„Ÿè§‰è½¬mcuä¹Ÿæ˜¯éœ€è¦æ”¹å˜å›ºæœ‰è®¤çŸ¥ï¼Œä½†æ˜¯æ¯•ç«Ÿæ²¡æœ‰ç»å†è¿‡ï¼Œåˆ™ä¸å†å±•å¼€å™è¿°ã€‚<br><em>æ³¨ï¼š 19é¢†è¯ç»“å©šï¼Œ20å¹´å–œè¿æˆ‘çš„å°å®è´</em></p></blockquote><h1 id="ä¸€ã€-æ›¾ç»çš„è¿·èŒ«"><a href="#ä¸€ã€-æ›¾ç»çš„è¿·èŒ«" class="headerlink" title="ä¸€ã€ æ›¾ç»çš„è¿·èŒ«"></a>ä¸€ã€ æ›¾ç»çš„è¿·èŒ«</h1><p>&emsp;&emsp;2019å¹´çš„æ—¶å€™ï¼Œå°±æƒ³å¼€å§‹æ…¢æ…¢çš„å­¦linuxå¼€å‘ï¼Œç”±äºé‚£æ—¶å€™å·¥ä½œæ‰ä¸åˆ°ä¸€å¹´ï¼Œè‡ªå·±æœ¬èº«åˆä¸æ˜¯ç§‘ç­å‡ºç”Ÿï¼Œåœ¨å­¦æ ¡çš„æ˜¯åŸºæœ¬æ˜¯ä»¥å•ç‰‡æœºï¼ˆMCUï¼‰å¼€å‘ä¸ºä¸»ï¼Œæ‰€ä»¥é‚£æ—¶å€™æƒ³å­¦ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸çŸ¥é“ä»ä½•å…¥æ‰‹ï¼Œå¹¶ä¸”æƒ³å­¦çš„åˆç‰¹åˆ«å¤šï¼Œå‚»ä¸å‚»åˆ†ä¸æ¸…BSPå’Œlinuxå¼€å‘ï¼Œé‚£æ—¶å€™å°±æŒºè¿·èŒ«çš„ã€‚æ„Ÿè§‰è‡ªå·±åƒlinuxçš„é‚£ä¸ªä¼é¹…ï¼Œå°±æ— å¥ˆ~~ï¼Œæœ‰æ—¶å€™çœ‹ç€è¿™ä¸ªä¼é¹…å°±å‘æ„£ï¼Œæƒ³ç€è¦æ˜¯è‡ªå·±å›linuxå¼€å‘å°±å¥½ã€‚<img src="/medias/how-mcu2linux/linux.jpeg" alt="linux logo"><br>åé¢åˆåšäº†ä¸€ä¸ª<strong>åè®®æ ˆè¯„ä¼°é¡¹ç›®</strong>ï¼Œè‡ªå·±ä»<em>é¡¹ç›®æˆå‘˜</em>å˜æˆäº†<em>æŠ€æœ¯è´Ÿè´£äºº</em>ï¼Œå…¶ä¸­å¾ˆå¤šæ—¶é—´éƒ½æŠ•å…¥åˆ°äº†é¡¹ç›®é‡Œï¼Œå¦å¤–è™½ç„¶æˆ‘æ˜¯<em>æŠ€æœ¯è´Ÿè´£äºº</em>ï¼Œä½†ä¸»è¦æ˜¯è´Ÿè´£mcuè¿™å—çš„å·¥ä½œï¼ŒåˆæœŸç”±äºé¡¹ç›®ç›®æ ‡ä¸æ˜ç¡®ï¼Œä»æ¢³ç†éœ€æ±‚åˆ°å®Œæˆéœ€æ±‚ï¼ŒèŠ±è´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œå°±æ›´æ²¡æœ‰æ—¶é—´å»æŒ‰éƒ¨å°±ç­çš„å­¦linuxäº†ã€‚è®°å¾—19å¹´ï¼Œçœ‹è¿‡ã€Šlinuxå°±è¯¥è¿™æ ·å­¦ã€‹ï¼Œçœ‹äº†ä¸€å°åŠæ„Ÿè§‰é‡Œé¢éƒ½æ˜¯å…«è‚¡æ–‡â€“ä»¥è¿ç»´ã€è€ƒè¯•ä¸ºä¸»ï¼Œæ‰€ä»¥æœ€åä¹Ÿä¸äº†äº†ä¹‹ï¼›ä¹Ÿçœ‹è¿‡ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹ï¼Œä¸çŸ¥é“æ˜¯è¯­è¨€å…³ç³»è¿˜æ˜¯ä¹¦ç±å¤ªè€äº†çš„åŸå› ï¼Œæœ€åä¹Ÿå¼€äº†ä¸ªå¤´è€Œå·²ã€‚ä½†æ˜¯è¿˜æ˜¯å¾—æ„Ÿè°¢<strong>åè®®æ ˆè¯„ä¼°é¡¹ç›®</strong>ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®é‡Œï¼Œä½œä¸º<em>æŠ€æœ¯è´Ÿè´£äºº</em>å¤šå°‘è€³æ¿¡ç›®æŸ“çš„äº†è§£ä¸€ä¸‹linuxã€Androidå’Œqnxï¼›åŒæ—¶æ›´åŠ ç†Ÿç»ƒåœ°ä½¿ç”¨gitï¼ˆçŠ¯è¿‡å¾ˆå¤šç½ªï¼‰ï¼›è¿›ä¸€æ­¥çš„å­¦ä¹ äº†è®¡ç®—æœºç½‘ç»œï¼›å®æ“è§£å†³äº†ç¼–è¯‘ç›¸å…³çš„é—®é¢˜ï¼Œè¿™åœ¨æˆ‘åé¢å¹³æ»‘çš„è¿‡æ¸¡åˆ°linuxå¥ å®šäº†ä¸å°‘çš„åŸºç¡€ï¼Œåé¢ä¹Ÿä¼šåˆ†æåˆ°ã€‚<br>&emsp;&emsp;å½“åˆæƒ³å­¦linuxï¼ˆå½“æ—¶ä¸çŸ¥é“linuxå¼€å‘è¿˜ç»†åˆ†å¥½å¤šï¼‰çš„åˆè¡·å…¶å®å°±æ˜¯è§‰å¾—åˆ«äººå¯¹ç€ä¸€å †é»‘æ¡†æ¡†å¼€å‘å¥½ç‚«ï¼›ä¸€ä¸ªå‘½ä»¤ï¼Œkuakuaå‡ºæ¥ä¸€å †ä¸œè¥¿ï¼›ç„¶åçœ‹åˆ°å…¶ä»–äººï¼Œå•¥å‘½ä»¤éƒ½æ‡‚ã€éƒ½èƒ½æ‹¼å‡ºæ¥ï¼Œåé¢æ‰çŸ¥é“åŸæ¥æœ‰tableè‡ªåŠ¨è¡¥å…¨ã€è¿˜æœ‰<code>help</code>å’Œ<code>man</code>å‘½ä»¤ï¼›ä¹Ÿè§‰å¾—ä»–ä»¬èƒ½ä»ä¸€å †<strong>é»‘å‹é»’å‹çš„å­—æ¯</strong>ä¸­ï¼Œæ‰¾åˆ°é”™è¯¯å‡ºç°åœ¨å“ªé‡Œï¼Œè§‰å¾—å¤ªtmç‰›é€¼äº†ï¼›è¿˜è§‰å¾—äº¤å‰ç¼–è¯‘å¥½ç¥å¥‡å‘€ã€‚ä½œä¸ºæŠ€æœ¯ç”·ï¼Œæ€èƒ½å¿å—è‡ªå·±ä¸ä¼šè¿™ä¹ˆç‰›é€¼çš„äº‹æƒ…ï¼Œæ‰€ä»¥å°±ä¸‹å®šå†³å¿ƒï¼Œè‡ªå·±ä¹Ÿå¾—ä¼šã€‚å°±é…é…¿ç€è¦å¼€å§‹å­¦linuxï¼Œå¤§æ¦‚çš„æµè§ˆäº†å‡ æœ¬ä¹¦ï¼Œä¸Šæ¥å°±æ˜¯<code>vim</code>ä½¿ç”¨ã€<em>å¿…é¡»è¦æŒæ¡çš„linuxå‘½ä»¤</em>ï¼Œåæ­£è®²äº†ä¸€å †å®æ“çš„ä¸œè¥¿ï¼Œå½“æ—¶è¿˜è§‰å¾—ï¼Œ<em>æ©ï¼Œè¿™å°±æ˜¯æˆ‘æƒ³å­¦çš„</em>ã€‚ä½†æ˜¯å­¦äº†ä¹‹åï¼Œå› ä¸ºè‡ªå·±è¿˜ä¸»è¦æ˜¯å•ç‰‡æœºå¼€å‘ï¼Œä¸€æ®µæ—¶é—´åï¼Œéƒ½å¿˜äº†ã€å¿˜äº†ã€‚ã€‚ã€‚ã€‚ï¼›ä¹Ÿçœ‹è¿‡ä¸€äº›å…¶ä»–çš„ä¹¦ç±ï¼Œæœ‰ä»ç›˜å¤å¼€å¤©è¾Ÿåœ°å¼€å§‹å†™çš„ï¼Œè¿˜æ˜¯å‰é¢æåˆ°çš„ç”±äºè‡ªå·±ä¸æ˜¯ç§‘ç­å‡ºç”Ÿï¼Œç›´æ¥ç»™æˆ‘å¹²æ‡µäº†ï¼Œå·®ç‚¹å°±ä»å…¥é—¨éƒ½æ”¾å¼ƒäº†ã€‚å¥½åœ¨å¿ƒé‡Œä¹Ÿä¸€ç›´æŒ‚å¿µç€è¿™ä¸ªäº‹ï¼Œä½†å‡¡èƒ½åœ¨Linuxä¸Šå®æ“åœ°äº‹æƒ…ï¼Œæˆ‘ä¸€å®šè¦ç ”ç©¶ç ”ç©¶ï¼Œæ¯”å¦‚å†™ä¸ªMakefileå•Šï¼›ä½¿ç”¨gccåæ±‡ç¼–å†çœ‹æ±‡ç¼–ï¼›ä½¿ç”¨<code>strace</code>è°ƒè¯•ä»£ç ï¼›å†åœ¨ç§¯ç´¯äº†ä¸€äº›è®¡ç®—æœºåŸºç¡€è¿‡åï¼Œè§‰å¾—è‡ªå·±<em>èƒ½è¡Œ</em>äº†ï¼Œè‡ªå·±å·å·å¹²äº†ä¸€äº›linuxé¡¹ç›®ï¼ˆå…¶å®å°±æ˜¯å¹³å¸¸å¤šç•™å¿ƒï¼Œä¸è¦æ”¾è¿‡ä»»ä½•é”»ç‚¼çš„æœºä¼šï¼‰ï¼Œåé¢å°±ç»™é¢†å¯¼è¯´ï¼Œlinuxå¼€å‘å–Šä¸Šæˆ‘ï¼Œæ²¡é—®é¢˜çš„ã€‚<br>&emsp;&emsp;è™½è¯´ï¼Œä¸Šé¢åœ¨åæ§½æˆ‘çœ‹è¿‡çš„é‚£äº›linuxä¹¦ç±ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯è§‰å¾—çœ‹ç»å…¸çš„ä¹¦ç±æ˜¯æœ€æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒé‡Œé¢çš„çŸ¥è¯†æ˜¯æˆä½“ç³»çš„ï¼Œä½†æ˜¯ç”±äºæˆ‘çš„èƒŒæ™¯å’Œå·¥ä½œå†³å®šæˆ‘ï¼Œä¸å¤ªèƒ½å»å¤§å—æ—¶é—´å»å•ƒé‚£äº›ä¹¦ï¼Œæ›´å¤šè¿˜æ˜¯æ‹¿ä¹¦å½“å­—å…¸ç”¨äº†ï¼Œä½†æ˜¯è¿˜å»ºè®®æœ‰æ¡ä»¶çš„å°ä¼™ä¼´ï¼Œé˜…è¯»ç»å…¸ä¹¦ç±æ¥æå‡è‡ªå·±ã€‚å¦å¤–ï¼Œè™½ç„¶æˆ‘è§‰å¾—linuxå¾ˆç‚«ï¼Œä½†å¹¶ä¸æ„å‘³ç€å•ç‰‡æœºå¼€å‘å°±å¾ˆlowï¼Œæ„Ÿè§‰è¿™æ›´å¤šæ˜¯ä¸ªäººçˆ±å¥½å’Œéšç€å·¥ä½œå†…å®¹å†³å®šçš„ã€‚</p><h1 id="äºŒã€-MCU2linux"><a href="#äºŒã€-MCU2linux" class="headerlink" title="äºŒã€ MCU2linux"></a>äºŒã€ MCU2linux</h1><p>&emsp;&emsp;å¦‚æœèƒ½å¤Ÿå›åˆ°è¿‡å»ï¼Œå¼€å¤©çœ¼ï¼Œä¹Ÿè®¸èƒ½å¤Ÿåšçš„æ›´å¥½ï¼Œä½†æ˜¯è‡ªæ‹çš„è¯´ï¼Œè§‰å¾—å½“åˆçš„åšæ³•ä¹Ÿæ˜¯æŒºæ­£ç¡®ï¼ˆæ¯•ç«Ÿå·¥ä½œè¿˜æ˜¯éœ€è¦å®Œæˆçš„ï¼‰ï¼Œå¹¶æ²¡æœ‰æƒ³ç€ä¸€è¹´è€Œå°±ï¼Œä¹Ÿæ²¡æœ‰å°±æ­¤æ”¾å¼ƒï¼Œæ…¢æ…¢çš„ç§¯ç´¯äº†ä¸€äº›åŸç†æ€§çš„ä¸œè¥¿ã€‚åœ¨è¿™ï¼Œä»¥æˆ‘ç°åœ¨çš„è®¤çŸ¥åˆ†æä¸€ä¸‹mcuå’Œlinuxçš„å·®åˆ«ï¼Œä»¥åŠä»mcuè½¬åˆ°linuxã€‚</p><h2 id="1-mcuå’Œlinuxã€os"><a href="#1-mcuå’Œlinuxã€os" class="headerlink" title="1. mcuå’Œlinuxã€os"></a>1. mcuå’Œlinuxã€os</h2><p>&emsp;&emsp;mcuæœ‰</p><h2 id="2-ä»£ç è·å–-ç‰ˆæœ¬ç®¡ç†â€“git"><a href="#2-ä»£ç è·å–-ç‰ˆæœ¬ç®¡ç†â€“git" class="headerlink" title="2. ä»£ç è·å–/ç‰ˆæœ¬ç®¡ç†â€“git"></a>2. ä»£ç è·å–/ç‰ˆæœ¬ç®¡ç†â€“git</h2><h2 id="3-ç¼–è¯‘ã€é“¾æ¥"><a href="#3-ç¼–è¯‘ã€é“¾æ¥" class="headerlink" title="3. ç¼–è¯‘ã€é“¾æ¥"></a>3. ç¼–è¯‘ã€é“¾æ¥</h2><h2 id="4-è™šæ‹Ÿå†…å­˜"><a href="#4-è™šæ‹Ÿå†…å­˜" class="headerlink" title="4. è™šæ‹Ÿå†…å­˜"></a>4. è™šæ‹Ÿå†…å­˜</h2><h2 id="5-è¿›ç¨‹-çº¿ç¨‹"><a href="#5-è¿›ç¨‹-çº¿ç¨‹" class="headerlink" title="5. è¿›ç¨‹/çº¿ç¨‹"></a>5. è¿›ç¨‹/çº¿ç¨‹</h2><h2 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h2><h2 id="7"><a href="#7" class="headerlink" title="7."></a>7.</h2>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mcu </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxé—´ç½‘ç»œé€šä¿¡æ— ç•Œé¢å®æ—¶æŠ“åŒ…ã€åˆ†æä»¥åŠæ–‡ä»¶åŒæ­¥</title>
      <link href="2021/06/06/linux-develop-tips1/"/>
      <url>2021/06/06/linux-develop-tips1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™å‘¨å››ã€äº”è¶ç€å·¥ä½œé—´éš™ä»¥åŠåŠ ç­æŠ˜è…¾äº†ä¸¤å¤©ï¼Œå®ç°äº†wiresharkè¿œç¨‹å®æ—¶æŠ“åŒ…å’Œæ˜¾ç¤ºï¼Œä»¥åŠä¸¤ä¸ªlinuxä¹‹é—´æ–‡ä»¶åŒæ­¥ã€‚ä¹Ÿè®¸æ²¡å¤šéš¾ï¼Œåˆæˆ–è€…æœ‰æ›´å¥½çš„åŠæ³•ï¼Œä½†æ˜¯æˆ‘æŠ˜è…¾äº†å¥½ä¹…ï¼Œè§‰å¾—å¯ä»¥è®°å½•ä¸‹ã€‚</p></blockquote><h1 id="ä¸€ã€-èƒŒæ™¯"><a href="#ä¸€ã€-èƒŒæ™¯" class="headerlink" title="ä¸€ã€ èƒŒæ™¯"></a>ä¸€ã€ èƒŒæ™¯</h1><p>&emsp;&emsp;ç°åœ¨éƒ½åŸºæœ¬éƒ½æ˜¯ä»¥linuxä¸Šçš„å¼€å‘ä¸ºä¸»ï¼Œç„¶åæ—¥å¸¸å¼€å‘ç¯å¢ƒåœ¨éƒ¨é—¨çš„ä¸¤å°æœåŠ¡å™¨ï¼ˆéƒ½æ˜¯ubuntuï¼‰ä¸Šï¼Œä½†æ˜¯ä¸»è¦è¿˜æ˜¯åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå› ä¸ºæˆ‘æœ¬èº«æš‚æ—¶æ˜¯ä»¥ç½‘ç»œç›¸å…³çš„å¼€å‘ä¸ºä¸»ï¼Œè¿™å°±é¿å…ä¸äº†çš„éœ€è¦æŠ“åŒ…åˆ†æï¼ŒæŠ¥æ–‡äº¤äº’åŸºæœ¬ä¸Šèƒ½å¤Ÿåˆ†æå‡ºé—®é¢˜æ‰€åœ¨ã€‚æˆ‘æ˜¯è¿œç¨‹sshç™»å½•æ¥åšæ—¥å¸¸å¼€å‘å·¥ä½œï¼Œå¦‚æœä½¿ç”¨tcpdumpæ¥æŠ“åŒ…åˆ†æï¼Œä¸€ä¸ªæ˜¯ä¸æ˜¯ç‰¹åˆ«çš„ç›´è§‚ï¼Œè¿˜æœ‰å°±æ˜¯çµæ´»æ€§ä¸æ˜¯ç‰¹åˆ«å¤Ÿï¼Œè¦æ˜¯ç›´æ¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼Œæ ¹æ®ä¸åŒçš„éœ€æ±‚ï¼Œéœ€è¦ä¸€ç›´è¯¥æ”¹å‘½ä»¤ï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½å¤Ÿä½¿ç”¨è¿œç¨‹æˆ–è€…æœ¬åœ°æ¥ä½¿ç”¨wiresharkæ¥åˆ†ææŠ¥æ–‡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯æˆ‘å®é™…å·¥ä½œç½‘ç»œæ‹“æ‰‘ç¤ºæ„å›¾ï¼Œ<img src="/medias/linux-develop-tips/server_and_mypc.png" alt="å·¥ä½œç½‘ç»œæ‹“æ‰‘"></p><p>&emsp;&emsp;ä¸Šé¢æåˆ°äº†ä¸»è¦æ˜¯åœ¨ä¸€å°æœåŠ¡å™¨å®Œæˆå¼€å‘ï¼Œä½†æ˜¯æœ‰æ—¶å€™è·‘client/serveræ—¶ï¼Œè¿˜æ˜¯è¦åœ¨ä¸¤å°ç”µè„‘é€šè¿‡ç‰©ç†ç½‘ç»œé€šé“æµ‹è¯•ä¸€ä¸‹ã€‚è¿™å°±æ¶‰åŠåˆ°äº†åœ¨ä¸¤å°ç”µè„‘åŒæ­¥å¼€å‘çš„é—®é¢˜ï¼Œå°±ä¼šæ¶‰åŠåˆ°æ–‡ä»¶åŒæ­¥çš„é—®é¢˜ã€‚</p><h1 id="äºŒã€è§£å†³æ–¹æ¡ˆ"><a href="#äºŒã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="äºŒã€è§£å†³æ–¹æ¡ˆ"></a>äºŒã€è§£å†³æ–¹æ¡ˆ</h1><p>&emsp;&emsp;å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œæ‰€ä»¥é’ˆå¯¹å‰é¢æåˆ°ç—›ç‚¹ï¼Œè¿˜æ˜¯æƒ³è§£å†³ç‚¹ï¼Œæƒ³äº†ä¸å°‘è§£å†³æ€è·¯ï¼Œå¹¶ä¸”éƒ½è¿›è¡Œäº†å°è¯•ï¼Œé’ˆå¯¹å¤±è´¥çš„é—®é¢˜è¿›è¡Œäº†åˆ†æã€‚</p><h2 id="1-ç½‘ç»œæŠ“åŒ…"><a href="#1-ç½‘ç»œæŠ“åŒ…" class="headerlink" title="1. ç½‘ç»œæŠ“åŒ…"></a>1. ç½‘ç»œæŠ“åŒ…</h2><p>&emsp;&emsp;é’ˆå¯¹ç½‘ç»œæŠ“åŒ…ï¼Œåˆ†åˆ«å°è¯•äº†ï¼š</p><ol><li>åœ¨æˆ‘çš„ä¸ªäººå·¥ä½œç”µè„‘ä¸Šï¼Œä½¿ç”¨è¿œç¨‹æ¡Œé¢ï¼ŒæœåŠ¡å™¨çš„ubuntuä¸Šå®‰è£…ä¸Šlinuxç‰ˆçš„wiresharkï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥å®æ—¶å¯¹ç€æŠ¥æ–‡åˆ†æäº†ã€‚ä½†æ˜¯å¤±è´¥äº†ã€‚</li><li>å°†æˆ‘çš„ä¸ªäººpcè¿æ¥åˆ°ä¸Šå›¾ä¸­çš„äº¤æ¢æœºä¸Šï¼Œwiresharkä½¿ç”¨æ··æ‚æ¨¡å¼å°†äº¤æ¢æœºä¸Šçš„æ‰€æœ‰æŠ¥æ–‡éƒ½æŠ“åˆ°ï¼Œå†é€šè¿‡è¿‡æ»¤ï¼Œè¿‡æ»¤ï¼ˆæ˜¾ç¤ºè¿‡æ»¤å’ŒæŠ“åŒ…è¿‡æ»¤ï¼‰æ‰ä¸å¿…è¦çš„æŠ¥æ–‡ã€‚ç»“æœå¤±è´¥</li><li>ä½¿ç”¨wiresharkä¸Šçš„è¿œç¨‹æŠ“åŒ…ã€‚ç»“æœæˆåŠŸ</li></ol><p>æœ€ç»ˆåªæœ‰<em>æ–¹æ³•3</em>æˆåŠŸäº†ï¼Œä½†æ˜¯å´æ˜¯æˆ‘æœ€åæƒ³åˆ°çš„ï¼Œä¸‹é¢å°†ç¨å¾®å±•å¼€çš„åˆ†æä¸‹æ¯ä¸ªæ–¹æ³•ï¼Œæˆ‘è§‰å¾—åç»­æœ‰æ—¶é—´ï¼Œéƒ½æ˜¯èƒ½å¤ŸæˆåŠŸçš„ã€‚</p><h3 id="1-è¿œç¨‹æ¡Œé¢"><a href="#1-è¿œç¨‹æ¡Œé¢" class="headerlink" title="1). è¿œç¨‹æ¡Œé¢"></a>1). è¿œç¨‹æ¡Œé¢</h3><p>&emsp;&emsp;é’ˆå¯¹è¿œç¨‹æ¡Œé¢è¿™ç§åŠæ³•ï¼Œä¸€å¼€å§‹ç”¨çš„æ˜¯VNCï¼Œå…¶ä¸­xfor4æ˜¯æœ€èƒ½æ»¡è¶³æˆ‘çš„éœ€æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰å¤–æ¥æ˜¾ç¤ºå™¨ï¼Œè¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œå¦‚æœæˆ‘å°†æ¡Œé¢è¾“å‡ºåˆ°xfore4ä¸Šå»äº†ï¼Œåé¢æœåŠ¡å™¨å³ä½¿å¤–æ¥äº†æ˜¾ç¤ºå™¨ä¹Ÿä¼šæ²¡ç”¨ï¼Œè¿™å°±ç»™åˆ«äººå¸¦æ¥ä¸ä¾¿åˆ©ã€‚å’±ä¹Ÿä¸èƒ½å¹²è¿™æ ·<strong>æŸäººåˆ©å·±</strong>çš„äº‹ï¼Œåœ¨ç®€å•çš„æŒ£æ‰åï¼ˆ**å…¶å®ä¸ç®€å•ï¼Œå°è¯•äº†å¥½å¤šç§åŠæ³•~~**ï¼‰ï¼Œè¿˜æ˜¯æ”¾å¼ƒäº†è¿™æ ·åšã€‚æƒ³è¦å®ç°è¿œç¨‹æ¡Œé¢çš„åŒå¿—å¯ä»¥å‚è€ƒä¸‹è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://blog.csdn.net/u012911347/article/details/90267252">ä½¿ç”¨RealVNCè¿æ¥æ— å¤–æ¥æ˜¾ç¤ºå™¨çš„Ubuntu18.04</a>ï¼Œè¿™ç¯‡æ–‡ç« è¿˜æ˜¯äº²æµ‹æœ‰ç”¨çš„ã€‚<br>&emsp;&emsp;åé¢åˆè¯•äº†ä¸‹ï¼Œteamviewerï¼Œèƒ½å¤Ÿè¿æ¥ä¸Šï¼Œä½†æ˜¯ä¸æ˜¾ç¤ºæ¡Œé¢ï¼Œé€šè¿‡æŸ¥èµ„æ–™ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åˆ¤å®šï¼Œæ˜¯éœ€è¦å¤–æ¥æ˜¾ç¤ºå™¨çš„ã€‚<br>&emsp;&emsp;ç»è¿‡ä¸Šè¿°æŠ˜è…¾åï¼Œæœæ–­æ”¾å¼ƒäº†è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="2-å°†pcç›´æ¥è¿æ¥åˆ°äº¤æ¢æœºä¸Š"><a href="#2-å°†pcç›´æ¥è¿æ¥åˆ°äº¤æ¢æœºä¸Š" class="headerlink" title="2). å°†pcç›´æ¥è¿æ¥åˆ°äº¤æ¢æœºä¸Š"></a>2). å°†pcç›´æ¥è¿æ¥åˆ°äº¤æ¢æœºä¸Š</h3><p>&emsp;&emsp;ä¹‹å‰æˆ‘è°ƒè¯•ç½‘ç»œæ—¶ï¼Œéƒ½æ˜¯è‡ªå·±çš„ç”µè„‘é€šè¿‡ç½‘çº¿æ¥åˆ°äº¤æ¢æœºä¸Šï¼Œå‰©ä½™å…¶ä»–çš„ç½‘ç»œç»ˆç«¯éƒ½è¿æ¥åˆ°äº¤æ¢æœºï¼Œè¿™æ ·æˆ‘å°±èƒ½ä»æˆ‘çš„ç”µè„‘ä¸ŠæŠ“åˆ°æ‰€æœ‰çš„æŠ¥æ–‡ï¼Œç®€å•æ–¹ä¾¿ã€å¿«æ·ï¼Œæ‰€ä»¥æˆ‘è¿™æ¬¡æˆ‘ä¹Ÿæƒ³è¿™æ ·ã€‚æ­£å¥½æˆ‘æœ‰ä¸¤ä¸ªç¬”è®°æœ¬ï¼Œæˆ‘å¯ä»¥å°†æˆ‘çš„å…¶ä¸­ä¸€ä¸ª<em>ç¬”è®°æœ¬ç”µè„‘1</em>é€šè¿‡ç½‘çº¿æ¥å…¥åˆ°äº¤æ¢æœºä¸Šï¼Œç„¶åå¦ä¸€ä¸ª<em>ç¬”è®°æœ¬2</em>è¿œç¨‹<em>ç¬”è®°æœ¬1</em>ï¼Œè¾¾åˆ°æˆ‘çš„æƒ³æ³•ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º:<img src="/medias/linux-develop-tips/doublepc.png" alt="åŒç”µè„‘æ–¹æ¡ˆ"><br>ç„¶è€Œç†æƒ³å¾ˆä¸°æ»¡ï¼Œç°å®å¾ˆæ®‹é…·ï¼Œéƒ¨é—¨å°ç»„é‡Œçš„äº¤æ¢æœºè™½ç„¶è·Ÿæˆ‘ä»¥å‰ä¸€æ ·æ˜¯ä¸ªäºŒå±‚äº¤æ¢æœºï¼Œä½†æ˜¯ä¸Šå›¾çš„<strong>my_pc1</strong>å¹¶æ²¡æœ‰èƒ½å¤ŸæŠ“åˆ°server1å’Œserver2çš„ç½‘ç»œæŠ¥æ–‡ï¼Œæœè¿‡å®˜ç½‘ï¼Œæ‰¾è¿‡æ·˜å®ï¼ŒèŠè¿‡äº¬ä¸œï¼Œä¾ç„¶æ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆã€‚åé¢è¿˜ä»¥ä¸ºwiresharkæ²¡å¼€<em>æ··æ‚æ¨¡å¼</em>ï¼Œæœ€åå‘ç°ä¹Ÿä¸æ˜¯è¿™ä¸ªåŸå› ã€‚æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ€»è§‰å¿ƒé‡Œæœ‰æ ¹åˆºï¼Œåé¢æ‰¾äº¤æ¢æœºèµ„æ–™æ—¶ï¼Œæ‰å¾—åˆ°ç­”æ¡ˆï¼Œç°åœ¨çš„äº¤æ¢æœºå˜èªæ˜äº†ï¼Œå¦‚æœä¸æ˜¯å‘ç»™ä½ çš„æŠ¥æ–‡ï¼Œmacå°±ç»™ä½ è¿‡æ»¤æ‰äº†ï¼Œå¹¶ä¸”è¿™ä¸ªäº¤æ¢æœºè¿˜ä¸æ”¯æŒé…ç½®æˆæ··æ‚æ¨¡å¼ã€‚æ¬²å“­æ— æ³ª~~~ã€‚<br>&emsp;&emsp;æ›¾ç»æ²§æµ·éš¾ä¸ºæ°´ï¼Œç»å†è¿‡ä»¥å‰äº¤æ¢æœºçš„ä¾¿åˆ©ï¼Œå’‹èƒ½å®¹å¿è¿™ç§æ‹‰ä½å·¥ä½œæ•ˆç‡çš„å­˜åœ¨ã€‚æœæ–­ä¹°ç½‘çº¿ä¹°äº¤äº’æœºï¼Œåé¢ç›´æ¥ä»æˆ‘çš„ç”µè„‘ç½‘å£æ€¼åˆ°äº¤æ¢æœºä¸Šã€‚</p><h3 id="3-wiresharkè¿œç¨‹æŠ“åŒ…"><a href="#3-wiresharkè¿œç¨‹æŠ“åŒ…" class="headerlink" title="3). wiresharkè¿œç¨‹æŠ“åŒ…"></a>3). wiresharkè¿œç¨‹æŠ“åŒ…</h3><p>&emsp;&emsp;è™½ç„¶ç»å†ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•çš„å¤±è´¥ï¼Œä½†æ˜¯å¿ƒé‡Œè¿˜æ˜¯æŒ‚å¿µç€ï¼Œæœ€ç»ˆäºåœ¨ä½¿ç”¨wiresharkæ•è·æ—¶ï¼Œçªç„¶çœ‹åˆ°æœ‰ä¸€ä¸ª<strong>è¿œç¨‹æ¥å£</strong>ï¼ŒæŠ€æœ¯æ•æ„Ÿå‘Šè¯‰æˆ‘ï¼Œé—®é¢˜åº”è¯¥å¾—åˆ°è§£å†³äº†ï¼Œä¸€é˜µbaidu/googleåï¼Œç»ˆäºæˆåŠŸçš„è¿œç¨‹æŠ“åˆ°äº†ä¸¤ä¸ªæœåŠ¡å™¨çš„ç½‘ç»œæŠ¥æ–‡äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/medias/linux-develop-tips/win_wireshark_rpcap.png" alt="windows wiresharkè¿œç¨‹æŠ“åŒ…"><br>æƒ³è¦è¾¾åˆ°ä¸Šè¿°æ•ˆæœï¼Œé¦–å…ˆéœ€è¦åœ¨windows wiresharkä¸Šåœ¨ç®¡ç†æ¥å£/è¿œç¨‹æ¥å£ä¸Šæ·»åŠ è¿œç¨‹è®¾å¤‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/medias/linux-develop-tips/win_wireshark_r_if.png" alt="è¿œç¨‹æ¥å£"><br>æƒ³è¦å®ç°windows ç¯å¢ƒä¸‹wiresharkè¿œç¨‹æŠ“åŒ…ï¼Œéœ€è¦åœ¨æœåŠ¡å™¨ç«¯linuxä¸Šå¦å¤–å®‰è£…rpcapæ¥åšserverï¼ˆtcpdumpç›¸å…³çš„è‡ªç„¶æ˜¯éœ€è¦çš„ï¼‰ã€‚<br>å…³äºå®‰è£…rpcapï¼Œç›´æ¥å‚è€ƒ<a href="https://github.com/rpcapd-linux/rpcapd-linux">githubä»“åº“ä¸Šçš„æ•™ç¨‹</a>å³å¯,å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="/medias/linux-develop-tips/rpcap_install.png" alt="rpcap build and use"></p><h4 id="ubuntu16ä¸Šçš„ä¸€äº›é—®é¢˜"><a href="#ubuntu16ä¸Šçš„ä¸€äº›é—®é¢˜" class="headerlink" title="ubuntu16ä¸Šçš„ä¸€äº›é—®é¢˜"></a>ubuntu16ä¸Šçš„ä¸€äº›é—®é¢˜</h4><p>&emsp;&emsp;ä¸Šè¿°æ“ä½œï¼Œæˆ‘éƒ½æ˜¯åœ¨ubuntu18ä¸Šæ“ä½œçš„ï¼Œä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ã€‚ä½†æ˜¯æˆ‘åé¢åœ¨ubuntu16ä¸Šå°±åˆé‡åˆ°ä¸€äº›é—®é¢˜äº†ï¼Œé¦–å…ˆæ˜¯å¯èƒ½ä¼šä½¿ç”¨<code>sudo apt-get build-dep libpcap</code>è¿™ä¸ªå‘½ä»¤ä¸‹è½½ä¸ä¸‹æ¥ä¸œè¥¿ï¼Œå› ä¸ºç¼ºå°‘<code>URL sources.list</code>ï¼Œè§£å†³åŠæ³•, ä¸€ä¸ªæ˜¯åœ¨sources.listä¸­æ·»åŠ ä¸Šï¼Œä½†æ˜¯æœåŠ¡å™¨å¹¶ä¸æ˜¯æˆ‘ä¸€ä¸ªäººç”¨ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©çš„æ˜¯ç¬¬äºŒç§åŠæ³•ï¼Œ<code>git clone https://github.com/rpcapd-linux/rpcapd-linux</code>ï¼Œç„¶åæŒ‰ä¸Šå›¾çš„åŠæ³•æ¥ç¼–è¯‘å‡ºlibpcapã€‚<br>&emsp;&emsp;æ­¤æ—¶ä¾ç„¶æœ‰å¯èƒ½å‡ºé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">yacc -d grammar.ymake: yacc: Command not foundMakefile:365: recipe for target &#39;grammar.c&#39; failedmake: *** [grammar.c] Error 127<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;è¿™æ˜¯ç¼ºå°‘ä¾èµ–é¡¹ï¼Œ<code>flex</code>ï¼Œåªéœ€æ‰§è¡Œ<code> sudo apt-get install flex bison</code>ï¼Œå®‰è£…ä¸Šä¾èµ–é¡¹ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºå°±èƒ½ä¸ªå¾ˆé¡ºåˆ©çš„å®‰è£…å¥½<code>rpcap</code>äº†ã€‚</p><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>é’ˆå¯¹ä½¿ç”¨ï¼Œå…¶å®ä¹Ÿè›®ç®€å•çš„ï¼Œ<code>sudo ./rpcapd -4 -n -p [your port] -deamon</code>ï¼Œç«¯å£çš„å°±æ˜¯è‡ªå·±è‡ªå®šä¹‰çš„ï¼Œåé¢åœ¨wiresharkä¸Šéœ€è¦è¾“å…¥ï¼Œæ¯”å¦‚æˆ‘æˆ‘è®¾ç½®çš„æ˜¯<em>55555</em>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦å¤–æœ€å¥½å°†<em>rpcapd</em>è®¾ç½®æˆå¼€æœºè‡ªå¯åŠ¨äº†ï¼Œå› ä¸ºä¸‡ä¸€æœåŠ¡å™¨é‡å¯äº†ï¼Œä½ è¿˜è¦æ‰‹åŠ¨å¼€å¯<em>rpcapd</em>ï¼Œå²‚ä¸æ˜¯å¾ˆlowã€‚æ‰€ä»¥å®ç°ä¸€ä¸ªè„šï¼Œå¹¶å°†è¯¥è„šæœ¬è®¾ä¸ºå¼€æœºå¯åŠ¨ï¼Œè¿™æ ·å°±ä¸ç”¨æ‹…å¿ƒå‰é¢æåˆ°çš„é—®é¢˜äº†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-run_rpcapd.sh" data-language="run_rpcapd.sh"><code class="language-run_rpcapd.sh">#run_rpcapd.sh#! &#x2F;bin&#x2F;sh# command content  echo &#39;xxx&#39; | sudo &#x2F;home&#x2F;jinbao&#x2F;software&#x2F;rpcapd-linux&#x2F;rpcapd -4 -n -p 8888  exit 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ç”±äºwindowsç”µè„‘ç•¥æœ‰ååº”è¿Ÿé’ï¼Œä¸»è¦æ˜¯ä»¥macä¸ºä¸»ï¼Œæƒ³ç€è¿˜æ˜¯ç”¨macç«¯çš„wiresharkä¹Ÿå®ç°è¿œç¨‹æŠ“åŒ…ï¼Œå‘ç°macä¸Šçš„wiresharkæ²¡æœ‰<strong>è¿œç¨‹æ¥å£</strong>è¿™ä¸ªä¸œè¥¿äº†ï¼ˆæˆ‘çš„æ˜¯m1 macbookproï¼‰ã€‚ä½†æ˜¯ä¸€é¡¿æ‘¸ç´¢åï¼Œå‘ç°æœ‰è¿™ä¸ª<strong>SSH remote capture: sshdump</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ„æ€ä¹Ÿå¾ˆæ˜æ˜¾äº†ï¼Œå‰©ä¸‹å°±äº¤ç»™baidu/googleäº†ã€‚<img src="/medias/linux-develop-tips/mac_wireshark.png" alt="mac wireshark"><br>ä½†æ˜¯ä¸€é¡¿æ“ä½œä¸‹æ¥ï¼Œå‘ç°ä¸æ˜¯æŠ¥è¿™ä¸ªé”™<img src="/medias/linux-develop-tips/mac_wireshark_cannotfind.png" alt="can&#39;t find .."><br>å°±æ˜¯æŠ¥æƒé™ä¸å¤Ÿçš„é”™è¯¯ï¼Œç±»ä¼¼ä¸‹å›¾è¿™ä¸ªé”™è¯¯ï¼š<img src="/medias/linux-develop-tips/mac_wireshark_permission.png" alt="permission invalid"><br>ç”±äºä»»åŠ¡ç´§å¼ ï¼Œåªèƒ½æš‚ä¸”æç½®æŠ˜è…¾äº†ï¼Œç­‰åé¢åœ¨è¯•è¯•äº†å’¯ã€‚æš‚æ—¶å…ˆç”¨windowså®æ—¶æŠ“åŒ…ç”¨ç€äº†å‘—ã€‚<br>Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·æ›´æ–°äº7.22Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·<br>&emsp;&emsp;ä¼˜ç§€çš„åŒäº‹å¸®æˆ‘æ‰¾åˆ°åŸå› ï¼Œå¹¶ä¸”ä¸éœ€è¦rpcapå°±èƒ½æŠ“åŒ…ï¼ŒåŸæ¥linuxé»˜è®¤æ²¡æœ‰å¼€å¯<code>PermitRootLogin</code>ï¼ŒçŸ¥é“åŸå› åï¼Œæ“ä½œå°±ç®€å•äº†ã€‚æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cd &#x2F;etc&#x2F;ssh&#x2F;vim&#x2F;vi sshd_config#æ‰¾åˆ°PermitRootLoginï¼Œæ³¨é‡Šæ‰è¿™ä¸€è¡Œ#æ·»åŠ PermitRootLogin yessudo service sshd restart <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-æ–‡ä»¶åŒæ­¥"><a href="#2-æ–‡ä»¶åŒæ­¥" class="headerlink" title="2. æ–‡ä»¶åŒæ­¥"></a>2. æ–‡ä»¶åŒæ­¥</h2><p>&emsp;&emsp;æ–‡ä»¶åŒæ­¥ï¼Œæˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æœ‰ç³»ç»Ÿï¼ˆwindowsã€mac osï¼‰è‡ªå¸¦çš„å±€åŸŸç½‘åŒæ­¥ï¼Œæˆ–è€…onedriverè¿™æ ·çš„äº‘åŒæ­¥ã€‚ä½†æ˜¯åœ¨linuxä¸Šæˆ‘åªæƒ³é’ˆå¯¹æŸäº›æ–‡ä»¶è¿›è¡Œç½‘ç»œåŒæ­¥å³å¯ï¼Œç”¨onedriveré™¤äº†æœ‰å¯èƒ½è¿åå…¬å¸å®‰å…¨è§„å®šå¤–ï¼Œæœªå…ä¹Ÿå¤ªå¤§æå°ç”¨äº†ï¼Œæ‰€ä»¥å°±è€ƒè™‘å…¶ä»–æ–¹æ¡ˆã€‚</p><ol><li>é€šè¿‡gitã€‚éœ€è¦ä¸åœçš„<code>add, commit, push, pull</code>ï¼Œå¤ªç¹çï¼Œ<strong>pass</strong>ã€‚</li><li>scpï¼Œä¼šå‡ºç°å…¨éƒ¨æ‹·è´ï¼Œä¸èƒ½å¢é‡æ‹·è´ï¼Œå¤šäº†ä¹‹åï¼Œæ•ˆç‡ç‰¹åˆ«ä½ï¼Œå¯¹ç£ç›˜ä¹Ÿæ˜¯é¢‘ç¹è¯»å†™ï¼Œ<strong>pass</strong>ã€‚</li><li>rsync_inotifyï¼Œå®æ—¶ã€å¢é‡åŒæ­¥ï¼Œ<strong>amazing</strong>ã€‚å¦‚ä¸‹å›¾ï¼š<img src="/medias/linux-develop-tips/rsync_inotify.png"></li></ol><p><strong>æ–‡ä»¶åŒæ­¥</strong><br>&emsp;&emsp;é’ˆå¯¹è¿™ä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä¸»è¦å‚è€ƒäº†è¿™ç¯‡æ–‡ç« <a href="https://www.cnblogs.com/qinhir/p/6589403.html">å®ç°rsync+inotify å®æ—¶åŒæ­¥æ–‡ä»¶</a>ï¼Œä½†æ˜¯å¯¹ç€è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘æ²¡æœ‰æˆåŠŸï¼Œå†ç»“åˆè¿™ç¯‡æ–‡ç« <a href="http://blog.chinaunix.net/uid-13954085-id-158637.html">æŠŠrsyncé”™è¯¯æŠ¥å‘Šè¯´æ¸…æ¥š</a>,å°±åŸºæœ¬æŠŠé—®é¢˜è§£å†³äº†ï¼Œå½“ç„¶è¿‡ç¨‹è¿˜æ˜¯æŒºä¸å®¹æ˜“çš„ï¼Œå› ä¸ºéƒ½æ˜¯ç½‘ä¸Šæœç´¢+è‡ªå·±æ‘¸ç´¢çš„ï¼Œæš‚æ—¶ä¹Ÿå°±ä¸å»è®°å½•äº†ï¼Œå¦‚æœå°ä¼™ä¼´æœ‰ç–‘é—®ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ï¼ŒåŸºæœ¬èƒ½å¤Ÿä¿è¯çŸ­æ—¶é—´å†…æ”¶åˆ°è¯„è®ºã€‚<br>&emsp;&emsp;æœ€ç»ˆæˆ‘æ²¡ç”¨inotifyæ¥å®æ—¶åŒæ­¥ï¼Œä½†æ˜¯äº²æµ‹æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæˆ‘æ€•å…¶ä»–åŒäº‹ä¹Ÿè¦åŒæ­¥ï¼Œä¼šå½±å“ä»–ä»¬ï¼Œä¸è¿‡æˆ‘é€šè¿‡è®¾ç½®å‘½ä»¤è¡Œåˆ«åçš„æ–¹å¼<code>alias sync_xxxx=&#39;xxxxx&#39;</code>,å°±èƒ½ä¸€ä¸ªå‘½ä»¤åŒæ­¥è¿‡å»äº†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘èƒ½åœ¨æ„ä½ç½®ç›´æ¥å°±<code>rsync_BWG</code>å°±èƒ½å°†æˆ‘äº‹å…ˆé…ç½®çš„æ–‡ä»¶åŒæ­¥è¿‡å»ã€‚<img src="/medias/linux-develop-tips/alias_rsync.png" alt="alias rsync"></p><p><strong>åŒæ­¥æ—¶å¿½ç•¥æŸäº›æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹</strong><br>&emsp;&emsp;åœ¨åŒæ­¥æ—¶ï¼Œæœ‰æ—¶æˆ‘ä»¬å¹¶ä¸éœ€è¦å°†æ‰€æœ‰æ–‡ä»¶åŒæ­¥è¿‡å»ã€‚<img src="/medias/linux-develop-tips/bgw_tree_l1.png" alt="BGW"> <img src="/medias/linux-develop-tips/uds_component_tree_l1.png" alt="uds-component"><br>ä¸Šè¿°ä¿©å›¾ï¼Œ<code>ironman-imx8-buildroot</code>å’Œ<code>.vscode</code>æˆ‘å°±ä¸æƒ³åŒæ­¥è¿‡å»ï¼Œæ­¤æ—¶æˆ‘å°±å¯ä»¥é€šè¿‡<code>--exclude</code>è¿™ä¸ªoptionæ¥è¾¾åˆ°ç›®çš„ï¼Œ<strong>æ–‡ä»¶æ˜¯ä½¿ç”¨ç›¸å¯¹è·¯å¾„å“¦</strong>ã€‚ç¤ºä¾‹å¦‚ä¸‹å›¾ï¼š<img src="/medias/linux-develop-tips/use_exclude.png" alt="use --exclude"></p><h1 id="ä¸‰ã€å†™åœ¨æœ€å"><a href="#ä¸‰ã€å†™åœ¨æœ€å" class="headerlink" title="ä¸‰ã€å†™åœ¨æœ€å"></a>ä¸‰ã€å†™åœ¨æœ€å</h1><p>&emsp;&emsp;è™½ç„¶è¯´å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œä½†æ˜¯å…³é”®çš„æ˜¯è¿˜éœ€è¦å¹³è¡¡åˆ©å¼Šï¼Œå¦‚æœæ”¹è¿›ä¸€ç‚¹æ•ˆç‡åè€Œä¼šæµªè´¹ä½ æ›´å¤šçš„æ—¶é—´ï¼Œæˆ‘è§‰å¾—åè€Œæ˜¯å¾—ä¸å¿å¤±çš„ã€‚ä¸è¿‡ï¼Œè¦æ˜¯åˆ©ç”¨è‡ªå·±ç©æ‰‹æœºåˆ·å‰§çš„æ—¶é—´ï¼Œç”¨æ¥å»æŠ˜è…¾è¿™ä¸ªæŠ€æœ¯ï¼Œæˆ‘è§‰å¾—æ˜¯å€¼å½“çš„ï¼Œå› ä¸ºè¡¨é¢æ˜¯æŠ˜è…¾è¿™ä¸€é¡¹ï¼Œæ‹”å‡ºèåœå¸¦å‡ºæ³¥ï¼Œé‡åˆ°é—®é¢˜äº†ï¼Œæƒ³è§£å†³ï¼ŒåŸºæœ¬ä¸Šä¼šæ¶‰åŠåˆ°å¾ˆå¤šçŸ¥è¯†é¢ï¼Œé’ˆå¯¹æˆ‘è¿™ç§è¿˜éœ€å¤§é‡å­¦ä¹ çš„äººè¯´ï¼Œç®€ç›´æ˜¯æˆé•¿çš„<em>å…´å¥‹å‰‚</em>ã€‚ä»¥å‰ç©å•ç‰‡æœºæ—¶ï¼Œå°±å„ç§æŠ˜è…¾windowsç³»ç»Ÿï¼›åé¢å› ä¸ºlinuxä¸Šæœ‰å¾ˆå¤šå¯ä»¥æŠ˜è…¾çš„ï¼Œæ‰€ä»¥æˆ‘å°±è½¬åˆ°äº†linuxå¼€å‘ï¼Œæœ‰å…´è¶£å¯ä»¥å‚è€ƒä¸‹<a href="https://jinbaotang.cn/2021/06/06/how-mcu2linux/">æˆ‘æ˜¯å¦‚ä½•ä»MCUå¼€å‘è½¬åˆ°linuxå¼€å‘</a>ï¼Œä¸è¿‡å½“å‰ï¼ˆ2021.06.07 02:13ï¼‰æœªå®Œæˆã€‚</p><p>&emsp;&emsp;é’ˆå¯¹ä¸Šé¢æœ‰äº›åœ°æ–¹ä¸å¤Ÿè¯¦ç»†ï¼Œå¯ä»¥è¯„è®ºåŒºç•™è¨€~~</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> wireshark </tag>
            
            <tag> rsync </tag>
            
            <tag> pcap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºopensslå®ç°tls+socketçš„å®‰å…¨é€šä¿¡-2</title>
      <link href="2021/06/06/tls-socket2/"/>
      <url>2021/06/06/tls-socket2/</url>
      
        <content type="html"><![CDATA[<blockquote><p><a href="https://jinbaotang.cn/2021/05/05/tls-socket/">æ¥åŸºäºopensslå®ç°tls+socketçš„å®‰å…¨é€šä¿¡-1</a>,è¿™ç¯‡è¿˜è¦æ˜¯è®²è§£ç”Ÿæˆç§˜é’¥ã€è¯ä¹¦ï¼Œå¹¶ä¸”æ˜¯ä½¿ç”¨<em>socket api</em>å’Œ<em>openssl api</em>æ¥å®ç°åŸºäºtlsçš„å®‰å…¨é€šä¿¡ã€‚ç”±äºè¯ä¹¦é“¾å¹¶æ²¡æœ‰æ–°ä¸œè¥¿ï¼Œè¯¥ç¯‡ä¸»è¦è¿˜æ˜¯ä»¥å•è¯ä¹¦ä¸ºä¾‹ï¼Œåç»­å¯ä»¥å†æ•´ä¸€ä¸ªåŸºäºè¯ä¹¦é“¾çš„é€šä¿¡ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> åè®®æ ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tls </tag>
            
            <tag> socket </tag>
            
            <tag> openssl </tag>
            
            <tag> ethernet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç é‡æ„-1</title>
      <link href="2021/06/05/refactor-1/"/>
      <url>2021/06/05/refactor-1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è®°å½•ç¬¬ä¸€æ¬¡ç¨å¤§è§„æ¨¡çš„é‡æ„ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸‰æ¬¡å†™DoIP, ç¬¬1.5æ¬¡å†™UDSï¼Œç¬¬ä¸€æ¬¡å†™CANTPã€routerã€‚</p></blockquote><h1 id="ä¸€ã€-èƒŒæ™¯"><a href="#ä¸€ã€-èƒŒæ™¯" class="headerlink" title="ä¸€ã€ èƒŒæ™¯"></a>ä¸€ã€ èƒŒæ™¯</h1><p>&emsp;&emsp;åœ¨<a href="https://jinbaotang.cn/2021/04/11/why-write/">ä¸ºä»€ä¹ˆè¦å†™åšå®¢</a>é‡Œæåˆ°äº†ï¼Œç”±äºä¸ªäººå…³ç³»ï¼Œæ¢å·¥ä½œäº†ã€‚æ–°å·¥ä½œçš„é¦–è¦ä»»åŠ¡å°±æ˜¯ä¼˜åŒ–å·²æœ‰ä»£ç ï¼Œåœ¨èŠ±äº†ä¸€æ®µæ—¶é—´é˜…è¯»ä»£ç æ•´ä½“æ¡†æ¶åï¼Œå‘ç°å·²æœ‰çš„ä»£ç æ¡†æ¶å±‚æ¬¡ä¸å¤ªæ¸…æ¥šï¼Œå¦‚æœè¦ä¼˜åŒ–çš„è¯ï¼Œæ€»æ„Ÿè§‰æ˜¯åœ¨åšé”™è¯¯çš„äº‹ã€‚è¿›è€Œè·Ÿé¢†å¯¼æå‡ºé‡æ„çš„æƒ³æ³•ï¼Œé¢†å¯¼ä¹ŸèµåŒã€‚å°±å¼€å§‹<strong>æµ´ç«é‡ç”Ÿ</strong>ä¹‹è·¯äº†ï¼Œè·Ÿä¹‹å‰çš„å·¥ä½œèƒŒæ™¯ç›¸å…³ï¼Œé‡æ„äº†å°±æƒ³åšæˆå¯è¿­ä»£ã€è·¨å¹³å°çš„ï¼Œæ‰€ä»¥åœ¨è¿‡å»çš„ä¸€ä¸¤ä¸ªæœˆä¸æ˜¯å°±æ˜¯åœ¨è®¾è®¡å°±æ˜¯åœ¨éªŒè¯äº†ï¼Œè¿™æ®µæ—¶é—´ï¼Œæ— è®ºæ˜¯åœ¨è½¦ä¸Šã€æ´—æ¾¡è¿˜æ˜¯ç¡è§‰å‰éƒ½æ˜¯åœ¨è„‘å­é‡Œè·‘æµç¨‹ï¼Œä¹ŸçœŸæ­£çš„ä½“ä¼šåˆ°äº†<em>é¢å‘å¯¹è±¡</em>ï¼ˆè™½ç„¶æˆ‘æ˜¯ç”¨cï¼‰å¸¦æ¥çš„å¥½å¤„äº†ã€‚ä¹Ÿç»ˆäºä¸€ç‚¹ç‚¹çš„ä½“ä¼šåˆ°äº†ï¼ŒåŸæ¥ä¹‹å‰è€è™ï¼ˆ<strong>æŠ€æœ¯å¶åƒä¹‹ä¸€</strong>ï¼‰çœ‹ç€è§„èŒƒå†™ä»£ç ä¹Ÿæ²¡æœ‰è¿™ä¹ˆçš„ç¥å¥‡ï¼Œ<em>æ³¨ï¼šç¦»è€è™çš„æ°´å¹³å½“ç„¶è¿˜æœ‰å¾ˆè¿œçš„è·¯ï¼Œæ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„å˜›ï¼Œè«æ¬ºå°‘å¹´ç©·ã€‚</em>â€”è®°äº2021.06.05 <img src="/medias/refactor-1/dream.jpeg"></p><h1 id="äºŒã€-å…³äºé¢å‘å¯¹è±¡"><a href="#äºŒã€-å…³äºé¢å‘å¯¹è±¡" class="headerlink" title="äºŒã€ å…³äºé¢å‘å¯¹è±¡"></a>äºŒã€ å…³äºé¢å‘å¯¹è±¡</h1><h2 id="1-å…³äºæˆ‘è‡ªå·±"><a href="#1-å…³äºæˆ‘è‡ªå·±" class="headerlink" title="1. å…³äºæˆ‘è‡ªå·±"></a>1. å…³äºæˆ‘è‡ªå·±</h2><p>&emsp;&emsp;è‡ªå·±ç›®å‰æ˜¯ä¸»<strong>c</strong>ï¼Œæš‚æ—¶ç•¥æ‡‚ä¸€ç‚¹c++ï¼Œæœ‰ä¸€æ®µæ—¶é—´ä¸€ç›´æŒºæƒ³è¿›ä¸€æ­¥å­¦c++çš„ï¼Œè™½ç„¶è‡ªå·±å·¥ä½œä¹‹ä½™ä¹Ÿå†™è¿‡ä¸€ä¸ªwebserverçš„å°ç¨‹åºï¼Œä½†æ˜¯æš‚æ—¶å—é™å·¥ä½œå†…å®¹ï¼Œä¹Ÿè°ˆä¸ä¸Šèƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨c++äº†ã€‚ä¹‹å‰æƒ³å­¦c++çš„åŸå› ä¹Ÿæ¯”è¾ƒå•çº¯ï¼Œå¾ˆå¤šäººéƒ½è¯´cæ˜¯é¢å‘è¿‡ç¨‹çš„è¯­è¨€ï¼Œc++æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œè€Œé¢å‘å¯¹è±¡æ˜¯äººæ­£å¸¸çš„æ€ç»´æ–¹å¼ã€‚æ‰€ä»¥è§‰å¾—å¿…é¡»å¾—å­¦ä¼šc++ï¼Œæ— è®ºæ˜¯ä¸ºäº†åšçŸ¥è¯†å‚¨å¤‡ï¼Œè¿˜æ˜¯ä¸ºäº†å­¦ä¼šé¢å‘å¯¹è±¡çš„æ€ç»´æ–¹å¼ã€‚å¯æ˜¯åé¢å­¦äº†ä¸€æ®µæ—¶é—´çš„c++åï¼Œå…¶å®è¿˜æ˜¯ä¸çŸ¥é“é¢å‘å¯¹è±¡å’Œé¢å‘å¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œç›´åˆ°æœ‰ä¸€å¤©çœ‹<strong>vsomeip</strong>çš„æºç ï¼ˆå¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡çœ‹ï¼‰ï¼Œçªç„¶å°±<strong>é¡¿æ‚Ÿäº†</strong>ï¼Œå¾ˆç¥å¥‡çš„ä¸€ä»¶äº‹ã€‚æ‰€ä»¥æˆ‘ç›¸ä¿¡ï¼Œ<em>æ— è®ºä»»ä½•äº‹ï¼Œå³ä½¿é‡åˆ°äº†å¾ˆå¤§çš„å›°éš¾ï¼Œæˆ‘éƒ½ç›¸ä¿¡è¿™äº›å›°éš¾å’Œé—®é¢˜ä¼šåœ¨æŸä¸€ä¸ªæ—¶é—´ç‚¹è§£å†³</em>ï¼Œè¿™æ˜¯åœ¨å›°å¢ƒä¸­ï¼Œä¸€ç›´æ¿€åŠ±ç€è‡ªå·±çš„è¯ã€‚</p><h2 id="2-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡"><a href="#2-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡" class="headerlink" title="2. ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡"></a>2. ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡</h2><p>&emsp;&emsp;å…³äºé¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹ï¼Œç½‘ä¸Šæœ‰é“ºå¤©ç›–åœ°çš„è§£é‡Šï¼Œæ¯”å¦‚ï¼š<a href="https://www.zhihu.com/question/27468564/answer/226691160">å¦‚ä½•é€šä¿—æ˜“æ‡‚åœ°ä¸¾ä¾‹è¯´æ˜ã€Œé¢å‘å¯¹è±¡ã€å’Œã€Œé¢å‘è¿‡ç¨‹ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a>ã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³è°ˆè°ˆè‡ªå·±çš„ç†è§£ã€‚æˆ‘è§‰ä¸Šé¢é“¾æ¥è¯´çš„æˆ‘æŒºè®¤å¯çš„ä¸€å¥è¯å°±æ˜¯ï¼š<strong>é¦–å…ˆæ˜¯å‘½åå†²çªï¼Œè‹±æ–‡å•è¯ä¹Ÿå°±é‚£ä¹ˆå‡ ä¸ªï¼Œå¯èƒ½å†™ç€å†™ç€å–åæ—¶å°±æ²¡åˆé€‚çš„çŸ­è¯ç”¨äº†ï¼Œä¸ºäº†é¿å…å†²çªï¼Œåªèƒ½æŠŠå‡½æ•°åå–å¾—è¶Šæ¥è¶Šé•¿ã€‚</strong>å½“ç„¶è¿™ä¸æ˜¯é¢å‘å¯¹è±¡å°±èƒ½è§£å†³çš„ï¼Œå› ä¸ºæ¯”å¦‚Cè¯­è¨€ï¼Œç”±äºæ²¡æœ‰å‘½åç©ºé—´çš„æ¦‚å¿µï¼Œæœ‰äº›å‡½æ•°ä¸æƒ³å¼„æˆ<strong>static</strong>ï¼Œä»¥ä¸ºæœ‰å…¶ä»–çš„æ–‡ä»¶å¯èƒ½ä¼šç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œè¿™å°±åˆ°å¯¼è‡´äº†ï¼Œä½ çš„æ•´ä¸ªå·¥ç¨‹/åŠ¨æ€åº“éƒ½åªèƒ½æœ‰è¿™ä¸ªä¸€ä¸ªå‡½æ•°åäº†ï¼›è¿˜æœ‰å°±æ˜¯ç±»å‹äº†ï¼Œç”¨c/c++éš¾å…ä¼šè‡ªå·±æ„é€ ä¸€äº›è‡ªå·±çš„ç±»å‹ï¼Œè¿˜æ˜¯åƒå‡½æ•°ä¸€æ ·ï¼Œç”±äºäº†æ²¡æœ‰åƒ<strong>å‘½åç©ºé—´</strong>è¿™æ ·ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œåœ¨ä¸€ä¸ªç¨‹åºé‡Œå¦‚æœæœ‰åŒæ ·çš„å‘½åï¼Œå³ä½¿ä¸ä¼šå¸¦æ¥ç¼–è¯‘ã€é“¾æ¥å‡ºé”™ï¼Œä¹Ÿä¼šç»™ä»£ç å¯è¯»æ€§å¸¦æ¥ç¾éš¾ã€‚ä½†æ˜¯å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæœ‰äº†é¢å‘å¯¹è±¡çš„æ€æƒ³åï¼Œå°±ä¼šè‡ªåŠ¨çš„å¯¹ä¸€äº›æ•°æ®ç»“æ„æ‰“åŒ…ï¼ˆstructï¼‰åœ¨ä¸€èµ·ï¼Œè¿™å°±åƒä¸€ä¸ªç±»äº†ï¼Œå†æ·»åŠ å‡ ä¸ªå‡½æ•°æŒ‡é’ˆå°±åƒæ˜¯<em>å¼±åŒ–ç‰ˆè™šå‡½æ•°</em>ï¼Œæ‰“åŒ…çš„åœ¨ä¸€èµ·åï¼Œä¹Ÿä¼šä¸è‡ªè§‰åœ°å¯¹ä¸€äº›å˜é‡å’Œå‡½æ•°æ·»åŠ <strong>static</strong>æ¥ä¿®é¥°äº†ï¼Œè¿™æ ·é™åˆ¶äº†ä½œç”¨åŸŸï¼Œæé«˜äº†ä»£ç å¯è¯»æ€§ï¼›ä¹Ÿå‡å°‘äº†ä¸Šé¢æåˆ°çš„å‘½åå†²çªã€‚å½“ç„¶å¯¹äºç¨å¤§è§„æ¨¡ï¼Œåˆæœ‰ç›¸è¿‘æ¦‚å¿µçš„åœ¨ä¸€ä¸ªç¨‹åºé‡Œæ˜¯ï¼Œä¸Šé¢é—®é¢˜ä¾ç„¶ä¼šå­˜åœ¨ï¼Œæ¯”å¦‚æˆ‘æ›¾ç»å†™è¿‡çš„<strong>someip</strong>ä»£ç ï¼Œå³ä½¿æˆ‘å·²ç»åˆ’åˆ†äº†å¥½å‡ ä¸ªæ¨¡å—ï¼Œä½†æ˜¯ç”±äºä¸Šé¢ç›¸è¿‘æ¦‚å¿µçš„å¤ªå¤šäº†ï¼Œä¹Ÿæœ‰ç‚¹å‘½åè¯ç©·ï¼ˆå¯èƒ½è¿˜æ˜¯å¤ªèœï¼‰ï¼Œå»çœ‹<strong>vsomeip</strong>ä»£ç ï¼ˆc++ï¼‰æ—¶ï¼Œå°±å‘ç°é‡Œé¢å¾ˆå¤šéƒ½æ˜¯ä¸€æ ·çš„åå­—ï¼Œä½†æ˜¯ç”±äºä½œç”¨åŸŸçš„é—®é¢˜ï¼Œæ—¢ä¸ä¼šå¸¦æ¥å†²çªï¼Œä¹Ÿä¸ä¼šç»™å¯è¯»æ€§å¸¦æ¥é—®é¢˜ã€‚</p><h2 id="3-æˆ‘ç†è§£çš„é¢å‘å¯¹è±¡"><a href="#3-æˆ‘ç†è§£çš„é¢å‘å¯¹è±¡" class="headerlink" title="3. æˆ‘ç†è§£çš„é¢å‘å¯¹è±¡"></a>3. æˆ‘ç†è§£çš„é¢å‘å¯¹è±¡</h2><p>&emsp;&emsp;ä¸Šé¢åˆ†æäº†è¿™ä¹ˆå¤šï¼Œä»‹ç»äº†é¢å‘å¯¹è±¡å¸¦æ¥çš„å¥½å¤„ï¼Œé‚£åˆ°åº•ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡å‘¢ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ<a href="https://www.zhihu.com/question/27468564/answer/101951302">ç¼–ç¨‹å‘å±•å²è°ˆé¢å‘å¯¹è±¡</a>è¿™ä½ç­”ä¸»è®²çš„æˆ‘è§‰å¾—ç‰¹åˆ«é€‚åˆæ²¡å’‹å†™è¿‡ä»£ç ï¼Œåˆæœ‰ä¸€å®šä¸ªæ¦‚å¿µçš„äººï¼›<a href="https://www.zhihu.com/question/27468564/answer/757537214">åŠ›æ‰£å®˜æ–¹è§£ç­”é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡</a>çš„ï¼Œæ—©æˆ‘å†™äº†å¤§æ¦‚2ä¸‡è¡Œä¸¤åœºä»£ç åï¼Œçœ‹åˆ°çš„ï¼Œè§‰å¾—å°±ç‰¹åˆ«é€‚åˆä¸€ç›´ä¸»è¦ç”¨é¢å‘è¿‡ç¨‹å†™cçš„äººï¼Œå›¾æ–‡å¹¶èŒ‚çš„å°†é¢å‘è¿‡ç¨‹ç›¸å¯¹é¢å‘è¿‡ç¨‹çš„å¥½å¤„è®²è§£çš„å¾ˆæ¸…æ¥šã€‚ä½†æ˜¯æˆ‘è§‰å¾—éƒ½ä¸å¤ŸæŠ½è±¡ï¼Œæˆ‘è‡ªå·±æœ‰ä¸€å¤©åƒèŠ’æœï¼Œç»“åˆè‡ªå·±ä¸€å¼€å§‹æåˆ°çš„<strong>é¡¿æ‚Ÿ</strong>ï¼Œæ„Ÿè§‰å¯ä»¥æ›´å½¢è±¡çš„è¯´æ˜<em>é¢å‘è¿‡ç¨‹</em>å’Œ<em>é¢å‘å¯¹è±¡</em>çš„åŒºåˆ«ï¼š<br>å¦‚æœæˆ‘è¦åƒä¸€ä¸ªèŠ’æœï¼Œé¢å‘è¿‡ç¨‹å°±æ˜¯ï¼š</p><ol><li>æ‰¾åˆ°èŠ’æœ</li><li>æ´—èŠ’æœ</li><li>ç»™èŠ’æœæ‰’çš®/åˆ‡ç›˜</li><li>åƒèŠ’æœ</li><li>æ¶ˆåŒ–èŠ’æœ</li><li>æˆ‘ä»¬å°±å®Œæˆäº†åƒæ‰èŠ’æœçš„ä»»åŠ¡<br>ä¸Šé¢å°±è·Ÿæµæ°´çº¿ä¸€ä¸‹ï¼Œè¿‡ç¨‹åŒ–ï¼Œåªæœ‰åšå®Œäº†ä¸Šä¸€æ­¥æ‰èƒ½ä¸‹ä¸€æ­¥ï¼Œä¸åšå®Œä¸Šä¸€æ­¥ï¼Œéƒ½ä¸çŸ¥é“ä¸‹ä¸€æ­¥è¦å¹²å•¥ã€‚å¯èƒ½ä¼šè¯´ï¼Œæˆ‘çŸ¥é“å•Šï¼Œæˆ‘çŸ¥é“æˆ‘åƒä¸€ä¸ªèŠ’æœï¼Œè¦æ‰¾ã€æ´—ã€åˆ‡ã€åƒã€æ¶ˆåŒ–ï¼Œå¯¹å•Šï¼Œè¿™å°±æ˜¯é¢å‘å¯¹è±¡å•Šï¼Œç¬¦åˆäººçš„æ€ç»´æ–¹å¼ã€‚<br>è¿˜æ˜¯ä»¥èŠ’æœä¸ºä¾‹ï¼Œé‚£é¢å‘å¯¹è±¡ï¼š</li><li>é¦–å…ˆå°±è¦æœ‰ä¸€ä¸ªæœ€ç»ˆå¯¹è±¡ï¼ŒèŠ’æœ</li><li>ä¸ºäº†åƒèŠ’æœï¼Œæˆ‘éœ€è¦ç”¨æ‰‹æ´—ï¼Œç”¨æ‰‹æ‰’çš®ï¼Œç”¨åˆ€åˆ‡ï¼Œç”¨å˜´åƒï¼Œè‡ªå·±æ¶ˆåŒ–ï¼Œæ‰€ä»¥è¿˜éœ€è¦<em>æ‰‹å¯¹è±¡</em>ï¼Œ<em>åˆ€å¯¹è±¡</em>ï¼Œ<em>å˜´å¯¹è±¡</em>ï¼Œ<em>æ¶ˆåŒ–å¯¹è±¡â€“èƒƒ</em>ã€‚</li><li>å‡†å¤‡å®Œè¿™äº›å¯¹è±¡ï¼Œè®¾ç½®å¯¹åº”å±æ€§ï¼Œç”¨ä»€ä¹ˆæ°´ï¼Œä»€ä¹ˆåˆ€ï¼Œè°çš„æ‰‹æ‰’çš®ï¼Œè°çš„å˜´è´Ÿè´£æœ€åçš„åƒï¼ŒèŠ’æœæ˜¯ç”±å“ªäº›å™¨å®˜æ¶ˆåŒ–ã€‚ </li><li>è¿™äº›éƒ½ç”¨å¼„å¥½ï¼Œå°±åˆ†åˆ«ä¸€æ¬¡ä½¿ç”¨å¯¹åº”çš„å¯¹é€‰å®Œæˆå¯¹åº”çš„è¿‡ç¨‹ï¼Œè¿™å°±å®Œæˆäº†å¯¹åº”åƒèŠ’æœè¿™ä¸ªäº‹äº†ã€‚<br>è½¬æˆä»£ç å°±æ˜¯ï¼š</li></ol><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//é¢å‘è¿‡ç¨‹ </span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">mango_s</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//....</span><span class="token punctuation">&#125;</span><span class="token class-name">mango_t</span><span class="token punctuation">;</span><span class="token class-name">mango_t</span> <span class="token operator">*</span><span class="token function">find_mango</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">wash_mango</span><span class="token punctuation">(</span><span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">peel_mango</span><span class="token punctuation">(</span><span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">cut_mango</span><span class="token punctuation">(</span><span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">bite_mango</span><span class="token punctuation">(</span><span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">digest_mango</span><span class="token punctuation">(</span><span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">mango_t</span> <span class="token operator">*</span>mango<span class="token punctuation">;</span>    mango <span class="token operator">=</span> <span class="token function">find_mango</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">wash_mango</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">cut_mango</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">bite_mango</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">digest_mango</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//é¢å‘å¯¹è±¡</span><span class="token keyword">class</span> <span class="token class-name">Hand</span> <span class="token punctuation">&#123;</span> <span class="token comment">//... &#125;;</span><span class="token keyword">class</span> <span class="token class-name">Knife</span> <span class="token punctuation">&#123;</span> <span class="token comment">//... &#125;;</span><span class="token keyword">class</span> <span class="token class-name">Mouth</span> <span class="token punctuation">&#123;</span> <span class="token comment">//... &#125;;</span><span class="token keyword">class</span> <span class="token class-name">Stomach</span> <span class="token punctuation">&#123;</span> <span class="token comment">//... &#125;;</span><span class="token keyword">class</span> <span class="token class-name">Mango</span> <span class="token punctuation">&#123;</span> <span class="token comment">//... &#125;;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Hand hand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Hand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Knife knife <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Knife</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Mouth mouth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Mouth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Stomach stomach <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Stomach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Mango mango <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Mango</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    hand<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    hand<span class="token punctuation">.</span><span class="token function">wash</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    hand<span class="token punctuation">.</span><span class="token function">peel</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    knife<span class="token punctuation">.</span><span class="token function">cut</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    mouth<span class="token punctuation">.</span><span class="token function">bite</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span>    stomach<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span>mango<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ä¸çŸ¥é“çœ‹å®Œä¸Šè¿°ç¤ºä¾‹åï¼Œæœ‰æ²¡æœ‰æ›´æ¸…æ¥šã€‚ä»æœ€åçš„å¤„ç†æµç¨‹æ¥çœ‹ï¼Œéƒ½æ˜¯éœ€è¦é¡ºåºè°ƒç”¨çš„ï¼Œä¸åŒçš„æ˜¯ä¸€å¼€å§‹çš„æ€è€ƒè¿‡ç¨‹ï¼Œé¢å‘è¿‡ç¨‹æ›´å¤šæ˜¯åšå®Œè¿™ä¸€æ­¥ï¼Œæ‰ä¼šå»æƒ³æˆ‘ä¸‹ä¸€æ­¥è¦ç”¨ä»€ä¹ˆä¸œè¥¿æ¥å¹²ä»€ä¹ˆï¼Œæœ€ç»ˆä¸€æ­¥ä¸€æ­¥å®Œæˆæ•´ä¸ªæ“ä½œã€‚é¢å‘å¯¹è±¡å‘¢ï¼Œä¸€å¼€å§‹å°±æƒ³å¥½å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘è¦ç”¨ä»€ä¹ˆå·¥å…·æ¥åšä»€ä¹ˆï¼Œç»™æ¯ä¸ªå·¥å…·ä»¥ç‰¹å®šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ‰‹å¯ä»¥ç”¨æ¥<strong>æ‰¾ã€æ´—ã€åˆ‡</strong>ï¼Œæœ‰äº†å¯¹è±¡å¹¶ä¸”æœ‰äº†æ“ä½œåï¼Œå°±å¯ä»¥æŒ‰ç…§æµç¨‹å®Œåæ•´ä¸ªä»»åŠ¡äº†ã€‚<br>&emsp;&emsp;çœ‹å®Œä¸Šè¿°ä»£ç ï¼Œå¯èƒ½å¾ˆå¤šäººä¼šè¯´ï¼Œæˆ‘è§‰å¾—æ²¡å•¥å¤šå¤§åŒºåˆ«å•Šã€‚æ˜¯çš„ï¼Œä¸Šé¢è¿™ä¸ªä»»åŠ¡çš„ç¡®æ²¡å•¥å¤šå¤§åŒºåˆ«ï¼Œç”šè‡³ç”¨é¢å‘è¿‡ç¨‹è¿˜æ›´ç®€å•ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ä¸ª<a href="https://www.zhihu.com/question/27468564/answer/757537214">åŠ›æ‰£å®˜æ–¹è§£ç­”é¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡</a>ï¼Œå°±æ¸…æ¥šäº†ã€‚æˆ–è€…åˆä¼šè¯´ï¼Œæˆ‘ç”¨cä¹Ÿèƒ½å®Œæˆc++é‚£æ ·çš„å•Šï¼Œå¯¹çš„ï¼Œå®Œå…¨æ²¡é—®é¢˜å“¦ï¼Œlinuxå†…æ ¸å°±æ˜¯è¿™ä¹ˆåšçš„å‘¢ã€‚ä½†æ˜¯ä½ å»çœ‹è¿™äº›ä»£ç ï¼Œåˆ«è¯´äº›å†™å‡ºé‚£æ ·çš„å®äº†ï¼Œå°±æ˜¯æ— éšœç¢çœ‹æ‡‚å°±æ˜¯å¤§ç¥äº†ï¼Œæ›´åˆ«è¯´c++è¿˜æœ‰è™šå‡½æ•°ã€é‡è½½è¿™æ ·ç§’æ€ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ¥å®ç°<strong>ç±»è™šå‡½æ•°çš„åšæ³•</strong>ã€‚å¦å¤–ï¼Œæ›´ä¸ºå…³é”®çš„æ˜¯ï¼Œä½¿ç”¨c++ï¼Œ<strong>å®ƒå¯ä»¥ç”¨è¯­æ³•è§„åˆ™ä¸Šæ¥å°½é‡ä¿è¯ä½ æŒ‰ç…§é¢å‘å¯¹è±¡è§„èŒƒæ¥å®ç°</strong>ï¼Œæ¯”å¦‚æˆ‘å¯ä»¥åœ¨<em>ç±»</em>é‡Œé¢å®šä¹‰<em>ç§æœ‰æˆå‘˜å˜é‡</em>ï¼Œå¤–éƒ¨æƒ³è¦è®¿é—®è¿™äº›å˜é‡å°±å¿…é¡»é€šè¿‡æ¥å£æ¥å®ç°ï¼Œè¿™æ ·ä½ å°±ä¸å¾—ä¸æ€è€ƒå¦‚ä½•å…ˆå®šä¹‰å¯¹åº”çš„æ“ä½œï¼›è‹¥ä½ æ˜¯ç”¨cçš„ï¼Œå°±ä¸ä¸€å®šä¼šè¿™æ ·åšï¼Œå¤§æ¦‚ç‡ä½ ä¼šç›´æ¥é€šè¿‡ç»“æ„ä½“å˜é‡ç›´æ¥å°±è®¿é—®äº†ï¼Œå› ä¸ºç»™æ¯ä¸ªå˜é‡éƒ½å†™ä¸ªgetå’Œsetã€‚ã€‚ã€‚ã€‚ï¼Œç€å®å¤ªç¹çäº†ã€‚<strong>ä¸è¿‡</strong>ï¼Œä½¿ç”¨cä¹Ÿèƒ½å®ç°ç±»ä¼¼äº<em>ç§æœ‰æˆå‘˜</em>ï¼Œè¿™æ ·çš„åšæ³•ä¸€ä¸ªæ˜¯ä¸ºäº†ä¸è®©å¤–éƒ¨çœ‹åˆ°é‡Œé¢çš„æˆå‘˜ï¼Œå¦ä¸€ä¸ªæ˜¯å¯ä»¥å‡å°‘æ¨¡å—é—´çš„è€¦åˆåº¦ã€‚æ¯”å¦‚ä¸‹è¿°æ“ä½œï¼ˆæˆ‘ä¹Ÿæ˜¯çœ‹åˆ«äººè¿™ä¹ˆå®ç°ï¼Œå½“æ—¶è§‰å¾—å¥½ç¥å¥‡ï¼Œç€å®æƒŠè‰³ï¼‰ï¼š</p><h2 id="4-cè¯­è¨€å®ç°ç§æœ‰æˆå‘˜"><a href="#4-cè¯­è¨€å®ç°ç§æœ‰æˆå‘˜" class="headerlink" title="4. cè¯­è¨€å®ç°ç§æœ‰æˆå‘˜"></a>4. cè¯­è¨€å®ç°ç§æœ‰æˆå‘˜</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* test.h */</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span><span class="token punctuation">&#123;</span>    <span class="token comment">/* public member */</span>    <span class="token keyword">int</span> test1<span class="token punctuation">;</span>    <span class="token keyword">int</span> test2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">test_handle</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span> <span class="token operator">*</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span> <span class="token operator">*</span><span class="token function">alloc_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">free_test</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span> <span class="token operator">*</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* test.c */</span><span class="token keyword">struct</span> <span class="token class-name">internal_test_s</span><span class="token punctuation">&#123;</span>    <span class="token comment">/* public member */</span>    <span class="token keyword">int</span> test_value1<span class="token punctuation">;</span>    <span class="token keyword">int</span> test_value2<span class="token punctuation">;</span>    <span class="token comment">/* private member */</span>    <span class="token keyword">int</span> test_value3<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">test_handle</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">test_t</span> <span class="token operator">*</span>test<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">struct</span> <span class="token class-name">internal_test_s</span> <span class="token operator">*</span>internal_test <span class="token operator">=</span> test<span class="token punctuation">;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> internal_test<span class="token operator">-></span>test_value3 <span class="token operator">+</span> test<span class="token operator">-></span>test_value1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span> <span class="token operator">*</span><span class="token function">alloc_test</span><span class="token punctuation">(</span>    <span class="token keyword">return</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">internal_test_s</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">free_test</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">test_s</span> <span class="token operator">*</span>test<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">free</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ä¸Šè¿°<code>test_value3</code>å°±æ˜¯ä¸€ä¸ªç§æœ‰å˜é‡äº†ï¼Œåœ¨test.cæ–‡ä»¶å†…æ˜¯å¯ç”¨çš„ï¼Œä½†æ˜¯æ–‡ä»¶å¤–å°±ä¸å¯è§äº†ï¼Œå…¶å®è¯´ç™½äº†ï¼Œè¿˜æ˜¯<strong>æŒ‡é’ˆæ°¸è¿œçš„ç¥</strong>ã€‚æ‹“å±•ä¸€ä¸‹ï¼Œå¦‚æœ<code>test_value3</code>æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹ï¼Œæ‰€ä»¥åœ¨test.cé‡Œé¢å°±ä¸å¾—ä¸å¼•å…¥è‡ªå®šä¹‰çš„å¤´æ–‡ä»¶ï¼ˆeg: custom_demo.hï¼‰ï¼Œä½†æ˜¯é’ˆå¯¹<code>test_value3</code>ï¼Œåªæœ‰test.cæ–‡ä»¶ç”¨çš„ç€ï¼Œå®Œå…¨æ²¡å¿…è¦å°†å…¶å®šä¹‰åœ¨å¤´æ–‡ä»¶ä¸Šäº†ï¼›<strong>å¦åˆ™</strong>ï¼Œå¦‚æœå…¶ä»–æ–‡ä»¶(æ¯”å¦‚æ¨¡å—C )ï¼Œéœ€è¦åŒ…å«test.hï¼Œé‚£å°±ä¸å¾—ä¸å°†custom_demo.hä¹ŸåŒ…å«è¿›å»ï¼Œè¿™æ ·æ˜æ˜¾ä¼šå¢åŠ ä»£ç çš„è€¦åˆåº¦ï¼›ä½†æ˜¯è‹¥ä½¿ç”¨ç§æœ‰æˆå‘˜ï¼Œæ˜æ˜¾å°†<code>custom demo</code>æ¨¡å—å’Œ<code>C</code>æ¨¡å—è¿›è¡Œè§£è€¦äº†ã€‚å°†éšç€è‡ªå·±cçš„ä»£ç é‡ç›´çº¿ä¸Šå‡å’Œæ…¢æ…¢æ›´å¤šæ¥è§¦c++ï¼Œå¯¹å®ƒä¿©çš„åŒºåˆ«ä¼šè¶Šæ¥è¶Šæœ‰ä½“ä¼šï¼Œä¹Ÿä¼šæ›´åŠ çš„æ³¨æ„ä»£ç ç»“æ„ã€è€¦åˆåº¦ï¼Œæ¯”å¦‚ç§æœ‰æˆå‘˜ï¼Œæˆ‘å·²ç»åº”ç”¨åˆ°å¥½å¤šä¸ªæ¨¡å—äº†ï¼Œè¿™çœŸçš„æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰æˆå°±æ„Ÿçš„äº‹æƒ…ã€‚å¯¹æˆ‘æ¥è¯´ï¼ŒæŠ€æœ¯æˆå°±æ„Ÿä¸€ç›´æ˜¯é­ç­–æˆ‘å­¦ä¹ çš„æœ€å¤§åŠ¨åŠ›ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> refactor </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>socket-canåŸºç¡€çŸ¥è¯†å’Œä½¿ç”¨</title>
      <link href="2021/05/07/socket-can/"/>
      <url>2021/05/07/socket-can/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç¬¬ä¸€æ¬¡æ¥è§¦socket can, å­¦ä¹ å’Œä½¿ç”¨çš„è¿‡ç¨‹ï¼Œä¹Ÿè®°å½•ä¸‹æ¥ï¼ŒåŠ æ·±å°è±¡ã€‚</p></blockquote><h1 id="ä¸€ã€-åŸç†"><a href="#ä¸€ã€-åŸç†" class="headerlink" title="ä¸€ã€ åŸç†"></a>ä¸€ã€ åŸç†</h1><p>&emsp;&emsp;è™½ç„¶ä½œä¸ºç¨‹åºå‘˜æœ€å¸Œæœ›çœ‹åˆ°çš„æŠ€æœ¯æ–‡ç« å°±æ˜¯ç›´æ¥ä¸Šæ¥ç”©å‡ºdemo codeï¼Œæœ€å¥½ç›´æ¥æ¬åˆ°å¯¹åº”çš„ç¯å¢ƒç›´æ¥æ‰§è¡Œè„šæœ¬å°±èƒ½è·‘èµ·æ¥ï¼Œå†ä¸æµä¹Ÿæ˜¯æœ‰cmakeï¼ŒMakefileå•¥çš„ã€‚ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œå…ˆè·‘èµ·æ¥å†è¯´ï¼Œç„¶åå†æ·±å…¥å­¦ä¹ ï¼Œæ•ˆç‡æ˜¯æœ€é«˜çš„ã€‚ä½†æ˜¯è¿™ç¯‡æ–‡ç« å¯¹æˆ‘æ¥è¯´æ˜¯ä¸ªå­¦ä¹ è®°å½•ï¼Œè¿˜æ˜¯å¾—ä»åŸç†ä¸Šå¼€å§‹è®°å½•ï¼Œåé¢æ•´ç†æ—¶å†è°ƒæ•´é¡ºåºå’¯ã€‚</p><h2 id="1-canæ€»çº¿åŸç†"><a href="#1-canæ€»çº¿åŸç†" class="headerlink" title="1. canæ€»çº¿åŸç†"></a>1. canæ€»çº¿åŸç†</h2><p>&emsp;&emsp;socket canæ¶‰åŠåˆ°CANæ€»çº¿åè®®ã€å¥—æ¥å­—ã€Linuxç½‘ç»œè®¾å¤‡é©±åŠ¨ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åè®®æ ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> can </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸºäºopensslå®ç°tls+socketçš„å®‰å…¨é€šä¿¡-1</title>
      <link href="2021/05/05/tls-socket/"/>
      <url>2021/05/05/tls-socket/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è®°å½•åŸºäºopensslæ¥å®ç°tlsçš„å®‰å…¨é€šä¿¡ï¼Œå€ŸåŠ©BSD socketæ¥å£æ¥å®ç°ã€‚ä¹Ÿåštlsç®€å•çš„ç§‘æ™®ï¼Œçœ‹è¿™ç¯‡æ–‡ç« ï¼Œé»˜è®¤è¯»è€…å·²ç»ä¼šsocketç¼–ç¨‹äº†ã€‚</p></blockquote><blockquote><p>å‘¨äº”æœ‹å‹åœˆçªç„¶çœ‹åˆ°å‰ä¸œå®¶ï¼Œä¹Ÿå†™äº†ä¸€ç¯‡å…³äºtlsçš„ç®€å•ç§‘æ™®ï¼Œçªç„¶æƒ³èµ·æˆ‘ä¹Ÿæœ‰ä¸€ä¸ªåŠæˆå“æ–‡ç« å…³äºtlsçš„ã€‚è¿™æ®µæ—¶é—´ç”±äºå·¥ä½œç¹å¿™ï¼Œä¸æ˜¯åœ¨refactorå°±æ˜¯åœ¨baidu/googleï¼Œä¸è¿‡è¿˜æ˜¯è›®æœ‰æ„æ€çš„ï¼Œç­‰é‡æ„å®Œæˆï¼Œæƒ³å¥½å¥½çš„æ€»ç»“ä¸€ä¸‹,åœ¨<a href="https://jinbaotang.cn/2021/06/05/tls-socket/">ä»£ç é‡æ„-1</a>ä¼šè¿™æ¬¡é‡æ„å¸¦æ¥çš„ä¸€äº›ä¸ªäººçš„è¿›æ­¥ï¼Œä»¥åŠè¿˜å¾…æ”¹è¿›çš„åœ°æ–¹ã€‚</p></blockquote><h1 id="ä¸€ã€-èƒŒæ™¯"><a href="#ä¸€ã€-èƒŒæ™¯" class="headerlink" title="ä¸€ã€ èƒŒæ™¯"></a>ä¸€ã€ èƒŒæ™¯</h1><p>&emsp;&emsp;ç”±äºä¸šåŠ¡éœ€è¦ï¼Œå¾—ä½¿ç”¨tlsæ¥å®Œæˆå®‰å…¨é€šä¿¡ï¼Œéœ€æ±‚ä¹Ÿæ˜¯å€ŸåŠ©å¼€æºçš„opensslæ¥å®ç°ã€‚æ•´äº†å¥½å‡ å¤©ï¼Œæ‰å®ç°openssl+socketæ¥è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚ç›®å‰æ˜¯è¯ä¹¦éƒ½å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯serverè·å–clientè¯ä¹¦å‡ºé”™ã€‚</p><p>&emsp;&emsp;å…¶ä¸­åœ¨ç”Ÿæˆè¯ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿèµ°äº†ä¸å°‘å¼¯è·¯ï¼Œç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°ä¸€ç¯‡ä»‹ç»å…³äºåŠ å¯†é€šä¿¡ã€è¯ä¹¦åŸç†ä»¥åŠä½¿ç”¨opensslè®²çš„æ¯”è¾ƒå…¨çš„æ–‡ç« ï¼Œç‰¹åˆ«æ˜¯åŸºäºC/C++ socketçš„å°±æ›´å°‘äº†ï¼Œæ‰€ä»¥å°±èŒç”Ÿäº†è‡ªå·±åœ¨å°è¯•çš„è¿‡ç¨‹ä¸­ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„è§£å†³è½¨è¿¹ã€‚</p><h1 id="äºŒã€å…³äºtls"><a href="#äºŒã€å…³äºtls" class="headerlink" title="äºŒã€å…³äºtls"></a>äºŒã€å…³äºtls</h1><h2 id="1-tlsçš„ä»‹ç»"><a href="#1-tlsçš„ä»‹ç»" class="headerlink" title="1. tlsçš„ä»‹ç»"></a>1. tlsçš„ä»‹ç»</h2><p>&emsp;&emsp;tlsæ˜¯transport layer securityçš„ç¼©å†™ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å®‰å…¨ä¼ è¾“å±‚åè®®ã€‚å…³äºtlsçš„ä»‹ç»ç½‘ä¸Šæœ‰ç‰¹åˆ«å¤šäº†ï¼Œå¼€å¤´ä¹Ÿæåˆ°äº†ï¼Œå‰ä¸œå®¶å‘è¡¨ä¸€ç¯‡å…³äº<a href="https://mp.weixin.qq.com/s/AnqZkYdk8XQZVT4MRidIEA">tlsçš„æ–‡ç« </a>ï¼Œè§‰å¾—æ˜¯å°‘æœ‰çš„è¿™ä¹ˆçŸ­ç¯‡å¹…ä»‹ç»è¿™ä¹ˆè¯¦ç»†ã€ç”ŸåŠ¨çš„äº†ã€‚å…³äºtlsçš„ä½œç”¨ä¸»è¦æ˜¯åœ¨è§£å†³ç½‘ç»œå®‰å…¨çš„å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li>ä¿å¯†(message privacy)ï¼Œä¿å¯†é€šè¿‡åŠ å¯†encryptionå®ç°ï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½åŠ å¯†ä¼ è¾“ï¼Œç¬¬ä¸‰æ–¹æ— æ³•å—…æ¢ï¼›</li><li>å®Œæ•´æ€§(message integrity)ï¼Œé€šè¿‡MACæ ¡éªŒæœºåˆ¶ï¼Œä¸€æ—¦è¢«ç¯¡æ”¹ï¼Œé€šä¿¡åŒæ–¹ä¼šç«‹åˆ»å‘ç°ï¼›</li><li>è®¤è¯(mutual authentication)ï¼ŒåŒæ–¹è®¤è¯,åŒæ–¹éƒ½å¯ä»¥é…å¤‡è¯ä¹¦ï¼Œé˜²æ­¢èº«ä»½è¢«å†’å……ï¼›<br>å¯¹æˆ‘ä»¬å†™çš„ä»£ç çš„æ¥è¯´ï¼Œå…¶å®å…³äºè¿™äº›åè®®å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œ<em>æš‚æ—¶</em>æˆ‘ä»¬å¹¶ä¸æ˜¯å¾ˆå…³å¿ƒï¼Œå› ä¸ºå·²ç»å¾ˆå¤šå®ç°å¥½çš„åº“å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚è¿™ç¯‡æ–‡ç« è¦ä»‹ç»çš„<a href="https://www.openssl.org/">openssl</a>ã€‚ç”šè‡³å¯¹äºhttpsä»¥ä¸Šçš„å¼€å‘è€…ï¼Œéƒ½ä¸å…³å¿ƒtlsçš„ä½¿ç”¨ã€‚ä½†æ˜¯å¯¹äºéœ€è¦ä½¿ç”¨åŸºäºtcpipæ¥å£ï¼ˆ<em>egï¼šBSD socketæ¥å£</em>ï¼‰ï¼Œè¿˜éœ€è¦å…³å¿ƒä¸€äº›tlsåº“çš„ä½¿ç”¨çš„ã€‚</li></ol><p>&emsp;&emsp;è™½ç„¶æˆ‘ä»¬å¯ä»¥æš‚æ—¶ä¸å…³å¿ƒtlsåè®®çš„å®ç°ï¼Œä½†æ˜¯å¯¹äºtlså…³äºå¯†ç å­¦éƒ¨åˆ†ï¼Œè§‰å¾—äº†è§£äº†åŸç†åï¼Œèƒ½å¤Ÿæ­£ç¡®ã€æ›´å¥½çš„ä½¿ç”¨tlsåº“çš„æ¥å£ï¼Œå‰é¢æåˆ°<a href="https://mp.weixin.qq.com/s/AnqZkYdk8XQZVT4MRidIEA">tlsçš„æ–‡ç« </a>å¯¹äºç®€å•çš„åŸç†æ¥è¯´ï¼Œè®²çš„çœŸçš„è›®ä¸é”™äº†ï¼Œä½†æ˜¯å¯¹äºè¯ä¹¦é‚£ä¸€å—ï¼Œæˆ‘è§‰å¾—å¯ä»¥å†å±•å¼€ä¸€ä¸‹ã€‚æ‰€ä»¥å€ŸèŠ±çŒ®ä½›äº†ï¼Œåœ¨ä¸Šé¢çš„æ–‡ç« åŸºç¡€ï¼Œç€é‡å¯¹è¯ä¹¦é‚£éƒ¨åˆ†å±•å¼€è®²</p><h2 id="2-tlsåŠ å¯†æŠ€æœ¯"><a href="#2-tlsåŠ å¯†æŠ€æœ¯" class="headerlink" title="2. tlsåŠ å¯†æŠ€æœ¯"></a>2. tlsåŠ å¯†æŠ€æœ¯</h2><p>&emsp;&emsp;tlsä¾èµ–äºä¸¤ç§åŠ å¯†æŠ€æœ¯ï¼š</p><ol><li>å¯¹ç§°åŠ å¯†ï¼ˆsymmetric encryptionï¼‰</li><li>éå¯¹ç§°åŠ å¯†ï¼ˆasymmetric encryptionï¼‰</li></ol><h3 id="1-å­—æ¯ç¼©å†™"><a href="#1-å­—æ¯ç¼©å†™" class="headerlink" title="1). å­—æ¯ç¼©å†™"></a>1). å­—æ¯ç¼©å†™</h3><blockquote><p>K: Key<br>E: Encrypt<br>D: Derypt<br>M: Message<br>C: Certificate</p></blockquote><h3 id="2-å¯¹ç§°åŠ å¯†"><a href="#2-å¯¹ç§°åŠ å¯†" class="headerlink" title="2). å¯¹ç§°åŠ å¯†"></a>2). å¯¹ç§°åŠ å¯†</h3><p>&emsp;&emsp;å…³äºå¯¹ç§°åŠ å¯†æ˜¯æœ€å¥½ç†è§£çš„ï¼Œåœ¨å°å”å’Œå°æ½˜æ‰‹é‡Œéƒ½æœ‰ä¸€ä»½ç§˜é’¥Kï¼ˆæ¯”å¦‚æ‰€æœ‰å­—éƒ½æ˜¯æŒ‰ç…§ä¸€ç‚¹è§„åˆ™è½¬æˆæ•°å­—+1ï¼‰ï¼Œå°å”ç»™å°æ½˜å‘æ‚„æ‚„è¯ä¹‹å‰ä¼šç”¨ç§˜é’¥KåŠ å¯†æ‚„æ‚„è¯ï¼Œå°æ½˜æ¥æ”¶åˆ°å°å”çš„æ‚„æ‚„è¯ï¼Œå°æ½˜æ˜¯çŸ¥é“è§„åˆ™ï¼Œå…ˆå‡1ï¼Œå†è½¬æˆæ•°å­—ï¼Œè¯¶ï¼Œå‘ç°æ˜¯å°å”å¯¹å°æ½˜çš„æƒ…è¯ï¼Œé‚£å‡ºäºåŒæ–¹çš„äº¤æµéœ€è¦ï¼Œå½“ç„¶éœ€è¦å“åº”äº†ã€‚æ‰€ä»¥å°æ½˜ä¹ŸæŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•åŠ å¯†äº†ä¸€ä¸‹ï¼Œç„¶åå‘ç»™äº†å°å”ã€‚å³ï¼š</p><pre class="line-numbers language-none"><code class="language-none">å°å”: C &#x3D; E(M, k)å°æ½˜: M &#x3D; D(C, K)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-éå¯¹ç§°åŠ å¯†"><a href="#3-éå¯¹ç§°åŠ å¯†" class="headerlink" title="3). éå¯¹ç§°åŠ å¯†"></a>3). éå¯¹ç§°åŠ å¯†</h3><p>&emsp;&emsp;ä¸Šé¢æåˆ°å°å”å’Œå°æ½˜éƒ½æœ‰ä¸€å¥—ä¸€æ ·çš„åŠ å¯†è§„åˆ™ï¼Œéå¯¹ç§°åŠ å¯†å‘¢ï¼Œå°±æ˜¯ä¸¤ä¸ªäººæ‰‹ä¸Šçš„åŠ å¯†è§„åˆ™æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚å°å”çš„æ˜¯K1(æ•°å­—+1), å°æ½˜çš„æ˜¯K2(æ•°å­—ä¹˜ä»¥3)ã€‚è™½ç„¶è§„åˆ™ä¸ä¸€æ ·ï¼Œä½†æ˜¯éƒ½èƒ½äº’ç›¸è§£å¯†å¯¹æ–¹çš„ä¿¡æ¯ï¼Œæ‹¿åˆ°å¯¹æ–¹çœŸæ­£æƒ³è¦è¡¨ç¤ºçš„ä¿¡æ¯ã€‚å³ï¼š</p><pre class="line-numbers language-none"><code class="language-none">å°å”: C &#x3D; E(M, k)å°æ½˜: M &#x3D; D(C, K)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-æ•°å­—ç­¾åå’ŒCA"><a href="#4-æ•°å­—ç­¾åå’ŒCA" class="headerlink" title="4). æ•°å­—ç­¾åå’ŒCA"></a>4). æ•°å­—ç­¾åå’ŒCA</h3><p>&emsp;&emsp;åœ¨å‰é¢æåˆ°äº†ç§˜é’¥Kï¼Œæ¶ˆæ¯å‘é€ç»™å¯¹æ–¹ä¹‹å‰ä¼šè¿›è¡ŒåŠ å¯†ï¼Œç„¶åæ¥æ”¶æ–¹æ”¶åˆ°æ¶ˆæ¯åè§£å¯†ã€‚ä½†æ˜¯æƒ³æƒ³ç§˜é’¥æ€ä¹ˆå‘é€è¿‡å»å‘¢ï¼Œæ˜æ–‡å‘é€è¿‡å»ä¸å°±è¢«äººå·å¬ã€ç¯¡æ”¹ï¼Œæ¯”å¦‚<a href="https://mp.weixin.qq.com/s/AnqZkYdk8XQZVT4MRidIEA">tlsçš„æ–‡ç« </a>æåˆ°çš„æ¢å±±ä¼¯ä¸ç¥è‹±å°ã€‚</p><p>ä¸ºäº†æˆå…¨æœ‰æƒ…äººï¼Œå¤§ä½¬å‘æ˜äº†**æ•°å­—ç­¾åï¼ˆdigital signature)**æŠ€æœ¯ã€‚æ•°å­—ç­¾åçš„åšæ³•æ˜¯ï¼š</p><ol><li>å°å”æŠŠè‡ªå·±çš„å…¬é’¥å’ŒIDï¼ˆæ¯”å¦‚ä»–èº«ä»½è¯å·æˆ–è€…ç”Ÿè¾°å…«å­—ï¼‰ä¸€èµ·ç»„æˆä¸€ä¸ª<strong>è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆcertificate signing requestï¼ŒCSRï¼‰</strong>ï¼Œ</li><li>å°å”æŠŠ<strong>CSR</strong>å‘ç»™ä¸€ä¸ªå¾·é«˜æœ›é‡ã€å¤§å®¶éƒ½è®¤å¯çš„äºº<strong>è¯ä¹¦ç®¡ç†ä¸­å¿ƒï¼ˆ certificate authorityï¼ŒCAï¼‰</strong>ï¼Œæ¯”å¦‚æœˆè€ï¼Œ</li><li>æœˆè€ç”¨è‡ªå·±çš„ç§é’¥åŠ å¯†å°å”çš„<strong>CSR</strong>ï¼Œå¾—åˆ°çš„å¯†æ–‡è¢«ç§°ä¸º<strong>æ•°å­—ç­¾åï¼ˆdigital signatureï¼‰</strong>ï¼Œ</li><li>æœˆè€æŠŠ <strong>æ•°å­—ç­¾å</strong> å’Œ <strong>CSR</strong> çš„æ˜æ–‡åˆåœ¨ä¸€èµ·ç§°ä¸º<strong>æœˆè€ç­¾ç½²çš„èº«ä»½è¯ï¼ˆCA signed certificateï¼ŒCRT</strong>ï¼‰ï¼Œå‘ç»™å°å”ï¼Œ</li></ol><pre class="line-numbers language-none"><code class="language-none">å°å”: CSR &#x3D; å°å”å…¬é’¥+å°å”èº«ä»½è¯     æ•°å­—ç­¾å &#x3D; E(CSR, æœˆè€çš„ç§é’¥)     CRT &#x3D; CSR + æ•°å­—ç­¾å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;æ¯å½“å…¶ä»–äººï¼ˆæ¯”å¦‚å°æ½˜ï¼‰æ‰¾å°å”èŠå¤©(eg:htts)çš„æ—¶å€™ï¼Œå°å”å‡ºç¤ºè‡ªå·±çš„æœˆè€ç­¾ç½²çš„èº«ä»½è¯<strong>ï¼ˆCRT.CSR)<strong>ã€‚æ‹¿åˆ°è¿™ä¸ªèº«ä»½è¯çš„äººï¼Œåªè¦ä»–æ˜¯ç›¸ä¿¡æœˆè€çš„(åœ¨è‡ªå·±æœºå™¨ä¸Šå®‰è£…äº†æœˆè€çš„èº«ä»½è¯</strong>CRT</strong>)ï¼Œå°±å¯ä»¥:</p><ol><li>ä»æœˆè€çš„èº«ä»½è¯ä¸­çš„æœˆè€çš„<strong>CSR</strong>é‡Œæå–æœˆè€çš„å…¬é’¥ï¼›</li><li>ç”¨æœˆè€çš„å…¬é’¥è§£å¯†å°å”çš„èº«ä»½è¯ä¸­æœˆè€çš„<strong>æ•°å­—ç­¾å</strong>ï¼Œå¾—åˆ°ä¸€ä¸ªå°å”çš„**CSRâ€™**ï¼›</li><li>å¦‚æœè¿™ä¸ª<strong>CSRâ€™<strong>å’Œå°å”èº«ä»½è¯ä¸­çš„</strong>CSR</strong>æ˜æ–‡ä¸€è‡´ï¼Œåˆ™è¯´æ˜<strong>â€è¿™ä¸ªå°å”çš„èº«ä»½è¯æ˜¯æœˆè€ç¡®è®¤è¿‡å¹¶ä¸”ç­¾åçš„â€</strong>ã€‚</li><li>å°æ½˜åªè¦ç›¸ä¿¡æœˆè€ï¼Œå°±ç›¸ä¿¡è¿™ä¸ªèº«ä»½è¯ï¼Œå°±ç›¸ä¿¡å°å”</li></ol><pre class="line-numbers language-none"><code class="language-none">å°æ½˜ï¼šæœˆè€çš„å…¬é’¥ &#x3D; æœˆè€çš„CRT.CSR.æœˆè€çš„å…¬é’¥     CSR&#39; &#x3D; D(å°å”çš„CRT.æ•°å­—ç­¾å, æœˆè€çš„å…¬é’¥)     if CSR&#39; &#x3D;&#x3D;å°å”çš„CRT.CSR then OK     I belive å°å”<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ç”±æ­¤è¿‡ç¨‹å¯ä»¥çœ‹å‡ºæ¥ï¼šéšä¾¿è°éƒ½å¯ä»¥å½“<strong>CAï¼ˆæœˆè€)<strong>â€”â€”åªè¦æ„¿æ„å…¬å¼€è‡ªå·±çš„å…¬é’¥ï¼Œå³å¯ç”¨è‡ªå·±çš„ç§é’¥å»åŠ å¯†åˆ«äººçš„è®¤è¯ã€‚é‚£æˆ‘ä»¬è¦æ˜¯ä¿¡é”™äº†</strong>CA</strong>ï¼Œè¢«ä»–æ‘†ä¸€é“æ€ä¹ˆåŠï¼Œæ¯”å¦‚ç¥æ¯ä¹Ÿæƒ³å½“<strong>CA* *<strong>ï¼Ÿç­”æ¡ˆæ˜¯ï¼š</strong>æ²¡åŠæ³•</strong>ã€‚æˆ‘ä»¬å¿…é¡»é€‰æ‹©ä¿¡ä»»ç¤¾ä¼šï¼Œè¦ç›¸ä¿¡å¦‚æœ<strong>CA</strong>è¯´è°ï¼Œä¸‡ä¸€è¢«è¯†ç ´ï¼Œå°±æ²¡æœ‰äººå†ç›¸ä¿¡ä»–äº†ï¼Œæ‰€è°“çš„<strong>CA</strong>å³å¤±å»å…¬ä¿¡åŠ›ã€‚ç°å®ä¸­ï¼Œå¾ˆå¤šæ“ä½œç³»ç»Ÿï¼ˆWindowsã€Mac OS Xï¼‰å’Œæµè§ˆå™¨ï¼ˆChromeã€ Firefoxã€IEï¼‰ä¼šå†…ç½®ä¸€äº›é è°±çš„ CA çš„èº«ä»½è¯ã€‚ä½†æ˜¯æœ‰æ²¡æœ‰<strong>CA</strong>å†’å¤©ä¸‹ä¹‹å¤§ä¸éŸªè¯´è°å‘¢ï¼Ÿä»çŸ¥ä¹ä¸Šçœ‹åˆ°äº†<a href="https://www.zhihu.com/question/49291684/answer/123313224">CNNIC</a>çš„æœºæ„å¥½åƒå°±æ˜¯ä¸€ä¸ªæˆ‘ä»¬ä¿¡é”™çš„é‚£ä¸ªäººã€‚</p><p>&emsp;&emsp;è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ä¸‹å›¾æè¿°ï¼š<img src="/medias/tls-socket/tang_pan.png" alt="å°å”å’Œå°æ½˜å¯¹è¯"></p><p>&emsp;&emsp;å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç¤ºæ„å›¾ï¼Œå› ä¸ºå¤§éƒ¨åˆ†èŠå¤©éƒ½éœ€è¦åŒè¾“å…¥è´¦å·ï¼Œä¸Šé¢ä¹ŸåŠ ä¸Šäº†è´¦å·å’Œå¯†ç ï¼Œä½†æ˜¯å¹¶ä¸å‡†ç¡®çš„è¡¨ç¤ºåè®®çš„æ¡æ‰‹å’Œé€šä¿¡è¿‡ç¨‹ã€‚ å›¾ä¸­çœç•¥äº†ä¸€äº›é‡è¦çš„ç»†èŠ‚ï¼Œæ¯”å¦‚æ¡æ‰‹ä¹‹åçš„å®é™…é€šä¿¡éƒ½æ˜¯é‡‡ç”¨å¯¹ç§°åŠ å¯†æŠ€æœ¯æ¥å®ç°çš„ï¼Œå› ä¸ºä¿è¯åŒæ–¹è·å–çš„å…¬é’¥æ˜¯æ²¡æœ‰è¢«ç¯¡æ”¹å’Œè·å–çš„ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†èƒ½å¤Ÿæåˆ°åŠ è§£å¯†é€Ÿåº¦ã€‚å› ä¸ºTLSæ¨¡å¼ä¸‹æ‰€æœ‰ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯åŠ å¯†çš„ï¼Œå¤§å®¶ä¼šå…³æ³¨åŠ å¯†å’Œè§£å¯†çš„æ€§èƒ½ã€‚å®¢ è§‚çš„è¯´ï¼Œéå¯¹ç§°åŠ å¯†æŠ€æœ¯çš„åŠ å¯†å’Œè§£å¯†æ¯”è¾ƒæ…¢ï¼Œç›¸å¯¹æ¥è¯´ï¼Œå¯¹ç§°åŠ å¯†æŠ€æœ¯çš„åŠ å¯† è§£å¯†è¿‡ç¨‹æ›´å¿«ã€‚æ‰€ä»¥å®é™…çš„è¿æ¥å’Œæ¡æ‰‹è¿‡ç¨‹ä¸­ï¼Œé€šä¿¡åŒæ–¹ä¼šåå•†ä¸€ä¸ªå¯¹ç§°åŠ å¯†ç§˜ é’¥ï¼Œä¹‹åçš„æ•°æ®é€šä¿¡è¿‡ç¨‹ä¸­çš„åŠ å¯†éƒ½æ˜¯åˆ©ç”¨å¯¹ç§°åŠ å¯†æŠ€æœ¯æ¥å®ç°çš„ã€‚</p><p>&emsp;&emsp;å…·ä½“çš„åšæ³•æ˜¯ï¼šæ¡æ‰‹çš„æ—¶å€™ï¼ŒåŒæ–¹å„è‡ªç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå¹¶ä¸”ä»¥éå¯¹ç§°åŠ å¯†çš„æ–¹å¼ åˆ†äº«ç»™å¯¹æ–¹ã€‚ç„¶åæ¯ä¸€æ–¹éƒ½æŠŠè‡ªå·±çš„éšæœºæ•°å’Œå¯¹æ–¹çš„éšæœºæ•°æ‹¼èµ·æ¥ï¼Œå°±æ˜¯æ¥ä¸‹æ¥ é€šä¿¡æ—¶å€™ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†æ–¹æ³•çš„ç§˜é’¥äº†ã€‚</p><h3 id="5-ä¿¡ä»»é“¾"><a href="#5-ä¿¡ä»»é“¾" class="headerlink" title="5). ä¿¡ä»»é“¾"></a>5). ä¿¡ä»»é“¾</h3><p>&emsp;&emsp;æœˆè€å¦‚æœæ‹…å¿ƒæ²¡æœ‰äººä¿¡ä»»è‡ªå·±æ˜¯ä¸ªå¥½<strong>CA</strong>ï¼ˆå°±åƒæ²¡äººä¿¡CNNICä¸€æ ·ï¼‰ï¼Œå¯ä»¥æ‰¾ä¸€ä¸ªå¤§å®¶éƒ½ä¿¡çš„<strong>CA</strong>ï¼ˆCNNICæ”¹æˆäº†DigiCertç­¾å‘çš„è¯ä¹¦ï¼‰ï¼Œæ¯”å¦‚æ°‘æ”¿å±€ï¼Œç”¨æ°‘æ”¿å±€çš„ç§é’¥åœ¨æœˆè€çš„èº«ä»½è¯ä¸Šç­¾åï¼š</p><pre class="line-numbers language-none"><code class="language-none">æœˆè€ï¼šCSR &#x3D; æœˆè€çš„å…¬é’¥+æœˆè€èº«ä»½è¯     æ•°å­—ç­¾å &#x3D; E(CSR, æ°‘æ”¿å±€çš„ç§é’¥)     CRT &#x3D; CSR + æ•°å­—ç­¾å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;å¦‚æœæµè§ˆå™¨æˆ–è€…æ“ä½œç³»ç»Ÿé‡Œå®‰è£…äº†æ°‘æ”¿å±€çš„å…¬é’¥åˆ™å¯ä»¥éªŒè¯<strong>â€œæœˆè€çš„èº«ä»½è¯æ˜¯æ°‘æ”¿å±€ç¡®è®¤å¹¶ä¸”ç­¾åè¿‡çš„â€</strong>ï¼Œä¿¡æœˆè€å°±ä¸å†æ˜¯è¿·ä¿¡äº†ï¼Œå°±ç®—æ˜¯å®˜æ–¹è®¤è¯è¿‡çš„äº†ã€‚</p><p>&emsp;&emsp;è¿™æ ·ï¼Œæœˆè€åœ¨ç­¾ç½²å°å”çš„èº«ä»½è¯çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨å°å”èº«ä»½è¯åé¢é™„ä¸Šè‡ªå·±çš„èº«ä»½è¯ã€‚è¿™æ ·å°å”çš„èº«ä»½è¯å°±æœ‰<strong>â€œä¸¤é¡µâ€</strong>äº†ã€‚</p><p>&emsp;&emsp;å½“å°æ½˜å’Œå°å”é€šä¿¡çš„æ—¶å€™ï¼š</p><ol><li>å°æ½˜ä¼šå…ˆè¦æ±‚å°å”å‡ºç¤ºè‡ªå·±çš„èº«ä»½è¯ï¼›</li><li>å°æ½˜è™½ç„¶ä¸ä¿¡ä»»æœˆè€ï¼Œä½†æ˜¯ä¿¡ä»»æ°‘æ”¿å±€ï¼Œæ‰€ä»¥å°æ½˜å¯ä»¥ç”¨æ°‘æ”¿å±€çš„èº«ä»½è¯é‡Œçš„æœˆè€çš„å…¬é’¥æ¥éªŒè¯å°å”èº«ä»½è¯é™„å¸¦çš„æœˆè€çš„èº«ä»½è¯ï¼Œäºæ˜¯å°±å¯ä»¥ä¿¡ä»»æœˆè€äº†ï¼›</li><li>å°æ½˜ç”¨æœˆè€èº«ä»½è¯é‡Œçš„å…¬é’¥éªŒè¯å°å”çš„èº«ä»½è¯ã€‚<br>è¦æ˜¯æ€• å°æ½˜è¿è‡ªå·±ä¹Ÿä¹Ÿä¸ä¿¡ä»»ï¼Œæ°‘æ”¿å±€å¯ä»¥å†æ‰¾ä¸€ä¸ª å°æ½˜ä¿¡ä»»çš„äººæ¥ç­¾åç¡®è®¤è‡ªå·±çš„èº«ä»½è¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä¸æ–­é€’æ¨ï¼Œä»è€Œå½¢æˆäº†ä¸€æ¡**ä¿¡ä»»é“¾ï¼ˆtrust of chain)**ã€‚</li></ol><h3 id="6-æ ¹èº«ä»½è¯å’Œè‡ªç­¾å"><a href="#6-æ ¹èº«ä»½è¯å’Œè‡ªç­¾å" class="headerlink" title="6).æ ¹èº«ä»½è¯å’Œè‡ªç­¾å"></a>6).æ ¹èº«ä»½è¯å’Œè‡ªç­¾å</h3><p>&emsp;&emsp;ä¿¡ä»»é“¾æ€»ä¼šæœ‰ä¸ªé¡¶ç«¯ï¼Œè¢«ç§°ä¸ºæ ¹èº«ä»½è¯ï¼ˆroot CAï¼‰ã€‚é‚£ä¹ˆæ ¹èº«ä»½è¯æ˜¯è°ç­¾åçš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼š<strong>è‡ªå·±ç­¾å</strong>ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬æ¯ä¸ªäººéƒ½å¯ä»¥è‡ªå·±ç­¾åè®¤è¯è‡ªå·±çš„èº«ä»½è¯ï¼Œå¾—åˆ°<strong>è‡ªç­¾åçš„èº«ä»½è¯ï¼ˆself-signed certificateï¼‰</strong>ã€‚å…·ä½“è¿‡ç¨‹æ˜¯ï¼š</p><ol><li>ç”Ÿæˆä¸€å¯¹ç§˜é’¥ï¼šå…¬é’¥ K2 å’Œç§é’¥ K1ï¼Œ</li><li>åˆ›å»ºè‡ªå·±çš„ <strong>CSR</strong>ï¼Œ</li><li>ç”¨è‡ªå·±çš„ç§˜é’¥åŠ å¯†<strong>CSR</strong>å¾—åˆ°<strong>æ•°å­—ç­¾å</strong>ï¼Œç„¶åæŠŠ<strong>CSR</strong>æ˜æ–‡å’Œ<strong>æ•°å­—ç­¾å</strong>ä¸€èµ·å‘å¸ƒã€‚</li></ol><p>ä»»ä½•äººåªè¦ä¿¡ä»»æˆ‘ä»¬è‡ªç­¾åçš„èº«ä»½è¯ <strong>CRT</strong>ï¼Œä¹Ÿå°±å¯ä»¥ç”¨ <strong>CRT.CSR.K2</strong>ä½œä¸ºå…¬é’¥åŠ å¯†è¦ä¼ é€’ç»™æˆ‘ä»¬çš„æ–‡æœ¬ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è‡ªå·±çš„ç§é’¥K1æ¥è§£å¯†æ–‡æœ¬ã€‚</p><p>å¦‚æœæ°‘æ”¿å±€å°±æ˜¯æ ¹CAäº†ï¼Œé‚£ä¹ˆä¸Šè¿°å„ä½çš„èº«ä»½è¯çš„ä¿¡ä»»é“¾å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">å°å”ï¼šCSR &#x3D; å°å”å…¬é’¥+å°å”åŸŸå     æ•°å­—ç­¾å &#x3D; E(CSR, æœˆè€çš„ç§é’¥)     CRT &#x3D; CSR + æ•°å­—ç­¾åæœˆè€ï¼šCSR &#x3D; æœˆè€çš„å…¬é’¥+æœˆè€åŸŸå     æ•°å­—ç­¾å &#x3D; E(æœˆè€çš„CSR, æ°‘æ”¿å±€çš„ç§é’¥)     CRT &#x3D; æœˆè€çš„CSR + æ•°å­—ç­¾åæ°‘æ”¿å±€ï¼šCSR &#x3D; æ°‘æ”¿å±€çš„å…¬é’¥+æ°‘æ”¿å±€çš„åŸŸå      æ•°å­—ç­¾å &#x3D; E(æ°‘æ”¿å±€çš„CSR, æ°‘æ”¿å±€è‡ªå·±çš„ç§é’¥)      CRT &#x3D; æ°‘æ”¿å±€çš„CSR + æ•°å­—ç­¾å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-åŒæ–¹è®¤è¯"><a href="#7-åŒæ–¹è®¤è¯" class="headerlink" title="7). åŒæ–¹è®¤è¯"></a>7). åŒæ–¹è®¤è¯</h3><p>&emsp;&emsp;ä¸Šè¿°ä¾‹å­è§£é‡Šäº†é€šä¿¡çš„ä¸€æ–¹å¦‚ä½•éªŒè¯å¦ä¸€æ–¹çš„èº«ä»½ã€‚æ¯”å¦‚è½¦è½½åè®®DoIP-2019å³æ˜¯è¦æ±‚serveréªŒè¯clientå³å¯ï¼Œä»¥æé«˜é€šä¿¡æ•ˆç‡ã€‚è¿™ç§æƒ…å†µçš„è¿˜æœ‰ä¸€ä¸ªå¸¸è§åº”ç”¨æ˜¯ï¼š æˆ‘ä»¬é€šè¿‡æµè§ˆå™¨è®¿é—®é“¶è¡Œçš„ç½‘é¡µã€‚è¿™é‡Œçš„å…³é”®æ˜¯ï¼Œæˆ‘ä»¬è¦èƒ½éªŒè¯é“¶è¡Œçš„èº«ä»½è¯ï¼Œ ç„¶åæ‰æ•¢äºåœ¨ç½‘é¡µé‡Œè¾“å…¥è´¦å·å’Œå¯†ç ã€‚æµè§ˆå™¨éªŒè¯é“¶è¡Œçš„èº«ä»½è¯çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>åœ¨æµè§ˆå™¨å’Œé“¶è¡Œçš„HTTPSæœåŠ¡å»ºç«‹å®‰å…¨è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œé“¶è¡Œçš„HTTPSæœåŠ¡ä¼šæŠŠ å®ƒçš„èº«ä»½è¯å‘ç»™æµè§ˆå™¨showcertsï¼›</li><li>æµè§ˆå™¨ä½¿ç”¨å†…ç½®çš„CAçš„èº«ä»½è¯æ¥éªŒè¯é“¶è¡Œçš„èº«ä»½è¯ã€‚</li></ol><p>æµè§ˆå™¨éªŒè¯äº†é“¶è¡Œçš„HTTPSæœåŠ¡çš„èº«ä»½ä¹‹åï¼Œå°±è½®åˆ°é“¶è¡ŒéªŒè¯æµè§ˆå™¨çš„ç”¨æˆ·çš„èº«ä»½äº†ï¼š</p><ol><li>æµè§ˆå™¨å±•ç¤ºé“¶è¡ŒHTTPSæœåŠ¡å‘æ¥çš„ç™»é™†é¡µé¢ï¼›</li><li>ç”¨æˆ·åœ¨è¿™ä¸ªé¡µé¢é‡Œè¾“å…¥è´¦å·å’Œå¯†ç ï¼Œé“¶è¡Œçš„HTTPSæœåŠ¡ç”±æ­¤éªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚<br>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé“¶è¡ŒHTTPSæœåŠ¡å™¨çš„èº«ä»½æ˜¯é€šè¿‡TLSèº«ä»½è¯æ¥éªŒè¯çš„ã€‚è€Œæˆ‘ä»¬ï¼ˆç”¨æˆ·ï¼‰çš„èº«ä»½æ˜¯é€šè¿‡æˆ‘ä»¬è¾“å…¥çš„è´¦å·å’Œå¯†ç æ¥éªŒè¯çš„ã€‚</li></ol><p>&emsp;&emsp;æœ‰æ—¶é€šä¿¡çš„åŒæ–¹éƒ½æ˜¯ç¨‹åºï¼ˆè€Œä¸æ˜¯äººï¼‰ã€‚æ­¤æ—¶ï¼Œè®©ä¸€æ–¹è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œä¸å¦‚è®© åŒæ–¹éƒ½é€šè¿‡TLSèº«ä»½è¯æ¥äº’ç›¸éªŒè¯æ–¹ä¾¿ã€‚å°¤å…¶æ˜¯åœ¨å¾ˆå¤šåˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œæœ‰å¤šç§ç±»å‹çš„ç¨‹åºäº’ç›¸é€šä¿¡ï¼Œè€Œä¸åªæ˜¯ä¸¤æ–¹é€šä¿¡ã€‚<br>&emsp;&emsp;æ¯”å¦‚åœ¨Kubernetesæœºç¾¤é‡Œï¼Œä¸å…‰æ“ä½œæœºç¾¤çš„å®¢æˆ·ç«¯ç¨‹åºkubectlè¦èƒ½éªŒè¯ Kubernetes master nodeï¼ˆå…·ä½“çš„è¯´æ˜¯apiserverçš„èº«ä»½ï¼Œæ‰èƒ½æ”¾å¿ƒåœ°æŠŠåŒ…æ‹¬ æ•æ„Ÿä¿¡æ¯ï¼ˆæ¯”å¦‚æ•°æ®åº“å¯†ç ï¼‰çš„è®¡ç®—ä½œä¸šæäº¤ç»™apiserverã€‚ç±»ä¼¼çš„ï¼Œapiserverä¹Ÿè¦èƒ½éªŒè¯kubectlçš„èº«ä»½ï¼Œä»¥ç¡®è®¤æäº¤ä½œä¸šçš„æ˜¯å…¬å¸çš„åˆæ³•é›‡å‘˜ï¼Œè€Œä¸æ˜¯å¤–è´¼signã€‚<br>&emsp;&emsp;ä¸ºæ­¤ï¼Œé€šä¿¡å„æ–¹éƒ½éœ€è¦æœ‰å„è‡ªçš„èº«ä»½è¯ã€‚ä¸€ä¸ªå…¬å¸å¯ä»¥è‡ªç­¾åä¸€ä¸ªCAèº«ä»½è¯ï¼Œå¹¶ä¸”ç”¨å®ƒæ¥ç»™æ¯ä¸ªé›‡å‘˜ä»¥åŠæ¯ä¸ªç¨‹åºç­¾ç½²èº«ä»½è¯ã€‚è¿™æ ·ï¼Œåªè¦æ¯å°ç”µè„‘ä¸Šéƒ½é¢„å…ˆå®‰è£…å¥½å…¬å¸è‡ªå·±çš„CAèº«ä»½è¯ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªèº«ä»½è¯éªŒè¯æ¯ä¸ªé›‡å‘˜å’Œç¨‹åºçš„èº«ä»½äº†ã€‚è¿™æ˜¯ç›®å‰å¾ˆå¤šå…¬å¸çš„å¸¸ç”¨åšæ³•ã€‚</p><h2 id="3-tlsåè®®å®ç°"><a href="#3-tlsåè®®å®ç°" class="headerlink" title="3. tlsåè®®å®ç°"></a>3. tlsåè®®å®ç°</h2><p>&emsp;&emsp;ç”±äºtlsåœ¨å®‰å…¨æ–¹é¢çš„é‡è¦ä½œç”¨ï¼Œåº”ç”¨ç‰¹åˆ«å¹¿æ³›ï¼Œç›¸å¯¹æ¥è¯´å°±ä¼šæœ‰ä¸å°‘å¼€æºå®ç°ï¼Œæ¯”è¾ƒçŸ¥åå°±æœ‰opensslå’Œmbed-tlsï¼Œåˆ†åˆ«åº”ç”¨åœ¨é€šç”¨æ“ä½œç³»ç»Ÿå’ŒåŸºäºmcuçš„åµŒå…¥å¼ç³»ç»Ÿäº†ã€‚è¿™é‡Œè¦ä»‹ç»çš„å³æ˜¯åœ¨é€šç”¨æ“ä½œç³»ç»Ÿï¼ˆlinuxï¼‰ï¼Œå¯¹opensslçš„åº”ç”¨äº†ã€‚</p><h1 id="ä¸‰ã€å…³äºopenssl"><a href="#ä¸‰ã€å…³äºopenssl" class="headerlink" title="ä¸‰ã€å…³äºopenssl"></a>ä¸‰ã€å…³äºopenssl</h1><p>&emsp;&emsp;ä¸Šé¢ä»‹ç»äº†tlsçš„åŸºæœ¬åŸç†ï¼Œå¯¹æˆ‘ä»¬ç¨‹åºå‘˜æ¥è¯´æœ€é‡è¦çš„å°±æ˜¯codingäº†ï¼Œé‚£æˆ‘ä»¬å°±çœ‹çœ‹å¦‚ä½•åœ¨linuxä¸Šä½¿ç”¨opensslæ¥å®ç°åŸºäºtcpipçš„å®‰å…¨é€šä¿¡ã€‚</p><h2 id="1-opensslå®‰è£…å’Œä½¿ç”¨"><a href="#1-opensslå®‰è£…å’Œä½¿ç”¨" class="headerlink" title="1. opensslå®‰è£…å’Œä½¿ç”¨"></a>1. opensslå®‰è£…å’Œä½¿ç”¨</h2><p>&emsp;&emsp;åœ¨å®‰è£…æ˜¯å’Œä½¿ç”¨ä¹‹å‰ï¼Œå…ˆç®€å•çš„ä»‹ç»ä¸€ä¸‹opensslï¼Œopensslæ˜¯ä¸€ä¸ªå®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨å¯†é’¥ã€è¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠå®ç°sslåè®®ã€‚opensslæ•´ä¸ªè½¯ä»¶åŒ…å¤§æ¦‚å¯ä»¥åˆ†æˆä¸‰ä¸ªä¸»è¦çš„åŠŸèƒ½éƒ¨åˆ†ï¼šSSLåè®®åº“libsslã€åº”ç”¨ç¨‹åºå‘½ä»¤å·¥å…·ä»¥åŠå¯†ç ç®—æ³•åº“libcryptoã€‚<br>&emsp;&emsp;å®‰è£…ä¹‹å‰ï¼Œç›´æ¥å…ˆ<code>openssl version -a</code>çœ‹ä¸‹æ˜¯å¦æœ‰å®‰è£…opensslï¼Œæˆ‘æ—¥å¸¸ä½¿ç”¨çš„æ˜¯ubuntu16å’Œubuntu18ï¼Œå¦‚ä¸‹å›¾æ˜¯å·²ç»å®‰è£…å¥½çš„ã€‚<img src="/medias/tls-socket/openssl_v.png" alt="openssl-version">å¦‚æœæ²¡æœ‰ï¼Œå»ºè®®ç›´æ¥å»<a href="https://www.openssl.org/source/">opensslçš„å®˜ç½‘</a>æˆ–è€…<a href="https://github.com/openssl/openssl">openssl gitä»“åº“</a>ä¸‹è½½å®‰è£…ï¼Œæœ¬æ¥è¿˜æƒ³å†™ä¸‹è¦å¦‚ä½•ä¸‹è½½ã€ç¼–è¯‘å®‰è£…ï¼Œåé¢è§‰å¾—å®åœ¨å¤šæ¬¡ä¸€ä¸¾äº†ã€‚ä¸ªäººå»ºè®®è¿˜æ˜¯ç›´æ¥åœ¨å®˜ç½‘æˆ–è€…gitä»“åº“æŸ¥çœ‹æ•™ç¨‹äº†ï¼Œgitä»“åº“ä¸Šç›´æ¥æœ‰å„ä¸ªå¹³å°çš„å®‰è£…æ•™ç¨‹]äº†ã€‚<img src="/medias/tls-socket/install_course.png" alt="å„ä¸ªå¹³å°çš„å®‰è£…æ•™ç¨‹"></p><p><em>æ³¨ï¼šubuntuç›´æ¥<code>sudo apt-get install openssl</code>å’Œ<code>sudo apt-get insall libssl-dev</code>å³å¯</em>ï¼Œå…¶ä»–å¹³å°ä¼°è®¡ä¹Ÿæœ‰ç›´æ¥å®‰è£…çš„ã€‚</p><p>&emsp;&emsp;å…³äºopensslåœ¨linuxçš„ä¸€äº›å‘½ä»¤å¹¶ä¸æ‰“ç®—è‡ªå·±å»å†™ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡<a href="https://segmentfault.com/a/1190000014963014">opensslçš„ä»‹ç»å’Œä½¿ç”¨</a>,åé¢ä¼šé™åˆ°å¦‚ä½•åœ¨linuxä¸Šä¼šä½¿ç”¨opensslæ¥ç”Ÿæˆç§˜é’¥å’Œè¯ä¹¦ï¼Œä»¥åŠè¯ä¹¦ç®¡ç†å·¥å…·ã€‚æ–‡ç« <a href="https://segmentfault.com/a/1190000014963014">opensslçš„ä»‹ç»å’Œä½¿ç”¨</a>ä»‹ç»å‘½ä»¤å¹¶ä¸æ˜¯ç‰¹åˆ«å…¨ï¼Œä½†æ˜¯ç»™å‡ºäº†ä¸€ä¸ªå‘½ä»¤å…·ä½“çš„å«ä¹‰ï¼Œå¾ˆå¤šæ•™ç¨‹ä¸Šæ¥å°±ç›´æ¥ç”Ÿæˆç§˜é’¥è¯ä¹¦ï¼Œåƒæˆ‘è¿™ç§ä¹‹å‰ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡è¿™å—ä¸œè¥¿çš„äººï¼Œè¿˜æ˜¯æŒºæ‡µé€¼çš„ï¼Œä½†æ˜¯çœ‹åˆ°äº†è¿™è¿™ç¯‡æ–‡ç« åï¼Œå¯¹ç€å…¶ä»–æ•™ç¨‹ï¼Œè·Œè·Œæ’æ’è¿˜æ˜¯è·‘é€šäº†ä¸€ä¸ªdemoã€‚ä¸Šé¢è™½ç„¶å†™çš„ä¸å…¨ï¼Œä½†æ˜¯ä¹Ÿå†™äº†å¯ä»¥é€šè¿‡<code>-help</code>æ¥è·å–æ›´è¯¦ç»†çš„å‘½ä»¤å‚æ•°å«ä¹‰ï¼Œæ¯”å¦‚openssl genrsa -helpå°±ä¼šå°†æ‰€æœ‰çš„å‚æ•°æ˜¾ç¤ºå‡ºæ¥ã€‚<img src="/medias/tls-socket/openssl_genrsa_help.png" alt="openssl genrsa -help">ã€‚åé¢å†æœåˆ°ä¸åŒçš„æ•™ç¨‹ï¼Œ<code>-help</code>ä¸€ä¸‹ï¼Œä»æ­¤ä¸å†è¿·èŒ«ã€‚</p><p>&emsp;&emsp;å¯¹äºopensslæ¥å£çš„ä¸€äº›æ–‡ç« ï¼Œæˆ‘ä¸»è¦å‚è€ƒäº†è¿™ç¯‡<a href="https://www.cnblogs.com/Yogile/p/12917402.html">åŸºäºOpenSSLçš„ç®€å•C/Sé€šä¿¡Cç¨‹åºè®¾è®¡ä½¿ç”¨å‡½æ•°æ–‡æ¡£</a>å’Œ<a href="https://www.openssl.org/docs/man1.0.2/man3/">å®˜æ–¹è‹±æ–‡æ–‡æ¡£</a>ï¼Œå½“ç„¶æœ‰æ—¶å€™å«Œçƒ¦ï¼Œå°±ç›´æ¥baidu/googleå¯¹åº”å‡½æ•°äº†ã€‚</p><h2 id="2-opensslå®æ“"><a href="#2-opensslå®æ“" class="headerlink" title="2. opensslå®æ“"></a>2. opensslå®æ“</h2><p>&emsp;&emsp;ä¸Šä¸€å°èŠ‚ï¼Œé™¤äº†å®‰è£…ã€ç¼–è¯‘é€‚åˆåœ¨å®æ“ä¹‹å‰æ“ä½œï¼Œå…¶ä»–éƒ¨åˆ†æ›´å¤šæ˜¯åœ¨å®æ“è¿‡ç¨‹ä¸­å»æœç´¢çš„ã€‚å½“ç„¶ç”±äºæˆ‘å·²ç»æœ‰è¿‡ç›¸å…³çš„å®æ“ç»éªŒäº†ï¼Œå¯¹äºæƒ³ä½¿ç”¨opensslæ¥å®Œæˆå®‰å…¨é€šä¿¡çš„å°ä¼™ä¼´ï¼Œè®°ä½ä¸Šè¿°ç›¸å…³ä»‹ç»å’Œé“¾æ¥ï¼Œå†ç»“åˆåé¢çš„ç¤ºä¾‹ï¼Œåº”è¯¥èƒ½å¤Ÿè¾¾åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚åœ¨tlsæ¡æ‰‹è¿‡ç¨‹ä¹‹å‰ï¼Œéœ€è¦tcpä¸‰æ¬¡æ¡æ‰‹åå»ºç«‹tcpè¿æ¥ï¼Œè€Œåæ‰å¼€å§‹tls1çš„æ¡æ‰‹ã€‚tlsçš„æ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›¾éšä¾¿æ‰¾çš„ï¼Œä¾µåˆ ï¼š<img src="/medias/tls-socket/tls_handshake.png" alt="tls handshake"><br>è™šçº¿éƒ¨åˆ†ä¸ºå¯é€‰çš„ï¼Œå¯é€‰çš„åŸå› æ˜¯å› ä¸ºï¼Œä¸€èˆ¬éƒ½æ˜¯serveréªŒè¯clientçš„å•å‘éªŒè¯ï¼Œæ¯”å¦‚å‰é¢çš„æåˆ°çš„DoIP-2019ï¼›ä½†æ˜¯å¦‚æœéœ€è¦åŒå‘è®¤è¯ï¼Œå³æ˜¯clientéªŒè¯serverï¼Œå‰é¢ä¹Ÿæœ‰æåˆ°åº”ç”¨åœºæ™¯ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>æ­¥éª¤ 1. ClientHello â€“ å®¢æˆ·ç«¯å‘é€æ‰€æ”¯æŒçš„ SSL/TLS æœ€é«˜åè®®ç‰ˆæœ¬å·å’Œæ‰€æ”¯æŒçš„åŠ å¯†ç®—æ³•é›†åˆåŠå‹ç¼©æ–¹æ³•é›†åˆç­‰ä¿¡æ¯ç»™æœåŠ¡å™¨ç«¯ã€‚</p></li><li><p>æ­¥éª¤ 2. ServerHello â€“ æœåŠ¡å™¨ç«¯æ”¶åˆ°å®¢æˆ·ç«¯ä¿¡æ¯åï¼Œé€‰å®šåŒæ–¹éƒ½èƒ½å¤Ÿæ”¯æŒçš„ SSL/TLS åè®®ç‰ˆæœ¬å’ŒåŠ å¯†æ–¹æ³•åŠå‹ç¼©æ–¹æ³•ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p></li><li><p>ï¼ˆå¯é€‰ï¼‰æ­¥éª¤ 3. SendCertificate â€“ æœåŠ¡å™¨ç«¯å‘é€æœåŠ¡ç«¯è¯ä¹¦ç»™å®¢æˆ·ç«¯ã€‚</p></li><li><p>ï¼ˆå¯é€‰ï¼‰æ­¥éª¤ 4. RequestCertificate â€“ å¦‚æœé€‰æ‹©åŒå‘éªŒè¯ï¼ŒæœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¯·æ±‚å®¢æˆ·ç«¯è¯ä¹¦ã€‚</p></li><li><p>æ­¥éª¤ 5. ServerHelloDone â€“ æœåŠ¡å™¨ç«¯é€šçŸ¥å®¢æˆ·ç«¯åˆå§‹åå•†ç»“æŸã€‚</p></li><li><p>ï¼ˆå¯é€‰ï¼‰æ­¥éª¤ 6. ResponseCertificate â€“ å¦‚æœé€‰æ‹©åŒå‘éªŒè¯ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€å®¢æˆ·ç«¯è¯ä¹¦ã€‚</p></li><li><p>æ­¥éª¤ 7. ClientKeyExchange â€“ å®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡å™¨ç«¯çš„å…¬é’¥ï¼Œå¯¹å®¢æˆ·ç«¯å…¬é’¥å’Œå¯†é’¥ç§å­è¿›è¡ŒåŠ å¯†ï¼Œå†å‘é€ç»™æœåŠ¡å™¨ç«¯ã€‚</p></li><li><p>ï¼ˆå¯é€‰ï¼‰æ­¥éª¤ 8. CertificateVerify â€“ å¦‚æœé€‰æ‹©åŒå‘éªŒè¯ï¼Œå®¢æˆ·ç«¯ç”¨æœ¬åœ°ç§é’¥ç”Ÿæˆæ•°å­—ç­¾åï¼Œå¹¶å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼Œè®©å…¶é€šè¿‡æ”¶åˆ°çš„å®¢æˆ·ç«¯å…¬é’¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p></li><li><p>æ­¥éª¤ 9. CreateSecretKey â€“ é€šè®¯åŒæ–¹åŸºäºå¯†é’¥ç§å­ç­‰ä¿¡æ¯ç”Ÿæˆé€šè®¯å¯†é’¥ã€‚</p></li><li><p>æ­¥éª¤ 10. ChangeCipherSpec â€“ å®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨ç«¯å·²å°†é€šè®¯æ–¹å¼åˆ‡æ¢åˆ°åŠ å¯†æ¨¡å¼ã€‚</p></li><li><p>æ­¥éª¤ 11. Finished â€“ å®¢æˆ·ç«¯åšå¥½åŠ å¯†é€šè®¯çš„å‡†å¤‡ã€‚</p></li><li><p>æ­¥éª¤ 12. ChangeCipherSpec â€“ æœåŠ¡å™¨ç«¯é€šçŸ¥å®¢æˆ·ç«¯å·²å°†é€šè®¯æ–¹å¼åˆ‡æ¢åˆ°åŠ å¯†æ¨¡å¼ã€‚</p></li><li><p>æ­¥éª¤ 13. Finished â€“ æœåŠ¡å™¨åšå¥½åŠ å¯†é€šè®¯çš„å‡†å¤‡ã€‚</p></li><li><p>æ­¥éª¤ 14. Encrypted/DecryptedData â€“ åŒæ–¹ä½¿ç”¨å®¢æˆ·ç«¯å¯†é’¥ï¼Œé€šè¿‡å¯¹ç§°åŠ å¯†ç®—æ³•å¯¹é€šè®¯å†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œè¿›è¡Œæ•°æ®é€šä¿¡ã€‚</p></li><li><p>æ­¥éª¤ 15. ClosedConnection â€“ é€šè®¯ç»“æŸåï¼Œä»»ä½•ä¸€æ–¹å‘å‡ºæ–­å¼€ SSL è¿æ¥çš„æ¶ˆæ¯ã€‚</p></li></ul><p>SSLæ¡æ‰‹ä¸»è¦å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š</p><ol><li> åå•†ä½¿ç”¨çš„åŠ å¯†å¥—ä»¶ã€‚åŠ å¯†å¥—ä»¶ä¸­åŒ…æ‹¬ä¸€ç»„åŠ å¯†å‚æ•°ï¼Œè¿™äº›å‚æ•°æŒ‡å®šäº†åŠ å¯†ç®—æ³•å’Œå¯†é’¥çš„é•¿åº¦ç­‰ä¿¡æ¯ã€‚</li><li>éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œæ­¤æ“ä½œæ˜¯å¯é€‰çš„ã€‚</li><li>ç¡®å®šä½¿ç”¨çš„åŠ å¯†ç®—æ³•ã€‚</li><li>SSLæ¡æ‰‹è¿‡ç¨‹é‡‡ç”¨éå¯¹ç§°åŠ å¯†æ–¹æ³•ä¼ é€’æ•°æ®ï¼Œç”±æ­¤æ¥å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„SSLä¼šè¯ã€‚SSLæ¡æ‰‹å®Œæˆåï¼Œé€šä¿¡åŒæ–¹å°†é‡‡ç”¨å¯¹ç§°åŠ å¯†æ–¹æ³•ä¼ é€’å®é™…çš„åº”ç”¨æ•°æ®ã€‚</li></ol><p>æœ€ç®€å•ã€åº”ç”¨å¹¿æ³›çš„åº”ç”¨åœºæ™¯å³æ˜¯serveréªŒè¯clientäº†.</p><h3 id="1-ç§˜é’¥ã€è¯ä¹¦ç­‰ç”Ÿæˆ"><a href="#1-ç§˜é’¥ã€è¯ä¹¦ç­‰ç”Ÿæˆ" class="headerlink" title="1). ç§˜é’¥ã€è¯ä¹¦ç­‰ç”Ÿæˆ"></a>1). ç§˜é’¥ã€è¯ä¹¦ç­‰ç”Ÿæˆ</h3><p><strong>æš‚æ—¶æ²¡æœ‰æ—¶é—´å±•å¼€ç»†è®²ï¼Œå¯ä»¥å‚è€ƒ<a href="https://github.com/jinbaotang/tls_test">æˆ‘çš„gitä»“åº“â€“tls_test</a></strong>,è¿™å—ä¸œè¥¿æ¶‰åŠçš„è¿˜æ˜¯è›®å¤šï¼Œæ„Ÿè§‰å¯ä»¥å¦å¼€ä¸€ä¸ªè¯é¢˜äº†ï¼Œå¦‚æœä¸åœ¨è¿™ç¯‡æ–‡ç« ç»§ç»­ï¼Œå°±å¯ä»¥å‚è€ƒé“¾æ¥<a href="https://jinbaotang.cn/2021/06/06/tls-socket2/">åŸºäºopensslå®ç°tls+socketçš„å®‰å…¨é€šä¿¡-2</a>,</p>]]></content>
      
      
      <categories>
          
          <category> åè®®æ ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tls </tag>
            
            <tag> socket </tag>
            
            <tag> openssl </tag>
            
            <tag> ethernet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LwIPä½¿ç”¨selectï¼Œclose socketèµ„æºé‡Šæ”¾ä¸å®Œå…¨é—®é¢˜</title>
      <link href="2021/04/12/lwip-close-socket-select/"/>
      <url>2021/04/12/lwip-close-socket-select/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™ç¯‡æ–‡ç« æœ¬åº”è¯¥åœ¨4æœˆå°±å†™å¥½çš„ï¼Œä½†æ˜¯åšå®¢è¯„è®ºç³»ç»Ÿä¸€ç›´æ²¡æœ‰æ­å»ºå¥½ï¼Œèµ°äº†å¾ˆå¤šå¼¯è·¯ï¼Œç°åœ¨å¥½äº†ï¼Œdelayè¿™ä¹ˆä¹…ï¼Œç»ˆäºè¦è¦è¡¥è¿‡æ¥äº†ã€‚</p></blockquote><blockquote><p>è¯¥æ–‡ç« å®Œå…¨åŸåˆ›ï¼Œé™¤é€šç”¨ã€å¹¿æ³›çš„çŸ¥è¯†ç‚¹å¤–ï¼Œå‡ä¸ºä¸ªäººæ€»ç»“ï¼Œå¦‚éœ€è½¬è½½è¿˜æœ›å¤‡æ³¨å‡ºå¤„ï¼ŒåŒæ—¶å¦‚æœ‰é”™è¯¯è¿˜è¯·æŒ‡å‡ºï¼Œè™šå¿ƒæ¥å—ã€‚</p></blockquote><h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><h2 id="1-é¢˜å¤–è¯"><a href="#1-é¢˜å¤–è¯" class="headerlink" title="1. é¢˜å¤–è¯"></a>1. é¢˜å¤–è¯</h2><p>&emsp;&emsp;ä»¥è¿™ç¯‡æ–‡ç« ä¸ºç¬¬ä¸€ç¯‡æŠ€æœ¯æ–‡ç« ï¼Œä¸€æ˜¯èŒç”Ÿå†™åšå®¢çš„å¥‘æœºæ˜¯æ¢å·¥ä½œï¼Œå¦å¤–å°±æ˜¯è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘åœ¨æ€¿æ˜Ÿè§£å†³çš„æœ€åä¸€ä¸ªbugã€‚</p><p><img src="/medias/lwip-close-socket-select/jinbao-ept.jpg"></p><p>&emsp;&emsp;é—®é¢˜æ¥æºæ˜¯ï¼Œè·‘åœ¨åŸºäºLwIP+FreeRTOSç¯å¢ƒçš„DoIPï¼Œåœ¨åå¤åˆå§‹åŒ–/ååˆå§‹åŒ–æ—¶å‡ æ¬¡ä¹‹åå°±ä¼šå¤±è´¥äº†ã€‚å¹´åˆç”±äºä»»åŠ¡ç´§å¼ ï¼Œæ£€æŸ¥äº†ä¸‹åˆå§‹åŒ–å’Œååˆå§‹åŒ–å‡½æ•°çš„æµç¨‹ï¼Œæ”¹æ‰äº†å‡ å¤„å¯èƒ½ä¼šå‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œé—®é¢˜ä¾æ—§ã€‚ä½†æ˜¯åŒæ ·çš„ä¸Šå±‚å¤„ç†ä»£ç ï¼Œåœ¨windowså’Œlinuxç¯å¢ƒä¸‹æ˜¯æ²¡é—®é¢˜çš„ï¼ŒåŸºæœ¬æ€€ç–‘æ˜¯LwIPæŸå¤„ä¸å®Œå–„å¼•èµ·ã€‚ä¸€ç›´æ‹–åˆ°è¦ç¦»èŒï¼Œç»ˆäºåœ¨ç¦»å¼€çš„æœ€åä¸€å¤©è§£å†³äº†ï¼Œä¹Ÿç®—æ˜¯ç»™åœ¨æ€¿æ˜Ÿçš„DoIPåè®®æ ˆç”»ä¸Šä¸€ä¸ªå±äºè‡ªå·±çš„å¥å·ã€‚</p><p>&emsp;&emsp; LwIP å…¨åä¸º Light weight IPï¼Œæ„æ€æ˜¯è½»é‡åŒ–çš„ TCP/IP åè®®ï¼Œ æ˜¯ç‘å…¸è®¡ç®—æœºç§‘å­¦é™¢(SICS)çš„ Adam Dunkels å¼€å‘çš„ä¸€ä¸ªå°å‹å¼€æºçš„ TCP/IP åè®®æ ˆã€‚ LwIP çš„è®¾è®¡åˆè¡·æ˜¯ï¼šç”¨å°‘é‡çš„èµ„æºæ¶ˆè€—(RAM)å®ç°ä¸€ä¸ªè¾ƒä¸ºå®Œæ•´çš„ TCP/IP åè®®æ ˆï¼Œå…¶ä¸­â€œå®Œæ•´â€ä¸»è¦æŒ‡çš„æ˜¯ TCP åè®®çš„å®Œæ•´æ€§ï¼Œ å®ç°çš„é‡ç‚¹æ˜¯åœ¨ä¿æŒ TCP åè®®ä¸»è¦åŠŸèƒ½çš„åŸºç¡€ä¸Šå‡å°‘å¯¹ RAM çš„å ç”¨ã€‚æ­¤å¤– LwIPæ—¢å¯ä»¥ç§»æ¤åˆ°æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨æ— æ“ä½œç³»ç»Ÿçš„æƒ…å†µä¸‹ç‹¬ç«‹è¿è¡Œã€‚</p><h2 id="2-åŸå› "><a href="#2-åŸå› " class="headerlink" title="2. åŸå› "></a>2. åŸå› </h2><p>&emsp;&emsp;å¼•èµ·è¯¥é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ï¼ŒLwIP selectå‡½æ•°é‡Œå¦‚æœåˆ¤æ–­å¯¹åº”çš„socketæ²¡æœ‰äº‹ä»¶äº§ç”Ÿï¼ˆè¯»/å†™/å¼‚å¸¸ï¼‰ï¼Œè¿›è¡Œç®€å•å¤„ç†ååˆ™æ”¹çº¿ç¨‹ä¼‘çœ ï¼Œè®©å‡ºcpuæ§åˆ¶æƒã€‚å¦‚æœåœ¨selectä¼‘çœ æœŸé—´ï¼Œè¿›è¡Œäº†close socketçš„æ“ä½œï¼Œä¼šé‡Šæ”¾å¯¹åº”çš„socket pcbï¼ˆ<strong>close(socket)<strong>æ˜¯æˆåŠŸçš„ï¼‰ï¼Œç„¶ååœ¨selectä¼‘çœ ç»“æŸåï¼Œåˆ¤æ–­è¯¥socketèµ„æºä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥é€€å‡ºselectå‡½æ•°ï¼Œ</strong>ä½†æ˜¯</strong>æ­¤æ—¶è¯¥socketçš„select_waitæ ‡å¿—ä½æ²¡è¢«æ¸…é™¤ã€‚LwIPåœ¨åˆ†é…socketæ—¶ï¼ˆèµ„æºéƒ½æ˜¯é™æ€åˆ†é…çš„ï¼Œç±»ä¼¼äºæœ‰ä¸€ä¸ªsocketæ•°ç»„ï¼Œè‹¥åˆ†é…åˆ™å¯¹åº”æ ‡å¿—ä½ä¸ºçœŸï¼‰ï¼Œsocketæ˜¯å¦ç©ºé—²æ˜¯ä¼šå¯¹select_waitè¯¥æ ‡å¿—ä½è¿›è¡Œåˆ¤æ–­ï¼Œæ‰€ä»¥å³ä½¿è¯¥socketæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œè°ƒç”¨*socket()*å‡½æ•°æ—¶ä¹Ÿä¼šè®¤ä¸ºè¯¥socketæ˜¯è¢«å ç”¨çš„ï¼Œæ‰€ä»¥å‡ æ¬¡ä¹‹åï¼Œsocketèµ„æºè¢«<strong>å‡è€—å°½</strong>ã€‚</p><h2 id="3-è§£å†³"><a href="#3-è§£å†³" class="headerlink" title="3. è§£å†³"></a>3. è§£å†³</h2><p>&emsp;&emsp;çŸ¥é“åŸå› åï¼Œé—®é¢˜å°±å¥½è§£å†³äº†ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªè§£å†³é—®é¢˜çš„æ€è·¯ã€‚</p><ol><li>æ›´æ”¹LwIPæºç ï¼Œå¯¹å¯¹åº”çš„æ ‡å¿—ä½è¿›è¡Œåˆ¤æ–­å’Œæ¸…é™¤ã€‚è¯¥è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœèƒ½å¤Ÿpushåˆ°LwIPä¸»åˆ†æ”¯ï¼Œåˆ™æ˜¯ä¸€åŠ³æ°¸é€¸çš„ï¼Œå¦åˆ™å¦‚æœè¦è·ŸéšLwIPå®˜æ–¹æ›´æ–°ï¼Œè‡ªå·±å¾—ç»´æŠ¤ä¸€å¥—ä»£ç ï¼Œå¹¶æŒç»­mergeã€‚</li><li>ä½¿ç”¨è€…ï¼Œåœ¨ä½¿ç”¨æ¥å£æ—¶ï¼ŒåšåŒæ­¥ã€‚å³åœ¨selectä¼‘çœ æœŸé—´ä¸å…è®¸è¿›è¡Œclose socketæ“ä½œï¼ŒåŒæ—¶åœ¨close socketä¹Ÿä¸å…è®¸è¿›å…¥selectå‡½æ•°ã€‚æ‰€ä»¥åªè¦åœ¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´åŠ ä¸Šæ¡ä»¶åˆ¤æ–­å°±å¥½ã€‚</li></ol><p>&emsp;&emsp;è€ƒè™‘åˆ°ç»´æŠ¤æˆæœ¬ï¼Œæœ€ç»ˆé€‰æ‹©æ–¹æ¡ˆ2.</p><h1 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h1><p>&emsp;&emsp;è§£å†³æ€è·¯åœ¨ä¸Šé¢å·²ç»ç»™å‡ºï¼Œä¸‹é¢ä¸»è¦æƒ³ä»æºç çº§å¯¹é—®é¢˜è¿›è¡Œåˆ†æã€‚åŸå› ä¸­ï¼Œæ¶‰åŠä¸‰ä¸ªå‡½æ•°ï¼Œ</p><ol><li><p>socketå‡½æ•°ï¼Œå³lwip_socketï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š<br><code>int lwip_socket(int domain, int type, int protocol)</code></p></li><li><p>closeå‡½æ•°ï¼Œå³lwip_closeï¼ŒåŸå‹å¦‚ä¸‹ï¼š<br><code>int lwip_close(int s)</code></p></li><li><p>selectå‡½æ•°ï¼Œ å³lwip_select(),åŸå‹å¦‚ä¸‹ï¼š<br><code>intlwip_select(int maxfdp1, fd_set *readset, fd_set *writeset, fd_set *exceptset, struct timeval *timeout)</code></p></li></ol><h2 id="1-æ‹“å±•"><a href="#1-æ‹“å±•" class="headerlink" title="1. æ‹“å±•"></a>1. æ‹“å±•</h2><p>&emsp;&emsp;LwIPæœ¬èº«æä¾›äº†ç±»ä¼¼äºbsd socketç¼–ç¨‹æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†ç®€æ˜“ç‰ˆçš„selectå‡½æ•°ã€‚</p><p>&emsp;&emsp;å…³äºsocketç¼–ç¨‹çš„æ•™ç¨‹æ˜¯å®åœ¨å¤ªå¤šäº†ï¼Œåœ¨è¿™ä¸å†é‡å¤å»æè¿°ï¼Œ<a href="https://blog.csdn.net/weixin_39634961/article/details/80236161">socketç¼–ç¨‹å‚è€ƒé“¾æ¥</a>ã€‚è¾…å¯¼è¿‡ä¸€äº›äººè¿›è¡Œsocketç¼–ç¨‹ï¼Œåˆå­¦è€…åŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œå®¹æ˜“å¿½ç•¥çš„ä¸€ç‚¹å°±æ˜¯ï¼Œä½œä¸ºserveræ—¶ï¼Œlisten-socketå’Œaccept-socketä¸æ˜¯ä¸€å›äº‹ã€‚å¯ä»¥ç†è§£ä¸ºlisten-socketçª—å£ï¼Œçª—å£åªæ˜¯è´Ÿè´£ç›‘å¬æœ‰è°è¦èµ°é€šé“ï¼Œèµ°å“ªä¸ªé€šé“ï¼Œå¹¶æŠŠçœŸæ­£çš„é€šé“â€“accept-socketç»™åˆ°ä¸Šå±‚ã€‚å¯¹äºå…¶ä»–çš„ï¼Œæ„Ÿè§‰è·‘è·‘ç¤ºä¾‹ç¨‹åºï¼Œå•æ­¥èµ°ä¸€ä¸‹ï¼Œå°±åŸºæœ¬ç†è§£äº†ã€‚</p><p>&emsp;&emsp;åœ¨ä¸ä½¿ç”¨selectæ—¶ï¼Œå¹¶æ²¡æœ‰å‘ç°socketèµ„æºé‡Šæ”¾ä¸å®Œå…¨çš„é—®é¢˜ã€‚æœ¬æ–‡ä¸å±•å¼€è®²è§£lwip selectçš„å®ç°ï¼Œä½†æ˜¯å¯¹äºselectçš„ä½¿ç”¨éœ€è¦ç¨å¾®å±•å¼€ä¸‹ï¼Œ<a href="https://www.cnblogs.com/skyfsm/p/7079458.html">selectç¼–ç¨‹å‚è€ƒé“¾æ¥</a>ã€‚å…³äºselectæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŒæ­¥I/Oå‡½æ•°ï¼Œåªä¸è¿‡æ”¹åŒæ­¥å‡½æ•°å¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ªâ€IOâ€é€šé“ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºå¤šè·¯å¤ç”¨ã€‚ç†Ÿæ‚‰äº†ä¸Šé¢çš„socketç¼–ç¨‹åï¼Œå¦‚æœéœ€è¦å®ç°å¤šä¸ªsocketåŒæ—¶é€šä¿¡çš„è¯ï¼Œå°±åº”è¯¥ç»™æ¯ä¸ªsocketå¼€ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨è´Ÿè½½ä¸æ˜¯ç‰¹åˆ«é«˜çš„æƒ…å†µä¸‹ä¼šæ˜¾å¾—æ•ˆç‡ç‰¹åˆ«ä½ï¼ŒåŒæ—¶çº¿ç¨‹å¤ªå¤šï¼Œå°±ä¸å¾—ä¸è€ƒè™‘èµ„æºç«äº‰çš„é—®é¢˜ï¼Œå¦‚æœç«æ€æ¡ä»¶å¤ªå¤šï¼Œä¹Ÿå®¹æ˜“äº§ç”Ÿé—®é¢˜ï¼ˆ<strong>å¤šçº¿ç¨‹èµ„æºç«äº‰é—®é¢˜</strong>ï¼‰ã€‚å¤šè·¯å¤ç”¨å³æ˜¯ç”¨ä¸€ä¸ªçº¿ç¨‹ç›‘å¬å¤šä¸ªé€šé“ï¼ˆæè¿°ç¬¦ï¼‰ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆå¯è¯»ã€å¯å†™æˆ–è€…å¼‚å¸¸ï¼‰ï¼Œå°±é€šçŸ¥ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯»å†™æ“ä½œã€‚ä¸Šåº™çš„æè¿°ï¼Œçœ‹èµ·æ¥selectæ˜¯å¼‚æ­¥çš„ï¼Œå…¶å®ä¸ç„¶ï¼Œå› ä¸ºäº§ç”Ÿè¯»å†™äº‹ä»¶åï¼Œåº”ç”¨ç¨‹åºå¿…é¡»è‡ªå·±è´Ÿè´£è¯»å†™æ“ä½œï¼Œè¯»å†™æ“ä½œæœ¬èº«æ˜¯é˜»å¡çš„ï¼Œè€Œå¼‚æ­¥I/Oæ˜¯ä¸éœ€è¦è‡ªå·±è¯»å†™ï¼›åŒæ—¶å³ä½¿æ²¡æœ‰è¯»å†™äº‹ä»¶äº§ç”Ÿï¼Œselectå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯é˜»å¡çš„ï¼ŒåŠ äº†è¶…æ—¶ä¹Ÿæ˜¯é˜»å¡çš„ï¼Œåªä¸è¿‡ç»™é˜»å¡å¢åŠ äº†ä¸€ä¸ªæ—¶é—´é™åˆ¶ã€‚</p><p>&emsp;&emsp;selectæœ€æ—©äº1983å¹´å‡ºç°åœ¨4.2BSDä¸­ï¼Œå®ƒé€šè¿‡ä¸€ä¸ªselect()ç³»ç»Ÿè°ƒç”¨æ¥ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„ï¼Œå½“select()è¿”å›åï¼Œè¯¥æ•°ç»„ä¸­å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ä¾¿ä¼šè¢«å†…æ ¸ä¿®æ”¹æ ‡å¿—ä½ï¼Œä½¿å¾—è¿›ç¨‹å¯ä»¥è·å¾—è¿™äº›æ–‡ä»¶æè¿°ç¬¦ä»è€Œè¿›è¡Œåç»­çš„è¯»å†™æ“ä½œã€‚ä»<a href="https://www.cnblogs.com/skyfsm/p/7079458.html">selectç¼–ç¨‹å‚è€ƒé“¾æ¥</a>ä¸­å¯ä»¥çœ‹å‡ºæœ€ç»ˆæ¯ä¸ªsocketéƒ½å¯¹åº”åˆ°æ¯ä¸ªbitä¸Šï¼Œå¦‚æœå¯¹åº”çš„socketæœ‰äº‹ä»¶äº§ç”Ÿï¼Œåˆ™ä¼šè¢«ç½®ä½ã€‚</p><h2 id="2-å‡½æ•°åˆ†æ"><a href="#2-å‡½æ•°åˆ†æ" class="headerlink" title="2. å‡½æ•°åˆ†æ"></a>2. å‡½æ•°åˆ†æ</h2><p>&emsp;&emsp;è¯¥èŠ‚åˆ†æå‡½æ•°socketï¼Œcloseï¼Œselectå®ç°ç»†èŠ‚ã€‚<strong>LwIPç‰ˆæœ¬2.1.4</strong>ã€‚</p><h3 id="2-1-socketå‡½æ•°"><a href="#2-1-socketå‡½æ•°" class="headerlink" title="2.1 socketå‡½æ•°"></a>2.1 socketå‡½æ•°</h3><p>&emsp;&emsp;lwipä¸­<code>#define socket lwip_socket</code>.</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">lwip_socket</span><span class="token punctuation">(</span><span class="token keyword">int</span> domain<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">,</span> <span class="token keyword">int</span> protocol<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">struct</span> <span class="token class-name">netconn</span> <span class="token operator">*</span>conn<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token function">LWIP_UNUSED_ARG</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/* @todo: check this */</span>    <span class="token comment">/* create a netconn */</span>    <span class="token comment">/* ä¸‹é¢ä¸»è¦æ˜¯é’ˆå¯¹ä¸åŒçš„socketç±»å‹ï¼Œåˆ†é…ç©ºé—´ï¼Œå¯¹ç›¸åº”çš„æˆå‘˜è¿›è¡Œèµ‹å€¼ï¼Œç©ºé—´èµ„æºä¸ºé¢„åˆ†é…ç»™lwipçš„å †ç©ºé—´     */</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> SOCK_RAW<span class="token operator">:</span>        conn <span class="token operator">=</span> <span class="token function">netconn_new_with_proto_and_callback</span><span class="token punctuation">(</span>            <span class="token function">DOMAIN_TO_NETCONN_TYPE</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> NETCONN_RAW<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">u8_t</span><span class="token punctuation">)</span>protocol<span class="token punctuation">,</span>            event_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span>                    <span class="token punctuation">(</span><span class="token string">"lwip_socket(%s, SOCK_RAW, %d) = "</span><span class="token punctuation">,</span>                     domain <span class="token operator">==</span> PF_INET <span class="token operator">?</span> <span class="token string">"PF_INET"</span> <span class="token operator">:</span> <span class="token string">"UNKNOWN"</span><span class="token punctuation">,</span> protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> SOCK_DGRAM<span class="token operator">:</span>        conn <span class="token operator">=</span> <span class="token function">netconn_new_with_callback</span><span class="token punctuation">(</span>            <span class="token function">DOMAIN_TO_NETCONN_TYPE</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>protocol <span class="token operator">==</span> IPPROTO_UDPLITE<span class="token punctuation">)</span>                                                <span class="token operator">?</span> NETCONN_UDPLITE                                                <span class="token operator">:</span> NETCONN_UDP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            event_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span>                    <span class="token punctuation">(</span><span class="token string">"lwip_socket(%s, SOCK_DGRAM, %d) = "</span><span class="token punctuation">,</span>                     domain <span class="token operator">==</span> PF_INET <span class="token operator">?</span> <span class="token string">"PF_INET"</span> <span class="token operator">:</span> <span class="token string">"UNKNOWN"</span><span class="token punctuation">,</span> protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> SOCK_STREAM<span class="token operator">:</span>        conn <span class="token operator">=</span> <span class="token function">netconn_new_with_callback</span><span class="token punctuation">(</span>            <span class="token function">DOMAIN_TO_NETCONN_TYPE</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> NETCONN_TCP<span class="token punctuation">)</span><span class="token punctuation">,</span> event_callback<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span>                    <span class="token punctuation">(</span><span class="token string">"lwip_socket(%s, SOCK_STREAM, %d) = "</span><span class="token punctuation">,</span>                     domain <span class="token operator">==</span> PF_INET <span class="token operator">?</span> <span class="token string">"PF_INET"</span> <span class="token operator">:</span> <span class="token string">"UNKNOWN"</span><span class="token punctuation">,</span> protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span>        <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"lwip_socket(%d, %d/UNKNOWN, %d) = -1\n"</span><span class="token punctuation">,</span>                                    domain<span class="token punctuation">,</span> type<span class="token punctuation">,</span> protocol<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">set_errno</span><span class="token punctuation">(</span>EINVAL<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>conn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span>                    <span class="token punctuation">(</span><span class="token string">"-1 / ENOBUFS (could not create netconn)\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">set_errno</span><span class="token punctuation">(</span>ENOBUFS<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/*     *ä¸Šé¢å·²ç»åˆ†é…å¥½äº†ï¼Œå¯¹åº”çš„connectionç©ºé—´ï¼Œæœ€ç»ˆè¦å¯¹åº”çš„socketä¸Šï¼Œå³socketæ•°ç»„ï¼Œè§ä¸‹é¢alloc_socketå®ç°ã€‚     */</span>    i <span class="token operator">=</span> <span class="token function">alloc_socket</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">netconn_delete</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">set_errno</span><span class="token punctuation">(</span>ENFILE<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    conn<span class="token operator">-></span>socket <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">set_errno</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">alloc_socket</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">netconn</span> <span class="token operator">*</span>newconn<span class="token punctuation">,</span> <span class="token keyword">int</span> accepted<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token function">SYS_ARCH_DECL_PROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* allocate a new socket identifier */</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> NUM_SOCKETS<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/* Protect socket array */</span>    <span class="token function">SYS_ARCH_PROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>conn <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>select_waiting <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>conn       <span class="token operator">=</span> newconn<span class="token punctuation">;</span>      <span class="token comment">/* The socket is not yet known to anyone, so no need to protect         after having marked it as used. */</span>      <span class="token function">SYS_ARCH_UNPROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>lastdata   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>lastoffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>rcvevent   <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">/* TCP sendbuf is empty, but the socket is not yet writable until connected       * (unless it has been created by accept()). */</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>sendevent  <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">NETCONNTYPE_GROUP</span><span class="token punctuation">(</span>newconn<span class="token operator">-></span>type<span class="token punctuation">)</span> <span class="token operator">==</span> NETCONN_TCP <span class="token operator">?</span> <span class="token punctuation">(</span>accepted <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>errevent   <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      sockets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>err        <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> i <span class="token operator">+</span> LWIP_SOCKET_OFFSET<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">SYS_ARCH_UNPROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;å¯ä»¥çœ‹åˆ°ï¼Œåˆ¤æ–­socketèµ„æºæ˜¯å¦æœ‰äººåœ¨ä½¿ç”¨æ—¶ï¼Œé™¤äº†åˆ¤æ–­socket-&gt;connæ˜¯å¦ä¸ºç©ºï¼Œè¿˜ä¼šåˆ¤æ–­select_waitingæ˜¯å¦ç­‰äº0ã€‚å…¶ä¸­select_waitingæ ‡è¯†è¯¥socketæ­£åœ¨è¢«å¤šå°‘ä¸ªçº¿ç¨‹åœ¨ä½¿ç”¨ã€‚å³è¦é‡Šæ”¾socketèµ„æºï¼ˆè¯´é‡Šæ”¾æœ‰ç‚¹ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œå› ä¸ºåœ¨lwipä¸­ï¼Œsocketèµ„æºæ˜¯ç¼–è¯‘å‰åˆ†é…çš„ï¼‰ï¼Œä¸¤ä¸ªé‡è¦æ¡ä»¶æ˜¯ï¼Œsocket-&gt;connå¿…é¡»ä¸ºç©ºï¼Œå¹¶ä¸”select_waitingè¦ä¸º0.</p><h3 id="2-2-closeå‡½æ•°"><a href="#2-2-closeå‡½æ•°" class="headerlink" title="2.2 closeå‡½æ•°"></a>2.2 closeå‡½æ•°</h3><p>&emsp;&emsp;æ¥ä¸‹æ¥çœ‹çœ‹closeå‡½æ•°çš„å®ç°ï¼Œçœ‹ä¸ºå•¥ä¼šå¯¼è‡´èµ„æºé‡Šæ”¾ä¸å®Œå…¨ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">lwip_close</span><span class="token punctuation">(</span><span class="token keyword">int</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">struct</span> <span class="token class-name">lwip_sock</span> <span class="token operator">*</span>sock<span class="token punctuation">;</span>  <span class="token keyword">int</span> is_tcp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token class-name">err_t</span> err<span class="token punctuation">;</span>  <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"lwip_close(%d)\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* æœ¬è´¨ä¸Šæ˜¯ï¼Œé€šè¿‡socketæ•°ç»„ä¸‹æ ‡è·å–åˆ°socketç»“æ„ä½“ */</span>  sock <span class="token operator">=</span> <span class="token function">get_socket</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sock<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>sock<span class="token operator">-></span>conn <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    is_tcp <span class="token operator">=</span> <span class="token function">NETCONNTYPE_GROUP</span><span class="token punctuation">(</span><span class="token function">netconn_type</span><span class="token punctuation">(</span>sock<span class="token operator">-></span>conn<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> NETCONN_TCP<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">LWIP_ASSERT</span><span class="token punctuation">(</span><span class="token string">"sock->lastdata == NULL"</span><span class="token punctuation">,</span> sock<span class="token operator">-></span>lastdata <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">LWIP_IGMP</span></span>  <span class="token comment">/* drop all possibly joined IGMP memberships */</span>  <span class="token function">lwip_socket_drop_registered_memberships</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* LWIP_IGMP */</span></span><span class="token comment">/* é‡Šæ”¾ä»lwipå†…å­˜å †é‡Œåˆ†é…åˆ°ç©ºé—´ */</span>  err <span class="token operator">=</span> <span class="token function">netconn_delete</span><span class="token punctuation">(</span>sock<span class="token operator">-></span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">!=</span> ERR_OK<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">sock_set_errno</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span> <span class="token function">err_to_errno</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token comment">/* ä¸»è¦æ˜¯å¯¹socketç»“æ„ä½“æˆå‘˜è¿›è¡Œååˆå§‹åŒ–ï¼Œå¹¶å¯¹æ•°æ®ç©ºé—´è¿›è¡Œé‡Šæ”¾ï¼Œçœ‹ä¸‹è¿°å¯¹è¯¥å‡½æ•°å®ç°åˆ†æ */</span>  <span class="token function">free_socket</span><span class="token punctuation">(</span>sock<span class="token punctuation">,</span> is_tcp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">set_errno</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">free_socket</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">lwip_sock</span> <span class="token operator">*</span>sock<span class="token punctuation">,</span> <span class="token keyword">int</span> is_tcp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">void</span> <span class="token operator">*</span>lastdata<span class="token punctuation">;</span>  lastdata         <span class="token operator">=</span> sock<span class="token operator">-></span>lastdata<span class="token punctuation">;</span>  sock<span class="token operator">-></span>lastdata   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  sock<span class="token operator">-></span>lastoffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  sock<span class="token operator">-></span>err        <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">/* Protect socket array */</span>  <span class="token comment">/* å¯¹socket->connè¿›è¡Œç½®ç©º */</span>  <span class="token function">SYS_ARCH_SET</span><span class="token punctuation">(</span>sock<span class="token operator">-></span>conn<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* don't use 'sock' after this line, as another task might have allocated it */</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>lastdata <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>is_tcp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">pbuf_free</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">pbuf</span> <span class="token operator">*</span><span class="token punctuation">)</span>lastdata<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      <span class="token function">netbuf_delete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">netbuf</span> <span class="token operator">*</span><span class="token punctuation">)</span>lastdata<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°åˆ†æå¯çŸ¥ï¼Œ<code>close</code>å‡½æ•°åªèƒ½ä½¿socket-&gt;connä¸ºç©ºï¼Œå¹¶ä¸èƒ½ä½¿select_waitingä¸º0ï¼Œæ‰€ä»¥å…¶å®åªæœ‰<code>close</code>å‡½æ•°æ˜¯ä¸èƒ½ä½¿socketèµ„æºå®Œå…¨é‡Šæ”¾çš„ã€‚</p><h3 id="2-3-selectå‡½æ•°"><a href="#2-3-selectå‡½æ•°" class="headerlink" title="2.3 selectå‡½æ•°"></a>2.3 selectå‡½æ•°</h3><p>&emsp;&emsp;ä»<em>select_waiting</em>åå­—ä¸­èƒ½æ¯”è¾ƒå®¹æ˜“çš„çŒœåˆ°ï¼Œè¯¥å˜é‡è·Ÿselectå‡½æ•°è‚¯å®šæ˜¯å¼ºç›¸å…³çš„ã€‚å…¨å±€æœç´¢select_waitingï¼Œæœç„¶åªæœ‰selectå‡½æ•°æœ‰è¿›è¡Œå†™æ“ä½œã€‚ä¸‹é¢åˆ†æselectå‡½æ•°ï¼Œè¯¥å‡½æ•°è¾ƒé•¿ï¼Œåšå¿…è¦çš„ç®€åŒ–ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">lwip_select</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxfdp1<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>readset<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>writeset<span class="token punctuation">,</span> fd_set <span class="token operator">*</span>exceptset<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">timeval</span> <span class="token operator">*</span>timeout<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token class-name">u32_t</span> waitres <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">int</span> nready<span class="token punctuation">;</span>  fd_set lreadset<span class="token punctuation">,</span> lwriteset<span class="token punctuation">,</span> lexceptset<span class="token punctuation">;</span>  <span class="token class-name">u32_t</span> msectimeout<span class="token punctuation">;</span>  <span class="token keyword">struct</span> <span class="token class-name">lwip_select_cb</span> select_cb<span class="token punctuation">;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span>  <span class="token keyword">int</span> maxfdp2<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">LWIP_NETCONN_SEM_PER_THREAD</span></span>  <span class="token keyword">int</span> waited <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>  <span class="token comment">/* Go through each socket in each list to count number of sockets which     currently match */</span>  <span class="token comment">/*   *æ‰«ææ‰€æœ‰socketå¯¹åº”çš„bitï¼Œå¦‚æœæœ‰å‡†å¤‡å¥½ï¼Œåˆ™ç›´æ¥å°†å¯¹åº”çš„bitç½®ä¸Šï¼Œåé¢å¯ä»¥çœ‹å‡ºï¼Œè¯¥å‡½æ•°ç®€å•çš„èµ‹å€¼åå°±é€€å‡ºäº†ï¼Œ  *ä¸æ¶‰åŠå¯¹select_waitingçš„æ“ä½œã€‚   */</span>  nready <span class="token operator">=</span> <span class="token function">lwip_selscan</span><span class="token punctuation">(</span>maxfdp1<span class="token punctuation">,</span> readset<span class="token punctuation">,</span> writeset<span class="token punctuation">,</span> exceptset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>lreadset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>lwriteset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>lexceptset<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/* If we don't have any current events, then suspend if we are supposed to */</span>  <span class="token comment">/* åªæœ‰æ²¡æœ‰ç›¸åº”çš„socketå‡†å¤‡å¥½å¹¶ä¸”æ²¡æœ‰è¶…æ—¶ï¼Œæ‰å›ç½®ä½select_waiting, å¹¶æŒ‚èµ·çº¿ç¨‹ã€‚ */</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>nready<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">&amp;&amp;</span> timeout<span class="token operator">-></span>tv_sec <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> timeout<span class="token operator">-></span>tv_usec <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">LWIP_DEBUGF</span><span class="token punctuation">(</span>SOCKETS_DEBUG<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"lwip_select: no timeout, returning 0\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">/* This is OK as the local fdsets are empty and nready is zero,         or we would have returned earlier. */</span>      <span class="token keyword">goto</span> return_copy_fdsets<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* çœç•¥ä¸€å †å¤„ç†ï¼Œå¯ä»¥çœ‹åˆ°åªè¦è¯¥socketè®¾ç½®äº†ï¼Œè¯»å†™å¼‚å¸¸é€šçŸ¥ï¼Œå¹¶ä¸”socketæ˜¯å­˜åœ¨çš„ï¼Œåˆ™ä¼šå°†select_waintingå¢åŠ 1 */</span>    <span class="token comment">/* Increase select_waiting for each socket we are interested in */</span>    maxfdp2 <span class="token operator">=</span> maxfdp1<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> LWIP_SOCKET_OFFSET<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxfdp1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>readset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> readset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>          <span class="token punctuation">(</span>writeset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> writeset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>          <span class="token punctuation">(</span>exceptset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> exceptset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">struct</span> <span class="token class-name">lwip_sock</span> <span class="token operator">*</span>sock<span class="token punctuation">;</span>        <span class="token function">SYS_ARCH_PROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>        sock <span class="token operator">=</span> <span class="token function">tryget_socket</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sock <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          sock<span class="token operator">-></span>select_waiting<span class="token operator">++</span><span class="token punctuation">;</span>          <span class="token function">LWIP_ASSERT</span><span class="token punctuation">(</span><span class="token string">"sock->select_waiting > 0"</span><span class="token punctuation">,</span> sock<span class="token operator">-></span>select_waiting <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>          <span class="token comment">/* Not a valid socket */</span>          nready <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>          maxfdp2 <span class="token operator">=</span> i<span class="token punctuation">;</span>          <span class="token function">SYS_ARCH_UNPROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">SYS_ARCH_UNPROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nready <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/*     *æ‰§è¡Œå®Œä¸Šè¿°æ“ä½œï¼Œè¿˜ä¼šå†æ‰«æä¸€æ¬¡æ˜¯å¦æœ‰socketæœ‰äº‹ä»¶äº§ç”Ÿï¼Œåˆ é™¤ç»†èŠ‚ã€‚    *å› ä¸ºä¸Šè¿°ï¼Œå¦‚æœsocketèµ„æºè¿‡å¤šï¼Œä¼šæ¶ˆè€—ä¸å°‘èµ„æºï¼Œå†æ‰«æä¸€æ¬¡å¯ä»¥æé«˜æ•ˆç‡ã€‚    */</span>      <span class="token comment">/* ä¼‘çœ æŒ‡å®šæ—¶é—´ï¼Œè®©å‡ºcpuæ§åˆ¶æƒ */</span>      waitres <span class="token operator">=</span> <span class="token function">sys_arch_sem_wait</span><span class="token punctuation">(</span><span class="token function">SELECT_SEM_PTR</span><span class="token punctuation">(</span>select_cb<span class="token punctuation">.</span>sem<span class="token punctuation">)</span><span class="token punctuation">,</span> msectimeout<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* ä¼‘çœ ç»“æŸï¼Œ å°†å¯¹åº”socket->select_waitingå‡1 */</span>    <span class="token comment">/* Decrease select_waiting for each socket we are interested in */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> LWIP_SOCKET_OFFSET<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxfdp2<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>readset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> readset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>          <span class="token punctuation">(</span>writeset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> writeset<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>          <span class="token punctuation">(</span>exceptset <span class="token operator">&amp;&amp;</span> <span class="token function">FD_ISSET</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> exceptset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">struct</span> <span class="token class-name">lwip_sock</span> <span class="token operator">*</span>sock<span class="token punctuation">;</span>        <span class="token function">SYS_ARCH_PROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>        sock <span class="token operator">=</span> <span class="token function">tryget_socket</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* å‡1ï¼Œå¿…é¡»socketæ˜¯è¿˜åœ¨çš„ */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sock <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token comment">/* for now, handle select_waiting==0... */</span>          <span class="token function">LWIP_ASSERT</span><span class="token punctuation">(</span><span class="token string">"sock->select_waiting > 0"</span><span class="token punctuation">,</span> sock<span class="token operator">-></span>select_waiting <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>sock<span class="token operator">-></span>select_waiting <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            sock<span class="token operator">-></span>select_waiting<span class="token operator">--</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>          <span class="token comment">/* Not a valid socket */</span>          nready <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">SYS_ARCH_UNPROTECT</span><span class="token punctuation">(</span>lev<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">/* åˆ é™¤ä¸å½±å“åˆ†æä»£ç ï¼Œæ„Ÿå…´è¶£å‚è€ƒæºç ã€‚ */</span>  <span class="token keyword">return</span> nready<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><center>è¿™æ˜¯è¿™ä¸€å¼ æ¥è‡ªæœªæ¥çš„selectå‡½æ•°å¤„ç†æµç¨‹å›¾</center></strong></p><p>&emsp;&emsp;å‚è€ƒä¸Šè¿°ä»£ç åˆ†æï¼Œç‰¹åˆ«æ³¨æ„<em>socket-&gt;select_waiting</em>åŠ 1å’Œå‡1çš„åœ°æ–¹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœsocketå­˜åœ¨ä¸”çš„ç¡®éœ€è¦ç›‘å¬äº‹ä»¶ï¼Œä¸”å¹¶ä¸æ˜¯è¿›æ¥äº‹ä»¶å°±å·²ç»äº§ç”Ÿæˆ–è€…å·²ç»è¶…æ—¶ï¼Œä¸€å®šä¼šåŠ 1ï¼›ç„¶åçº¿ç¨‹ä¼šæœ‰å¯èƒ½ä¼šè¿›è¡Œä¼‘çœ ï¼›æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¼‘çœ ç»“æŸåï¼Œ<em>socket-&gt;select_waiting</em>å‡1ï¼Œç¦»å¼€è¯¥å‡½æ•°ï¼Œ<em>socket-&gt;select_waiting</em>æ¢å¤åŸå€¼ã€‚<strong>ä½†æ˜¯</strong>ï¼Œå¦‚æœåœ¨çº¿ç¨‹ä¼‘çœ æœŸé—´ï¼Œæ°å·§åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œäº†closeæ“ä½œï¼Œäº‹ä»¶å°±å˜å‘³äº†ã€‚</p><p>&emsp;&emsp;å¦‚æœåœ¨ä¼‘çœ æœŸé—´è¿›è¡Œäº†<code>close(socket)</code>,åˆ™é€šè¿‡<code>tyr_socket(socket)</code>è·å–ä¸åˆ°socketç»“æ„ä½“ï¼Œåˆ™<em>socket-&gt;select_waiting</em>ä¸ä¼šè¿›è¡Œå‡1ï¼Œåé¢æ‰§è¡Œä¸€ç³»åˆ—è¯­å¥åï¼Œé€€å‡ºè¯¥å‡½æ•°ï¼Œ<em>socket-&gt;select_waiting</em>æ²¡æœ‰æ¢å¤åŸå€¼ï¼Œä¸”æ¯”è¿›æ¥æ—¶å¤§1ã€‚é’ˆå¯¹è¯¥å‡½æ•°ï¼Œ<em>socket-&gt;select_waiting</em>åŠ 1çš„æ¬¡æ•°æ˜¯*&gt;=<em>å‡1çš„æ¬¡æ•°ï¼Œæ‰€ä»¥å¦‚æœåªè¦åœ¨å‡½æ•°é€€å‡ºæ—¶æ²¡æœ‰æ¢å¤åŸå€¼ï¼Œåˆ™</em>socket-&gt;select_waiting*æ°¸è¿œä¸å¯èƒ½å†å‡ä¸º0äº†ï¼Œæ­¤æ—¶socketèµ„æºå°±å‡ºç°äº†<strong>å‡å ç”¨</strong>ï¼Œè¯¥socketå†ä¹Ÿä¸èƒ½è¢«å…¶ä»–äººä½¿ç”¨äº†ã€‚</p><h1 id="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"></a>ä¸‰ã€è§£å†³æ–¹æ¡ˆ</h1><p>&emsp;&emsp;ç¬¬äºŒç« å·²ç»å¯¹äº§ç”Ÿçš„åŸå› è¿›è¡Œäº†åˆ†æã€‚è§£å†³é—®é¢˜çš„æ€è·¯ä¹Ÿæƒ³ä¸€å¼€å§‹æåˆ°çš„æœ‰ä¸¤ç§ï¼Œä¸ºäº†ä¸æ”¹lwipæºç ï¼Œä½¿ç”¨äº†ç¬¬äºŒç§æ€è·¯ã€‚ä¸‹é¢ç”¨ä¼ªä»£ç ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚éœ€è¦ä½¿ç”¨åˆ°ä¸¤ä¸ªflag<code>closing_socket_flag</code>å’ŒÂ·selecting_flag`ã€‚<br><strong>thread1</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">adaptor_closesocket</span><span class="token punctuation">(</span><span class="token keyword">int</span> socket<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">get_select_processing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">set_closesocket_processing</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">close</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">set_closescoket_processing</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>thread2</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">select_loop</span><span class="token punctuation">(</span><span class="token keyword">int</span> socket<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">get_closesocket_processing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">set_select_processing</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">;</span>    select_return <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span>sockMAX <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>read_set<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>exception_set<span class="token punctuation">,</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">set_select_processing</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;ä¸Šé¢çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘è®¤ä¸ºæ˜¯æœ€ä¸ºç®€å•é€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œå½“ç„¶é’ˆå¯¹ä¸¤ä¸ªflagè‚¯å®šè¿˜æ˜¯éœ€è¦åŠ é”çš„ã€‚å¦å¤–è¿˜æœ‰ä¸€ç§æ€è·¯å°±æ˜¯ä½¿ç”¨é€šçŸ¥ç±»ä¼¼äºconditionçš„æ–¹æ³•ã€‚çŸ¥é“äº†é”™è¯¯åŸå› ï¼Œè§£å†³æ–¹æ³•çš„æ€è·¯å°±æ˜¯åšåŒæ­¥ã€‚</p><h1 id="å››ã€å†™åœ¨æœ€å"><a href="#å››ã€å†™åœ¨æœ€å" class="headerlink" title="å››ã€å†™åœ¨æœ€å"></a>å››ã€å†™åœ¨æœ€å</h1><p>&emsp;&emsp;LwIPæ— ç–‘æ˜¯ä¸€ä¸ªå¾ˆä¼˜ç§€çš„è½»é‡ç‰ˆçš„TCP/IPåè®®å®ç°äº†ï¼Œè™½ç„¶ä¸Šé¢çš„socketæ¥å£éƒ½æ˜¯ç®€åŒ–ç‰ˆï¼Œå½“æ—¶ä»¥ä¸ºå¦‚æœåŠŸèƒ½æ˜¯æ”¯æŒçš„ï¼Œåœ¨ä½¿ç”¨ä»¥ä¸ºå¯ä»¥è·ŸBSDçš„ä¸€æ ·ã€‚å› ä¸ºåœ¨å¼€å‘DoIPæ—¶æ˜¯è·¨å¹³å°ï¼Œä¸Šå±‚åº”ç”¨ä»£ç æ˜¯ä¸€æ ·çš„ï¼Œåœ¨windowså’Œlinuxéƒ½æ˜¯æ”¯æŒçš„ï¼Œæ‰€ä»¥æ¯”è¾ƒç®€å•å°±åˆæ­¥å®šä½å‡ºäº†é—®é¢˜åº”è¯¥æ˜¯å‡ºåœ¨äº†LwIPåè®®æœ¬èº«ï¼Œä½†æ˜¯å½“æ—¶ç”±äºç°è±¡ç‰¹åˆ«å¥‡æ€ªï¼ˆç•¥è¿‡ä¸è¡¨ï¼‰ï¼Œä¹Ÿè´¹äº†ä¸€èˆ¬å‘¨æŠ˜æ‰æœ€ç»ˆå®šä½å‡ºæ¥ã€‚ä¸€å¼€å§‹è§‰å¾—è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªbugï¼Œåé¢è·Ÿè€è™ï¼ˆæŠ€æœ¯å¶åƒï¼‰æ·±åº¦è®¨è®ºè¿‡ï¼Œè§‰å¾—è¿™ä¹Ÿä¸å±äºLwIPæœ¬èº«çš„ä¸€ä¸ªbugï¼Œæ„Ÿè§‰æ›´åƒæ˜¯featureå®ç°çš„ä¸å¤Ÿå®Œæ•´ï¼Œä½†æ˜¯light weightä¹Ÿå·²ç»è¶³å¤Ÿäº†ã€‚åŒæ—¶åœ¨ä½¿ç”¨LwIPæœ¬èº«ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šæŠ€å·§ï¼Œå¦‚è¿æ¥ç¬¦**##**çš„ä½¿ç”¨ã€åœ¨MCUä¸Šå®ç°åˆ†é…ç©ºé—´çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><img src="https://savannah.nongnu.org/images/Savannah.theme/floating.png"></p>]]></content>
      
      
      <categories>
          
          <category> åè®®æ ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> LwIP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘ä¸ºä»€ä¹ˆè¦å†™åšå®¢</title>
      <link href="2021/04/11/why-write/"/>
      <url>2021/04/11/why-write/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å…³äºè¿™ç¯‡åšå®¢ï¼Œæƒ³è®°å½•ä¸‹è‡ªå·±å½“å‰å†™åšå®¢çš„åŸå› ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›è®°å½•è‡ªå·±å½“å‰è‡ªå·±çš„ä¸€äº›çœ‹æ³•ï¼Œåé¢æŒç»­æ›´æ–°ã€‚</p></blockquote><blockquote><p>è®°äº2021.4</p></blockquote><h1 id="ä¸ºä»€ä¹ˆè¦å†™åšå®¢"><a href="#ä¸ºä»€ä¹ˆè¦å†™åšå®¢" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å†™åšå®¢"></a>ä¸ºä»€ä¹ˆè¦å†™åšå®¢</h1><p> &emsp;&emsp;ä¸€ç›´æŒºæƒ³ç”¨æ–‡å­—è®°å½•è®°å½•è‡ªå·±çš„æˆé•¿è½¨è¿¹ï¼Œç¬¬ä¸€ä»½å·¥ä½œåœ¨ç»çº¬æ’æ¶¦æ—¶ï¼Œéƒ¨é—¨è¦æ±‚æ¯å¤©éƒ½è¦å†™å†™tasklistï¼Œå½“æ—¶åˆšæ¯•ä¸šï¼Œä¹Ÿç®—æ˜¯é€—æ¯”ä¸€ä¸ªï¼Œå†™çš„æ–‡å­—ä¸æ­¢æ˜¯æ¯å¤©å·¥ä½œçš„è®°å½•ï¼Œä¹ŸåŒ…å«è‡ªå·±é‡åˆ°é—®é¢˜æ—¶è‡ªå·±è‹¦æ¼çš„å¿ƒæƒ…ï¼ŒåŒæ—¶ä¹Ÿæœ‰è‡ªå·±åœ¨è§£å†³äº†é—®é¢˜æ—¶å¼€å¿ƒã€‚åœ¨å…¥èŒ2ä¸ªå¤šæœˆåï¼Œè½¬æ­£ç­”è¾©ï¼Œçœ‹ç€è‡ªå·±å†™çš„tasklistï¼Œæ„Ÿè§‰è‡ªå·±åˆæŠŠå‰ä¸¤ä¸ªæœˆè¿‡äº†ä¸€éä¼¼çš„ï¼Œå½“æ—¶å†™è½¬æ­£pptä¹Ÿè›®é¡ºåˆ©çš„ã€‚åé¢è™½ç„¶ç•¥æœ‰å·æ‡’ï¼Œä½†æ˜¯ä¹Ÿä¼šâ€œå‹¤å‹¤æ³æ³â€çš„è®°å½•ï¼Œ<br> åœ¨2019å¹´ç¦»èŒå‰ï¼Œå¯¹åœ¨æ’æ¶¦çš„èŒä¸šç”Ÿæ¶¯åˆå›é¡¾äº†ä¸€éï¼Œæ„Ÿè§‰å°±åƒçœ‹åˆ°äº†ä¸€ä¸ªä»æ ¡å›­å‡ºæ¥çš„å­¦ç”Ÿæ˜¯å¦‚ä½•æ…¢æ…¢å˜ä¸ºç¤¾ä¼šäººçš„ã€‚</p><p> &emsp;&emsp;ä»åŒ—äº¬åˆ°ä¸Šæµ·ï¼Œä»æ’æ¶¦åˆ°æ€¿æ˜Ÿï¼Œå‰ä¸‰ä¸ªæœˆä¹Ÿåƒæ¨¡åƒæ ·çš„åœ¨æ¯å¤©åœ¨è®°å½•ã€‚å½“æ—¶å¤„äºæ”¾å…»çŠ¶æ€ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯è‡ªå·±åœ¨å­¦ä¸œè¥¿ï¼Œå†™tasklistï¼Œä¸€æ–¹é¢æ˜¯è®°å½•è‡ªå·±çš„å­¦ä¹ ï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸ºäº†é˜²æ­¢é¢†å¯¼è§‰å¾—æˆ‘åœ¨è¯•ç”¨æœŸæ²¡æœ‰æˆæœã€‚ç£•ç£•ç»Šç»Šã€æ–­æ–­ç»­ç»­ä¹Ÿå†™äº†ä¸‰ä¸ªæœˆï¼Œç»ˆäºåœ¨æŸä¸€å¤©å°±ä¸¢äº†ã€‚</p><p><img src="/medias/article/2.jpeg"></p><p>&emsp;&emsp;2020å¹´å¹´ç»ˆæ€»ç»“ï¼Œè§‰å¾—æ²¡æœ‰è¾¾åˆ°çš„ç›®æ ‡ï¼Œè€ƒè™‘åˆ°åœ¨ç›®å‰å¹³å°è‡ªå·±æˆé•¿å—é™å°±æƒ³ç€è¦æ¢ä¸ªå¹³å°ã€‚æ‰¾å·¥ä½œå˜›ï¼Œé¿å…ä¸äº†è¦æ›´æ–°ç®€å†ï¼ŒæœŸé—´å›å¿†å›å¿†è‡ªå·±åšè¿‡çš„äº‹æƒ…ï¼Œä¹Ÿåœ¨æ„Ÿæ…¨è‡ªå·±çš„ä¸€äº›æˆé•¿å’Œè§è¯†ã€‚ä¹Ÿè¶Šæ¥è¶ŠèŒç”Ÿï¼Œè‡ªå·±éœ€è¦åœ¨æŸä¸ªåœ°æ–¹è®°å½•è®°å½•çš„å­¦ä¹ è¿‡ç¨‹ä»¥åŠå­¦ä¹ æˆæœã€‚</p><p>&emsp;&emsp;è‡ªå·±åœ¨2020å¹´ä¸€å¹´ä¸­çœ‹äº†å¾ˆå¤šè®¡ç®—æœºç›¸å…³çš„ä¹¦ç±ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å½¢æˆæ€»ç»“ã€‚æ¯”å¦‚è‡ªå·±åœ¨çœ‹ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹æ—¶ï¼Œçœ‹åˆ°è™šæ‹Ÿå†…å­˜é‚£é‡Œï¼Œçªç„¶å°±æ˜ç™½äº†MCUå’ŒMPUçš„å·®å¼‚æ€§åœ¨å“ªé‡Œäº†ã€‚åœ¨é˜…è¯»ã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹æ—¶ï¼Œæ˜ç™½äº†åŸæ¥æ²¡æœ‰å®Œç¾çš„è®¾è®¡ï¼Œæ€»æ˜¯ä¼šåœ¨å¤æ‚åº¦å’Œæ€§èƒ½å–ä¸ªæŠ˜ä¸­ã€‚è‡ªå·±æœ¬èº«æ˜¯ä¸€åç å†œ(<strong>è¿˜ä¸é…ç§°ä¸ºç¨‹åºå‘˜</strong>ï¼‰ï¼Œåœ¨æ’¸ä»£ç æ—¶ï¼Œè€æ˜¯æƒ³å®ç°ä¸€ä¸ªå®Œç¾ç¨‹åºï¼Œä½†æ˜¯æœ€ç»ˆå¾€å¾€æµäº§ï¼Œçœ‹å®Œè¿™æœ¬ä¹¦åä¹Ÿç®—æ˜¯ç»™äº†æˆ‘å¯å‘ã€‚ä»ã€Šäººæœˆç¥è¯ã€‹è¿™æœ¬ä¹¦ä¸ä»…çŸ¥é“äº†è½¯ä»¶å·¥ä½œé‡æ˜¯ä¸èƒ½ç®€å•ç”¨äººæœˆæ¥è¡¡é‡ï¼Œè€Œä¸”ä¹Ÿæ•™ä¼šäº†æˆ‘å¦‚ä½•çœ‹å¾…å›¢é˜Ÿæ°´å¹³ä¸åŒå±‚æ¬¡çš„äººï¼Œä¹Ÿç®—æ˜¯æ‘†æ­£äº†è‡ªå·±çš„ä½ç½®ã€‚</p><p>&emsp;&emsp;ä¸Šé¢æ— è®ºç²¾å½©çš„æˆ–è€…ä¸ç²¾å½©çš„å†…å®¹ï¼Œæ·±åˆ»æˆ–è€…ä¸æ·±åˆ»çš„ç¬é—´ï¼Œéƒ½æ²¡ç”¨æ–‡å­—è®°å½•ä¸‹æ¥ã€‚ç°åœ¨å†å»å›æƒ³ï¼Œå¦‚è™šæ‹Ÿå†…å­˜ä¹‹ç±»ï¼Œå¾ˆéš¾å†ä½“ä¼šåˆ°é‚£ç§çªç„¶é¡¿æ‚Ÿçš„æ¿€åŠ¨ã€‚æ®Šä¸çŸ¥ï¼Œé‚£æ˜¯è‡ªå·±ä»MCUè½¬åˆ°MPU(é€šç”¨æ“ä½œç³»ç»Ÿ)å¾ˆé‡è¦çš„ä¸€ä»¶äº‹ï¼Œæ‰«æ¸…äº†è‡ªå·±çš„è®¤çŸ¥éšœç¢ã€‚</p><p>&emsp;&emsp;è¶ç€è·³æ§½ä¹‹é™…ï¼Œåˆæ˜¯åšå®¢å›­æ•´é¡¿ä¹‹æ—¶ï¼Œä¸ºäº†è®©è‡ªå·±çš„åšå®¢æŒæ¡åœ¨è‡ªå·±çš„æ‰‹é‡Œã€‚åœ¨æ¸…æ˜èŠ‚å‰åæ­å»ºå‡ºäº†å±äºçš„åšå®¢ï¼Œä¹Ÿå€Ÿæ­¤å¸Œæœ›èƒ½å¤Ÿå­¦äº›å­¦å­¦nodejsï¼ŒåŒæ—¶ä¹Ÿæƒ³åœ¨æ­¤è®°å½•è‡ªå·±çš„å¿ƒæƒ…ã€å­¦ä¹ çš„æŠ€æœ¯ä»¥åŠè‡ªå·±çš„å¿ƒå¾—ã€‚psï¼š<em>æ­å»ºåšå®¢ä¹Ÿè¸äº†ä¸å°‘å‘ï¼Œå¸Œæœ›æœ‰æ—¶é—´æ•´ç†ä¸€ç¯‡æ–‡ç« ã€‚</em></p><h1 id="åšå®¢å†™äº›ä»€ä¹ˆ"><a href="#åšå®¢å†™äº›ä»€ä¹ˆ" class="headerlink" title="åšå®¢å†™äº›ä»€ä¹ˆ"></a>åšå®¢å†™äº›ä»€ä¹ˆ</h1><p>&emsp;&emsp;å…¶å®ç›®å‰é˜¶æ®µæ²¡æœ‰ç‰¹åˆ«çš„è§„åˆ’å»äº›ä»€ä¹ˆã€‚å¿ƒé‡Œå¤§æ¦‚æƒ³å†™ä¸€äº›æŠ€æœ¯ç±»çš„æ–‡ç« ï¼Œå¹¶è®°å½•è‡ªå·±çš„å¿ƒå¾—ä½“ä¼šã€‚åŠ æ·±è‡ªå·±å¯¹æŠ€æœ¯ç†è§£ï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°åœ¨æŠ€æœ¯ä¸Šä¸€æ ·é‡åˆ°é—®é¢˜çš„æœ‰ç¼˜äººï¼Œæˆ–è€…æ˜¯åœ¨å¿ƒå¾—ä½“ä¼šä¸Šæœ‰åŒæ„Ÿçš„åŒè·¯äººã€‚å½“ç„¶ï¼Œè‡ªå·±æœ¬èº«æ˜¯èŒåœºäººï¼Œæ¶‰åŠå·¥ä½œæœºå¯†çš„å†…å®¹æˆ–è€…ä¼šå¯¹å…¬å¸é€ æˆä»»ä½•æŸå¤±çš„å†…å®¹è‚¯å®šä¸ä¼šå‡ºç°åœ¨ä¸Šé¢ã€‚æŠ€æœ¯ç±»çš„æ–‡ç« ï¼Œè®¡åˆ’æ˜¯å®Œæ•´çš„ï¼Œæœ‰demoå¯ä»¥ç›´æ¥è¿è¡Œï¼Œå°½é‡æŠŠè‡ªå·±åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­èµ°çš„å¼¯è·¯ä¹Ÿéƒ½åˆ—å‡ºæ¥ï¼Œæƒå½“ç»™è‡ªå·±è®°å½•äº†ã€‚</p><p>&emsp;&emsp;é˜¶æ®µæ€§çš„å†™å†™æ€»ç»“ï¼Œæ¯”å¦‚å­£åº¦æ€»ç»“æˆ–è€…å¹´ç»ˆæ€»ç»“ï¼Œåœ¨åç»­å›é¡¾èƒ½å¤Ÿçœ‹åˆ°ä¹‹å‰çš„è‡ªå·±æ˜¯å‚»å­ï¼Œè¿™å°±è¯æ˜äº†è‡ªå·±æ˜¯åœ¨æˆé•¿çš„ã€‚</p><p>&emsp;&emsp;åé¢è¿˜æƒ³è¦å†™çš„ï¼Œä¹Ÿä¼šè®°å½•åœ¨åšå®¢ä¸Šã€‚</p><h1 id="åšå®¢å†™ç»™è°çœ‹"><a href="#åšå®¢å†™ç»™è°çœ‹" class="headerlink" title="åšå®¢å†™ç»™è°çœ‹"></a>åšå®¢å†™ç»™è°çœ‹</h1><p>&emsp;&emsp;å†™åšå®¢çš„å¾ˆå¤§ä¸€ä¸ªåŸå› å°±æ˜¯å¸Œæœ›è®°å½•è‡ªå·±ï¼Œæ‰€ä»¥æœ€ä¸»è¦çš„æ˜¯å†™ç»™è‡ªå·±çœ‹çš„ã€‚</p><p>&emsp;&emsp;å› ä¸ºè‡ªå·±æœ¬èº«æ˜¯ä¸€ä¸ªèŒåœºäººï¼Œåšçš„ä¸œè¥¿ä¹Ÿç®—æ˜¯è¾ƒä¸ºå‰æ²¿çš„ä¸œè¥¿ï¼›åŒæ—¶è‡ªå·±å› ä¸ºæ²¡æœ‰è¯»ç ”ï¼Œå·¥ä½œä¹Ÿè¿˜ä¸åˆ°ä¸‰å¹´ï¼Œè·Ÿå¾ˆå¤šç¡•å£«æ¯•ä¸šçš„åŒå­¦ä¹Ÿæ˜¯åŒé¾„äººã€‚æ‰€ä»¥åœ¨å·¥ä½œä¸Šé‡åˆ°å›°éš¾çš„èŒåœºäººèƒ½å¤Ÿä»æˆ‘è¿™è·å¾—å¯ç¤ºç”šè‡³ç­”æ¡ˆï¼Œä¹Ÿå¸Œæœ›å³å°†è¸å…¥èŒåœºçš„åŒé¾„äººèƒ½å¤Ÿäº¤æµäº¤æµå¿ƒå¾—ï¼Œæ„¿æ„ä¸€èµ·æˆé•¿ã€‚</p><h1 id="åšå®¢ä»€ä¹ˆæ—¶å€™æ›´æ–°"><a href="#åšå®¢ä»€ä¹ˆæ—¶å€™æ›´æ–°" class="headerlink" title="åšå®¢ä»€ä¹ˆæ—¶å€™æ›´æ–°"></a>åšå®¢ä»€ä¹ˆæ—¶å€™æ›´æ–°</h1><p>&emsp;&emsp;æš‚æ—¶ä¸å®šæ›´æ–°æ—¥æœŸï¼Œå› ä¸ºç¬¬ä¸€æ¬¡å†™åšå®¢ï¼Œä¹ŸçŸ¥é“å†™è¿™ä¸ªç©æ„å„¿å¾ˆæµªè´¹æ—¶é—´å’Œç»å†ï¼Œç”¨ç©æ‰‹æœºçš„æ—¶é—´å†™åšå®¢ï¼Œæœ€åèƒ½å¤ŸåšæŒä¸‹æ¥ï¼ŒæŒç»­çš„æ›´æ–°ï¼Œè‡ªå·±å°±ç®—æ˜¯æˆåŠŸã€‚æœ€åæœŸæœ›è‡ªå·±èƒ½å¤Ÿç¨³å®šå‘¨æœŸçš„æ›´æ–°åšå®¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸ªäºº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cpp Primer å­¦ä¹ </title>
      <link href="2021/04/11/learn-with-cpp-primer/"/>
      <url>2021/04/11/learn-with-cpp-primer/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ‰€æœ‰æ–‡ç« æš‚æ—¶å‡æ¥è‡ª<a href="https://github.com/applenob/Cpp_Primer_Practice">æå®šC++ğŸ‘Šã€‚cpp-primer ä¸­æ–‡ç‰ˆç¬¬5ç‰ˆå­¦ä¹ ä»“åº“ï¼ŒåŒ…æ‹¬ç¬”è®°å’Œè¯¾åç»ƒä¹ ç­”æ¡ˆ</a>ã€‚ç›´æ¥ä¸Šä¼ ä»…ä¸ºäº†æ–¹ä¾¿è‡ªå·±å®¹æ˜“é˜…è¯»å’Œæ›´æ”¹ã€‚ä¾µæƒè¯·ç›´æ¥è”ç³»æœ¬äººåˆ é™¤ã€‚éšç€è‡ªå·±å­¦ä¹ ï¼Œä¼šå°†ç¬”è®°æ›¿æ¢æˆè‡ªå·±çš„ã€‚</p></blockquote><h1 id="Cpp-Primer-å­¦ä¹ "><a href="#Cpp-Primer-å­¦ä¹ " class="headerlink" title="Cpp Primer å­¦ä¹ "></a>Cpp Primer å­¦ä¹ </h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ã€Šcpp-primer ä¸­æ–‡ç‰ˆï¼ˆç¬¬ 5 ç‰ˆï¼‰ã€‹å­¦ä¹ ä»“åº“ï¼ŒåŒ…æ‹¬<strong>ç¬”è®°</strong>å’Œ<strong>è¯¾åç»ƒä¹ ç­”æ¡ˆ</strong>ã€‚</p><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><ul><li>system: ubuntu 16.04</li><li>IDE: VS Code</li><li>compiler: g++</li></ul><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li>ç¬¬1ç«  : å¼€å§‹  <a href="https://jinbaotang.cn/2021/04/10/notes/ch01">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch01">ç»ƒä¹ </a></li><li>ç¬¬ I éƒ¨åˆ† : C++åŸºç¡€<ul><li>ç¬¬2ç«  : å˜é‡å’ŒåŸºæœ¬ç±»å‹  <a href="https://jinbaotang.cn/2021/04/10/notes/ch02">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch02">ç»ƒä¹ </a></li><li>ç¬¬3ç«  : å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„  <a href="https://jinbaotang.cn/2021/04/10/notes/ch03">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch03">ç»ƒä¹ </a></li><li>ç¬¬4ç«  : è¡¨è¾¾å¼  <a href="https://jinbaotang.cn/2021/04/10/notes/ch04">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch04">ç»ƒä¹ </a>  </li><li>ç¬¬5ç«  : è¯­å¥  <a href="https://jinbaotang.cn/2021/04/10/notes/ch05">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch05">ç»ƒä¹ </a></li><li>ç¬¬6ç«  : å‡½æ•°  <a href="https://jinbaotang.cn/2021/04/10/notes/ch06">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch06">ç»ƒä¹ </a></li><li>ç¬¬7ç«  : ç±»  <a href="https://jinbaotang.cn/2021/04/10/notes/ch07">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch07">ç»ƒä¹ </a></li></ul></li><li>ç¬¬ II éƒ¨åˆ† : C++æ ‡å‡†åº“<ul><li>ç¬¬8ç«  : IOåº“  <a href="https://jinbaotang.cn/2021/04/10/notes/ch08">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch08">ç»ƒä¹ </a></li><li>ç¬¬9ç«  : é¡ºåºå®¹å™¨  <a href="https://jinbaotang.cn/2021/04/10/notes/ch09">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch09">ç»ƒä¹ </a></li><li>ç¬¬10ç«  : æ³›å‹ç®—æ³•  <a href="https://jinbaotang.cn/2021/04/10/notes/ch10">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch10">ç»ƒä¹ </a></li><li>ç¬¬11ç«  : å…³è”å®¹å™¨  <a href="https://jinbaotang.cn/2021/04/10/notes/ch11">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch11">ç»ƒä¹ </a></li><li>ç¬¬12ç«  : åŠ¨æ€å†…å­˜  <a href="https://jinbaotang.cn/2021/04/10/notes/ch12">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch12">ç»ƒä¹ </a></li></ul></li><li>ç¬¬ III éƒ¨åˆ† : ç±»è®¾è®¡è€…çš„å·¥å…· <ul><li>ç¬¬13ç«  : æ‹·è´æ§åˆ¶   <a href="https://jinbaotang.cn/2021/04/10/notes/ch13">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch13">ç»ƒä¹ </a></li><li>ç¬¬14ç«  : é‡è½½ä¸ç±»å‹è½¬æ¢  <a href="https://jinbaotang.cn/2021/04/10/notes/ch14">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch14">ç»ƒä¹ </a></li><li>ç¬¬15ç«  : é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡  <a href="https://jinbaotang.cn/2021/04/10/notes/ch15">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch15">ç»ƒä¹ </a></li><li>ç¬¬16ç«  : æ¨¡ç‰ˆä¸æ³›å‹ç¼–ç¨‹  <a href="https://jinbaotang.cn/2021/04/10/notes/ch16">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch16">ç»ƒä¹ </a></li></ul></li><li>ç¬¬ IV éƒ¨åˆ† : é«˜çº§ä¸»é¢˜  <ul><li>ç¬¬17ç«  : æ ‡å‡†åº“ä¸ç‰¹æ®Šè®¾æ–½  <a href="https://jinbaotang.cn/2021/04/10/notes/ch17">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch17">ç»ƒä¹ </a></li><li>ç¬¬18ç«  : ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·  <a href="https://jinbaotang.cn/2021/04/10/notes/ch18">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch18">ç»ƒä¹ </a></li><li>ç¬¬19ç«  : ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯  <a href="https://jinbaotang.cn/2021/04/10/notes/ch19">ç¬”è®°</a>  <a href="https://jinbaotang.cn/2021/04/10/excersize/ch19">ç»ƒä¹ </a></li></ul></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://github.com/Mooophy/Cpp-Primer">cpp-primer 5 Answers(C++11/14)</a></li><li><a href="https://github.com/huangmingchuan/Cpp_Primer_Answers">ã€Šcpp-primerã€‹ç¬¬äº”ç‰ˆä¸­æ–‡ç‰ˆä¹ é¢˜ç­”æ¡ˆ</a></li><li><a href="https://github.com/applenob/Cpp_Primer_Practice">æå®šC++ğŸ‘Šã€‚cpp-primer ä¸­æ–‡ç‰ˆç¬¬5ç‰ˆå­¦ä¹ ä»“åº“ï¼ŒåŒ…æ‹¬ç¬”è®°å’Œè¯¾åç»ƒä¹ ç­”æ¡ˆ</a><h2 id="å‚ä¸è´¡çŒ®"><a href="#å‚ä¸è´¡çŒ®" class="headerlink" title="å‚ä¸è´¡çŒ®"></a>å‚ä¸è´¡çŒ®</h2></li></ul>]]></content>
      
      
      <categories>
          
          <category> cpp-primer </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ1</title>
      <link href="2021/04/10/excersize/ch01/"/>
      <url>2021/04/10/excersize/ch01/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸€ç« -å¼€å§‹"><a href="#ç¬¬ä¸€ç« -å¼€å§‹" class="headerlink" title="ç¬¬ä¸€ç«  å¼€å§‹"></a>ç¬¬ä¸€ç«  å¼€å§‹</h1><h2 id="ç»ƒä¹ 1-1"><a href="#ç»ƒä¹ 1-1" class="headerlink" title="ç»ƒä¹ 1.1"></a>ç»ƒä¹ 1.1</h2><p>æŸ¥é˜…ä½ ä½¿ç”¨çš„ç¼–è¯‘å™¨çš„æ–‡æ¡£ï¼Œç¡®å®šå®ƒæ‰€ä½¿ç”¨çš„æ–‡ä»¶åçº¦å®šã€‚ç¼–è¯‘å¹¶è¿è¡Œç¬¬2é¡µçš„mainç¨‹åºã€‚</p><p>è§£ï¼š</p><ul><li><code>g++ --std=c++11 ch1.cpp -o main</code></li><li><code>./main</code></li></ul><h2 id="ç»ƒä¹ 1-2"><a href="#ç»ƒä¹ 1-2" class="headerlink" title="ç»ƒä¹ 1.2"></a>ç»ƒä¹ 1.2</h2><p>æ”¹å†™ç¨‹åºï¼Œè®©å®ƒè¿”å›-1ã€‚è¿”å›å€¼-1é€šå¸¸è¢«å½“åšç¨‹åºé”™è¯¯çš„æ ‡è¯†ã€‚é‡æ–°ç¼–è¯‘å¹¶è¿è¡Œä½ çš„ç¨‹åºï¼Œè§‚å¯Ÿä½ çš„ç³»ç»Ÿå¦‚ä½•å¤„ç†mainè¿”å›çš„é”™è¯¯æ ‡è¯†ã€‚</p><p>è§£ï¼š</p><ul><li>åœ¨ubuntuä¸‹ï¼Œä½¿ç”¨g++ï¼Œè¿”å›-1ï¼Œ<code>./main</code>æ²¡æœ‰å‘ç°ä»»ä½•å¼‚å¸¸ã€‚</li><li><code>echo $?</code>ï¼Œè¿”å›255ã€‚</li></ul><h2 id="ç»ƒä¹ 1-3"><a href="#ç»ƒä¹ 1-3" class="headerlink" title="ç»ƒä¹ 1.3"></a>ç»ƒä¹ 1.3</h2><p>ç¼–å†™ç¨‹åºï¼Œåœ¨æ ‡å‡†è¾“å‡ºä¸Šæ‰“å°Hello, Worldã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Hello, World"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-4"><a href="#ç»ƒä¹ 1-4" class="headerlink" title="ç»ƒä¹ 1.4"></a>ç»ƒä¹ 1.4</h2><p>æˆ‘ä»¬çš„ç¨‹åºä½¿ç”¨åŠ æ³•è¿ç®—ç¬¦<code>+</code>æ¥å°†ä¸¤ä¸ªæ•°ç›¸åŠ ã€‚ç¼–å†™ç¨‹åºä½¿ç”¨ä¹˜æ³•è¿ç®—ç¬¦<code>*</code>ï¼Œæ¥æ‰“å°ä¸¤ä¸ªæ•°çš„ç§¯ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter two numbers:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">int</span> v1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> v1 <span class="token operator">>></span> v2<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The product of "</span> <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">&lt;&lt;</span> <span class="token string">" and "</span> <span class="token operator">&lt;&lt;</span> v2              <span class="token operator">&lt;&lt;</span> <span class="token string">" is "</span> <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">*</span> v2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-5"><a href="#ç»ƒä¹ 1-5" class="headerlink" title="ç»ƒä¹ 1.5"></a>ç»ƒä¹ 1.5</h2><p>æˆ‘ä»¬å°†æ‰€æœ‰çš„è¾“å‡ºæ“ä½œæ”¾åœ¨ä¸€æ¡å¾ˆé•¿çš„è¯­å¥ä¸­ï¼Œé‡å†™ç¨‹åºï¼Œå°†æ¯ä¸ªè¿ç®—å¯¹è±¡çš„æ‰“å°æ“ä½œæ”¾åœ¨ä¸€æ¡ç‹¬ç«‹çš„è¯­å¥ä¸­ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter two numbers:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">int</span> v1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> v2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cin <span class="token operator">>></span> v1 <span class="token operator">>></span> v2<span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The product of "</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v1<span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">" and "</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v2<span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">" is "</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">*</span> v2<span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-6"><a href="#ç»ƒä¹ 1-6" class="headerlink" title="ç»ƒä¹ 1.6"></a>ç»ƒä¹ 1.6</h2><p>è§£é‡Šä¸‹é¢ç¨‹åºç‰‡æ®µæ˜¯å¦åˆæ³•ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The sum of "</span> <span class="token operator">&lt;&lt;</span> v1<span class="token punctuation">;</span>          <span class="token operator">&lt;&lt;</span> <span class="token string">" and "</span> <span class="token operator">&lt;&lt;</span> v2<span class="token punctuation">;</span>          <span class="token operator">&lt;&lt;</span> <span class="token string">" is "</span> <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">+</span> v2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç¨‹åºæ˜¯åˆæ³•çš„ï¼Œå®ƒçš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœç¨‹åºä¸åˆæ³•ï¼ŒåŸå› ä½•åœ¨ï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ­£ï¼Ÿ</p><p>è§£ï¼š</p><p>ç¨‹åºä¸åˆæ³•ï¼Œæœ‰å¤šä½™çš„åˆ†å·ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The sum of "</span> <span class="token operator">&lt;&lt;</span> v1          <span class="token operator">&lt;&lt;</span> <span class="token string">" and "</span> <span class="token operator">&lt;&lt;</span> v2          <span class="token operator">&lt;&lt;</span> <span class="token string">" is "</span> <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">+</span> v2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-7"><a href="#ç»ƒä¹ 1-7" class="headerlink" title="ç»ƒä¹ 1.7"></a>ç»ƒä¹ 1.7</h2><p>ç¼–è¯‘ä¸€ä¸ªåŒ…å«ä¸æ­£ç¡®çš„åµŒå¥—æ³¨é‡Šçš„ç¨‹åºï¼Œè§‚å¯Ÿç¼–è¯‘å™¨è¿”å›çš„é”™è¯¯ä¿¡æ¯ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/* æ­£å¸¸æ³¨é‡Š /* åµŒå¥—æ³¨é‡Š */</span> æ­£å¸¸æ³¨é‡Š<span class="token operator">*</span><span class="token operator">/</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é”™è¯¯ä¿¡æ¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">  &#x2F;* æ­£å¸¸æ³¨é‡Š &#x2F;* åµŒå¥—æ³¨é‡Š *&#x2F; æ­£å¸¸æ³¨é‡Š*&#x2F;                                     ^ch1.cpp:97:37: error: stray â€˜\255â€™ in programch1.cpp:97:37: error: stray â€˜\243â€™ in programch1.cpp:97:37: error: stray â€˜\345â€™ in programch1.cpp:97:37: error: stray â€˜\270â€™ in programch1.cpp:97:37: error: stray â€˜\270â€™ in programch1.cpp:97:37: error: stray â€˜\346â€™ in programch1.cpp:97:37: error: stray â€˜\263â€™ in programch1.cpp:97:37: error: stray â€˜\250â€™ in programch1.cpp:97:37: error: stray â€˜\351â€™ in programch1.cpp:97:37: error: stray â€˜\207â€™ in programch1.cpp:97:37: error: stray â€˜\212â€™ in programch1.cpp: In function â€˜int main()â€™:ch1.cpp:97:50: error: expected primary-expression before â€˜&#x2F;â€™ token  &#x2F;* æ­£å¸¸æ³¨é‡Š &#x2F;* åµŒå¥—æ³¨é‡Š *&#x2F; æ­£å¸¸æ³¨é‡Š*&#x2F;                                                  ^ch1.cpp:98:5: error: expected primary-expression before â€˜returnâ€™     return 0;     ^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-8"><a href="#ç»ƒä¹ 1-8" class="headerlink" title="ç»ƒä¹ 1.8"></a>ç»ƒä¹ 1.8</h2><p>æŒ‡å‡ºä¸‹åˆ—å“ªäº›è¾“å‡ºè¯­å¥æ˜¯åˆæ³•çš„ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"/*"</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"*/"</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token comment">/* "*/</span>" <span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token comment">/* "*/</span><span class="token string">" /* "</span><span class="token comment">/*" */</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é¢„æµ‹ç¼–è¯‘è¿™äº›è¯­å¥ä¼šäº§ç”Ÿä»€ä¹ˆæ ·çš„ç»“æœï¼Œå®é™…ç¼–è¯‘è¿™äº›è¯­å¥æ¥éªŒè¯ä½ çš„ç­”æ¡ˆ(ç¼–å†™ä¸€ä¸ªå°ç¨‹åºï¼Œæ¯æ¬¡å°†ä¸Šè¿°ä¸€æ¡è¯­å¥ä½œä¸ºå…¶ä¸»ä½“)ï¼Œæ”¹æ­£æ¯ä¸ªç¼–è¯‘é”™è¯¯ã€‚</p><p>è§£ï¼š</p><p>åªæœ‰ç¬¬ä¸‰å¥ç¼–è¯‘å‡ºé”™ï¼Œæ”¹æˆå¦‚ä¸‹å³å¯ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token comment">/* "*/</span><span class="token string">" */"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¬¬å››å¥ç­‰ä»·äºè¾“å‡º <code>&quot; /* &quot;</code>ã€‚</p><h2 id="ç»ƒä¹ 1-9"><a href="#ç»ƒä¹ 1-9" class="headerlink" title="ç»ƒä¹ 1.9"></a>ç»ƒä¹ 1.9</h2><p>ç¼–å†™ç¨‹åºï¼Œä½¿ç”¨<code>while</code>å¾ªç¯å°†50åˆ°100æ•´æ•°ç›¸åŠ ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> val <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        sum <span class="token operator">+=</span> val<span class="token punctuation">;</span>        val <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Sum of 50 to 100 inclusive is "</span>              <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-10"><a href="#ç»ƒä¹ 1-10" class="headerlink" title="ç»ƒä¹ 1.10"></a>ç»ƒä¹ 1.10</h2><p>é™¤äº†<code>++</code>è¿ç®—ç¬¦å°†è¿ç®—å¯¹è±¡çš„å€¼å¢åŠ 1ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªé€’å‡è¿ç®—ç¬¦<code>--</code>å®ç°å°†å€¼å‡å°‘1.ç¼–å†™ç¨‹åºä¸ï¼Œä½¿ç”¨é€’å‡è¿ç®—ç¬¦åœ¨å¾ªç¯ä¸­æŒ‰é€’å‡é¡ºåºæ‰“å°å‡º10åˆ°0ä¹‹é—´çš„æ•´æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> val <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>val <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> val <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        val <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-11"><a href="#ç»ƒä¹ 1-11" class="headerlink" title="ç»ƒä¹ 1.11"></a>ç»ƒä¹ 1.11</h2><p>ç¼–å†™ç¨‹åºï¼Œæç¤ºç”¨æˆ·è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼Œæ‰“å°å‡ºè¿™ä¸¤ä¸ªæ•´æ•°æ‰€æŒ‡å®šçš„èŒƒå›´å†…çš„æ‰€æœ‰æ•´æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input two num: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> start <span class="token operator">>></span> end<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>            <span class="token operator">++</span>start<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"start should be smaller than end !!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-12"><a href="#ç»ƒä¹ 1-12" class="headerlink" title="ç»ƒä¹ 1.12"></a>ç»ƒä¹ 1.12</h2><p>ä¸‹é¢çš„forå¾ªç¯å®Œæˆäº†ä»€ä¹ˆåŠŸèƒ½ï¼Ÿsumçš„ç»ˆå€¼æ˜¯å¤šå°‘ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>sum <span class="token operator">+=</span> i<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä»-100åŠ åˆ°100ï¼Œsumçš„ç»ˆå€¼æ˜¯0ã€‚</p><h2 id="ç»ƒä¹ 1-13"><a href="#ç»ƒä¹ 1-13" class="headerlink" title="ç»ƒä¹ 1.13"></a>ç»ƒä¹ 1.13</h2><p>ä½¿ç”¨forå¾ªç¯é‡åš1.4.1èŠ‚ä¸­çš„æ‰€æœ‰ç»ƒä¹ ï¼ˆç»ƒä¹ 1.9åˆ°1.11ï¼‰ã€‚</p><p>è§£ï¼š</p><h3 id="ç»ƒä¹ 1-9-1"><a href="#ç»ƒä¹ 1-9-1" class="headerlink" title="ç»ƒä¹ 1.9"></a>ç»ƒä¹ 1.9</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> val <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> val <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        sum <span class="token operator">+=</span> val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Sum of 50 to 100 inclusive is "</span>              <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»ƒä¹ 1-10-1"><a href="#ç»ƒä¹ 1-10-1" class="headerlink" title="ç»ƒä¹ 1.10"></a>ç»ƒä¹ 1.10</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> val <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> val <span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> val <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç»ƒä¹ 1-11-1"><a href="#ç»ƒä¹ 1-11-1" class="headerlink" title="ç»ƒä¹ 1.11"></a>ç»ƒä¹ 1.11</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input two num: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> start <span class="token operator">>></span> end<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> start <span class="token operator">&lt;=</span> end<span class="token punctuation">;</span> <span class="token operator">++</span>start<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"start should be smaller than end !!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-14"><a href="#ç»ƒä¹ 1-14" class="headerlink" title="ç»ƒä¹ 1.14"></a>ç»ƒä¹ 1.14</h2><p>å¯¹æ¯”forå¾ªç¯å’Œwhileå¾ªç¯ï¼Œä¸¤ç§å½¢å¼çš„ä¼˜ç¼ºç‚¹å„æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-none"><code class="language-none">The main difference between the &#96;for&#96;&#39;s and the &#96;while&#96;&#39;s is a matter of pragmatics: we usually use &#96;for&#96; when there is a known number of iterations, and use &#96;while&#96; constructs when the number of iterations in not known in advance. The &#96;while&#96; vs &#96;do ... while&#96; issue is also of pragmatics, the second executes the instructions once at start, and afterwards it behaves just like the simple &#96;while&#96;.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-15"><a href="#ç»ƒä¹ 1-15" class="headerlink" title="ç»ƒä¹ 1.15"></a>ç»ƒä¹ 1.15</h2><p>ç¼–å†™ç¨‹åºï¼ŒåŒ…å«ç¬¬14é¡µâ€œå†æ¢ç¼–è¯‘â€ä¸­è®¨è®ºçš„å¸¸è§é”™è¯¯ã€‚ç†Ÿæ‚‰ç¼–è¯‘å™¨ç”Ÿæˆçš„é”™è¯¯ä¿¡æ¯ã€‚</p><p>è§£ï¼š</p><p>ç¼–è¯‘å™¨å¯ä»¥æ£€æŸ¥å‡ºçš„é”™è¯¯æœ‰ï¼š</p><ul><li>è¯­æ³•é”™è¯¯</li><li>ç±»å‹é”™è¯¯ </li><li>å£°æ˜é”™è¯¯</li></ul><h2 id="ç»ƒä¹ 1-16"><a href="#ç»ƒä¹ 1-16" class="headerlink" title="ç»ƒä¹ 1.16"></a>ç»ƒä¹ 1.16</h2><p>ç¼–å†™ç¨‹åºï¼Œä»cinè¯»å–ä¸€ç»„æ•°ï¼Œè¾“å‡ºå…¶å’Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> value<span class="token punctuation">;</span> <span class="token punctuation">)</span>        sum <span class="token operator">+=</span> value<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-17"><a href="#ç»ƒä¹ 1-17" class="headerlink" title="ç»ƒä¹ 1.17"></a>ç»ƒä¹ 1.17</h2><p>å¦‚æœè¾“å…¥çš„æ‰€æœ‰å€¼éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œæœ¬èŠ‚çš„ç¨‹åºä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿå¦‚æœæ²¡æœ‰é‡å¤å€¼ï¼Œè¾“å‡ºåˆä¼šæ˜¯æ€æ ·çš„ï¼Ÿ</p><h2 id="ç»ƒä¹ 1-18"><a href="#ç»ƒä¹ 1-18" class="headerlink" title="ç»ƒä¹ 1.18"></a>ç»ƒä¹ 1.18</h2><p>ç¼–è¯‘å¹¶è¿è¡Œæœ¬èŠ‚çš„ç¨‹åºï¼Œç»™å®ƒè¾“å…¥å…¨éƒ½ç›¸ç­‰çš„å€¼ã€‚å†æ¬¡è¿è¡Œç¨‹åºï¼Œè¾“å…¥æ²¡æœ‰é‡å¤çš„å€¼ã€‚</p><p>è§£ï¼š</p><p>å…¨éƒ¨é‡å¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">1 1 1 1 1 1 occurs 5 times <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ²¡æœ‰é‡å¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">1 2 3 4 51 occurs 1 times 2 occurs 1 times 3 occurs 1 times 4 occurs 1 times 5 occurs 1 times <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-19"><a href="#ç»ƒä¹ 1-19" class="headerlink" title="ç»ƒä¹ 1.19"></a>ç»ƒä¹ 1.19</h2><p>ä¿®æ”¹ä½ ä¸º1.4.1èŠ‚ç»ƒä¹ 1.11ï¼ˆç¬¬11é¡µï¼‰æ‰€ç¼–å†™çš„ç¨‹åºï¼ˆæ‰“å°ä¸€ä¸ªèŒƒå›´å†…çš„æ•°ï¼‰ï¼Œä½¿å…¶èƒ½å¤„ç†ç”¨æˆ·è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°æ¯”ç¬¬äºŒä¸ªæ•°å°çš„æƒ…å†µã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input two num: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> start <span class="token operator">>></span> end<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> start <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>            <span class="token operator">++</span>start<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"start should be smaller than end !!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-20"><a href="#ç»ƒä¹ 1-20" class="headerlink" title="ç»ƒä¹ 1.20"></a>ç»ƒä¹ 1.20</h2><p>åœ¨ç½‘ç«™<a href="http://www.informit.com/title/032174113">http://www.informit.com/title/032174113</a> ä¸Šï¼Œç¬¬1ç« çš„ä»£ç ç›®å½•åŒ…å«äº†å¤´æ–‡ä»¶ Sales_item.hã€‚å°†å®ƒæ‹·è´åˆ°ä½ è‡ªå·±çš„å·¥ä½œç›®å½•ä¸­ã€‚ç”¨å®ƒç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å–ä¸€ç»„ä¹¦ç±é”€å”®è®°å½•ï¼Œå°†æ¯æ¡è®°å½•æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºä¸Šã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Sales_item.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>Sales_item item<span class="token punctuation">;</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> item<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> item <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;main &lt; data&#x2F;add_item<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">0-201-78345-X 3 60 200-201-78345-X 2 50 25<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-21"><a href="#ç»ƒä¹ 1-21" class="headerlink" title="ç»ƒä¹ 1.21"></a>ç»ƒä¹ 1.21</h2><p>ç¼–å†™ç¨‹åºï¼Œè¯»å–ä¸¤ä¸ª ISBN ç›¸åŒçš„ Sales_item å¯¹è±¡ï¼Œè¾“å‡ºä»–ä»¬çš„å’Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Sales_item.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_item item_1<span class="token punctuation">;</span>    Sales_item item_2<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> item_1<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> item_1 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> item_2<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> item_2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"sum of sale items: "</span> <span class="token operator">&lt;&lt;</span> item_1 <span class="token operator">+</span> item_2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;main &lt; data&#x2F;add_item<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">0-201-78345-X 3 60 200-201-78345-X 2 50 25sum of sale items: 0-201-78345-X 5 110 22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-22"><a href="#ç»ƒä¹ 1-22" class="headerlink" title="ç»ƒä¹ 1.22"></a>ç»ƒä¹ 1.22</h2><p>ç¼–å†™ç¨‹åºï¼Œè¯»å–å¤šä¸ªå…·æœ‰ç›¸åŒ ISBN çš„é”€å”®è®°å½•ï¼Œè¾“å‡ºæ‰€æœ‰è®°å½•çš„å’Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Sales_item.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_item sum_item<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> sum_item<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> sum_item <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>Sales_item item<span class="token punctuation">;</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> item<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> item <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        sum_item <span class="token operator">+=</span> item<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"sum of sale items: "</span> <span class="token operator">&lt;&lt;</span> sum_item <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;main &lt; data&#x2F;add_item<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">0-201-78345-X 3 60 200-201-78345-X 2 50 25sum of sale items: 0-201-78345-X 5 110 22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-23"><a href="#ç»ƒä¹ 1-23" class="headerlink" title="ç»ƒä¹ 1.23"></a>ç»ƒä¹ 1.23</h2><p>ç¼–å†™ç¨‹åºï¼Œè¯»å–å¤šæ¡é”€å”®è®°å½•ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ª ISBNï¼ˆæ¯æœ¬ä¹¦ï¼‰æœ‰å‡ æ¡é”€å”®è®°å½•ã€‚</p><h2 id="ç»ƒä¹ 1-24"><a href="#ç»ƒä¹ 1-24" class="headerlink" title="ç»ƒä¹ 1.24"></a>ç»ƒä¹ 1.24</h2><p>è¾“å…¥è¡¨ç¤ºå¤šä¸ª ISBN çš„å¤šæ¡é”€å”®è®°å½•æ¥æµ‹è¯•ä¸Šä¸€ä¸ªç¨‹åºï¼Œæ¯ä¸ª ISBN çš„è®°å½•åº”è¯¥èšåœ¨ä¸€èµ·ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Sales_item.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_item total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> total<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Sales_item trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> trans<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                total <span class="token operator">+=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘½ä»¤ï¼š</p><pre class="line-numbers language-none"><code class="language-none">.&#x2F;main &lt; data&#x2F;book_sales<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">0-201-70353-X 4 99.96 24.990-201-82470-1 4 181.56 45.390-201-88954-4 16 198 12.3750-399-82477-1 5 226.95 45.390-201-78345-X 5 110 22<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 1-25"><a href="#ç»ƒä¹ 1-25" class="headerlink" title="ç»ƒä¹ 1.25"></a>ç»ƒä¹ 1.25</h2><p>å€ŸåŠ©ç½‘ç«™ä¸Šçš„<code>Sales_item.h</code>å¤´æ–‡ä»¶ï¼Œç¼–è¯‘å¹¶è¿è¡Œæœ¬èŠ‚ç»™å‡ºçš„ä¹¦åº—ç¨‹åºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ4</title>
      <link href="2021/04/10/excersize/ch04/"/>
      <url>2021/04/10/excersize/ch04/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å››ç« -è¡¨è¾¾å¼"><a href="#ç¬¬å››ç« -è¡¨è¾¾å¼" class="headerlink" title="ç¬¬å››ç«  è¡¨è¾¾å¼"></a>ç¬¬å››ç«  è¡¨è¾¾å¼</h1><h2 id="ç»ƒä¹ 4-1"><a href="#ç»ƒä¹ 4-1" class="headerlink" title="ç»ƒä¹ 4.1"></a>ç»ƒä¹ 4.1</h2><p>è¡¨è¾¾å¼<code>5 + 10 * 20 / 2</code>çš„æ±‚å€¼ç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p><p>è§£ï¼š</p><p>ç­‰ä»·äº<code>5 + ((10 * 20) / 2) = 105</code></p><h2 id="ç»ƒä¹ 4-2"><a href="#ç»ƒä¹ 4-2" class="headerlink" title="ç»ƒä¹ 4.2"></a>ç»ƒä¹ 4.2</h2><p>æ ¹æ®4.12èŠ‚ä¸­çš„è¡¨ï¼Œåœ¨ä¸‹è¿°è¡¨è¾¾å¼çš„åˆç†ä½ç½®æ·»åŠ æ‹¬å·ï¼Œä½¿å¾—æ·»åŠ æ‹¬å·åè¿ç®—å¯¹è±¡çš„ç»„åˆé¡ºåºä¸æ·»åŠ æ‹¬å·å‰ä¸€è‡´ã€‚<br>(a) <code>*vec.begin()</code><br>(b) <code>*vec.begin() + 1</code></p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">*</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-3"><a href="#ç»ƒä¹ 4-3" class="headerlink" title="ç»ƒä¹ 4.3"></a>ç»ƒä¹ 4.3</h2><p>C++è¯­è¨€æ²¡æœ‰æ˜ç¡®è§„å®šå¤§å¤šæ•°äºŒå…ƒè¿ç®—ç¬¦çš„æ±‚å€¼é¡ºåºï¼Œç»™ç¼–è¯‘å™¨ä¼˜åŒ–ç•™ä¸‹äº†ä½™åœ°ã€‚è¿™ç§ç­–ç•¥å®é™…ä¸Šæ˜¯åœ¨ä»£ç ç”Ÿæˆæ•ˆç‡å’Œç¨‹åºæ½œåœ¨ç¼ºé™·ä¹‹é—´è¿›è¡Œäº†æƒè¡¡ï¼Œä½ è®¤ä¸ºè¿™å¯ä»¥æ¥å—å—ï¼Ÿè¯·è¯´å‡ºä½ çš„ç†ç”±ã€‚</p><p>è§£ï¼š</p><p>å¯ä»¥æ¥å—ã€‚C++çš„è®¾è®¡æ€æƒ³æ˜¯å°½å¯èƒ½åœ°â€œç›¸ä¿¡â€ç¨‹åºå‘˜ï¼Œå°†æ•ˆç‡æœ€å¤§åŒ–ã€‚ç„¶è€Œè¿™ç§æ€æƒ³å´æœ‰ç€æ½œåœ¨çš„å±å®³ï¼Œå°±æ˜¯æ— æ³•æ§åˆ¶ç¨‹åºå‘˜è‡ªèº«å¼•å‘çš„é”™è¯¯ã€‚å› æ­¤ Java çš„è¯ç”Ÿä¹Ÿæ˜¯å¿…ç„¶ï¼ŒJavaçš„æ€æƒ³å°±æ˜¯å°½å¯èƒ½åœ°â€œä¸ç›¸ä¿¡â€ç¨‹åºå‘˜ã€‚</p><h2 id="ç»ƒä¹ 4-4"><a href="#ç»ƒä¹ 4-4" class="headerlink" title="ç»ƒä¹ 4.4"></a>ç»ƒä¹ 4.4</h2><p>åœ¨ä¸‹é¢çš„è¡¨è¾¾å¼ä¸­æ·»åŠ æ‹¬å·ï¼Œè¯´æ˜å…¶æ±‚å€¼è¿‡ç¨‹åŠæœ€ç»ˆç»“æœã€‚ç¼–å†™ç¨‹åºç¼–è¯‘è¯¥ï¼ˆä¸åŠ æ‹¬å·çš„ï¼‰è¡¨è¾¾å¼å¹¶è¾“å‡ºç»“æœéªŒè¯ä¹‹å‰çš„æ¨æ–­ã€‚</p><p><code>12 / 3 * 4 + 5 * 15 + 24 % 4 / 2</code></p><p>è§£ï¼š</p><p><code>((12 / 3) * 4) + (5 * 15) + ((24 % 4) / 2) = 16 + 75 + 0 = 91</code></p><h2 id="ç»ƒä¹ 4-5"><a href="#ç»ƒä¹ 4-5" class="headerlink" title="ç»ƒä¹ 4.5"></a>ç»ƒä¹ 4.5</h2><p>å†™å‡ºä¸‹åˆ—è¡¨è¾¾å¼çš„æ±‚å€¼ç»“æœã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">-</span><span class="token number">30</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">21</span> <span class="token operator">/</span> <span class="token number">5</span>  <span class="token comment">// -90+4 = -86</span><span class="token operator">-</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">21</span> <span class="token operator">/</span> <span class="token number">5</span>  <span class="token comment">// -30+63/5 = -30+12 = -18</span><span class="token number">30</span> <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">21</span> <span class="token operator">%</span> <span class="token number">5</span>   <span class="token comment">// 10*21%5 = 210%5 = 0</span><span class="token operator">-</span><span class="token number">30</span> <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">21</span> <span class="token operator">%</span> <span class="token number">4</span>  <span class="token comment">// -10*21%4 = -210%4 = -2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-6"><a href="#ç»ƒä¹ 4-6" class="headerlink" title="ç»ƒä¹ 4.6"></a>ç»ƒä¹ 4.6</h2><p>å†™å‡ºä¸€æ¡è¡¨è¾¾å¼ç”¨äºç¡®å®šä¸€ä¸ªæ•´æ•°æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">/* ... */</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token comment">/* ... */</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-7"><a href="#ç»ƒä¹ 4-7" class="headerlink" title="ç»ƒä¹ 4.7"></a>ç»ƒä¹ 4.7</h2><p>æº¢å‡ºæ˜¯ä½•å«ä¹‰ï¼Ÿå†™å‡ºä¸‰æ¡å°†å¯¼è‡´æº¢å‡ºçš„è¡¨è¾¾å¼ã€‚</p><p>è§£ï¼š</p><p>å½“è®¡ç®—çš„ç»“æœè¶…å‡ºè¯¥ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´æ—¶å°±ä¼šäº§ç”Ÿæº¢å‡ºã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">short</span> svalue <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">;</span> <span class="token operator">++</span>svalue<span class="token punctuation">;</span> <span class="token comment">// -32768</span><span class="token keyword">unsigned</span> uivalue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>uivalue<span class="token punctuation">;</span>  <span class="token comment">// 4294967295</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span> usvalue <span class="token operator">=</span> <span class="token number">65535</span><span class="token punctuation">;</span> <span class="token operator">++</span>usvalue<span class="token punctuation">;</span>  <span class="token comment">// 0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-8"><a href="#ç»ƒä¹ 4-8" class="headerlink" title="ç»ƒä¹ 4.8"></a>ç»ƒä¹ 4.8</h2><p>è¯´æ˜åœ¨é€»è¾‘ä¸ã€é€»è¾‘æˆ–åŠç›¸ç­‰æ€§è¿ç®—ç¬¦ä¸­è¿ç®—å¯¹è±¡çš„æ±‚å€¼é¡ºåºã€‚</p><p>è§£ï¼š</p><ul><li>é€»è¾‘ä¸è¿ç®—ç¬¦å’Œé€»è¾‘æˆ–è¿ç®—ç¬¦éƒ½æ˜¯å…ˆæ±‚å·¦ä¾§è¿ç®—å¯¹è±¡çš„å€¼å†æ±‚å³ä¾§è¿ç®—å¯¹è±¡çš„å€¼ï¼Œå½“ä¸”ä»…å½“å·¦ä¾§è¿ç®—å¯¹è±¡æ— æ³•ç¡®å®šè¡¨è¾¾å¼çš„ç»“æœæ—¶æ‰ä¼šè®¡ç®—å³ä¾§è¿ç®—å¯¹è±¡çš„å€¼ã€‚è¿™ç§ç­–ç•¥ç§°ä¸º <strong>çŸ­è·¯æ±‚å€¼</strong>ã€‚</li><li>ç›¸ç­‰æ€§è¿ç®—ç¬¦æœªå®šä¹‰æ±‚å€¼é¡ºåºã€‚</li></ul><h2 id="ç»ƒä¹ 4-9"><a href="#ç»ƒä¹ 4-9" class="headerlink" title="ç»ƒä¹ 4.9"></a>ç»ƒä¹ 4.9</h2><p>è§£é‡Šåœ¨ä¸‹é¢çš„<code>if</code>è¯­å¥ä¸­æ¡ä»¶éƒ¨åˆ†çš„åˆ¤æ–­è¿‡ç¨‹ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cp <span class="token operator">=</span> <span class="token string">"Hello World"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>cp <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>cp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>é¦–å…ˆåˆ¤æ–­<code>cp</code>ï¼Œ<code>cp</code> ä¸æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œå› æ­¤<code>cp</code>ä¸ºçœŸã€‚ç„¶ååˆ¤æ–­<code>*cp</code>ï¼Œ<code>*cp</code> çš„å€¼æ˜¯å­—ç¬¦<code>&#39;H&#39;</code>ï¼Œé0ã€‚å› æ­¤æœ€åçš„ç»“æœä¸ºçœŸã€‚</p><h2 id="ç»ƒä¹ 4-10"><a href="#ç»ƒä¹ 4-10" class="headerlink" title="ç»ƒä¹ 4.10"></a>ç»ƒä¹ 4.10</h2><p>ä¸º<code>while</code>å¾ªç¯å†™ä¸€ä¸ªæ¡ä»¶ï¼Œä½¿å…¶ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•´æ•°ï¼Œé‡åˆ°<code>42</code>æ—¶åœæ­¢ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> i <span class="token operator">&amp;&amp;</span> i <span class="token operator">!=</span> <span class="token number">42</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-11"><a href="#ç»ƒä¹ 4-11" class="headerlink" title="ç»ƒä¹ 4.11"></a>ç»ƒä¹ 4.11</h2><p>ä¹¦å†™ä¸€æ¡è¡¨è¾¾å¼ç”¨äºæµ‹è¯•4ä¸ªå€¼aã€bã€cã€dçš„å…³ç³»ï¼Œç¡®ä¿aå¤§äºbã€bå¤§äºcã€cå¤§äºdã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">a<span class="token operator">></span>b <span class="token operator">&amp;&amp;</span> b<span class="token operator">></span>c <span class="token operator">&amp;&amp;</span> c<span class="token operator">></span>d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-12"><a href="#ç»ƒä¹ 4-12" class="headerlink" title="ç»ƒä¹ 4.12"></a>ç»ƒä¹ 4.12</h2><p>å‡è®¾<code>i</code>ã€<code>j</code>å’Œ<code>k</code>æ˜¯ä¸‰ä¸ªæ•´æ•°ï¼Œè¯´æ˜è¡¨è¾¾å¼<code>i != j &lt; k</code>çš„å«ä¹‰ã€‚</p><p>è§£ï¼š</p><p>è¿™ä¸ªè¡¨è¾¾å¼ç­‰äº<code>i != (j &lt; k)</code>ã€‚é¦–å…ˆå¾—åˆ°<code>j &lt; k</code>çš„ç»“æœä¸º<code>true</code>æˆ–<code>false</code>ï¼Œè½¬æ¢ä¸ºæ•´æ•°å€¼æ˜¯<code>1</code>æˆ–<code>0</code>ï¼Œç„¶ååˆ¤æ–­<code>i</code>ä¸ç­‰äº<code>1</code>æˆ–<code>0</code> ï¼Œæœ€ç»ˆçš„ç»“æœä¸º<code>bool</code>å€¼ã€‚</p><h2 id="ç»ƒä¹ 4-13"><a href="#ç»ƒä¹ 4-13" class="headerlink" title="ç»ƒä¹ 4.13"></a>ç»ƒä¹ 4.13</h2><p>åœ¨ä¸‹è¿°è¯­å¥ä¸­ï¼Œå½“èµ‹å€¼å®Œæˆå i å’Œ d çš„å€¼åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">;</span>   <span class="token keyword">double</span> d<span class="token punctuation">;</span>d <span class="token operator">=</span> i <span class="token operator">=</span> <span class="token number">3.5</span><span class="token punctuation">;</span> <span class="token comment">// i = 3, d = 3.0</span>i <span class="token operator">=</span> d <span class="token operator">=</span> <span class="token number">3.5</span><span class="token punctuation">;</span> <span class="token comment">// d = 3.5, i = 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-14"><a href="#ç»ƒä¹ 4-14" class="headerlink" title="ç»ƒä¹ 4.14"></a>ç»ƒä¹ 4.14</h2><p>æ‰§è¡Œä¸‹è¿° if è¯­å¥åå°†å‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">42</span> <span class="token operator">=</span> i<span class="token punctuation">)</span>   <span class="token comment">// ç¼–è¯‘é”™è¯¯ã€‚èµ‹å€¼è¿ç®—ç¬¦å·¦ä¾§å¿…é¡»æ˜¯ä¸€ä¸ªå¯ä¿®æ”¹çš„å·¦å€¼ã€‚è€Œå­—é¢å€¼æ˜¯å³å€¼ã€‚</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>   <span class="token comment">// true.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-15"><a href="#ç»ƒä¹ 4-15" class="headerlink" title="ç»ƒä¹ 4.15"></a>ç»ƒä¹ 4.15</h2><p>ä¸‹é¢çš„èµ‹å€¼æ˜¯éæ³•çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> dval<span class="token punctuation">;</span> <span class="token keyword">int</span> ival<span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token operator">*</span>pi<span class="token punctuation">;</span>dval <span class="token operator">=</span> ival <span class="token operator">=</span> pi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š<br><code>p</code>æ˜¯æŒ‡é’ˆï¼Œä¸èƒ½èµ‹å€¼ç»™<code>int</code>ï¼Œåº”è¯¥æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">dval <span class="token operator">=</span> ival <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>pi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-16"><a href="#ç»ƒä¹ 4-16" class="headerlink" title="ç»ƒä¹ 4.16"></a>ç»ƒä¹ 4.16</h2><p>å°½ç®¡ä¸‹é¢çš„è¯­å¥åˆæ³•ï¼Œä½†å®ƒä»¬å®é™…æ‰§è¡Œçš„è¡Œä¸ºå¯èƒ½å’Œé¢„æœŸå¹¶ä¸ä¸€æ ·ï¼Œä¸ºä»€ä¹ˆï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token function">getPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token function">getPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-17"><a href="#ç»ƒä¹ 4-17" class="headerlink" title="ç»ƒä¹ 4.17"></a>ç»ƒä¹ 4.17</h2><p>è¯´æ˜å‰ç½®é€’å¢è¿ç®—ç¬¦å’Œåç½®é€’å¢è¿ç®—ç¬¦çš„åŒºåˆ«ã€‚</p><p>è§£ï¼š</p><p>å‰ç½®é€’å¢è¿ç®—ç¬¦å°†å¯¹è±¡æœ¬èº«ä½œä¸ºå·¦å€¼è¿”å›ï¼Œè€Œåç½®é€’å¢è¿ç®—ç¬¦å°†å¯¹è±¡åŸå§‹å€¼çš„å‰¯æœ¬ä½œä¸ºå³å€¼è¿”å›ã€‚</p><h2 id="ç»ƒä¹ 4-18"><a href="#ç»ƒä¹ 4-18" class="headerlink" title="ç»ƒä¹ 4.18"></a>ç»ƒä¹ 4.18</h2><p>å¦‚æœ132é¡µé‚£ä¸ªè¾“å‡º<code>vector</code>å¯¹è±¡å…ƒç´ çš„<code>while</code>å¾ªç¯ä½¿ç”¨å‰ç½®é€’å¢è¿ç®—ç¬¦ï¼Œå°†å¾—åˆ°ä»€ä¹ˆç»“æœï¼Ÿ</p><p>è§£ï¼š</p><p>å°†ä¼šä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹å–å€¼ï¼Œå¹¶ä¸”æœ€åå¯¹<code>v.end()</code>è¿›è¡Œå–å€¼ï¼Œç»“æœæ˜¯æœªå®šä¹‰çš„ã€‚</p><h2 id="ç»ƒä¹ 4-19"><a href="#ç»ƒä¹ 4-19" class="headerlink" title="ç»ƒä¹ 4.19"></a>ç»ƒä¹ 4.19</h2><p>å‡è®¾<code>ptr</code>çš„ç±»å‹æ˜¯æŒ‡å‘<code>int</code>çš„æŒ‡é’ˆã€<code>vec</code>çš„ç±»å‹æ˜¯<code>vector</code>ã€<code>ival</code>çš„ç±»å‹æ˜¯<code>int</code>ï¼Œè¯´æ˜ä¸‹é¢çš„è¡¨è¾¾å¼æ˜¯ä½•å«ä¹‰ï¼Ÿå¦‚æœæœ‰è¡¨è¾¾å¼ä¸æ­£ç¡®ï¼Œä¸ºä»€ä¹ˆï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> ptr <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>ptr<span class="token operator">++</span>  <span class="token punctuation">(</span>b<span class="token punctuation">)</span> ival<span class="token operator">++</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ival</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> vec<span class="token punctuation">[</span>ival<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> vec<span class="token punctuation">[</span>ival<span class="token punctuation">]</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) åˆ¤æ–­<code>ptr</code>ä¸æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œå¹¶ä¸”<code>ptr</code>å½“å‰æŒ‡å‘çš„å…ƒç´ çš„å€¼ä¹Ÿä¸ºçœŸï¼Œç„¶åå°†<code>ptr</code>æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ </li><li>(b) åˆ¤æ–­<code>ival</code>çš„å€¼ä¸ºçœŸï¼Œå¹¶ä¸”<code>(ival + 1)</code>çš„å€¼ä¹Ÿä¸ºçœŸ</li><li>(c) è¡¨è¾¾å¼æœ‰è¯¯ã€‚C++å¹¶æ²¡æœ‰è§„å®š<code>&lt;=</code>è¿ç®—ç¬¦ä¸¤è¾¹çš„æ±‚å€¼é¡ºåºï¼Œåº”è¯¥æ”¹ä¸º<code>vec[ival] &lt;= vec[ival+1]</code></li></ul><h2 id="ç»ƒä¹ 4-20"><a href="#ç»ƒä¹ 4-20" class="headerlink" title="ç»ƒä¹ 4.20"></a>ç»ƒä¹ 4.20</h2><p>å‡è®¾<code>iter</code>çš„ç±»å‹æ˜¯<code>vector::iterator</code>, è¯´æ˜ä¸‹é¢çš„è¡¨è¾¾å¼æ˜¯å¦åˆæ³•ã€‚å¦‚æœåˆæ³•ï¼Œè¡¨è¾¾å¼çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œé”™åœ¨ä½•å¤„ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">*</span>iter<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">*</span>iter<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> iter<span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">++</span><span class="token operator">*</span>iter<span class="token punctuation">;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> iter<span class="token operator">++</span><span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a)åˆæ³•ã€‚è¿”å›è¿­ä»£å™¨æ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œç„¶åè¿­ä»£å™¨é€’å¢ã€‚</li><li>(b)ä¸åˆæ³•ã€‚å› ä¸º<code>vector</code>å…ƒç´ ç±»å‹æ˜¯<code>string</code>ï¼Œæ²¡æœ‰<code>++</code>æ“ä½œã€‚</li><li>(c)ä¸åˆæ³•ã€‚è¿™é‡Œåº”è¯¥åŠ æ‹¬å·ã€‚</li><li>(d)åˆæ³•ã€‚åˆ¤æ–­è¿­ä»£å™¨å½“å‰çš„å…ƒç´ æ˜¯å¦ä¸ºç©ºã€‚</li><li>(e)ä¸åˆæ³•ã€‚<code>string</code>ç±»å‹æ²¡æœ‰<code>++</code>æ“ä½œã€‚</li><li>(f)åˆæ³•ã€‚åˆ¤æ–­è¿­ä»£å™¨å½“å‰å…ƒç´ æ˜¯å¦ä¸ºç©ºï¼Œç„¶åè¿­ä»£å™¨é€’å¢ã€‚</li></ul><h2 id="ç»ƒä¹ 4-21"><a href="#ç»ƒä¹ 4-21" class="headerlink" title="ç»ƒä¹ 4.21"></a>ç»ƒä¹ 4.21</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦ä»<code>vector</code>ä¸­æ‰¾åˆ°å“ªäº›å…ƒç´ çš„å€¼æ˜¯å¥‡æ•°ï¼Œç„¶åå°†è¿™äº›å¥‡æ•°å€¼ç¿»å€ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> ivec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span> <span class="token operator">?</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">:</span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-22"><a href="#ç»ƒä¹ 4-22" class="headerlink" title="ç»ƒä¹ 4.22"></a>ç»ƒä¹ 4.22</h2><p>æœ¬èŠ‚çš„ç¤ºä¾‹ç¨‹åºå°†æˆç»©åˆ’åˆ†ä¸º<code>high pass</code>ã€<code>pass</code> å’Œ <code>fail</code> ä¸‰ç§ï¼Œæ‰©å±•è¯¥ç¨‹åºä½¿å…¶è¿›ä¸€æ­¥å°† 60 åˆ†åˆ° 75 åˆ†ä¹‹é—´çš„æˆç»©è®¾å®šä¸º<code>low pass</code>ã€‚è¦æ±‚ç¨‹åºåŒ…å«ä¸¤ä¸ªç‰ˆæœ¬ï¼šä¸€ä¸ªç‰ˆæœ¬åªä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦ï¼›å¦ä¸€ä¸ªç‰ˆæœ¬ä½¿ç”¨1ä¸ªæˆ–å¤šä¸ª<code>if</code>è¯­å¥ã€‚å“ªä¸ªç‰ˆæœ¬çš„ç¨‹åºæ›´å®¹æ˜“ç†è§£å‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> g<span class="token punctuation">;</span> cin <span class="token operator">>></span> g<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> result <span class="token operator">=</span> g <span class="token operator">></span> <span class="token number">90</span> <span class="token operator">?</span> <span class="token string">"high pass"</span> <span class="token operator">:</span> g <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token operator">?</span> <span class="token string">"fail"</span> <span class="token operator">:</span> g <span class="token operator">&lt;</span> <span class="token number">75</span> <span class="token operator">?</span> <span class="token string">"low pass"</span> <span class="token operator">:</span> <span class="token string">"pass"</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> result <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// -------------------------</span><span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">></span> <span class="token number">90</span><span class="token punctuation">)</span>         cout <span class="token operator">&lt;&lt;</span> <span class="token string">"high pass"</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"fail"</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">&lt;</span> <span class="token number">75</span><span class="token punctuation">)</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"low pass"</span><span class="token punctuation">;</span><span class="token keyword">else</span>                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"pass"</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒä¸ªç‰ˆæœ¬å®¹æ˜“ç†è§£ã€‚å½“æ¡ä»¶è¿ç®—ç¬¦åµŒå¥—å±‚æ•°å˜å¤šä¹‹åï¼Œä»£ç çš„å¯è¯»æ€§æ€¥å‰§ä¸‹é™ã€‚è€Œ<code>if else</code>çš„é€»è¾‘å¾ˆæ¸…æ™°ã€‚</p><h2 id="ç»ƒä¹ 4-23"><a href="#ç»ƒä¹ 4-23" class="headerlink" title="ç»ƒä¹ 4.23"></a>ç»ƒä¹ 4.23</h2><p>å› ä¸ºè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é—®é¢˜ï¼Œä¸‹é¢è¿™æ¡è¡¨è¾¾å¼æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚æ ¹æ®4.12èŠ‚ä¸­çš„è¡¨æŒ‡å‡ºå®ƒçš„é—®é¢˜åœ¨å“ªé‡Œï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string s <span class="token operator">=</span> <span class="token string">"word"</span><span class="token punctuation">;</span>string pl <span class="token operator">=</span> s <span class="token operator">+</span> s<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'s'</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"s"</span> <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åŠ æ³•è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜äºæ¡ä»¶è¿ç®—ç¬¦ã€‚å› æ­¤è¦æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string pl <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'s'</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"s"</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-24"><a href="#ç»ƒä¹ 4-24" class="headerlink" title="ç»ƒä¹ 4.24"></a>ç»ƒä¹ 4.24</h2><p>æœ¬èŠ‚çš„ç¤ºä¾‹ç¨‹åºå°†æˆç»©åˆ’åˆ†ä¸º<code>high pass</code>ã€<code>pass</code>ã€å’Œ<code>fail</code>ä¸‰ç§ï¼Œå®ƒçš„ä¾æ®æ˜¯æ¡ä»¶è¿ç®—ç¬¦æ»¡è¶³å³ç»“åˆå¾‹ã€‚å‡å¦‚æ¡ä»¶è¿ç®—ç¬¦æ»¡è¶³çš„æ˜¯å·¦ç»“åˆå¾‹ï¼Œæ±‚å€¼çš„è¿‡ç¨‹å°†æ˜¯æ€æ ·çš„ï¼Ÿ</p><p>è§£ï¼š</p><p>å¦‚æœæ¡ä»¶è¿ç®—ç¬¦æ»¡è¶³çš„æ˜¯å·¦ç»“åˆå¾‹ã€‚é‚£ä¹ˆ</p><p><code>finalgrade = (grade &gt; 90) ? &quot;high pass&quot; : (grade &lt; 60) ? &quot;fail&quot; : &quot;pass&quot;;</code><br>ç­‰åŒäº<br><code>finalgrade = ((grade &gt; 90) ? &quot;high pass&quot; : (grade &lt; 60)) ? &quot;fail&quot; : &quot;pass&quot;;</code><br>å‡å¦‚æ­¤æ—¶ <code>grade &gt; 90</code> ï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„ç»“æœæ˜¯ <code>&quot;high pass&quot;</code> ï¼Œè€Œå­—ç¬¦ä¸²å­—é¢å€¼çš„ç±»å‹æ˜¯ <code>const char *</code>ï¼Œéç©ºæ‰€ä»¥ä¸ºçœŸã€‚å› æ­¤ç¬¬äºŒä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„ç»“æœæ˜¯ <code>&quot;fail&quot;</code>ã€‚è¿™æ ·å°±å‡ºç°äº†è‡ªç›¸çŸ›ç›¾çš„é€»è¾‘ã€‚</p><h2 id="ç»ƒä¹ 4-25"><a href="#ç»ƒä¹ 4-25" class="headerlink" title="ç»ƒä¹ 4.25"></a>ç»ƒä¹ 4.25</h2><p>å¦‚æœä¸€å°æœºå™¨ä¸Š<code>int</code>å 32ä½ã€<code>char</code>å 8ä½ï¼Œç”¨çš„æ˜¯<code>Latin-1</code>å­—ç¬¦é›†ï¼Œå…¶ä¸­å­—ç¬¦<code>&#39;q&#39;</code> çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯<code>01110001</code>ï¼Œé‚£ä¹ˆè¡¨è¾¾å¼<code>~&#39;q&#39; &lt;&lt; 6</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>é¦–å…ˆå°†<code>char</code>ç±»å‹æå‡ä¸º<code>int</code>ç±»å‹ï¼Œå³<code>00000000 00000000 00000000 01110001</code>ï¼Œç„¶åå–åï¼Œå†å·¦ç§»6ä½ï¼Œç»“æœæ˜¯-7296ã€‚</p><h2 id="ç»ƒä¹ 4-26"><a href="#ç»ƒä¹ 4-26" class="headerlink" title="ç»ƒä¹ 4.26"></a>ç»ƒä¹ 4.26</h2><p>åœ¨æœ¬èŠ‚å…³äºæµ‹éªŒæˆç»©çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä½¿ç”¨<code>unsigned int</code> ä½œä¸º<code>quiz1</code> çš„ç±»å‹ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><p>è§£ï¼š</p><p>åœ¨æœ‰çš„æœºå™¨ä¸Šï¼Œ<code>unsigned int</code> ç±»å‹å¯èƒ½åªæœ‰ 16 ä½ï¼Œå› æ­¤ç»“æœæ˜¯æœªå®šä¹‰çš„ã€‚</p><h2 id="ç»ƒä¹ 4-27"><a href="#ç»ƒä¹ 4-27" class="headerlink" title="ç»ƒä¹ 4.27"></a>ç»ƒä¹ 4.27</h2><p>ä¸‹åˆ—è¡¨è¾¾å¼çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> <span class="token keyword">long</span> ul1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> ul2 <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> ul1 <span class="token operator">&amp;</span> <span class="token function">ul2</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> ul1 <span class="token operator">|</span> <span class="token function">ul2</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> ul1 <span class="token operator">&amp;&amp;</span> <span class="token function">ul2</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> ul1 <span class="token operator">||</span> ul2 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) 3</li><li>(b) 7</li><li>(c) true</li><li>(d) ture</li></ul><h2 id="ç»ƒä¹ 4-28"><a href="#ç»ƒä¹ 4-28" class="headerlink" title="ç»ƒä¹ 4.28"></a>ç»ƒä¹ 4.28</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œè¾“å‡ºæ¯ä¸€ç§å†…ç½®ç±»å‹æ‰€å ç©ºé—´çš„å¤§å°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span> </span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"bool:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"char:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"wchar_t:\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">wchar_t</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"char16_t:\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char16_t</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"char32_t:\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char32_t</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"short:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"int:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"long:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"long long:\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"float:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"double:\t\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"long double:\t"</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" bytes"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">bool:           1 byteschar:           1 byteswchar_t:        4 byteschar16_t:       2 byteschar32_t:       4 bytesshort:          2 bytesint:            4 byteslong:           8 byteslong long:      8 bytesfloat:          4 bytesdouble:         8 byteslong double:    16 bytes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-29"><a href="#ç»ƒä¹ 4-29" class="headerlink" title="ç»ƒä¹ 4.29"></a>ç»ƒä¹ 4.29</h2><p>æ¨æ–­ä¸‹é¢ä»£ç çš„è¾“å‡ºç»“æœå¹¶è¯´æ˜ç†ç”±ã€‚å®é™…è¿è¡Œè¿™æ®µç¨‹åºï¼Œç»“æœå’Œä½ æƒ³è±¡çš„ä¸€æ ·å—ï¼Ÿå¦‚ä¸ä¸€æ ·ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> x<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> x<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç¬¬ä¸€ä¸ªè¾“å‡ºç»“æœæ˜¯ 10ã€‚ç¬¬äºŒä¸ªç»“æœ1,æ­¤å¤„ç”¨æ³•ä¸åˆç†ä¸æ˜¯æœªå®šä¹‰ï¼Œå‚è€ƒ<a href="https://www.geeksforgeeks.org/using-sizof-operator-with-array-paratmeters/%E3%80%82">https://www.geeksforgeeks.org/using-sizof-operator-with-array-paratmeters/ã€‚</a></p><h2 id="ç»ƒä¹ 4-30"><a href="#ç»ƒä¹ 4-30" class="headerlink" title="ç»ƒä¹ 4.30"></a>ç»ƒä¹ 4.30</h2><p>æ ¹æ®4.12èŠ‚ä¸­çš„è¡¨ï¼Œåœ¨ä¸‹è¿°è¡¨è¾¾å¼çš„é€‚å½“ä½ç½®åŠ ä¸Šæ‹¬å·ï¼Œä½¿å¾—åŠ ä¸Šæ‹¬å·ä¹‹åçš„è¡¨è¾¾å¼çš„å«ä¹‰ä¸åŸæ¥çš„å«ä¹‰ç›¸åŒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">sizeof</span> x <span class="token operator">+</span> <span class="token function">y</span>      <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">sizeof</span> p<span class="token operator">-></span>mem<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">sizeof</span> a <span class="token operator">&lt;</span> <span class="token function">b</span>     <span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">sizeof</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">sizeof</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">y</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token operator">-></span>mem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">b</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-31"><a href="#ç»ƒä¹ 4-31" class="headerlink" title="ç»ƒä¹ 4.31"></a>ç»ƒä¹ 4.31</h2><p>æœ¬èŠ‚çš„ç¨‹åºä½¿ç”¨äº†å‰ç½®ç‰ˆæœ¬çš„é€’å¢è¿ç®—ç¬¦å’Œé€’å‡è¿ç®—ç¬¦ï¼Œè§£é‡Šä¸ºä»€ä¹ˆè¦ç”¨å‰ç½®ç‰ˆæœ¬è€Œä¸ç”¨åç½®ç‰ˆæœ¬ã€‚è¦æƒ³ä½¿ç”¨åç½®ç‰ˆæœ¬çš„é€’å¢é€’å‡è¿ç®—ç¬¦éœ€è¦åšå“ªäº›æ”¹åŠ¨ï¼Ÿä½¿ç”¨åç½®ç‰ˆæœ¬é‡å†™æœ¬èŠ‚çš„ç¨‹åºã€‚</p><p>è§£ï¼š</p><p>åœ¨4.5èŠ‚ï¼ˆ132é¡µï¼‰å·²ç»è¯´è¿‡äº†ï¼Œé™¤éå¿…é¡»ï¼Œå¦åˆ™ä¸ç”¨é€’å¢é€’å‡è¿ç®—ç¬¦çš„åç½®ç‰ˆæœ¬ã€‚åœ¨è¿™é‡Œè¦ä½¿ç”¨åè€…ç‰ˆæœ¬çš„é€’å¢é€’å‡è¿ç®—ç¬¦ä¸éœ€è¦ä»»ä½•æ”¹åŠ¨ã€‚</p><h2 id="ç»ƒä¹ 4-32"><a href="#ç»ƒä¹ 4-32" class="headerlink" title="ç»ƒä¹ 4.32"></a>ç»ƒä¹ 4.32</h2><p>è§£é‡Šä¸‹é¢è¿™ä¸ªå¾ªç¯çš„å«ä¹‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">constexpr</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token keyword">int</span> ia<span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> ia<span class="token punctuation">,</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    ix <span class="token operator">!=</span> size <span class="token operator">&amp;&amp;</span> ptr <span class="token operator">!=</span> ia<span class="token operator">+</span>size<span class="token punctuation">;</span>    <span class="token operator">++</span>ix<span class="token punctuation">,</span> <span class="token operator">++</span>ptr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¿™ä¸ªå¾ªç¯åœ¨éå†æ•°ç»„<code>ia</code>ï¼ŒæŒ‡é’ˆ<code>ptr</code>å’Œæ•´å‹<code>ix</code>éƒ½æ˜¯èµ·åˆ°ä¸€ä¸ªå¾ªç¯è®¡æ•°çš„åŠŸèƒ½ã€‚</p><h2 id="ç»ƒä¹ 4-33"><a href="#ç»ƒä¹ 4-33" class="headerlink" title="ç»ƒä¹ 4.33"></a>ç»ƒä¹ 4.33</h2><p>æ ¹æ®4.12èŠ‚ä¸­çš„è¡¨è¯´æ˜ä¸‹é¢è¿™æ¡è¡¨è¾¾å¼çš„å«ä¹‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">someValue <span class="token operator">?</span> <span class="token operator">++</span>x<span class="token punctuation">,</span> <span class="token operator">++</span>y <span class="token operator">:</span> <span class="token operator">--</span>x<span class="token punctuation">,</span> <span class="token operator">--</span>y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>é€—å·è¡¨è¾¾å¼çš„ä¼˜å…ˆçº§æ˜¯æœ€ä½çš„ã€‚å› æ­¤è¿™æ¡è¡¨è¾¾å¼ä¹Ÿç­‰äºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>someValue <span class="token operator">?</span> <span class="token operator">++</span>x<span class="token punctuation">,</span> <span class="token operator">++</span>y <span class="token operator">:</span> <span class="token operator">--</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">--</span>y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœ<code>someValue</code>çš„å€¼ä¸ºçœŸï¼Œ<code>x</code> å’Œ <code>y</code> çš„å€¼éƒ½è‡ªå¢å¹¶è¿”å› <code>y</code> å€¼ï¼Œç„¶åä¸¢å¼ƒ<code>y</code>å€¼ï¼Œ<code>y</code>é€’å‡å¹¶è¿”å›<code>y</code>å€¼ã€‚å¦‚æœ<code>someValue</code>çš„å€¼ä¸ºå‡ï¼Œ<code>x</code> é€’å‡å¹¶è¿”å›<code>x</code> å€¼ï¼Œç„¶åä¸¢å¼ƒ<code>x</code>å€¼ï¼Œ<code>y</code>é€’å‡å¹¶è¿”å›<code>y</code>å€¼ã€‚</p><h2 id="ç»ƒä¹ 4-34"><a href="#ç»ƒä¹ 4-34" class="headerlink" title="ç»ƒä¹ 4.34"></a>ç»ƒä¹ 4.34</h2><p>æ ¹æ®æœ¬èŠ‚ç»™å‡ºçš„å˜é‡å®šä¹‰ï¼Œè¯´æ˜åœ¨ä¸‹é¢çš„è¡¨è¾¾å¼ä¸­å°†å‘ç”Ÿä»€ä¹ˆæ ·çš„ç±»å‹è½¬æ¢ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fval<span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> dval <span class="token operator">=</span> fval <span class="token operator">+</span> ival<span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> dval <span class="token operator">+</span> ival <span class="token operator">*</span> cval<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„æ¯ç§è¿ç®—ç¬¦éµå¾ªçš„æ˜¯å·¦ç»“åˆå¾‹è¿˜æ˜¯å³ç»“åˆå¾‹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> fval è½¬æ¢ä¸º <span class="token keyword">bool</span> ç±»å‹<span class="token punctuation">(</span>b<span class="token punctuation">)</span> ival è½¬æ¢ä¸º <span class="token keyword">float</span> ï¼Œç›¸åŠ çš„ç»“æœè½¬æ¢ä¸º <span class="token keyword">double</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> cval è½¬æ¢ä¸º <span class="token keyword">int</span>ï¼Œç„¶åç›¸ä¹˜çš„ç»“æœè½¬æ¢ä¸º <span class="token keyword">double</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-35"><a href="#ç»ƒä¹ 4-35" class="headerlink" title="ç»ƒä¹ 4.35"></a>ç»ƒä¹ 4.35</h2><p>å‡è®¾æœ‰å¦‚ä¸‹çš„å®šä¹‰ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> cval<span class="token punctuation">;</span><span class="token keyword">int</span> ival<span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> ui<span class="token punctuation">;</span><span class="token keyword">float</span> fval<span class="token punctuation">;</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯·å›ç­”åœ¨ä¸‹é¢çš„è¡¨è¾¾å¼ä¸­å‘ç”Ÿäº†éšå¼ç±»å‹è½¬æ¢å—ï¼Ÿå¦‚æœæœ‰ï¼ŒæŒ‡å‡ºæ¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> cval <span class="token operator">=</span> <span class="token string">'a'</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> fval <span class="token operator">=</span> ui <span class="token operator">-</span> ival <span class="token operator">*</span> <span class="token number">1.0</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> dval <span class="token operator">=</span> ui <span class="token operator">*</span> fval<span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> cval <span class="token operator">=</span> ival <span class="token operator">+</span> fval <span class="token operator">+</span> dval<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) <code>&#39;a&#39;</code> è½¬æ¢ä¸º <code>int</code> ï¼Œç„¶åä¸ <code>3</code> ç›¸åŠ çš„ç»“æœè½¬æ¢ä¸º <code>char</code></li><li>(b) <code>ival</code> è½¬æ¢ä¸º <code>double</code>ï¼Œ<code>ui</code> è½¬æ¢ä¸º <code>double</code>ï¼Œç»“æœè½¬æ¢ä¸º <code>float</code></li><li>(c) <code>ui</code> è½¬æ¢ä¸º <code>float</code>ï¼Œç»“æœè½¬æ¢ä¸º <code>double</code></li><li>(d) <code>ival</code> è½¬æ¢ä¸º <code>float</code>ï¼Œä¸<code>fval</code>ç›¸åŠ åçš„ç»“æœè½¬æ¢ä¸º <code>double</code>ï¼Œæœ€åçš„ç»“æœè½¬æ¢ä¸º<code>char</code></li></ul><h2 id="ç»ƒä¹ 4-36"><a href="#ç»ƒä¹ 4-36" class="headerlink" title="ç»ƒä¹ 4.36"></a>ç»ƒä¹ 4.36</h2><p>å‡è®¾ <code>i</code> æ˜¯<code>int</code>ç±»å‹ï¼Œ<code>d</code> æ˜¯<code>double</code>ç±»å‹ï¼Œä¹¦å†™è¡¨è¾¾å¼ <code>i*=d</code> ä½¿å…¶æ‰§è¡Œæ•´æ•°ç±»å‹çš„ä¹˜æ³•è€Œéæµ®ç‚¹ç±»å‹çš„ä¹˜æ³•ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">i <span class="token operator">*=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-37"><a href="#ç»ƒä¹ 4-37" class="headerlink" title="ç»ƒä¹ 4.37"></a>ç»ƒä¹ 4.37</h2><p>ç»ƒä¹ 4.37<br>ç”¨å‘½åçš„å¼ºåˆ¶ç±»å‹è½¬æ¢æ”¹å†™ä¸‹åˆ—æ—§å¼çš„è½¬æ¢è¯­å¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token keyword">double</span> d<span class="token punctuation">;</span> <span class="token keyword">const</span> string <span class="token operator">*</span>ps<span class="token punctuation">;</span> <span class="token keyword">char</span> <span class="token operator">*</span>pc<span class="token punctuation">;</span> <span class="token keyword">void</span> <span class="token operator">*</span>pv<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> pv <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>ps<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> pv <span class="token operator">=</span> <span class="token operator">&amp;</span>d<span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> pc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>pv<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> pv <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const_cast</span><span class="token operator">&lt;</span>string<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">*</span>pc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> pv <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> pc <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 4-38"><a href="#ç»ƒä¹ 4-38" class="headerlink" title="ç»ƒä¹ 4.38"></a>ç»ƒä¹ 4.38</h2><p>è¯´æ˜ä¸‹é¢è¿™æ¡è¡¨è¾¾å¼çš„å«ä¹‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> slope <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span><span class="token punctuation">(</span>j<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å°†<code>j/i</code>çš„ç»“æœå€¼è½¬æ¢ä¸º<code>double</code>ï¼Œç„¶åèµ‹å€¼ç»™<code>slope</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ8</title>
      <link href="2021/04/10/excersize/ch08/"/>
      <url>2021/04/10/excersize/ch08/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å…«ç« -IOåº“"><a href="#ç¬¬å…«ç« -IOåº“" class="headerlink" title="ç¬¬å…«ç«  IOåº“"></a>ç¬¬å…«ç«  IOåº“</h1><h2 id="ç»ƒä¹ 8-1"><a href="#ç»ƒä¹ 8-1" class="headerlink" title="ç»ƒä¹ 8.1"></a>ç»ƒä¹ 8.1</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª<code>istream&amp;</code>å‚æ•°ï¼Œè¿”å›å€¼ç±»å‹ä¹Ÿæ˜¯<code>istream&amp;</code>ã€‚æ­¤å‡½æ•°é¡»ä»ç»™å®šæµä¸­è¯»å–æ•°æ®ï¼Œç›´è‡³é‡åˆ°æ–‡ä»¶ç»“æŸæ ‡è¯†æ—¶åœæ­¢ã€‚å®ƒå°†è¯»å–çš„æ•°æ®æ‰“å°åœ¨æ ‡å‡†è¾“å‡ºä¸Šã€‚å®Œæˆè¿™äº›æ“ä½œåï¼Œåœ¨è¿”å›æµä¹‹å‰ï¼Œå¯¹æµè¿›è¡Œå¤ä½ï¼Œä½¿å…¶å¤„äºæœ‰æ•ˆçŠ¶æ€ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token function">func</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string buf<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>is <span class="token operator">>></span> buf<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    is<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-2"><a href="#ç»ƒä¹ 8-2" class="headerlink" title="ç»ƒä¹ 8.2"></a>ç»ƒä¹ 8.2</h2><blockquote><p>æµ‹è¯•å‡½æ•°ï¼Œè°ƒç”¨å‚æ•°ä¸º<code>cin</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>istream<span class="token punctuation">;</span>istream<span class="token operator">&amp;</span> <span class="token function">func</span><span class="token punctuation">(</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string buf<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>is <span class="token operator">>></span> buf<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    is<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    istream<span class="token operator">&amp;</span> is <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> is<span class="token punctuation">.</span><span class="token function">rdstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-3"><a href="#ç»ƒä¹ 8-3" class="headerlink" title="ç»ƒä¹ 8.3"></a>ç»ƒä¹ 8.3</h2><blockquote><p>ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä¸‹é¢çš„<code>while</code>å¾ªç¯ä¼šç»ˆæ­¢ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token comment">/*  ...    */</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å¦‚<code>badbit</code>ã€<code>failbit</code>ã€<code>eofbit</code> çš„ä»»ä¸€ä¸ªè¢«ç½®ä½ï¼Œé‚£ä¹ˆæ£€æµ‹æµçŠ¶æ€çš„æ¡ä»¶ä¼šå¤±è´¥ã€‚</p><h2 id="ç»ƒä¹ 8-4"><a href="#ç»ƒä¹ 8-4" class="headerlink" title="ç»ƒä¹ 8.4"></a>ç»ƒä¹ 8.4</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œä»¥è¯»æ¨¡å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå°†å…¶å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ª<code>string</code>çš„<code>vector</code>ä¸­ï¼Œå°†æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…ƒç´ å­˜äº<code>vector</code>ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">ReadFileToVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> fileName<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string buf<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">)</span>            vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-5"><a href="#ç»ƒä¹ 8-5" class="headerlink" title="ç»ƒä¹ 8.5"></a>ç»ƒä¹ 8.5</h2><blockquote><p>é‡å†™ä¸Šé¢çš„ç¨‹åºï¼Œå°†æ¯ä¸ªå•è¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å…ƒç´ è¿›è¡Œå­˜å‚¨ã€‚<br>è§£ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">ReadFileToVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> fileName<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ifs<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string buf<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>ifs <span class="token operator">>></span> buf<span class="token punctuation">)</span>            vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-6"><a href="#ç»ƒä¹ 8-6" class="headerlink" title="ç»ƒä¹ 8.6"></a>ç»ƒä¹ 8.6</h2><blockquote><p>é‡å†™7.1.1èŠ‚çš„ä¹¦åº—ç¨‹åºï¼Œä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–äº¤æ˜“è®°å½•ã€‚å°†æ–‡ä»¶åä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™<code>main</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../ch07/ex7_26.h"</span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">input</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> total<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> trans<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                <span class="token function">print</span><span class="token punctuation">(</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">print</span><span class="token punctuation">(</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-7"><a href="#ç»ƒä¹ 8-7" class="headerlink" title="ç»ƒä¹ 8.7"></a>ç»ƒä¹ 8.7</h2><blockquote><p>ä¿®æ”¹ä¸Šä¸€èŠ‚çš„ä¹¦åº—ç¨‹åºï¼Œå°†ç»“æœä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å°†è¾“å‡ºæ–‡ä»¶åä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™<code>main</code>å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../ch07/ex7_26.h"</span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ofstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">input</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ofstream <span class="token function">output</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> total<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> trans<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                <span class="token function">print</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">print</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-8"><a href="#ç»ƒä¹ 8-8" class="headerlink" title="ç»ƒä¹ 8.8"></a>ç»ƒä¹ 8.8</h2><blockquote><p>ä¿®æ”¹ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œå°†ç»“æœè¿½åŠ åˆ°ç»™å®šçš„æ–‡ä»¶æœ«å°¾ã€‚å¯¹åŒä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œè¿è¡Œç¨‹åºè‡³å°‘ä¸¤æ¬¡ï¼Œæ£€éªŒæ•°æ®æ˜¯å¦å¾—ä»¥ä¿ç•™ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../ch07/ex7_26.h"</span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ofstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">input</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ofstream <span class="token function">output</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ofstream<span class="token operator">::</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>        Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> total<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> trans<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                <span class="token function">print</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">print</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-9"><a href="#ç»ƒä¹ 8-9" class="headerlink" title="ç»ƒä¹ 8.9"></a>ç»ƒä¹ 8.9</h2><blockquote><p>ä½¿ç”¨ä½ ä¸º8.1.2èŠ‚ç¬¬ä¸€ä¸ªç»ƒä¹ æ‰€ç¼–å†™çš„å‡½æ•°æ‰“å°ä¸€ä¸ª<code>istringstream</code>å¯¹è±¡çš„å†…å®¹ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>istream<span class="token punctuation">;</span>istream<span class="token operator">&amp;</span> <span class="token function">func</span><span class="token punctuation">(</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string buf<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>is <span class="token operator">>></span> buf<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> buf <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    is<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>istringstream <span class="token function">iss</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">func</span><span class="token punctuation">(</span>iss<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-10"><a href="#ç»ƒä¹ 8-10" class="headerlink" title="ç»ƒä¹ 8.10"></a>ç»ƒä¹ 8.10</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œå°†æ¥è‡ªä¸€ä¸ªæ–‡ä»¶ä¸­çš„è¡Œä¿å­˜åœ¨ä¸€ä¸ª<code>vector</code>ä¸­ã€‚ç„¶åä½¿ç”¨ä¸€ä¸ª<code>istringstream</code>ä»<code>vector</code>è¯»å–æ•°æ®å…ƒç´ ï¼Œæ¯æ¬¡è¯»å–ä¸€ä¸ªå•è¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>istringstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"../data/book.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ifs<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        vector<span class="token operator">&lt;</span>string<span class="token operator">></span> vecLine<span class="token punctuation">;</span>    string line<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span>        vecLine<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>s <span class="token operator">:</span> vecLine<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        istringstream <span class="token function">iss</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        string word<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>iss <span class="token operator">>></span> word<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> word <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-11"><a href="#ç»ƒä¹ 8-11" class="headerlink" title="ç»ƒä¹ 8.11"></a>ç»ƒä¹ 8.11</h2><blockquote><p>æœ¬èŠ‚çš„ç¨‹åºåœ¨å¤–å±‚<code>while</code>å¾ªç¯ä¸­å®šä¹‰äº†<code>istringstream</code>å¯¹è±¡ã€‚å¦‚æœ<code>record</code>å¯¹è±¡å®šä¹‰åœ¨å¾ªç¯ä¹‹å¤–ï¼Œä½ éœ€è¦å¯¹ç¨‹åºè¿›è¡Œæ€æ ·çš„ä¿®æ”¹ï¼Ÿé‡å†™ç¨‹åºï¼Œå°†<code>record</code>çš„å®šä¹‰ç§»åˆ°<code>while</code>å¾ªç¯ä¹‹å¤–ï¼ŒéªŒè¯ä½ è®¾æƒ³çš„ä¿®æ”¹æ–¹æ³•æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>istringstream<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">PersonInfo</span> <span class="token punctuation">&#123;</span>    string name<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> phones<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string line<span class="token punctuation">,</span> word<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span> people<span class="token punctuation">;</span>    istringstream record<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        PersonInfo info<span class="token punctuation">;</span>        record<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        record<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        record <span class="token operator">>></span> info<span class="token punctuation">.</span>name<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>record <span class="token operator">>></span> word<span class="token punctuation">)</span>            info<span class="token punctuation">.</span>phones<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        people<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>p <span class="token operator">:</span> people<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>s <span class="token operator">:</span> p<span class="token punctuation">.</span>phones<span class="token punctuation">)</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-12"><a href="#ç»ƒä¹ 8-12" class="headerlink" title="ç»ƒä¹ 8.12"></a>ç»ƒä¹ 8.12</h2><blockquote><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆæ²¡æœ‰åœ¨<code>PersonInfo</code>ä¸­ä½¿ç”¨ç±»å†…åˆå§‹åŒ–ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºè¿™é‡Œåªéœ€è¦èšåˆç±»å°±å¤Ÿäº†ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦åœ¨<code>PersionInfo</code>ä¸­ä½¿ç”¨ç±»å†…åˆå§‹åŒ–ã€‚</p><h2 id="ç»ƒä¹ 8-13"><a href="#ç»ƒä¹ 8-13" class="headerlink" title="ç»ƒä¹ 8.13"></a>ç»ƒä¹ 8.13</h2><blockquote><p>é‡å†™æœ¬èŠ‚çš„ç”µè¯å·ç ç¨‹åºï¼Œä»ä¸€ä¸ªå‘½åæ–‡ä»¶è€Œé<code>cin</code>è¯»å–æ•°æ®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>istringstream<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>ostringstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>isdigit<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">PersonInfo</span> <span class="token punctuation">&#123;</span>    string name<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> phones<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">isdigit</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>string <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"../data/phonenumbers.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ifs<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"no phone numbers?"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    string line<span class="token punctuation">,</span> word<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span> people<span class="token punctuation">;</span>    istringstream record<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        PersonInfo info<span class="token punctuation">;</span>        record<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        record<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        record <span class="token operator">>></span> info<span class="token punctuation">.</span>name<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>record <span class="token operator">>></span> word<span class="token punctuation">)</span>            info<span class="token punctuation">.</span>phones<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        people<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>entry <span class="token operator">:</span> people<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        ostringstream formatted<span class="token punctuation">,</span> badNums<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>nums <span class="token operator">:</span> entry<span class="token punctuation">.</span>phones<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">valid</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">)</span> badNums <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> nums<span class="token punctuation">;</span>            <span class="token keyword">else</span> formatted <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">format</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> formatted<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">else</span>            cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"input error: "</span> <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name                 <span class="token operator">&lt;&lt;</span> <span class="token string">" invalid number(s) "</span> <span class="token operator">&lt;&lt;</span> badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 8-14"><a href="#ç»ƒä¹ 8-14" class="headerlink" title="ç»ƒä¹ 8.14"></a>ç»ƒä¹ 8.14</h2><blockquote><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆå°†<code>entry</code>å’Œ<code>nums</code>å®šä¹‰ä¸º<code>const auto&amp;</code>ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å®ƒä»¬éƒ½æ˜¯ç±»ç±»å‹ï¼Œå› æ­¤ä½¿ç”¨å¼•ç”¨é¿å…æ‹·è´ã€‚<br>åœ¨å¾ªç¯å½“ä¸­ä¸ä¼šæ”¹å˜å®ƒä»¬çš„å€¼ï¼Œå› æ­¤ç”¨<code>const</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ18</title>
      <link href="2021/04/10/excersize/ch18/"/>
      <url>2021/04/10/excersize/ch18/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå…«ç« -ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·"><a href="#ç¬¬åå…«ç« -ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·" class="headerlink" title="ç¬¬åå…«ç«  ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·"></a>ç¬¬åå…«ç«  ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·</h1><h2 id="ç»ƒä¹ 18-1"><a href="#ç»ƒä¹ 18-1" class="headerlink" title="ç»ƒä¹ 18.1"></a>ç»ƒä¹ 18.1</h2><blockquote><p>åœ¨ä¸‹åˆ— <code>throw</code> è¯­å¥ä¸­å¼‚å¸¸å¯¹è±¡çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> range_error <span class="token function">r</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">throw</span> r<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> exception <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>r<span class="token punctuation">;</span><span class="token keyword">throw</span> <span class="token operator">*</span>p<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a): <code>range_error</code></li><li>(b): <code>exception</code></li></ul><h2 id="ç»ƒä¹ 18-2"><a href="#ç»ƒä¹ 18-2" class="headerlink" title="ç»ƒä¹ 18.2"></a>ç»ƒä¹ 18.2</h2><blockquote><p>å½“åœ¨æŒ‡å®šçš„ä½ç½®å‘ç”Ÿäº†å¼‚å¸¸æ—¶å°†å‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">exercise</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>ifstream <span class="token function">in</span><span class="token punctuation">(</span><span class="token string">"ints"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ­¤å¤„å‘ç”Ÿå¼‚å¸¸</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æŒ‡é’ˆ<code>p</code>æŒ‡å‘çš„å†…å®¹ä¸ä¼šè¢«é‡Šæ”¾ï¼Œå°†é€ æˆå†…å­˜æ³„æ¼ã€‚</p><h2 id="ç»ƒä¹ 18-3"><a href="#ç»ƒä¹ 18-3" class="headerlink" title="ç»ƒä¹ 18.3"></a>ç»ƒä¹ 18.3</h2><blockquote><p>è¦æƒ³è®©ä¸Šé¢çš„ä»£ç åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶èƒ½æ­£å¸¸å·¥ä½œï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆã€‚è¯·æè¿°è¿™ä¸¤ç§æ–¹æ³•å¹¶å®ç°å®ƒä»¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ–¹æ³•ä¸€ï¼šä¸ä½¿ç”¨æŒ‡é’ˆï¼Œä½¿ç”¨å¯¹è±¡ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">intArray</span><span class="token punctuation">&#123;</span>    <span class="token function">intArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">explicit</span>    <span class="token function">intArray</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t s<span class="token punctuation">)</span><span class="token operator">:</span>        <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">)</span>       <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">intArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// data meber</span>    <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>intArray <span class="token function">p</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–¹æ³•äºŒï¼šä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-4"><a href="#ç»ƒä¹ 18-4" class="headerlink" title="ç»ƒä¹ 18.4"></a>ç»ƒä¹ 18.4</h2><blockquote><p>æŸ¥çœ‹å›¾18.1æ‰€ç¤ºçš„ç»§æ‰¿ä½“ç³»ï¼Œè¯´æ˜ä¸‹é¢çš„ <code>try</code> å—æœ‰ä½•é”™è¯¯å¹¶ä¿®æ”¹å®ƒã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// ä½¿ç”¨ C++ æ ‡å‡†åº“</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> runtime_error <span class="token operator">&amp;</span>re<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>overflow_error eobj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç»†åŒ–çš„å¼‚å¸¸ç±»å‹åº”è¯¥å†™åœ¨å‰é¢ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// ä½¿ç”¨ C++ æ ‡å‡†åº“</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>overflow_error eobj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token keyword">const</span> runtime_error <span class="token operator">&amp;</span>re<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>exception<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-5"><a href="#ç»ƒä¹ 18-5" class="headerlink" title="ç»ƒä¹ 18.5"></a>ç»ƒä¹ 18.5</h2><blockquote><p>ä¿®æ”¹ä¸‹é¢çš„<code>main</code>å‡½æ•°ï¼Œä½¿å…¶èƒ½æ•è·å›¾18.1æ‰€ç¤ºçš„ä»»ä½•å¼‚å¸¸ç±»å‹ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// ä½¿ç”¨ C++æ ‡å‡†åº“</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¤„ç†ä»£ç åº”è¯¥é¦–å…ˆæ‰“å°å¼‚å¸¸ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨ <code>abort</code> ç»ˆæ­¢å‡½æ•°ã€‚</p><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-6"><a href="#ç»ƒä¹ 18-6" class="headerlink" title="ç»ƒä¹ 18.6"></a>ç»ƒä¹ 18.6</h2><blockquote><p>å·²çŸ¥ä¸‹é¢çš„å¼‚å¸¸ç±»å‹å’Œ <code>catch</code> è¯­å¥ï¼Œä¹¦å†™ä¸€ä¸ª <code>throw</code> è¡¨è¾¾å¼ä½¿å…¶åˆ›å»ºçš„å¼‚å¸¸å¯¹è±¡èƒ½è¢«è¿™äº› <code>catch</code> è¯­å¥æ•è·ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">exceptionType</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>exceptionType <span class="token operator">*</span>pet<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">typedef</span> <span class="token keyword">int</span> EXCPTYPE<span class="token punctuation">;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>EXCPTYPE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token function">exceptionType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">throw</span> <span class="token function">expection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">:</span> EXCPTYPE e <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token keyword">throw</span> e<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-7"><a href="#ç»ƒä¹ 18-7" class="headerlink" title="ç»ƒä¹ 18.7"></a>ç»ƒä¹ 18.7</h2><blockquote><p>æ ¹æ®ç¬¬16ç« çš„ä»‹ç»å®šä¹‰ä½ è‡ªå·±çš„ <code>Blob</code> å’Œ <code>BlobPtr</code>ï¼Œæ³¨æ„å°†æ„é€ å‡½æ•°å†™æˆå‡½æ•°<code>try</code>è¯­å¥å—ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-8"><a href="#ç»ƒä¹ 18-8" class="headerlink" title="ç»ƒä¹ 18.8"></a>ç»ƒä¹ 18.8</h2><blockquote><p>å›é¡¾ä½ ä¹‹å‰ç¼–å†™çš„å„ä¸ªç±»ï¼Œä¸ºå®ƒä»¬çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ·»åŠ æ­£ç¡®çš„å¼‚å¸¸è¯´æ˜ã€‚å¦‚æœä½ è®¤ä¸ºæŸä¸ªææ„å‡½æ•°å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œå°è¯•ä¿®æ”¹ä»£ç ä½¿å¾—è¯¥ææ„å‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-9"><a href="#ç»ƒä¹ 18-9" class="headerlink" title="ç»ƒä¹ 18.9"></a>ç»ƒä¹ 18.9</h2><blockquote><p>å®šä¹‰æœ¬èŠ‚æè¿°çš„ä¹¦åº—ç¨‹åºå¼‚å¸¸ç±»ï¼Œç„¶åä¸º <code>Sales_data</code> ç±»é‡æ–°ç¼–å†™ä¸€ä¸ªå¤åˆèµ‹å€¼è¿ç®—ç¬¦å¹¶ä»¤å…¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚</p></blockquote><h2 id="ç»ƒä¹ 18-10"><a href="#ç»ƒä¹ 18-10" class="headerlink" title="ç»ƒä¹ 18.10"></a>ç»ƒä¹ 18.10</h2><blockquote><p>ç¼–å†™ç¨‹åºä»¤å…¶å¯¹ä¸¤ä¸ª <code>ISBN</code> ç¼–å·ä¸ç›¸åŒçš„å¯¹è±¡æ‰§è¡Œ <code>Sales_data</code> çš„åŠ æ³•è¿ç®—ã€‚ä¸ºè¯¥ç¨‹åºç¼–å†™ä¸¤ä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼šä¸€ä¸ªå¤„ç†å¼‚å¸¸ï¼Œå¦ä¸€ä¸ªä¸å¤„ç†å¼‚å¸¸ã€‚è§‚å¯Ÿå¹¶æ¯”è¾ƒè¿™ä¸¤ä¸ªç¨‹åºçš„è¡Œä¸ºï¼Œç”¨å¿ƒä½“ä¼šå½“å‡ºç°äº†ä¸€ä¸ªæœªè¢«æ•è·çš„å¼‚å¸¸æ—¶ç¨‹åºä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-11"><a href="#ç»ƒä¹ 18-11" class="headerlink" title="ç»ƒä¹ 18.11"></a>ç»ƒä¹ 18.11</h2><blockquote><p>ä¸ºä»€ä¹ˆ <code>what</code> å‡½æ•°ä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-12"><a href="#ç»ƒä¹ 18-12" class="headerlink" title="ç»ƒä¹ 18.12"></a>ç»ƒä¹ 18.12</h2><blockquote><p>å°†ä½ ä¸ºä¹‹å‰å„ç« ç»ƒä¹ ç¼–å†™çš„ç¨‹åºæ”¾ç½®åœ¨å„è‡ªçš„å‘½åç©ºé—´ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘½åç©ºé—´chapter15åŒ…å«<code>Query</code>ç¨‹åºçš„ä»£ç ï¼Œå‘½åç©ºé—´chapter10åŒ…å«<code>TextQuery</code>çš„ä»£ç ï¼›ä½¿ç”¨è¿™ç§ç»“æ„é‡æ–°ç¼–è¯‘<code>Query</code>ä»£ç å®ä¾‹ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-13"><a href="#ç»ƒä¹ 18-13" class="headerlink" title="ç»ƒä¹ 18.13"></a>ç»ƒä¹ 18.13</h2><blockquote><p>ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨æœªå‘½åçš„å‘½åç©ºé—´ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>éœ€è¦å®šä¹‰ä¸€ç³»åˆ—é™æ€çš„å˜é‡çš„æ—¶å€™ã€‚</p><p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/154469/unnamed-anonymous-namespaces-vs-static-functions">https://stackoverflow.com/questions/154469/unnamed-anonymous-namespaces-vs-static-functions</a></p><h2 id="ç»ƒä¹ 18-14"><a href="#ç»ƒä¹ 18-14" class="headerlink" title="ç»ƒä¹ 18.14"></a>ç»ƒä¹ 18.14</h2><blockquote><p>å‡è®¾ä¸‹é¢çš„ <code>operator*</code> å£°æ˜çš„æ˜¯åµŒå¥—çš„å‘½åç©ºé—´ <code>mathLib::MatrixLib</code> çš„ä¸€ä¸ªæˆå‘˜ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> mathLib <span class="token punctuation">&#123;</span><span class="token keyword">namespace</span> MatrixLib <span class="token punctuation">&#123;</span><span class="token keyword">class</span> <span class="token class-name">matrix</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>matrix <span class="token keyword">operator</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> matrix <span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> matrix <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯·é—®ä½ åº”è¯¥å¦‚ä½•åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å£°æ˜è¯¥è¿ç®—ç¬¦ï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">mathLib<span class="token operator">::</span>MatrixLib<span class="token operator">::</span>matrix mathLib<span class="token operator">::</span>MatrixLib<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> mathLib<span class="token operator">::</span>MatrixLib<span class="token operator">::</span>matrix <span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> mathLib<span class="token operator">::</span>MatrixLib<span class="token operator">::</span>matrix <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-15"><a href="#ç»ƒä¹ 18-15" class="headerlink" title="ç»ƒä¹ 18.15"></a>ç»ƒä¹ 18.15</h2><blockquote><p>è¯´æ˜ <code>using</code> æŒ‡ç¤ºä¸ <code>using</code> å£°æ˜çš„åŒºåˆ«ã€‚</p></blockquote><p>è§£ï¼š</p><ul><li>ä¸€æ¡<code>using</code>å£°æ˜è¯­å¥ä¸€æ¬¡åªå¼•å…¥å‘½åç©ºé—´çš„ä¸€ä¸ªæˆå‘˜ã€‚</li><li><code>using</code> æŒ‡ç¤ºä½¿å¾—æŸä¸ªç‰¹å®šçš„å‘½åç©ºé—´ä¸­æ‰€æœ‰çš„åå­—éƒ½å¯è§ã€‚</li></ul><p>æœ‰ç‚¹åƒpythonä¸­çš„<code>import</code>:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> lib <span class="token keyword">import</span> func<span class="token keyword">from</span> lib <span class="token keyword">import</span> <span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-16"><a href="#ç»ƒä¹ 18-16" class="headerlink" title="ç»ƒä¹ 18.16"></a>ç»ƒä¹ 18.16</h2><blockquote><p>å‡å®šåœ¨ä¸‹é¢çš„ä»£ç ä¸­æ ‡è®°ä¸ºâ€œä½ç½®1â€çš„åœ°æ–¹æ˜¯å¯¹å‘½åç©ºé—´ Exercise ä¸­æ‰€æœ‰æˆå‘˜çš„<code>using</code>å£°æ˜ï¼Œè¯·è§£é‡Šä»£ç çš„å«ä¹‰ã€‚å¦‚æœè¿™äº›<code>using</code>å£°æ˜å‡ºç°åœ¨â€œä½ç½®2â€åˆä¼šæ€æ ·å‘¢ï¼Ÿå°†<code>using</code>å£°æ˜å˜ä¸º<code>using</code>æŒ‡ç¤ºï¼Œé‡æ–°å›ç­”ä¹‹å‰çš„é—®é¢˜ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> Exercise <span class="token punctuation">&#123;</span><span class="token keyword">int</span> ivar <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">double</span> dvar <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> limit <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> ivar <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//ä½ç½®1</span><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ä½ç½®2</span><span class="token keyword">double</span> dvar <span class="token operator">=</span> <span class="token number">3.1416</span><span class="token punctuation">;</span><span class="token keyword">int</span> iobj <span class="token operator">=</span> limit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">++</span>ivar<span class="token punctuation">;</span><span class="token operator">++</span><span class="token operator">::</span>ivar<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-17"><a href="#ç»ƒä¹ 18-17" class="headerlink" title="ç»ƒä¹ 18.17"></a>ç»ƒä¹ 18.17</h2><blockquote><p>å®é™…ç¼–å†™ä»£ç æ£€éªŒä½ å¯¹ä¸Šä¸€é¢˜çš„å›ç­”æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-18"><a href="#ç»ƒä¹ 18-18" class="headerlink" title="ç»ƒä¹ 18.18"></a>ç»ƒä¹ 18.18</h2><blockquote><p>å·²çŸ¥æœ‰ä¸‹é¢çš„ <code>swap</code> çš„å…¸å‹å®šä¹‰ï¼Œå½“ <code>mem1</code> æ˜¯ä¸€ä¸ª <code>string</code> æ—¶ç¨‹åºä½¿ç”¨ <code>swap</code> çš„å“ªä¸ªç‰ˆæœ¬ï¼Ÿå¦‚æœ <code>mem1</code> æ˜¯ <code>int</code> å‘¢ï¼Ÿè¯´æ˜åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹åå­—æŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>T v1<span class="token punctuation">,</span> T v2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>v1<span class="token punctuation">.</span>mem1<span class="token punctuation">,</span> v2<span class="token punctuation">.</span>mem1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//äº¤æ¢ç±»å‹çš„å…¶ä»–æˆå‘˜</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>std::swap</code>æ˜¯ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œå¦‚æœæ˜¯<code>string</code>ä¼šæ‰¾åˆ°<code>string</code>ç‰ˆæœ¬ï¼›åä¹‹å¦‚æœæ˜¯<code>int</code>ä¼šæ‰¾åˆ°<code>int</code>ç‰ˆæœ¬ã€‚</p><h2 id="ç»ƒä¹ 18-19"><a href="#ç»ƒä¹ 18-19" class="headerlink" title="ç»ƒä¹ 18.19"></a>ç»ƒä¹ 18.19</h2><blockquote><p>å¦‚æœå¯¹ <code>swap</code> çš„è°ƒç”¨å½¢å¦‚ <code>std::swap(v1.mem1, v2.mem1)</code> å°†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šç›´æ¥è°ƒç”¨<code>std</code>ç‰ˆçš„<code>swap</code>ï¼Œä½†å¯¹åé¢çš„è°ƒç”¨æ— å½±å“ã€‚</p><h2 id="ç»ƒä¹ 18-20"><a href="#ç»ƒä¹ 18-20" class="headerlink" title="ç»ƒä¹ 18.20"></a>ç»ƒä¹ 18.20</h2><blockquote><p>åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œç¡®å®šå“ªä¸ªå‡½æ•°ä¸<code>compute</code>è°ƒç”¨åŒ¹é…ã€‚åˆ—å‡ºæ‰€æœ‰å€™é€‰å‡½æ•°å’Œå¯è¡Œå‡½æ•°ï¼Œå¯¹äºæ¯ä¸ªå¯è¡Œå‡½æ•°çš„å®å‚ä¸å½¢å‚çš„åŒ¹é…è¿‡ç¨‹æ¥è¯´ï¼Œå‘ç”Ÿäº†å“ªç§ç±»å‹è½¬æ¢ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> primerLib <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">using</span> primerLib<span class="token operator">::</span>compute<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">=</span> <span class="token number">3.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 18-21"><a href="#ç»ƒä¹ 18-21" class="headerlink" title="ç»ƒä¹ 18.21"></a>ç»ƒä¹ 18.21</h2><blockquote><p>è§£é‡Šä¸‹åˆ—å£°æ˜çš„å«ä¹‰ï¼Œåœ¨å®ƒä»¬å½“ä½œå­˜åœ¨é”™è¯¯å—ï¼Ÿå¦‚æœæœ‰ï¼Œè¯·æŒ‡å‡ºæ¥å¹¶è¯´æ˜é”™è¯¯çš„åŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">CADVehicle</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CAD</span><span class="token punctuation">,</span> <span class="token class-name">Vehicle</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">DbiList</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">List</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">iostream</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">istream</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">ostream</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-22"><a href="#ç»ƒä¹ 18-22" class="headerlink" title="ç»ƒä¹ 18.22"></a>ç»ƒä¹ 18.22</h2><blockquote><p>å·²çŸ¥å­˜åœ¨å¦‚ä¸‹æ‰€ç¤ºçš„ç±»çš„ç»§æ‰¿ä½“ç³»ï¼Œå…¶ä¸­æ¯ä¸ªç±»éƒ½å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Y</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Z</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">X</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Y</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">MI</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">C</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Z</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºä¸‹é¢çš„å®šä¹‰æ¥è¯´ï¼Œæ„é€ å‡½æ•°çš„æ‰§è¡Œé¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">MI mi<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-23"><a href="#ç»ƒä¹ 18-23" class="headerlink" title="ç»ƒä¹ 18.23"></a>ç»ƒä¹ 18.23</h2><blockquote><p>ä½¿ç”¨ç»ƒä¹ 18.22çš„ç»§æ‰¿ä½“ç³»ä»¥åŠä¸‹é¢å®šä¹‰çš„ç±» <code>D</code>ï¼ŒåŒæ—¶å‡å®šæ¯ä¸ªç±»éƒ½å®šä¹‰äº†é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¯·é—®ä¸‹é¢çš„å“ªäº›ç±»å‹è½¬æ¢æ˜¯ä¸è¢«å…è®¸çš„ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">X</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">C</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>p <span class="token operator">*</span>pd <span class="token operator">=</span> <span class="token keyword">new</span> D<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> X <span class="token operator">*</span>px <span class="token operator">=</span> pd<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> A <span class="token operator">*</span>pa <span class="token operator">=</span> pd<span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> B <span class="token operator">*</span>pb <span class="token operator">=</span> pd<span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> C <span class="token operator">*</span>pc <span class="token operator">=</span> pd<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-24"><a href="#ç»ƒä¹ 18-24" class="headerlink" title="ç»ƒä¹ 18.24"></a>ç»ƒä¹ 18.24</h2><blockquote><p>åœ¨ç¬¬714é¡µï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæŒ‡å‘ <code>Panda</code> å¯¹è±¡çš„ <code>Bear</code> æŒ‡é’ˆè¿›è¡Œäº†ä¸€ç³»åˆ—è°ƒç”¨ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>Panda</code> å¯¹è±¡çš„ <code>ZooAnimal</code> æŒ‡é’ˆå°†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Œè¯·å¯¹è¿™äº›è°ƒç”¨è¯­å¥é€ä¸€è¿›è¡Œè¯´æ˜ã€‚</p></blockquote><h2 id="ç»ƒä¹ 18-25"><a href="#ç»ƒä¹ 18-25" class="headerlink" title="ç»ƒä¹ 18.25"></a>ç»ƒä¹ 18.25</h2><blockquote><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªåŸºç±» <code>Base1</code> å’Œ <code>Base2</code> ï¼Œå®ƒä»¬å„è‡ªå®šä¹‰äº†ä¸€ä¸ªåä¸º <code>print</code> çš„è™šæˆå‘˜å’Œä¸€ä¸ªè™šææ„å‡½æ•°ã€‚ä»è¿™ä¸¤ä¸ªåŸºç±»ä¸­æ–‡åæ´¾ç”Ÿå‡ºä¸‹é¢çš„ç±»ï¼Œå®ƒä»¬éƒ½é‡æ–°å®šä¹‰äº† <code>print</code> å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">D1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base1</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">D2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base2</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">MI</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">D1</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">D2</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡ä¸‹é¢çš„æŒ‡é’ˆï¼ŒæŒ‡å‡ºåœ¨æ¯ä¸ªè°ƒç”¨ä¸­åˆ†åˆ«ä½¿ç”¨äº†å“ªä¸ªå‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Base1 <span class="token operator">*</span>pb1 <span class="token operator">=</span> <span class="token keyword">new</span> MI<span class="token punctuation">;</span>Base2 <span class="token operator">*</span>pb2 <span class="token operator">=</span> <span class="token keyword">new</span> MI<span class="token punctuation">;</span>D1 <span class="token operator">*</span>pd1 <span class="token operator">=</span> <span class="token keyword">new</span> MI<span class="token punctuation">;</span>D2 <span class="token operator">*</span>pd2 <span class="token operator">=</span> <span class="token keyword">new</span> MI<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> pb1<span class="token operator">-></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> pd1<span class="token operator">-></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> pd2<span class="token operator">-></span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">delete</span> pb2<span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token keyword">delete</span> pd1<span class="token punctuation">;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token keyword">delete</span> pd2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Base1</span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">int</span> ival<span class="token punctuation">;</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span class="token keyword">char</span> cval<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">int</span> <span class="token operator">*</span>id<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Base2</span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">double</span> fval<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base1</span></span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span>std<span class="token operator">::</span>string sval<span class="token punctuation">;</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">MI</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Derived</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Base2</span></span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">int</span> <span class="token operator">*</span>ival<span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> dvec<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-26"><a href="#ç»ƒä¹ 18-26" class="headerlink" title="ç»ƒä¹ 18.26"></a>ç»ƒä¹ 18.26</h2><blockquote><p>å·²çŸ¥å¦‚ä¸Šæ‰€ç¤ºçš„ç»§æ‰¿ä½“ç³»ï¼Œä¸‹é¢å¯¹<code>print</code>çš„è°ƒç”¨ä¸ºä»€ä¹ˆæ˜¯é”™è¯¯çš„ï¼Ÿé€‚å½“ä¿®æ”¹<code>MI</code>ï¼Œä»¤å…¶å¯¹<code>print</code>çš„è°ƒç”¨å¯ä»¥ç¼–è¯‘é€šè¿‡å¹¶æ­£ç¡®æ‰§è¡Œã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">MI mi<span class="token punctuation">;</span>mi<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-27"><a href="#ç»ƒä¹ 18-27" class="headerlink" title="ç»ƒä¹ 18.27"></a>ç»ƒä¹ 18.27</h2><blockquote><p>å·²çŸ¥å¦‚ä¸Šæ‰€ç¤ºçš„ç»§æ‰¿ä½“ç³»ï¼ŒåŒæ—¶å‡å®šä¸ºMIæ·»åŠ äº†ä¸€ä¸ªåä¸º<code>foo</code>çš„å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> ival<span class="token punctuation">;</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token class-name">MI</span><span class="token operator">::</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">double</span> cval<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> dval<span class="token punctuation">;</span><span class="token comment">//ç»ƒä¹ ä¸­çš„é—®é¢˜å‘ç”Ÿåœ¨æ­¤å¤„</span><span class="token punctuation">&#125;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> åˆ—å‡ºåœ¨MI<span class="token operator">::</span>fooä¸­å¯è§çš„æ‰€æœ‰åå­—ã€‚<span class="token punctuation">(</span>b<span class="token punctuation">)</span> æ˜¯å¦å­˜åœ¨æŸä¸ªå¯è§çš„åå­—æ˜¯ç»§æ‰¿è‡ªå¤šä¸ªåŸºç±»çš„ï¼Ÿ<span class="token punctuation">(</span>c<span class="token punctuation">)</span> å°†Base1çš„dvalæˆå‘˜ä¸Derived çš„dval æˆå‘˜æ±‚å’Œåèµ‹ç»™dvalçš„å±€éƒ¨å®ä¾‹ã€‚<span class="token punctuation">(</span>d<span class="token punctuation">)</span> å°†MI<span class="token operator">::</span>dvecçš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™Base2<span class="token operator">::</span>fvalã€‚<span class="token punctuation">(</span>e<span class="token punctuation">)</span> å°†ä»Base1ç»§æ‰¿çš„cvalèµ‹ç»™ä»Derivedç»§æ‰¿çš„svalçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-28"><a href="#ç»ƒä¹ 18-28" class="headerlink" title="ç»ƒä¹ 18.28"></a>ç»ƒä¹ 18.28</h2><blockquote><p>å·²çŸ¥å­˜åœ¨å¦‚ä¸‹çš„ç»§æ‰¿ä½“ç³»ï¼Œåœ¨ <code>VMI</code> ç±»çš„å†…éƒ¨å“ªäº›ç»§æ‰¿è€Œæ¥çš„æˆå‘˜æ— é¡»å‰ç¼€é™å®šç¬¦å°±èƒ½ç›´æ¥è®¿é—®ï¼Ÿå“ªäº›å¿…é¡»æœ‰é™å®šç¬¦æ‰èƒ½è®¿é—®ï¼Ÿè¯´æ˜ä½ çš„åŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">int</span> ival<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">char</span> cval<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">int</span> ival<span class="token punctuation">;</span><span class="token keyword">char</span> cval<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">VMI</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Derived1</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Derived2</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-29"><a href="#ç»ƒä¹ 18-29" class="headerlink" title="ç»ƒä¹ 18.29"></a>ç»ƒä¹ 18.29</h2><blockquote><p>å·²çŸ¥æœ‰å¦‚ä¸‹æ‰€ç¤ºçš„ç±»ç»§æ‰¿å…³ç³»ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Class</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Class</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">D1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">D2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">MI</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">D1</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">D2</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Final</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">MI</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Class</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> å½“ä½œç”¨äºä¸€ä¸ªFinalå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„æ‰§è¡Œæ¬¡åºåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ<span class="token punctuation">(</span>b<span class="token punctuation">)</span> åœ¨ä¸€ä¸ªFinalå¯¹è±¡ä¸­æœ‰å‡ ä¸ªBaseéƒ¨åˆ†ï¼Ÿå‡ ä¸ªClasséƒ¨åˆ†ï¼Ÿ<span class="token punctuation">(</span>c<span class="token punctuation">)</span> ä¸‹é¢çš„å“ªäº›èµ‹å€¼è¿ç®—ç¬¦å°†é€ æˆç¼–è¯‘é”™è¯¯ï¼ŸBase <span class="token operator">*</span>pb<span class="token punctuation">;</span> Class <span class="token operator">*</span>pc<span class="token punctuation">;</span> MI <span class="token operator">*</span>pmi<span class="token punctuation">;</span> D2 <span class="token operator">*</span>pd2<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> pb <span class="token operator">=</span> <span class="token keyword">new</span> Class<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> pc <span class="token operator">=</span> <span class="token keyword">new</span> Final<span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> pmi <span class="token operator">=</span> pb<span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> pd2 <span class="token operator">=</span> pmi<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 18-30"><a href="#ç»ƒä¹ 18-30" class="headerlink" title="ç»ƒä¹ 18.30"></a>ç»ƒä¹ 18.30</h2><blockquote><p>åœ¨<code>Base</code>ä¸­å®šä¹‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°å’Œä¸€ä¸ªæ¥å—<code>int</code>å½¢å‚çš„æ„é€ å‡½æ•°ã€‚åœ¨æ¯ä¸ªæ´¾ç”Ÿç±»ä¸­åˆ†åˆ«å®šä¹‰è¿™ä¸‰ç§æ„é€ å‡½æ•°ï¼Œæ¯ä¸ªæ„é€ å‡½æ•°åº”è¯¥ä½¿ç”¨å®ƒçš„å½¢å‚åˆå§‹åŒ–å…¶<code>Base</code>éƒ¨åˆ†ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ19</title>
      <link href="2021/04/10/excersize/ch19/"/>
      <url>2021/04/10/excersize/ch19/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¹ç« -ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯"><a href="#ç¬¬åä¹ç« -ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯" class="headerlink" title="ç¬¬åä¹ç«  ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯"></a>ç¬¬åä¹ç«  ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯</h1><h2 id="ç»ƒä¹ 19-1"><a href="#ç»ƒä¹ 19-1" class="headerlink" title="ç»ƒä¹ 19.1"></a>ç»ƒä¹ 19.1</h2><blockquote><p>ä½¿ç”¨ malloc ç¼–å†™ä½ è‡ªå·±çš„ operator new(sizt_t)å‡½æ•°ï¼Œä½¿ç”¨ free ç¼–å†™operator delete(void *)å‡½æ•°ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-2"><a href="#ç»ƒä¹ 19-2" class="headerlink" title="ç»ƒä¹ 19.2"></a>ç»ƒä¹ 19.2</h2><blockquote><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œallocator ç±»ä½¿ç”¨ operator new è·å–å­˜å‚¨ç©ºé—´ï¼Œç„¶åä½¿ç”¨ operator delete é‡Šæ”¾å®ƒã€‚åˆ©ç”¨ä¸Šä¸€é¢˜ä¸­çš„ä¸¤ä¸ªå‡½æ•°é‡æ–°ç¼–è¯‘å¹¶è¿è¡Œä½ çš„ StrVec ç¨‹åºã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-3"><a href="#ç»ƒä¹ 19-3" class="headerlink" title="ç»ƒä¹ 19.3"></a>ç»ƒä¹ 19.3</h2><blockquote><p>å·²çŸ¥å­˜åœ¨å¦‚ä¸‹çš„ç±»ç»§æ‰¿ä½“ç³»ï¼Œå…¶ä¸­æ¯ä¸ªç±»åˆ†åˆ«å®šä¹‰äº†ä¸€ä¸ªå…¬æœ‰çš„é»˜è®¤æ„é€ å‡½æ•°å’Œä¸€ä¸ªææ„å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">A</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‹é¢å“ªä¸ª dynamic_cast å°†å¤±è´¥ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> A <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span> C<span class="token punctuation">;</span>B <span class="token operator">*</span>pb <span class="token operator">=</span> <span class="token keyword">dynamic_cast</span><span class="token operator">&lt;</span>B<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> B <span class="token operator">*</span>pb <span class="token operator">=</span> <span class="token keyword">new</span> B<span class="token punctuation">;</span>C <span class="token operator">*</span>pc <span class="token operator">=</span> <span class="token keyword">dynamic_cast</span><span class="token operator">&lt;</span>C<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pb<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> A <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span> D<span class="token punctuation">;</span>B <span class="token operator">*</span>pb <span class="token operator">=</span> <span class="token keyword">dynamic_cast</span><span class="token operator">&lt;</span>B<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 19-4"><a href="#ç»ƒä¹ 19-4" class="headerlink" title="ç»ƒä¹ 19.4"></a>ç»ƒä¹ 19.4</h2><blockquote><p>ä½¿ç”¨ä¸Šä¸€ä¸ªç»ƒä¹ å®šä¹‰çš„ç±»æ”¹å†™ä¸‹é¢çš„ä»£ç ï¼Œå°†è¡¨è¾¾å¼*pa è½¬æ¢æˆç±»å‹C&amp;ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>C <span class="token operator">*</span>pc <span class="token operator">=</span> <span class="token keyword">dynamic_cast</span><span class="token operator">&lt;</span>C<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ä½¿ç”¨Cçš„æˆå‘˜</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token comment">//ä½¿ç”¨Açš„æˆå‘˜</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 19-5"><a href="#ç»ƒä¹ 19-5" class="headerlink" title="ç»ƒä¹ 19.5"></a>ç»ƒä¹ 19.5</h2><blockquote><p>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½ åº”è¯¥ç”¨ dynamic_cast æ›¿ä»£è™šå‡½æ•°ï¼Ÿ</p></blockquote><h2 id="ç»ƒä¹ 19-6"><a href="#ç»ƒä¹ 19-6" class="headerlink" title="ç»ƒä¹ 19.6"></a>ç»ƒä¹ 19.6</h2><blockquote><p>ç¼–å†™ä¸€æ¡è¡¨è¾¾å¼å°† Query_base æŒ‡é’ˆåŠ¨æ€è½¬æ¢ä¸º AndQuery æŒ‡é’ˆã€‚åˆ†åˆ«ä½¿ç”¨ AndQuery çš„å¯¹è±¡ä»¥åŠå…¶ä»–ç±»å‹çš„å¯¹è±¡æµ‹è¯•è½¬æ¢æ˜¯å¦æœ‰æ•ˆã€‚æ‰“å°ä¸€æ¡è¡¨ç¤ºç±»å‹è½¬æ¢æ˜¯å¦æˆåŠŸçš„ä¿¡æ¯ï¼Œç¡®ä¿å®é™…è¾“å‡ºçš„ç»“æœä¸æœŸæœ›çš„ä¸€è‡´ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-7"><a href="#ç»ƒä¹ 19-7" class="headerlink" title="ç»ƒä¹ 19.7"></a>ç»ƒä¹ 19.7</h2><blockquote><p>ç¼–å†™ä¸ä¸Šä¸€ä¸ªç»ƒä¹ ç±»ä¼¼çš„è½¬æ¢ï¼Œè¿™ä¸€æ¬¡å°† Query_base å¯¹è±¡è½¬æ¢ä¸º AndQuery çš„å¼•ç”¨ã€‚é‡å¤ä¸Šé¢çš„æµ‹è¯•è¿‡ç¨‹ï¼Œç¡®ä¿è½¬æ¢èƒ½æ­£å¸¸å·¥ä½œã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-8"><a href="#ç»ƒä¹ 19-8" class="headerlink" title="ç»ƒä¹ 19.8"></a>ç»ƒä¹ 19.8</h2><blockquote><p>ç¼–å†™ä¸€æ¡ typeid è¡¨è¾¾å¼æ£€æŸ¥ä¸¤ä¸ª Query_base å¯¹è±¡æ˜¯å¦æŒ‡å‘åŒä¸€ç§ç±»å‹ã€‚å†æ£€æŸ¥è¯¥ç±»å‹æ˜¯å¦æ˜¯ AndQueryã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-9"><a href="#ç»ƒä¹ 19-9" class="headerlink" title="ç»ƒä¹ 19.9"></a>ç»ƒä¹ 19.9</h2><blockquote><p>ç¼–å†™ä¸æœ¬èŠ‚æœ€åä¸€ä¸ªç¨‹åºç±»ä¼¼çš„ä»£ç ï¼Œä»¤å…¶æ‰“å°ä½ çš„ç¼–è¯‘å™¨ä¸ºä¸€äº›å¸¸è§ç±»å‹æ‰€èµ·çš„åå­—ã€‚å¦‚æœä½ å¾—åˆ°çš„è¾“å‡ºç»“æœä¸æœ¬ä¹¦ç±»ä¼¼ï¼Œå°è¯•ç¼–å†™ä¸€ä¸ªå‡½æ•°å°†è¿™äº›å­—ç¬¦ä¸²ç¿»è¯‘æˆäººä»¬æ›´å®¹æ˜“è¯»æ‡‚çš„å½¢å¼ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-10"><a href="#ç»ƒä¹ 19-10" class="headerlink" title="ç»ƒä¹ 19.10"></a>ç»ƒä¹ 19.10</h2><blockquote><p>å·²çŸ¥å­˜åœ¨å¦‚ä¸‹çš„ç±»ç»§æ‰¿ä½“ç³»ï¼Œå…¶ä¸­æ¯ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤å…¬æœ‰çš„æ„é€ å‡½æ•°å’Œä¸€ä¸ªè™šææ„å‡½æ•°ã€‚ä¸‹é¢çš„è¯­å¥å°†æ‰“å°å“ªäº›ç±»å‹åå­—ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span></span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> A <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span> C<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>pa<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> C cobj<span class="token punctuation">;</span>A<span class="token operator">&amp;</span> ra <span class="token operator">=</span> cobj<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ra<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> B <span class="token operator">*</span>px <span class="token operator">=</span> <span class="token keyword">new</span> B<span class="token punctuation">;</span>A<span class="token operator">&amp;</span> ra <span class="token operator">=</span> <span class="token operator">*</span>px<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ra<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 19-11"><a href="#ç»ƒä¹ 19-11" class="headerlink" title="ç»ƒä¹ 19.11"></a>ç»ƒä¹ 19.11</h2><blockquote><p>æ™®é€šçš„æ•°æ®æŒ‡é’ˆå’ŒæŒ‡å‘æ•°æ®æˆå‘˜çš„æŒ‡é’ˆæœ‰ä½•åŒºåˆ«ï¼Ÿ</p></blockquote><h2 id="ç»ƒä¹ 19-12"><a href="#ç»ƒä¹ 19-12" class="headerlink" title="ç»ƒä¹ 19.12"></a>ç»ƒä¹ 19.12</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªæˆå‘˜æŒ‡é’ˆï¼Œä»¤å…¶å¯ä»¥æŒ‡å‘ Screen ç±»çš„ cursor æˆå‘˜ã€‚é€šè¿‡è¯¥æŒ‡é’ˆè·å¾— Screen::cursor çš„å€¼ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-13"><a href="#ç»ƒä¹ 19-13" class="headerlink" title="ç»ƒä¹ 19.13"></a>ç»ƒä¹ 19.13</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œä½¿å…¶å¯ä»¥è¡¨ç¤ºæŒ‡å‘ Sales_data ç±»çš„ bookNo æˆå‘˜çš„æŒ‡é’ˆã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-14"><a href="#ç»ƒä¹ 19-14" class="headerlink" title="ç»ƒä¹ 19.14"></a>ç»ƒä¹ 19.14</h2><blockquote><p>ä¸‹é¢çš„ä»£ç åˆæ³•å—ï¼Ÿå¦‚æœåˆæ³•ï¼Œä»£ç çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œè§£é‡ŠåŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> pmf <span class="token operator">=</span> <span class="token operator">&amp;</span>Screen<span class="token operator">::</span>get_cursor<span class="token punctuation">;</span>pmf <span class="token operator">=</span> <span class="token operator">&amp;</span>Screen<span class="token operator">::</span>get<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 19-15"><a href="#ç»ƒä¹ 19-15" class="headerlink" title="ç»ƒä¹ 19.15"></a>ç»ƒä¹ 19.15</h2><blockquote><p>æ™®é€šå‡½æ•°æŒ‡é’ˆå’ŒæŒ‡å‘æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆæœ‰ä½•åŒºåˆ«ï¼Ÿ</p></blockquote><h2 id="ç»ƒä¹ 19-16"><a href="#ç»ƒä¹ 19-16" class="headerlink" title="ç»ƒä¹ 19.16"></a>ç»ƒä¹ 19.16</h2><blockquote><p>å£°æ˜ä¸€ä¸ªç±»å‹åˆ«åï¼Œä»¤å…¶ä½œä¸ºæŒ‡å‘ Sales_data çš„ avg_price æˆå‘˜çš„æŒ‡é’ˆçš„åŒä¹‰è¯ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-17"><a href="#ç»ƒä¹ 19-17" class="headerlink" title="ç»ƒä¹ 19.17"></a>ç»ƒä¹ 19.17</h2><blockquote><p>ä¸º Screen çš„æ‰€æœ‰æˆå‘˜å‡½æ•°ç±»å‹å„å®šä¹‰ä¸€ä¸ªç±»å‹åˆ«åã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-18"><a href="#ç»ƒä¹ 19-18" class="headerlink" title="ç»ƒä¹ 19.18"></a>ç»ƒä¹ 19.18</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ count_if ç»Ÿè®¡åœ¨ç»™å®šçš„ vector ä¸­æœ‰å¤šå°‘ä¸ªç©º stringã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-19"><a href="#ç»ƒä¹ 19-19" class="headerlink" title="ç»ƒä¹ 19.19"></a>ç»ƒä¹ 19.19</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä»¤å…¶æ¥å—vector<Sales_data>å¹¶æŸ¥æ‰¾å¹³å‡ä»·æ ¼é«˜äºæŸä¸ªå€¼çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-20"><a href="#ç»ƒä¹ 19-20" class="headerlink" title="ç»ƒä¹ 19.20"></a>ç»ƒä¹ 19.20</h2><blockquote><p>å°†ä½ çš„ QueryResult ç±»åµŒå¥—åœ¨ TextQuery ä¸­ï¼Œç„¶åé‡æ–°è¿è¡Œ12.3.2èŠ‚ä¸­ä½¿ç”¨äº† TextQuery çš„ç¨‹åºã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-21"><a href="#ç»ƒä¹ 19-21" class="headerlink" title="ç»ƒä¹ 19.21"></a>ç»ƒä¹ 19.21</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±çš„ Token ç±»ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-22"><a href="#ç»ƒä¹ 19-22" class="headerlink" title="ç»ƒä¹ 19.22"></a>ç»ƒä¹ 19.22</h2><blockquote><p>ä¸ºä½ çš„ Token ç±»æ·»åŠ ä¸€ä¸ª Sales_data ç±»å‹çš„æˆå‘˜ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-23"><a href="#ç»ƒä¹ 19-23" class="headerlink" title="ç»ƒä¹ 19.23"></a>ç»ƒä¹ 19.23</h2><blockquote><p>ä¸ºä½ çš„ Token ç±»æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-24"><a href="#ç»ƒä¹ 19-24" class="headerlink" title="ç»ƒä¹ 19.24"></a>ç»ƒä¹ 19.24</h2><blockquote><p>å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ª Token å¯¹è±¡ä»˜ç»™å®ƒè‡ªå·±å°†å‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><h2 id="ç»ƒä¹ 19-25"><a href="#ç»ƒä¹ 19-25" class="headerlink" title="ç»ƒä¹ 19.25"></a>ç»ƒä¹ 19.25</h2><blockquote><p>ç¼–å†™ä¸€ç³»åˆ—èµ‹å€¼è¿ç®—ç¬¦ï¼Œä»¤å…¶åˆ†åˆ«æ¥æ”¶ union ä¸­å„ç§ç±»å‹çš„å€¼ã€‚</p></blockquote><h2 id="ç»ƒä¹ 19-26"><a href="#ç»ƒä¹ 19-26" class="headerlink" title="ç»ƒä¹ 19.26"></a>ç»ƒä¹ 19.26</h2><blockquote><p>è¯´æ˜ä¸‹åˆ—å£°æ˜è¯­å¥çš„å«ä¹‰å¹¶åˆ¤æ–­å®ƒä»¬æ˜¯å¦åˆæ³•ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token keyword">int</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token keyword">double</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°1</title>
      <link href="2021/04/10/notes/ch01/"/>
      <url>2021/04/10/notes/ch01/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸€ç« -å¼€å§‹"><a href="#ç¬¬ä¸€ç« -å¼€å§‹" class="headerlink" title="ç¬¬ä¸€ç«  å¼€å§‹"></a>ç¬¬ä¸€ç«  å¼€å§‹</h1><h2 id="ç†Ÿæ‚‰ç¼–è¯‘å™¨"><a href="#ç†Ÿæ‚‰ç¼–è¯‘å™¨" class="headerlink" title="ç†Ÿæ‚‰ç¼–è¯‘å™¨"></a>ç†Ÿæ‚‰ç¼–è¯‘å™¨</h2><p>**g++**ï¼š</p><ul><li>ç¼–è¯‘ï¼š<code>g++ --std=c++11 ch01.cpp -o main</code></li><li>è¿è¡Œï¼š<code>./prog1</code></li><li>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ï¼š<code>echo $?</code></li><li>ç¼–è¯‘å¤šä¸ªæ–‡ä»¶:<code>g++ ch2.cpp Sales_item.cc -o main</code></li></ul><p>è¾“å…¥ <code>g++ --help</code>ï¼ŒæŸ¥çœ‹ç¼–è¯‘å™¨é€‰é¡¹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">Usage: g++ [options] file...Options:  -pass-exit-codes         Exit with highest error code from a phase  --help                   Display this information  --target-help            Display target specific command line options  --help&#x3D;&#123;common|optimizers|params|target|warnings|[^]&#123;joined|separate|undocumented&#125;&#125;[,...]                           Display specific types of command line options  (Use &#39;-v --help&#39; to display command line options of sub-processes)  --version                Display compiler version information  -dumpspecs               Display all of the built in spec strings  -dumpversion             Display the version of the compiler  -dumpmachine             Display the compiler&#39;s target processor  -print-search-dirs       Display the directories in the compiler&#39;s search path  -print-libgcc-file-name  Display the name of the compiler&#39;s companion library  -print-file-name&#x3D;&lt;lib&gt;   Display the full path to library &lt;lib&gt;  -print-prog-name&#x3D;&lt;prog&gt;  Display the full path to compiler component &lt;prog&gt;  -print-multiarch         Display the target&#39;s normalized GNU triplet, used as                           a component in the library path  -print-multi-directory   Display the root directory for versions of libgcc  -print-multi-lib         Display the mapping between command line options and                           multiple library search directories  -print-multi-os-directory Display the relative path to OS libraries  -print-sysroot           Display the target libraries directory  -print-sysroot-headers-suffix Display the sysroot suffix used to find headers  -Wa,&lt;options&gt;            Pass comma-separated &lt;options&gt; on to the assembler  -Wp,&lt;options&gt;            Pass comma-separated &lt;options&gt; on to the preprocessor  -Wl,&lt;options&gt;            Pass comma-separated &lt;options&gt; on to the linker  -Xassembler &lt;arg&gt;        Pass &lt;arg&gt; on to the assembler  -Xpreprocessor &lt;arg&gt;     Pass &lt;arg&gt; on to the preprocessor  -Xlinker &lt;arg&gt;           Pass &lt;arg&gt; on to the linker  -save-temps              Do not delete intermediate files  -save-temps&#x3D;&lt;arg&gt;        Do not delete intermediate files  -no-canonical-prefixes   Do not canonicalize paths when building relative                           prefixes to other gcc components  -pipe                    Use pipes rather than intermediate files  -time                    Time the execution of each subprocess  -specs&#x3D;&lt;file&gt;            Override built-in specs with the contents of &lt;file&gt;  -std&#x3D;&lt;standard&gt;          Assume that the input sources are for &lt;standard&gt;  --sysroot&#x3D;&lt;directory&gt;    Use &lt;directory&gt; as the root directory for headers                           and libraries  -B &lt;directory&gt;           Add &lt;directory&gt; to the compiler&#39;s search paths  -v                       Display the programs invoked by the compiler  -###                     Like -v but options quoted and commands not executed  -E                       Preprocess only; do not compile, assemble or link  -S                       Compile only; do not assemble or link  -c                       Compile and assemble, but do not link  -o &lt;file&gt;                Place the output into &lt;file&gt;  -pie                     Create a position independent executable  -shared                  Create a shared library  -x &lt;language&gt;            Specify the language of the following input files                           Permissible languages include: c c++ assembler none                           &#39;none&#39; means revert to the default behavior of                           guessing the language based on the file&#39;s extension<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å…¥ <code>g++ -v --help</code>å¯ä»¥çœ‹åˆ°æ›´å®Œæ•´çš„æŒ‡ä»¤ã€‚<br>ä¾‹å¦‚è¿˜æœ‰äº›å¸¸ç”¨çš„ï¼š</p><pre class="line-numbers language-none"><code class="language-none">-h FILENAME, -soname FILENAME: Set internal name of shared library-I PROGRAM, --dynamic-linker PROGRAM: Set PROGRAM as the dynamic linker to use-l LIBNAME, --library LIBNAME: Search for library LIBNAME-L DIRECTORY, --library-path DIRECTORY: Add DIRECTORY to library search path<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è·å¾—ç¨‹åºçŠ¶æ€</strong>:</p><ul><li>windows: <code>echo %ERRORLEVEL%</code></li><li>UNIX: <code>echo $?</code></li></ul><h2 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h2><ul><li><code>#include &lt;iostream&gt;</code></li><li><code>std::cout &lt;&lt; &quot;hello&quot;</code></li><li><code>std::cin &gt;&gt; v1</code></li></ul><p>è®°ä½<code>&gt;&gt;</code>å’Œ<code>&lt;&lt;</code>è¿”å›çš„ç»“æœéƒ½æ˜¯å·¦æ“ä½œæ•°ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥æµå’Œè¾“å‡ºæµæœ¬èº«ã€‚</p><p><strong>endl</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè¢«ç§°ä¸º<strong>æ“çºµç¬¦</strong>ï¼ˆmanipulatorï¼‰çš„ç‰¹æ®Šå€¼ï¼Œæ•ˆæœæ˜¯ç»“æŸå½“å‰è¡Œï¼Œå¹¶å°†è®¾å¤‡å…³è”çš„ç¼“å†²åŒºï¼ˆbufferï¼‰ä¸­çš„å†…å®¹åˆ·åˆ°è®¾å¤‡ä¸­ã€‚</p><p>UNIXå’ŒMacä¸‹é”®ç›˜è¾“å…¥æ–‡ä»¶ç»“æŸç¬¦ï¼š<code>ctrl+d</code>ï¼ŒWindowsä¸‹ï¼š<code>ctrl+z</code></p><p><strong>å¤´æ–‡ä»¶</strong>ï¼šç±»çš„ç±»å‹ä¸€èˆ¬å­˜å‚¨åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œæ ‡å‡†åº“çš„å¤´æ–‡ä»¶ä½¿ç”¨<code>&lt;&gt;</code>ï¼Œéæ ‡å‡†åº“çš„å¤´æ–‡ä»¶ä½¿ç”¨<code>&quot;&quot;</code>ã€‚ç”³æ˜å†™åœ¨<code>.h</code>æ–‡ä»¶ï¼Œå®šä¹‰å®ç°å†™åœ¨<code>.cpp</code>æ–‡ä»¶ã€‚</p><p><strong>é¿å…å¤šæ¬¡åŒ…å«åŒä¸€å¤´æ–‡ä»¶</strong>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">SALESITEM_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SALESITEM_H</span></span><span class="token comment">// Definition of Sales_itemclass and related functions goes here</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æˆå‘˜å‡½æ•°ï¼ˆç±»æ–¹æ³•ï¼‰</strong>ï¼šä½¿ç”¨<code>.</code>è°ƒç”¨ã€‚</p><p><strong>å‘½åç©ºé—´ï¼ˆnamespaceï¼‰</strong>ï¼šä½¿ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦<code>::</code>è°ƒç”¨ã€‚</p><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><ul><li>å•è¡Œæ³¨é‡Šï¼š <code>//</code></li><li>å¤šè¡Œæ³¨é‡Šï¼š <code>/**/</code>ã€‚ç¼–è¯‘å™¨å°†<code>/*</code>å’Œ<code>*/</code>ä¹‹é—´çš„å†…å®¹éƒ½ä½œä¸ºæ³¨é‡Šå†…å®¹å¿½ç•¥ã€‚æ³¨æ„ä¸èƒ½åµŒå¥—ã€‚</li></ul><h2 id="whileè¯­å¥"><a href="#whileè¯­å¥" class="headerlink" title="whileè¯­å¥"></a>whileè¯­å¥</h2><p>å¾ªç¯æ‰§è¡Œï¼Œï¼ˆç›´åˆ°æ¡ä»¶ï¼ˆconditionï¼‰ä¸ºå‡ã€‚</p><h2 id="forè¯­å¥"><a href="#forè¯­å¥" class="headerlink" title="forè¯­å¥"></a>forè¯­å¥</h2><p>å¾ªç¯å¤´ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>ä¸€ä¸ªåˆå§‹åŒ–è¯­å¥ï¼ˆinit-statementï¼‰</li><li>ä¸€ä¸ªå¾ªç¯æ¡ä»¶ï¼ˆconditionï¼‰</li><li>ä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆexpressionï¼‰</li></ul><h2 id="ä½¿ç”¨æ–‡ä»¶é‡å®šå‘"><a href="#ä½¿ç”¨æ–‡ä»¶é‡å®šå‘" class="headerlink" title="ä½¿ç”¨æ–‡ä»¶é‡å®šå‘"></a>ä½¿ç”¨æ–‡ä»¶é‡å®šå‘</h2><p><code>./main &lt;infile &gt;outfile</code></p>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°3</title>
      <link href="2021/04/10/notes/ch03/"/>
      <url>2021/04/10/notes/ch03/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸‰ç« -å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„"><a href="#ç¬¬ä¸‰ç« -å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„" class="headerlink" title="ç¬¬ä¸‰ç«  å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„"></a>ç¬¬ä¸‰ç«  å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„</h1><h2 id="usingå£°æ˜"><a href="#usingå£°æ˜" class="headerlink" title="usingå£°æ˜"></a>usingå£°æ˜</h2><ul><li>ä½¿ç”¨æŸä¸ªå‘½åç©ºé—´ï¼šä¾‹å¦‚ <code>using std::cin</code>è¡¨ç¤ºä½¿ç”¨å‘½åç©ºé—´<code>std</code>ä¸­çš„åå­—<code>cin</code>ã€‚</li><li>å¤´æ–‡ä»¶ä¸­ä¸åº”è¯¥åŒ…å«<code>using</code>å£°æ˜ã€‚è¿™æ ·ä½¿ç”¨äº†è¯¥å¤´æ–‡ä»¶çš„æºç ä¹Ÿä¼šä½¿ç”¨è¿™ä¸ªå£°æ˜ï¼Œä¼šå¸¦æ¥é£é™©ã€‚</li></ul><h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><ul><li>æ ‡å‡†åº“ç±»å‹<code>string</code>è¡¨ç¤ºå¯å˜é•¿çš„å­—ç¬¦åºåˆ—ã€‚</li><li><code>#include &lt;string&gt;</code>ï¼Œç„¶å <code>using std::string;</code></li><li><strong>stringå¯¹è±¡</strong>ï¼šæ³¨æ„ï¼Œä¸åŒäºå­—ç¬¦ä¸²å­—é¢å€¼ã€‚</li></ul><h3 id="å®šä¹‰å’Œåˆå§‹åŒ–stringå¯¹è±¡"><a href="#å®šä¹‰å’Œåˆå§‹åŒ–stringå¯¹è±¡" class="headerlink" title="å®šä¹‰å’Œåˆå§‹åŒ–stringå¯¹è±¡"></a>å®šä¹‰å’Œåˆå§‹åŒ–stringå¯¹è±¡</h3><p>åˆå§‹åŒ–<code>string</code>å¯¹è±¡çš„æ–¹å¼ï¼š</p><table><thead><tr><th>æ–¹å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>string s1</code></td><td>é»˜è®¤åˆå§‹åŒ–ï¼Œ<code>s1</code>æ˜¯ä¸ªç©ºå­—ç¬¦ä¸²</td></tr><tr><td><code>string s2(s1)</code></td><td><code>s2</code>æ˜¯<code>s1</code>çš„å‰¯æœ¬</td></tr><tr><td><code>string s2 = s1</code></td><td>ç­‰ä»·äº<code>s2(s1)</code>ï¼Œ<code>s2</code>æ˜¯<code>s1</code>çš„å‰¯æœ¬</td></tr><tr><td><code>string s3(&quot;value&quot;)</code></td><td><code>s3</code>æ˜¯å­—é¢å€¼â€œvalueâ€çš„å‰¯æœ¬ï¼Œé™¤äº†å­—é¢å€¼æœ€åçš„é‚£ä¸ªç©ºå­—ç¬¦å¤–</td></tr><tr><td><code>string s3 = &quot;value&quot;</code></td><td>ç­‰ä»·äº<code>s3(&quot;value&quot;)</code>ï¼Œ<code>s3</code>æ˜¯å­—é¢å€¼â€valueâ€çš„å‰¯æœ¬</td></tr><tr><td><code>string s4(n, &#39;c&#39;)</code></td><td>æŠŠ<code>s4</code>åˆå§‹åŒ–ä¸ºç”±è¿ç»­<code>n</code>ä¸ªå­—ç¬¦<code>c</code>ç»„æˆçš„ä¸²</td></tr></tbody></table><ul><li>æ‹·è´åˆå§‹åŒ–ï¼ˆcopy initializationï¼‰ï¼šä½¿ç”¨ç­‰å·<code>=</code>å°†ä¸€ä¸ªå·²æœ‰çš„å¯¹è±¡æ‹·è´åˆ°æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡ã€‚</li><li>ç›´æ¥åˆå§‹åŒ–ï¼ˆdirect initializationï¼‰ï¼šé€šè¿‡æ‹¬å·ç»™å¯¹è±¡èµ‹å€¼ã€‚</li></ul><h3 id="stringå¯¹è±¡ä¸Šçš„æ“ä½œ"><a href="#stringå¯¹è±¡ä¸Šçš„æ“ä½œ" class="headerlink" title="stringå¯¹è±¡ä¸Šçš„æ“ä½œ"></a>stringå¯¹è±¡ä¸Šçš„æ“ä½œ</h3><p><code>string</code>çš„æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>os &lt;&lt; s</code></td><td>å°†<code>s</code>å†™åˆ°è¾“å‡ºæµ<code>os</code>å½“ä¸­ï¼Œè¿”å›<code>os</code></td></tr><tr><td><code>is &gt;&gt; s</code></td><td>ä»<code>is</code>ä¸­è¯»å–å­—ç¬¦ä¸²èµ‹ç»™<code>s</code>ï¼Œå­—ç¬¦ä¸²ä»¥ç©ºç™½åˆ†å‰²ï¼Œè¿”å›<code>is</code></td></tr><tr><td><code>getline(is, s)</code></td><td>ä»<code>is</code>ä¸­è¯»å–ä¸€è¡Œèµ‹ç»™<code>s</code>ï¼Œè¿”å›<code>is</code></td></tr><tr><td><code>s.empty()</code></td><td><code>s</code>ä¸ºç©ºè¿”å›<code>true</code>ï¼Œå¦åˆ™è¿”å›<code>false</code></td></tr><tr><td><code>s.size()</code></td><td>è¿”å›<code>s</code>ä¸­å­—ç¬¦çš„ä¸ªæ•°</td></tr><tr><td><code>s[n]</code></td><td>è¿”å›<code>s</code>ä¸­ç¬¬<code>n</code>ä¸ªå­—ç¬¦çš„å¼•ç”¨ï¼Œä½ç½®<code>n</code>ä»0è®¡èµ·</td></tr><tr><td><code>s1+s2</code></td><td>è¿”å›<code>s1</code>å’Œ<code>s2</code>è¿æ¥åçš„ç»“æœ</td></tr><tr><td><code>s1=s2</code></td><td>ç”¨<code>s2</code>çš„å‰¯æœ¬ä»£æ›¿<code>s1</code>ä¸­åŸæ¥çš„å­—ç¬¦</td></tr><tr><td><code>s1==s2</code></td><td>å¦‚æœ<code>s1</code>å’Œ<code>s2</code>ä¸­æ‰€å«çš„å­—ç¬¦å®Œå…¨ä¸€æ ·ï¼Œåˆ™å®ƒä»¬ç›¸ç­‰ï¼›<code>string</code>å¯¹è±¡çš„ç›¸ç­‰æ€§åˆ¤æ–­å¯¹å­—æ¯çš„å¤§å°å†™æ•æ„Ÿ</td></tr><tr><td><code>s1!=s2</code></td><td>åŒä¸Š</td></tr><tr><td><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code></td><td>åˆ©ç”¨å­—ç¬¦åœ¨å­—å…¸ä¸­çš„é¡ºåºè¿›è¡Œæ¯”è¾ƒï¼Œä¸”å¯¹å­—æ¯çš„å¤§å°å†™æ•æ„Ÿ</td></tr></tbody></table><ul><li>string ioï¼š<ul><li>æ‰§è¡Œè¯»æ“ä½œ<code>&gt;&gt;</code>ï¼šå¿½ç•¥æ‰å¼€å¤´çš„ç©ºç™½ï¼ˆåŒ…æ‹¬ç©ºæ ¼ã€æ¢è¡Œç¬¦å’Œåˆ¶è¡¨ç¬¦ï¼‰ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€å¤„ç©ºç™½ä¸ºæ­¢ã€‚</li><li><code>getline</code>ï¼šè¯»å–ä¸€æ•´è¡Œï¼Œ<strong>åŒ…æ‹¬ç©ºç™½ç¬¦</strong>ã€‚</li></ul></li><li>å­—ç¬¦ä¸²å­—é¢å€¼å’Œstringæ˜¯ä¸åŒçš„ç±»å‹ã€‚</li></ul><h3 id="å¤„ç†stringå¯¹è±¡ä¸­çš„å­—ç¬¦"><a href="#å¤„ç†stringå¯¹è±¡ä¸­çš„å­—ç¬¦" class="headerlink" title="å¤„ç†stringå¯¹è±¡ä¸­çš„å­—ç¬¦"></a>å¤„ç†stringå¯¹è±¡ä¸­çš„å­—ç¬¦</h3><ul><li><strong>ctype.h vs. cctype</strong>ï¼šC++ä¿®æ”¹äº†cçš„æ ‡å‡†åº“ï¼Œåç§°ä¸ºå»æ‰<code>.h</code>ï¼Œå‰é¢åŠ <code>c</code>ã€‚</li></ul><p><code>cctype</code>å¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ç»„æ ‡å‡†å‡½æ•°ï¼š</p><table><thead><tr><th>å‡½æ•°</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>isalnum(c)</code></td><td>å½“<code>c</code>æ˜¯å­—æ¯æˆ–æ•°å­—æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isalpha(c)</code></td><td>å½“<code>c</code>æ˜¯å­—æ¯æ—¶ä¸ºçœŸ</td></tr><tr><td><code>iscntrl(c)</code></td><td>å½“<code>c</code>æ˜¯æ§åˆ¶å­—ç¬¦æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isdigit(c)</code></td><td>å½“<code>c</code>æ˜¯æ•°å­—æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isgraph(c)</code></td><td>å½“<code>c</code>ä¸æ˜¯ç©ºæ ¼ä½†å¯ä»¥æ‰“å°æ—¶ä¸ºçœŸ</td></tr><tr><td><code>islower(c)</code></td><td>å½“<code>c</code>æ˜¯å°å†™å­—æ¯æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isprint(c)</code></td><td>å½“<code>c</code>æ˜¯å¯æ‰“å°å­—ç¬¦æ—¶ä¸ºçœŸ</td></tr><tr><td><code>ispunct(c)</code></td><td>å½“<code>c</code>æ˜¯æ ‡ç‚¹ç¬¦å·æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isspace(c)</code></td><td>å½“<code>c</code>æ˜¯ç©ºç™½æ—¶ä¸ºçœŸï¼ˆç©ºæ ¼ã€æ¨ªå‘åˆ¶è¡¨ç¬¦ã€çºµå‘åˆ¶è¡¨ç¬¦ã€å›è½¦ç¬¦ã€æ¢è¡Œç¬¦ã€è¿›çº¸ç¬¦ï¼‰</td></tr><tr><td><code>isupper(c)</code></td><td>å½“<code>c</code>æ˜¯å¤§å†™å­—æ¯æ—¶ä¸ºçœŸ</td></tr><tr><td><code>isxdigit(c)</code></td><td>å½“<code>c</code>æ˜¯åå…­è¿›åˆ¶æ•°å­—æ—¶ä¸ºçœŸ</td></tr><tr><td><code>tolower(c)</code></td><td>å½“<code>c</code>æ˜¯å¤§å†™å­—æ¯ï¼Œè¾“å‡ºå¯¹åº”çš„å°å†™å­—æ¯ï¼›å¦åˆ™åŸæ ·è¾“å‡º<code>c</code></td></tr><tr><td><code>toupper(c)</code></td><td>å½“<code>c</code>æ˜¯å°å†™å­—æ¯ï¼Œè¾“å‡ºå¯¹åº”çš„å¤§å†™å­—æ¯ï¼›å¦åˆ™åŸæ ·è¾“å‡º<code>c</code></td></tr></tbody></table><ul><li>éå†å­—ç¬¦ä¸²ï¼šä½¿ç”¨<strong>èŒƒå›´for</strong>ï¼ˆrange forï¼‰è¯­å¥ï¼š <code>for (auto c: str)</code>ï¼Œæˆ–è€… <code>for (auto &amp;c: str)</code>ä½¿ç”¨å¼•ç”¨ç›´æ¥æ”¹å˜å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ã€‚ ï¼ˆC++11ï¼‰</li></ul><h2 id="vector"><a href="#vector" class="headerlink" title="vector"></a>vector</h2><ul><li>vectoræ˜¯ä¸€ä¸ª<strong>å®¹å™¨</strong>ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç±»æ¨¡æ¿ï¼›</li><li><code>#include &lt;vector&gt;</code> ç„¶å <code>using std::vector;</code></li><li>å®¹å™¨ï¼šåŒ…å«å…¶ä»–å¯¹è±¡ã€‚</li><li>ç±»æ¨¡æ¿ï¼šæœ¬èº«ä¸æ˜¯ç±»ï¼Œä½†å¯ä»¥<strong>å®ä¾‹åŒ–instantiation</strong>å‡ºä¸€ä¸ªç±»ã€‚ <code>vector</code>æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œ <code>vector&lt;int&gt;</code>æ˜¯ä¸€ä¸ªç±»å‹ã€‚</li><li>é€šè¿‡å°†ç±»å‹æ”¾åœ¨ç±»æ¨¡æ¿åç§°åé¢çš„<strong>å°–æ‹¬å·</strong>ä¸­æ¥æŒ‡å®š<strong>ç±»å‹</strong>ï¼Œå¦‚<code>vector&lt;int&gt; ivec</code>ã€‚</li></ul><h3 id="å®šä¹‰å’Œåˆå§‹åŒ–vectorå¯¹è±¡"><a href="#å®šä¹‰å’Œåˆå§‹åŒ–vectorå¯¹è±¡" class="headerlink" title="å®šä¹‰å’Œåˆå§‹åŒ–vectorå¯¹è±¡"></a>å®šä¹‰å’Œåˆå§‹åŒ–vectorå¯¹è±¡</h3><p>åˆå§‹åŒ–<code>vector</code>å¯¹è±¡çš„æ–¹æ³•</p><table><thead><tr><th>æ–¹æ³•</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>vector&lt;T&gt; v1</code></td><td><code>v1</code>æ˜¯ä¸€ä¸ªç©º<code>vector</code>ï¼Œå®ƒæ½œåœ¨çš„å…ƒç´ æ˜¯<code>T</code>ç±»å‹çš„ï¼Œæ‰§è¡Œé»˜è®¤åˆå§‹åŒ–</td></tr><tr><td><code>vector&lt;T&gt; v2(v1)</code></td><td><code>v2</code>ä¸­åŒ…å«æœ‰<code>v1</code>æ‰€æœ‰å…ƒç´ çš„å‰¯æœ¬</td></tr><tr><td><code>vector&lt;T&gt; v2 = v1</code></td><td>ç­‰ä»·äº<code>v2(v1)</code>ï¼Œ<code>v2</code>ä¸­åŒ…å«<code>v1</code>æ‰€æœ‰å…ƒç´ çš„å‰¯æœ¬</td></tr><tr><td><code>vector&lt;T&gt; v3(n, val)</code></td><td><code>v3</code>åŒ…å«äº†nä¸ªé‡å¤çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ çš„å€¼éƒ½æ˜¯<code>val</code></td></tr><tr><td><code>vector&lt;T&gt; v4(n)</code></td><td><code>v4</code>åŒ…å«äº†nä¸ªé‡å¤åœ°æ‰§è¡Œäº†å€¼åˆå§‹åŒ–çš„å¯¹è±¡</td></tr><tr><td><code>vector&lt;T&gt; v5&#123;a, b, c...&#125;</code></td><td><code>v5</code>åŒ…å«äº†åˆå§‹å€¼ä¸ªæ•°çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ è¢«èµ‹äºˆç›¸åº”çš„åˆå§‹å€¼</td></tr><tr><td><code>vector&lt;T&gt; v5=&#123;a, b, c...&#125;</code></td><td>ç­‰ä»·äº<code>v5&#123;a, b, c...&#125;</code></td></tr></tbody></table><ul><li>åˆ—è¡¨åˆå§‹åŒ–ï¼š <code>vector&lt;string&gt; v&#123;&quot;a&quot;, &quot;an&quot;, &quot;the&quot;&#125;;</code> ï¼ˆC++11ï¼‰</li></ul><h3 id="å‘vectorå¯¹è±¡ä¸­æ·»åŠ å…ƒç´ "><a href="#å‘vectorå¯¹è±¡ä¸­æ·»åŠ å…ƒç´ " class="headerlink" title="å‘vectorå¯¹è±¡ä¸­æ·»åŠ å…ƒç´ "></a>å‘vectorå¯¹è±¡ä¸­æ·»åŠ å…ƒç´ </h3><ul><li><code>v.push_back(e)</code> åœ¨å°¾éƒ¨å¢åŠ å…ƒç´ ã€‚</li></ul><h3 id="å…¶ä»–vectoræ“ä½œ"><a href="#å…¶ä»–vectoræ“ä½œ" class="headerlink" title="å…¶ä»–vectoræ“ä½œ"></a>å…¶ä»–vectoræ“ä½œ</h3><p><code>vector</code>æ”¯æŒçš„æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>v.emtpy()</code></td><td>å¦‚æœ<code>v</code>ä¸å«æœ‰ä»»ä½•å…ƒç´ ï¼Œè¿”å›çœŸï¼›å¦åˆ™è¿”å›å‡</td></tr><tr><td><code>v.size()</code></td><td>è¿”å›<code>v</code>ä¸­å…ƒç´ çš„ä¸ªæ•°</td></tr><tr><td><code>v.push_back(t)</code></td><td>å‘<code>v</code>çš„å°¾ç«¯æ·»åŠ ä¸€ä¸ªå€¼ä¸º<code>t</code>çš„å…ƒç´ </td></tr><tr><td><code>v[n]</code></td><td>è¿”å›<code>v</code>ä¸­ç¬¬<code>n</code>ä¸ªä½ç½®ä¸Šå…ƒç´ çš„<strong>å¼•ç”¨</strong></td></tr><tr><td><code>v1 = v2</code></td><td>ç”¨<code>v2</code>ä¸­çš„å…ƒç´ æ‹·è´æ›¿æ¢<code>v1</code>ä¸­çš„å…ƒç´ </td></tr><tr><td><code>v1 = &#123;a,b,c...&#125;</code></td><td>ç”¨åˆ—è¡¨ä¸­å…ƒç´ çš„æ‹·è´æ›¿æ¢<code>v1</code>ä¸­çš„å…ƒç´ </td></tr><tr><td><code>v1 == v2</code></td><td><code>v1</code>å’Œ<code>v2</code>ç›¸ç­‰å½“ä¸”ä»…å½“å®ƒä»¬çš„å…ƒç´ æ•°é‡ç›¸åŒä¸”å¯¹åº”ä½ç½®çš„å…ƒç´ å€¼éƒ½ç›¸åŒ</td></tr><tr><td><code>v1 != v2</code></td><td>åŒä¸Š</td></tr><tr><td><code>&lt;</code>,<code>&lt;=</code>,<code>&gt;</code>, <code>&gt;=</code></td><td>ä»¥å­—å…¸é¡ºåºè¿›è¡Œæ¯”è¾ƒ</td></tr></tbody></table><ul><li>èŒƒå›´<code>for</code>è¯­å¥å†…ä¸åº”è¯¥æ”¹å˜å…¶éå†åºåˆ—çš„å¤§å°ã€‚</li><li><code>vector</code>å¯¹è±¡ï¼ˆä»¥åŠ<code>string</code>å¯¹è±¡ï¼‰çš„ä¸‹æ ‡è¿ç®—ç¬¦ï¼Œåªèƒ½å¯¹ç¡®çŸ¥å·²å­˜åœ¨çš„å…ƒç´ æ‰§è¡Œä¸‹æ ‡æ“ä½œï¼Œä¸èƒ½ç”¨äºæ·»åŠ å…ƒç´ ã€‚</li></ul><h2 id="è¿­ä»£å™¨iterator"><a href="#è¿­ä»£å™¨iterator" class="headerlink" title="è¿­ä»£å™¨iterator"></a>è¿­ä»£å™¨iterator</h2><ul><li>æ‰€æœ‰æ ‡å‡†åº“å®¹å™¨éƒ½å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨ã€‚</li><li>ç±»ä¼¼äºæŒ‡é’ˆç±»å‹ï¼Œè¿­ä»£å™¨ä¹Ÿæä¾›äº†å¯¹å¯¹è±¡çš„é—´æ¥è®¿é—®ã€‚</li></ul><h3 id="ä½¿ç”¨è¿­ä»£å™¨"><a href="#ä½¿ç”¨è¿­ä»£å™¨" class="headerlink" title="ä½¿ç”¨è¿­ä»£å™¨"></a>ä½¿ç”¨è¿­ä»£å™¨</h3><ul><li><code>vector&lt;int&gt;::iterator iter</code>ã€‚</li><li><code>auto b = v.begin();</code>è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li><code>auto e = v.end();</code>è¿”å›æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªï¼ˆå“¨å…µï¼Œå°¾å,one past the endï¼‰çš„è¿­ä»£å™¨ï¼ˆoff the endï¼‰ã€‚</li><li>å¦‚æœå®¹å™¨ä¸ºç©ºï¼Œ <code>begin()</code>å’Œ <code>end()</code>è¿”å›çš„æ˜¯åŒä¸€ä¸ªè¿­ä»£å™¨ï¼Œéƒ½æ˜¯å°¾åè¿­ä»£å™¨ã€‚</li><li>ä½¿ç”¨è§£å¼•ç”¨ç¬¦<code>*</code>è®¿é—®è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´ ã€‚</li><li>å…»æˆä½¿ç”¨è¿­ä»£å™¨å’Œ<code>!=</code>çš„ä¹ æƒ¯ï¼ˆæ³›å‹ç¼–ç¨‹ï¼‰ã€‚</li><li><strong>å®¹å™¨</strong>ï¼šå¯ä»¥åŒ…å«å…¶ä»–å¯¹è±¡ï¼›ä½†æ‰€æœ‰çš„å¯¹è±¡å¿…é¡»ç±»å‹ç›¸åŒã€‚</li><li><strong>è¿­ä»£å™¨ï¼ˆiteratorï¼‰</strong>ï¼šæ¯ç§æ ‡å‡†å®¹å™¨éƒ½æœ‰è‡ªå·±çš„è¿­ä»£å™¨ã€‚<code>C++</code>å€¾å‘äºç”¨è¿­ä»£å™¨è€Œä¸æ˜¯ä¸‹æ ‡éå†å…ƒç´ ã€‚</li><li><strong>const_iterator</strong>ï¼šåªèƒ½è¯»å–å®¹å™¨å†…å…ƒç´ ä¸èƒ½æ”¹å˜ã€‚</li><li><strong>ç®­å¤´è¿ç®—ç¬¦</strong>ï¼š è§£å¼•ç”¨ + æˆå‘˜è®¿é—®ï¼Œ<code>it-&gt;mem</code>ç­‰ä»·äº <code>(*it).mem</code></li><li><strong>è°¨è®°</strong>ï¼šä½†å‡¡æ˜¯ä½¿ç”¨äº†è¿­ä»£å™¨çš„å¾ªç¯ä½“ï¼Œéƒ½ä¸è¦å‘è¿­ä»£å™¨æ‰€å±çš„å®¹å™¨æ·»åŠ å…ƒç´ ã€‚</li></ul><p>æ ‡å‡†å®¹å™¨è¿­ä»£å™¨çš„è¿ç®—ç¬¦:</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>*iter</code></td><td>è¿”å›è¿­ä»£å™¨<code>iter</code>æ‰€æŒ‡å‘çš„<strong>å…ƒç´ çš„å¼•ç”¨</strong></td></tr><tr><td><code>iter-&gt;mem</code></td><td>ç­‰ä»·äº<code>(*iter).mem</code></td></tr><tr><td><code>++iter</code></td><td>ä»¤<code>iter</code>æŒ‡ç¤ºå®¹å™¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </td></tr><tr><td><code>--iter</code></td><td>ä»¤<code>iter</code>æŒ‡ç¤ºå®¹å™¨ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ </td></tr><tr><td><code>iter1 == iter2</code></td><td>åˆ¤æ–­ä¸¤ä¸ªè¿­ä»£å™¨æ˜¯å¦ç›¸ç­‰</td></tr></tbody></table><h3 id="è¿­ä»£å™¨è¿ç®—"><a href="#è¿­ä»£å™¨è¿ç®—" class="headerlink" title="è¿­ä»£å™¨è¿ç®—"></a>è¿­ä»£å™¨è¿ç®—</h3><p><code>vector</code>å’Œ<code>string</code>è¿­ä»£å™¨æ”¯æŒçš„è¿ç®—ï¼š</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>iter + n</code></td><td>è¿­ä»£å™¨åŠ ä¸Šä¸€ä¸ªæ•´æ•°å€¼ä»å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡ç¤ºçš„æ–°ä½ç½®å’ŒåŸæ¥ç›¸æ¯”å‘å‰ç§»åŠ¨äº†è‹¥å¹²ä¸ªå…ƒç´ ã€‚ç»“æœè¿­ä»£å™¨æˆ–è€…æŒ‡ç¤ºå®¹å™¨å†…çš„ä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è€…æŒ‡ç¤ºå®¹å™¨å°¾å…ƒç´ çš„ä¸‹ä¸€ä½ç½®ã€‚</td></tr><tr><td><code>iter - n</code></td><td>è¿­ä»£å™¨å‡å»ä¸€ä¸ªè¯ä¹¦ä»å¾—åˆ°ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨æŒ‡ç¤ºçš„æ–°ä½ç½®æ¯”åŸæ¥å‘åç§»åŠ¨äº†è‹¥å¹²ä¸ªå…ƒç´ ã€‚ç»“æœè¿­ä»£å™¨æˆ–è€…æŒ‡å‘å®¹å™¨å†…çš„ä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è€…æŒ‡ç¤ºå®¹å™¨å°¾å…ƒç´ çš„ä¸‹ä¸€ä½ç½®ã€‚</td></tr><tr><td><code>iter1 += n</code></td><td>è¿­ä»£å™¨åŠ æ³•çš„å¤åˆèµ‹å€¼è¯­å¥ï¼Œå°†<code>iter1</code>åŠ nçš„ç»“æœèµ‹ç»™<code>iter1</code></td></tr><tr><td><code>iter1 -= n</code></td><td>è¿­ä»£å™¨å‡æ³•çš„å¤åˆèµ‹å€¼è¯­å¥ï¼Œå°†<code>iter2</code>å‡nçš„åŠ è¿‡èµ‹ç»™<code>iter1</code></td></tr><tr><td><code>iter1 - iter2</code></td><td>ä¸¤ä¸ªè¿­ä»£å™¨ç›¸å‡çš„ç»“æœæ˜¯å®ƒä»¬ä¹‹é—´çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°†è¿ç®—ç¬¦å³ä¾§çš„è¿­ä»£å™¨å‘å‰ç§»åŠ¨å·®å€¼ä¸ªå…ƒç´ åå¾—åˆ°å·¦ä¾§çš„è¿­ä»£å™¨ã€‚å‚ä¸è¿ç®—çš„ä¸¤ä¸ªè¿­ä»£å™¨å¿…é¡»æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå®¹å™¨ä¸­çš„å…ƒç´ æˆ–è€…å°¾å…ƒç´ çš„ä¸‹ä¸€ä½ç½®ã€‚</td></tr><tr><td><code>&gt;</code>ã€<code>&gt;=</code>ã€<code>&lt;</code>ã€<code>&lt;=</code></td><td>è¿­ä»£å™¨çš„å…³ç³»è¿ç®—ç¬¦ï¼Œå¦‚æœæŸè¿­ä»£å™¨</td></tr></tbody></table><ul><li><strong>difference_type</strong>ï¼šä¿è¯è¶³å¤Ÿå¤§ä»¥å­˜å‚¨ä»»ä½•ä¸¤ä¸ªè¿­ä»£å™¨å¯¹è±¡é—´çš„è·ç¦»ï¼Œå¯æ­£å¯è´Ÿã€‚</li></ul><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><ul><li>ç›¸å½“äºvectorçš„ä½çº§ç‰ˆï¼Œ<strong>é•¿åº¦å›ºå®š</strong>ã€‚</li></ul><h3 id="å®šä¹‰å’Œåˆå§‹åŒ–å†…ç½®æ•°ç»„"><a href="#å®šä¹‰å’Œåˆå§‹åŒ–å†…ç½®æ•°ç»„" class="headerlink" title="å®šä¹‰å’Œåˆå§‹åŒ–å†…ç½®æ•°ç»„"></a>å®šä¹‰å’Œåˆå§‹åŒ–å†…ç½®æ•°ç»„</h3><ul><li>åˆå§‹åŒ–ï¼š<code>char input_buffer[buffer_size];</code>ï¼Œé•¿åº¦å¿…é¡»æ˜¯constè¡¨è¾¾å¼ï¼Œæˆ–è€…ä¸å†™ï¼Œè®©ç¼–è¯‘å™¨è‡ªå·±æ¨æ–­ã€‚</li><li>æ•°ç»„ä¸å…è®¸ç›´æ¥èµ‹å€¼ç»™å¦ä¸€ä¸ªæ•°ç»„ã€‚</li></ul><h3 id="è®¿é—®æ•°ç»„å…ƒç´ "><a href="#è®¿é—®æ•°ç»„å…ƒç´ " class="headerlink" title="è®¿é—®æ•°ç»„å…ƒç´ "></a>è®¿é—®æ•°ç»„å…ƒç´ </h3><ul><li>æ•°ç»„ä¸‹æ ‡çš„ç±»å‹ï¼š<code>size_t</code> ã€‚</li><li>å­—ç¬¦æ•°ç»„çš„ç‰¹æ®Šæ€§ï¼šç»“å°¾å¤„æœ‰ä¸€ä¸ªç©ºå­—ç¬¦ï¼Œå¦‚ <code>char a[] = &quot;hello&quot;;</code> ã€‚</li><li>ç”¨æ•°ç»„åˆå§‹åŒ– <code>vector</code>ï¼š <code>int a[] = &#123;1,2,3,4,5&#125;; vector&lt;int&gt; v(begin(a), end(a));</code> ã€‚</li></ul><h3 id="æ•°ç»„å’ŒæŒ‡é’ˆ"><a href="#æ•°ç»„å’ŒæŒ‡é’ˆ" class="headerlink" title="æ•°ç»„å’ŒæŒ‡é’ˆ"></a>æ•°ç»„å’ŒæŒ‡é’ˆ</h3><ul><li>ä½¿ç”¨æ•°ç»„æ—¶ï¼Œç¼–è¯‘å™¨ä¸€èˆ¬ä¼šæŠŠå®ƒè½¬æ¢æˆæŒ‡é’ˆã€‚</li><li>æ ‡å‡†åº“ç±»å‹é™å®šä½¿ç”¨çš„ä¸‹æ ‡å¿…é¡»æ˜¯æ— ç¬¦å·ç±»å‹ï¼Œè€Œå†…ç½®çš„ä¸‹æ ‡å¯ä»¥å¤„ç†è´Ÿå€¼ã€‚ </li><li><strong>æŒ‡é’ˆè®¿é—®æ•°ç»„</strong>ï¼šåœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ•°ç»„åæ—¶ï¼Œåå­—ä¼šè‡ªåŠ¨è½¬æ¢æˆæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚</li></ul><h2 id="Cé£æ ¼å­—ç¬¦ä¸²"><a href="#Cé£æ ¼å­—ç¬¦ä¸²" class="headerlink" title="Cé£æ ¼å­—ç¬¦ä¸²"></a>Cé£æ ¼å­—ç¬¦ä¸²</h2><ul><li>ä»Cç»§æ‰¿æ¥çš„å­—ç¬¦ä¸²ã€‚</li><li>ç”¨ç©ºå­—ç¬¦ç»“æŸï¼ˆ<code>\0</code>ï¼‰ã€‚</li><li>å¯¹å¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œä½¿ç”¨æ ‡å‡†åº“ <code>string</code>æ¯”ä½¿ç”¨Cé£æ ¼å­—ç¬¦ä¸²æ›´å®‰å…¨ã€æ›´é«˜æ•ˆã€‚</li><li>è·å– <code>string</code> ä¸­çš„ <code>cstring</code> ï¼š <code>const char *str = s.c_str();</code> ã€‚</li></ul><p>Cæ ‡å‡†åº“Stringå‡½æ•°ï¼Œå®šä¹‰åœ¨<code>&lt;cstring&gt;</code> ä¸­ï¼š</p><table><thead><tr><th>å‡½æ•°</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td><code>strlen(p)</code></td><td>è¿”å›<code>p</code>çš„é•¿åº¦ï¼Œç©ºå­—ç¬¦ä¸è®¡ç®—åœ¨å†…</td></tr><tr><td><code>strcmp(p1, p2)</code></td><td>æ¯”è¾ƒ<code>p1</code>å’Œ<code>p2</code>çš„ç›¸ç­‰æ€§ã€‚å¦‚æœ<code>p1==p2</code>ï¼Œè¿”å›0ï¼›å¦‚æœ<code>p1&gt;p2</code>ï¼Œè¿”å›ä¸€ä¸ªæ­£å€¼ï¼›å¦‚æœ<code>p1&lt;p2</code>ï¼Œè¿”å›ä¸€ä¸ªè´Ÿå€¼ã€‚</td></tr><tr><td><code>strcat(p1, p2)</code></td><td>å°†<code>p2</code>é™„åŠ åˆ°<code>p1</code>ä¹‹åï¼Œè¿”å›<code>p1</code></td></tr><tr><td><code>strcpy(p1, p2)</code></td><td>å°†<code>p2</code>æ‹·è´ç»™<code>p1</code>ï¼Œè¿”å›<code>p1</code></td></tr></tbody></table><h2 id="å¤šç»´æ•°ç»„"><a href="#å¤šç»´æ•°ç»„" class="headerlink" title="å¤šç»´æ•°ç»„"></a>å¤šç»´æ•°ç»„</h2><ul><li><strong>å¤šç»´æ•°ç»„çš„åˆå§‹åŒ–</strong>ï¼š <code>int ia[3][4] = &#123;&#123;0,1,2,3&#125;, ...&#125;</code>ã€‚</li><li>ä½¿ç”¨èŒƒå›´forè¯­å¥æ—¶ï¼Œé™¤äº†æœ€å†…å±‚çš„å¾ªç¯å¤–ï¼Œå…¶ä»–æ‰€æœ‰å¾ªç¯çš„æ§åˆ¶å˜é‡éƒ½åº”è¯¥æ˜¯å¼•ç”¨ç±»å‹ã€‚</li></ul><h2 id="æŒ‡é’ˆvså¼•ç”¨"><a href="#æŒ‡é’ˆvså¼•ç”¨" class="headerlink" title="æŒ‡é’ˆvså¼•ç”¨"></a>æŒ‡é’ˆvså¼•ç”¨</h2><ul><li>å¼•ç”¨æ€»æ˜¯æŒ‡å‘æŸä¸ªå¯¹è±¡ï¼Œå®šä¹‰å¼•ç”¨æ—¶æ²¡æœ‰åˆå§‹åŒ–æ˜¯é”™çš„ã€‚</li><li>ç»™å¼•ç”¨èµ‹å€¼ï¼Œä¿®æ”¹çš„æ˜¯è¯¥å¼•ç”¨æ‰€å…³è”çš„å¯¹è±¡çš„å€¼ï¼Œè€Œä¸æ˜¯è®©å¼•ç”¨å’Œå¦ä¸€ä¸ªå¯¹è±¡ç›¸å…³è”ã€‚</li></ul><h2 id="æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ"><a href="#æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ" class="headerlink" title="æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ"></a>æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ</h2><ul><li>å®šä¹‰ï¼š <code>int **ppi = &amp;pi;</code></li><li>è§£å¼•ç”¨ï¼š<code>**ppi</code></li></ul><h2 id="åŠ¨æ€æ•°ç»„"><a href="#åŠ¨æ€æ•°ç»„" class="headerlink" title="åŠ¨æ€æ•°ç»„"></a>åŠ¨æ€æ•°ç»„</h2><ul><li>ä½¿ç”¨ <code>new</code>å’Œ <code>delete</code>è¡¨è¾¾å’Œcä¸­<code>malloc</code>å’Œ<code>free</code>ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå³åœ¨å †ï¼ˆè‡ªç”±å­˜å‚¨åŒºï¼‰ä¸­åˆ†é…å­˜å‚¨ç©ºé—´ã€‚</li><li>å®šä¹‰ï¼š <code>int *pia = new int[10];</code> 10å¯ä»¥è¢«ä¸€ä¸ªå˜é‡æ›¿ä»£ã€‚</li><li>é‡Šæ”¾ï¼š <code>delete [] pia;</code>ï¼Œæ³¨æ„ä¸è¦å¿˜è®°<code>[]</code>ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°4</title>
      <link href="2021/04/10/notes/ch04/"/>
      <url>2021/04/10/notes/ch04/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å››ç« -è¡¨è¾¾å¼"><a href="#ç¬¬å››ç« -è¡¨è¾¾å¼" class="headerlink" title="ç¬¬å››ç«  è¡¨è¾¾å¼"></a>ç¬¬å››ç«  è¡¨è¾¾å¼</h1><h2 id="è¡¨è¾¾å¼åŸºç¡€"><a href="#è¡¨è¾¾å¼åŸºç¡€" class="headerlink" title="è¡¨è¾¾å¼åŸºç¡€"></a>è¡¨è¾¾å¼åŸºç¡€</h2><ul><li><strong>é‡è½½è¿ç®—ç¬¦</strong>ï¼šå½“è¿ç®—ç¬¦ä½œç”¨åœ¨ç±»ç±»å‹çš„è¿ç®—å¯¹è±¡æ—¶ï¼Œç”¨æˆ·å¯ä»¥è‡ªè¡Œå®šä¹‰å…¶å«ä¹‰ã€‚</li><li><strong>å·¦å€¼å’Œå³å€¼</strong>ï¼š<ul><li>Cä¸­åŸæ„ï¼šå·¦å€¼<strong>å¯ä»¥</strong>åœ¨è¡¨è¾¾å¼å·¦è¾¹ï¼Œå³å€¼ä¸èƒ½ã€‚</li><li><code>C++</code>ï¼šå½“ä¸€ä¸ªå¯¹è±¡è¢«ç”¨ä½œ<strong>å³å€¼</strong>çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯å¯¹è±¡çš„<strong>å€¼</strong>ï¼ˆå†…å®¹ï¼‰ï¼›</li><li>è¢«ç”¨åš<strong>å·¦å€¼</strong>æ—¶ï¼Œç”¨çš„æ˜¯å¯¹è±¡çš„<strong>èº«ä»½</strong>ï¼ˆåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼‰ã€‚</li></ul></li></ul><h2 id="ç®—æœ¯è¿ç®—ç¬¦"><a href="#ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦"></a>ç®—æœ¯è¿ç®—ç¬¦</h2><ul><li><strong>æº¢å‡º</strong>ï¼šå½“è®¡ç®—çš„ç»“æœè¶…å‡ºè¯¥ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´æ—¶å°±ä¼šäº§ç”Ÿæº¢å‡ºã€‚</li></ul><h2 id="é€»è¾‘è¿ç®—ç¬¦"><a href="#é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦"></a>é€»è¾‘è¿ç®—ç¬¦</h2><ul><li><strong>çŸ­è·¯æ±‚å€¼</strong>ï¼šé€»è¾‘ä¸è¿ç®—ç¬¦å’Œé€»è¾‘æˆ–è¿ç®—ç¬¦éƒ½æ˜¯å…ˆæ±‚å·¦ä¾§è¿ç®—å¯¹è±¡çš„å€¼å†æ±‚å³ä¾§è¿ç®—å¯¹è±¡çš„å€¼ï¼Œå½“ä¸”ä»…å½“å·¦ä¾§è¿ç®—å¯¹è±¡æ— æ³•ç¡®å®šè¡¨è¾¾å¼çš„ç»“æœæ—¶æ‰ä¼šè®¡ç®—å³ä¾§è¿ç®—å¯¹è±¡çš„å€¼ã€‚</li></ul><h2 id="èµ‹å€¼è¿ç®—ç¬¦"><a href="#èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="èµ‹å€¼è¿ç®—ç¬¦"></a>èµ‹å€¼è¿ç®—ç¬¦</h2><ul><li>å¦‚æœèµ‹å€¼è¿ç®—çš„å·¦å³ä¾§è¿ç®—å¯¹è±¡ç±»å‹ä¸åŒï¼Œåˆ™å³ä¾§è¿ç®—å¯¹è±¡å°†è½¬æ¢æˆå·¦ä¾§è¿ç®—å¯¹è±¡çš„ç±»å‹ã€‚</li><li>èµ‹å€¼è¿ç®—ç¬¦æ»¡è¶³å³ç»“åˆå¾‹ï¼Œè¿™ç‚¹å’Œå…¶ä»–äºŒå…ƒè¿ç®—ç¬¦ä¸ä¸€æ ·ã€‚ <code>ival = jval = 0;</code>ç­‰ä»·äº<code>ival = (jval = 0);</code></li><li>èµ‹å€¼è¿ç®—ä¼˜å…ˆçº§æ¯”è¾ƒä½ã€‚</li></ul><h2 id="æ¡ä»¶è¿ç®—ç¬¦"><a href="#æ¡ä»¶è¿ç®—ç¬¦" class="headerlink" title="æ¡ä»¶è¿ç®—ç¬¦"></a>æ¡ä»¶è¿ç®—ç¬¦</h2><ul><li>æ¡ä»¶è¿ç®—ç¬¦ï¼ˆ<code>?:</code>ï¼‰å…è®¸æˆ‘ä»¬æŠŠç®€å•çš„<code>if-else</code>é€»è¾‘åµŒå…¥åˆ°å•ä¸ªè¡¨è¾¾å¼ä¸­å»ï¼ŒæŒ‰ç…§å¦‚ä¸‹å½¢å¼ï¼š<code>cond? expr1: expr2</code></li></ul><h2 id="ä½è¿ç®—ç¬¦"><a href="#ä½è¿ç®—ç¬¦" class="headerlink" title="ä½è¿ç®—ç¬¦"></a>ä½è¿ç®—ç¬¦</h2><ul><li>ä½è¿ç®—ç¬¦æ˜¯ä½œç”¨äº<strong>æ•´æ•°ç±»å‹</strong>çš„è¿ç®—å¯¹è±¡ã€‚</li><li>äºŒè¿›åˆ¶ä½å‘å·¦ç§»ï¼ˆ<code>&lt;&lt;</code>ï¼‰æˆ–è€…å‘å³ç§»ï¼ˆ<code>&gt;&gt;</code>ï¼‰ï¼Œç§»å‡ºè¾¹ç•Œå¤–çš„ä½å°±è¢«èˆå¼ƒæ‰äº†ã€‚</li><li>ä½å–åï¼ˆ<code>~</code>ï¼‰ã€ä¸ï¼ˆ<code>&amp;</code>ï¼‰ã€æˆ–ï¼ˆ<code>|</code>ï¼‰ã€å¼‚æˆ–ï¼ˆ<code>^</code>ï¼‰</li></ul><h2 id="sizeofè¿ç®—ç¬¦"><a href="#sizeofè¿ç®—ç¬¦" class="headerlink" title="sizeofè¿ç®—ç¬¦"></a>sizeofè¿ç®—ç¬¦</h2><ul><li>è¿”å›ä¸€æ¡è¡¨è¾¾å¼æˆ–ä¸€ä¸ªç±»å‹åå­—æ‰€å çš„<strong>å­—èŠ‚æ•°</strong>ã€‚è¿”å›çš„ç±»å‹æ˜¯ <code>size_t</code>ã€‚</li><li>ä¸¤ç§å½¢å¼ï¼š <code>sizeof (type)</code>å’Œ <code>sizeof expr</code></li></ul><h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h2><h3 id="éšå¼ç±»å‹è½¬æ¢"><a href="#éšå¼ç±»å‹è½¬æ¢" class="headerlink" title="éšå¼ç±»å‹è½¬æ¢"></a>éšå¼ç±»å‹è½¬æ¢</h3><ul><li>æ¯” <code>int</code>ç±»å‹å°çš„æ•´æ•°å€¼å…ˆæå‡ä¸ºè¾ƒå¤§çš„æ•´æ•°ç±»å‹ã€‚</li><li>æ¡ä»¶ä¸­ï¼Œéå¸ƒå°”è½¬æ¢æˆå¸ƒå°”ã€‚</li><li>åˆå§‹åŒ–ä¸­ï¼Œåˆå§‹å€¼è½¬æ¢æˆå˜é‡çš„ç±»å‹ã€‚</li><li>ç®—æœ¯è¿ç®—æˆ–è€…å…³ç³»è¿ç®—çš„è¿ç®—å¯¹è±¡æœ‰å¤šç§ç±»å‹ï¼Œè¦è½¬æ¢æˆåŒä¸€ç§ç±»å‹ã€‚</li><li>å‡½æ•°è°ƒç”¨æ—¶ã€‚</li></ul><h3 id="æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå°½é‡é¿å…ï¼‰"><a href="#æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå°½é‡é¿å…ï¼‰" class="headerlink" title="æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå°½é‡é¿å…ï¼‰"></a>æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå°½é‡é¿å…ï¼‰</h3><ul><li><strong>static_cast</strong>ï¼šä»»ä½•æ˜ç¡®å®šä¹‰çš„ç±»å‹è½¬æ¢ï¼Œåªè¦ä¸åŒ…å«åº•å±‚constï¼Œéƒ½å¯ä»¥ä½¿ç”¨ã€‚ <code>double slope = static_cast&lt;double&gt;(j);</code></li><li><strong>dynamic_cast</strong>ï¼šæ”¯æŒè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ã€‚</li><li><strong>const_cast</strong>ï¼šåªèƒ½æ”¹å˜è¿ç®—å¯¹è±¡çš„åº•å±‚constï¼Œä¸€èˆ¬å¯ç”¨äºå»é™¤constæ€§è´¨ã€‚ <code>const char *pc; char *p = const_cast&lt;char*&gt;(pc)</code></li><li><strong>reinterpret_cast</strong>ï¼šé€šå¸¸ä¸ºè¿ç®—å¯¹è±¡çš„ä½æ¨¡å¼æä¾›ä½å±‚æ¬¡ä¸Šçš„é‡æ–°è§£é‡Šã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°2</title>
      <link href="2021/04/10/notes/ch02/"/>
      <url>2021/04/10/notes/ch02/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬äºŒç« -å˜é‡å’ŒåŸºæœ¬ç±»å‹"><a href="#ç¬¬äºŒç« -å˜é‡å’ŒåŸºæœ¬ç±»å‹" class="headerlink" title="ç¬¬äºŒç«  å˜é‡å’ŒåŸºæœ¬ç±»å‹"></a>ç¬¬äºŒç«  å˜é‡å’ŒåŸºæœ¬ç±»å‹</h1><h3 id="åŸºæœ¬å†…ç½®ç±»å‹"><a href="#åŸºæœ¬å†…ç½®ç±»å‹" class="headerlink" title="åŸºæœ¬å†…ç½®ç±»å‹"></a>åŸºæœ¬å†…ç½®ç±»å‹</h3><p><strong>åŸºæœ¬ç®—æ•°ç±»å‹</strong>ï¼š</p><table><thead><tr><th>ç±»å‹</th><th>å«ä¹‰</th><th>æœ€å°å°ºå¯¸</th></tr></thead><tbody><tr><td><code>bool</code></td><td>å¸ƒå°”ç±»å‹</td><td>8bits</td></tr><tr><td><code>char</code></td><td>å­—ç¬¦</td><td>8bits</td></tr><tr><td><code>wchar_t</code></td><td>å®½å­—ç¬¦</td><td>16bits</td></tr><tr><td><code>char16_t</code></td><td>Unicodeå­—ç¬¦</td><td>16bits</td></tr><tr><td><code>char32_t</code></td><td>Unicodeå­—ç¬¦</td><td>32bits</td></tr><tr><td><code>short</code></td><td>çŸ­æ•´å‹</td><td>16bits</td></tr><tr><td><code>int</code></td><td>æ•´å‹</td><td>16bits (åœ¨32ä½æœºå™¨ä¸­æ˜¯32bits)</td></tr><tr><td><code>long</code></td><td>é•¿æ•´å‹</td><td>32bits</td></tr><tr><td><code>long long</code></td><td>é•¿æ•´å‹</td><td>64bits ï¼ˆæ˜¯åœ¨C++11ä¸­æ–°å®šä¹‰çš„ï¼‰</td></tr><tr><td><code>float</code></td><td>å•ç²¾åº¦æµ®ç‚¹æ•°</td><td>6ä½æœ‰æ•ˆæ•°å­—</td></tr><tr><td><code>double</code></td><td>åŒç²¾åº¦æµ®ç‚¹æ•°</td><td>10ä½æœ‰æ•ˆæ•°å­—</td></tr><tr><td><code>long double</code></td><td>æ‰©å±•ç²¾åº¦æµ®ç‚¹æ•°</td><td>10ä½æœ‰æ•ˆæ•°å­—</td></tr></tbody></table><h3 id="å¦‚ä½•é€‰æ‹©ç±»å‹"><a href="#å¦‚ä½•é€‰æ‹©ç±»å‹" class="headerlink" title="å¦‚ä½•é€‰æ‹©ç±»å‹"></a>å¦‚ä½•é€‰æ‹©ç±»å‹</h3><ul><li>1.å½“æ˜ç¡®çŸ¥æ™“æ•°å€¼ä¸å¯èƒ½æ˜¯è´Ÿæ•°æ—¶ï¼Œé€‰ç”¨æ— ç¬¦å·ç±»å‹ï¼›</li><li>2.ä½¿ç”¨<code>int</code>æ‰§è¡Œæ•´æ•°è¿ç®—ã€‚ä¸€èˆ¬<code>long</code>çš„å¤§å°å’Œ<code>int</code>ä¸€æ ·ï¼Œè€Œ<code>short</code>å¸¸å¸¸æ˜¾å¾—å¤ªå°ã€‚é™¤éè¶…è¿‡äº†<code>int</code>çš„èŒƒå›´ï¼Œé€‰æ‹©<code>long long</code>ã€‚</li><li>3.ç®—æœ¯è¡¨è¾¾å¼ä¸­ä¸è¦ä½¿ç”¨<code>char</code>æˆ–<code>bool</code>ã€‚</li><li>4.æµ®ç‚¹è¿ç®—é€‰ç”¨<code>double</code>ã€‚</li></ul><h3 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h3><ul><li>éå¸ƒå°”å‹èµ‹ç»™å¸ƒå°”å‹ï¼Œåˆå§‹å€¼ä¸º0åˆ™ç»“æœä¸ºfalseï¼Œå¦åˆ™ä¸ºtrueã€‚</li><li>å¸ƒå°”å‹èµ‹ç»™éå¸ƒå°”å‹ï¼Œåˆå§‹å€¼ä¸ºfalseç»“æœä¸º0ï¼Œåˆå§‹å€¼ä¸ºtrueç»“æœä¸º1ã€‚</li></ul><h3 id="å­—é¢å€¼å¸¸é‡"><a href="#å­—é¢å€¼å¸¸é‡" class="headerlink" title="å­—é¢å€¼å¸¸é‡"></a>å­—é¢å€¼å¸¸é‡</h3><ul><li>ä¸€ä¸ªå½¢å¦‚<code>42</code>çš„å€¼è¢«ç§°ä½œ<strong>å­—é¢å€¼å¸¸é‡</strong>ï¼ˆliteralï¼‰ã€‚<ul><li>æ•´å‹å’Œæµ®ç‚¹å‹å­—é¢å€¼ã€‚</li><li>å­—ç¬¦å’Œå­—ç¬¦ä¸²å­—é¢å€¼ã€‚<ul><li>ä½¿ç”¨ç©ºæ ¼è¿æ¥ï¼Œç»§æ‰¿è‡ªCã€‚</li><li>å­—ç¬¦å­—é¢å€¼ï¼šå•å¼•å·ï¼Œ <code>&#39;a&#39;</code></li><li>å­—ç¬¦ä¸²å­—é¢å€¼ï¼šåŒå¼•å·ï¼Œ <code>&quot;Hello World&quot;&quot;</code></li></ul></li><li>è½¬ä¹‰åºåˆ—ã€‚<code>\n</code>ã€<code>\t</code>ç­‰ã€‚</li><li>å¸ƒå°”å­—é¢å€¼ã€‚<code>true</code>ï¼Œ<code>false</code>ã€‚</li><li>æŒ‡é’ˆå­—é¢å€¼ã€‚<code>nullptr</code></li></ul></li></ul><h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><p><strong>å˜é‡</strong>æä¾›ä¸€ä¸ª<strong>å…·å</strong>çš„ã€å¯ä¾›ç¨‹åºæ“ä½œçš„å­˜å‚¨ç©ºé—´ã€‚   <code>C++</code>ä¸­<strong>å˜é‡</strong>å’Œ<strong>å¯¹è±¡</strong>ä¸€èˆ¬å¯ä»¥äº’æ¢ä½¿ç”¨ã€‚</p><h3 id="å˜é‡å®šä¹‰ï¼ˆdefineï¼‰"><a href="#å˜é‡å®šä¹‰ï¼ˆdefineï¼‰" class="headerlink" title="å˜é‡å®šä¹‰ï¼ˆdefineï¼‰"></a>å˜é‡å®šä¹‰ï¼ˆdefineï¼‰</h3><ul><li><strong>å®šä¹‰å½¢å¼</strong>ï¼šç±»å‹è¯´æ˜ç¬¦ï¼ˆtype specifierï¼‰ + ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡åç»„æˆçš„åˆ—è¡¨ã€‚å¦‚<code>int sum = 0, value, units_sold = 0;</code></li><li><strong>åˆå§‹åŒ–</strong>ï¼ˆinitializeï¼‰ï¼šå¯¹è±¡åœ¨åˆ›å»ºæ—¶è·å¾—äº†ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚<ul><li><strong>åˆå§‹åŒ–ä¸æ˜¯èµ‹å€¼ï¼</strong>ï¼š</li><li>åˆå§‹åŒ– = åˆ›å»ºå˜é‡ + èµ‹äºˆåˆå§‹å€¼</li><li>èµ‹å€¼ = æ“¦é™¤å¯¹è±¡çš„å½“å‰å€¼ + ç”¨æ–°å€¼ä»£æ›¿</li><li><strong>åˆ—è¡¨åˆå§‹åŒ–</strong>ï¼šä½¿ç”¨èŠ±æ‹¬å·<code>&#123;&#125;</code>ï¼Œå¦‚<code>int units_sold&#123;0&#125;;</code></li><li>é»˜è®¤åˆå§‹åŒ–ï¼šå®šä¹‰æ—¶æ²¡æœ‰æŒ‡å®šåˆå§‹å€¼ä¼šè¢«é»˜è®¤åˆå§‹åŒ–ï¼›åœ¨å‡½æ•°ä½“å†…éƒ¨çš„å†…ç½®ç±»å‹å˜é‡å°†ä¸ä¼šè¢«åˆå§‹åŒ–ã€‚</li><li>å»ºè®®åˆå§‹åŒ–æ¯ä¸€ä¸ªå†…ç½®ç±»å‹çš„å˜é‡ã€‚</li></ul></li></ul><h3 id="å˜é‡çš„å£°æ˜ï¼ˆdeclarationï¼‰-vs-å®šä¹‰ï¼ˆdefineï¼‰"><a href="#å˜é‡çš„å£°æ˜ï¼ˆdeclarationï¼‰-vs-å®šä¹‰ï¼ˆdefineï¼‰" class="headerlink" title="å˜é‡çš„å£°æ˜ï¼ˆdeclarationï¼‰ vs å®šä¹‰ï¼ˆdefineï¼‰"></a>å˜é‡çš„<strong>å£°æ˜</strong>ï¼ˆdeclarationï¼‰ vs <strong>å®šä¹‰</strong>ï¼ˆdefineï¼‰</h3><ul><li>ä¸ºäº†æ”¯æŒåˆ†ç¦»å¼ç¼–è¯‘ï¼Œ<code>C++</code>å°†å£°æ˜å’Œå®šä¹‰åŒºåˆ†å¼€ã€‚<strong>å£°æ˜</strong>ä½¿å¾—åå­—ä¸ºç¨‹åºæ‰€çŸ¥ã€‚<strong>å®šä¹‰</strong>è´Ÿè´£åˆ›å»ºä¸åå­—å…³è”çš„å®ä½“ã€‚</li><li><strong>extern</strong>ï¼šåªæ˜¯è¯´æ˜å˜é‡å®šä¹‰åœ¨å…¶ä»–åœ°æ–¹ã€‚</li><li>åªå£°æ˜è€Œä¸å®šä¹‰ï¼š åœ¨å˜é‡åå‰æ·»åŠ å…³é”®å­— <code>extern</code>ï¼Œå¦‚<code>extern int i;</code>ã€‚ä½†å¦‚æœåŒ…å«äº†åˆå§‹å€¼ï¼Œå°±å˜æˆäº†å®šä¹‰ï¼š<code>extern double pi = 3.14;</code></li><li>å˜é‡åªèƒ½è¢«å®šä¹‰ä¸€æ¬¡ï¼Œä½†æ˜¯å¯ä»¥å¤šæ¬¡å£°æ˜ã€‚</li><li>åå­—çš„<strong>ä½œç”¨åŸŸ</strong>ï¼ˆnamescopeï¼‰</li></ul><h2 id="å·¦å€¼å’Œå³å€¼"><a href="#å·¦å€¼å’Œå³å€¼" class="headerlink" title="å·¦å€¼å’Œå³å€¼"></a>å·¦å€¼å’Œå³å€¼</h2><ul><li><strong>å·¦å€¼</strong>ï¼ˆl-valueï¼‰<strong>å¯ä»¥</strong>å‡ºç°åœ¨èµ‹å€¼è¯­å¥çš„å·¦è¾¹æˆ–è€…å³è¾¹ï¼Œæ¯”å¦‚å˜é‡ï¼›</li><li><strong>å³å€¼</strong>ï¼ˆr-valueï¼‰<strong>åªèƒ½</strong>å‡ºç°åœ¨èµ‹å€¼è¯­å¥çš„å³è¾¹ï¼Œæ¯”å¦‚å¸¸é‡ã€‚</li></ul><h2 id="å¤åˆç±»å‹"><a href="#å¤åˆç±»å‹" class="headerlink" title="å¤åˆç±»å‹"></a>å¤åˆç±»å‹</h2><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><ul><li><strong>å¼•ç”¨</strong>ï¼šå¼•ç”¨æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åˆ«åï¼Œå¼•ç”¨ç±»å‹å¼•ç”¨ï¼ˆrefer toï¼‰å¦å¤–ä¸€ç§ç±»å‹ã€‚å¦‚<code>int &amp;refVal = val;</code>ã€‚</li><li>å¼•ç”¨å¿…é¡»åˆå§‹åŒ–ã€‚</li><li>å¼•ç”¨å’Œå®ƒçš„åˆå§‹å€¼æ˜¯<strong>ç»‘å®šbind</strong>åœ¨ä¸€èµ·çš„ï¼Œè€Œ<strong>ä¸æ˜¯æ‹·è´</strong>ã€‚</li></ul><h3 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h3><ul><li>æ˜¯ä¸€ç§ <code>&quot;æŒ‡å‘ï¼ˆpoint toï¼‰&quot;</code>å¦å¤–ä¸€ç§ç±»å‹çš„å¤åˆç±»å‹ã€‚</li><li><strong>å®šä¹‰</strong>æŒ‡é’ˆç±»å‹ï¼š <code>int *ip1;</code>ï¼Œ<strong>ä»å³å‘å·¦è¯»</strong>ï¼Œ<code>ip1</code>æ˜¯æŒ‡å‘<code>int</code>ç±»å‹çš„æŒ‡é’ˆã€‚</li><li>æŒ‡é’ˆå­˜æ”¾æŸä¸ªå¯¹è±¡çš„<strong>åœ°å€</strong>ã€‚</li><li>è·å–å¯¹è±¡çš„åœ°å€ï¼š <code>int i=42; int *p = &amp;i;</code>ã€‚ <code>&amp;</code>æ˜¯<strong>å–åœ°å€ç¬¦</strong>ã€‚</li><li>æŒ‡é’ˆçš„å€¼çš„å››ç§çŠ¶æ€ï¼š<ul><li>1.æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼›</li><li>2.æŒ‡å‘ç´§é‚»å¯¹è±¡çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼›</li><li>3.ç©ºæŒ‡é’ˆï¼›</li><li>4.æ— æ•ˆæŒ‡é’ˆã€‚</li></ul></li><li>æŒ‡é’ˆè®¿é—®å¯¹è±¡ï¼š <code>cout &lt;&lt; *p;</code>ï¼Œ <code>*</code>æ˜¯<strong>è§£å¼•ç”¨ç¬¦</strong>ã€‚</li><li>ç©ºæŒ‡é’ˆä¸æŒ‡å‘ä»»ä½•å¯¹è±¡ã€‚</li><li><code>void*</code>æŒ‡é’ˆå¯ä»¥å­˜æ”¾<strong>ä»»æ„</strong>å¯¹è±¡çš„åœ°å€ã€‚</li><li>å…¶ä»–æŒ‡é’ˆç±»å‹å¿…é¡»è¦ä¸æ‰€æŒ‡å¯¹è±¡<strong>ä¸¥æ ¼åŒ¹é…</strong>ã€‚</li><li>ä¸¤ä¸ªæŒ‡é’ˆç›¸å‡çš„ç±»å‹æ˜¯<code>ptrdiff_t</code>ã€‚</li><li>å»ºè®®ï¼šåˆå§‹åŒ–æ‰€æœ‰æŒ‡é’ˆã€‚</li></ul><h2 id="consté™å®šç¬¦"><a href="#consté™å®šç¬¦" class="headerlink" title="consté™å®šç¬¦"></a>consté™å®šç¬¦</h2><ul><li>åŠ¨æœºï¼šå¸Œæœ›å®šä¹‰ä¸€äº›ä¸èƒ½è¢«æ”¹å˜å€¼çš„å˜é‡ã€‚</li></ul><h3 id="åˆå§‹åŒ–å’Œconst"><a href="#åˆå§‹åŒ–å’Œconst" class="headerlink" title="åˆå§‹åŒ–å’Œconst"></a>åˆå§‹åŒ–å’Œconst</h3><ul><li>constå¯¹è±¡<strong>å¿…é¡»åˆå§‹åŒ–</strong>ï¼Œä¸”<strong>ä¸èƒ½è¢«æ”¹å˜</strong>ã€‚</li><li>constå˜é‡é»˜è®¤ä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶è®¿é—®ï¼Œéè¦è®¿é—®ï¼Œå¿…é¡»åœ¨æŒ‡å®šconstå‰åŠ externã€‚</li></ul><h3 id="constçš„å¼•ç”¨"><a href="#constçš„å¼•ç”¨" class="headerlink" title="constçš„å¼•ç”¨"></a>constçš„å¼•ç”¨</h3><ul><li><strong>reference to const</strong>ï¼ˆå¯¹å¸¸é‡çš„å¼•ç”¨ï¼‰ï¼šæŒ‡å‘constå¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚ <code>const int ival=1; const int &amp;refVal = ival;</code>ï¼Œå¯ä»¥è¯»å–ä½†ä¸èƒ½ä¿®æ”¹<code>refVal</code>ã€‚</li><li><strong>ä¸´æ—¶é‡</strong>ï¼ˆtemporaryï¼‰å¯¹è±¡ï¼šå½“ç¼–è¯‘å™¨éœ€è¦ä¸€ä¸ªç©ºé—´æ¥æš‚å­˜è¡¨è¾¾å¼çš„æ±‚å€¼ç»“æœæ—¶ï¼Œä¸´æ—¶åˆ›å»ºçš„ä¸€ä¸ªæœªå‘½åçš„å¯¹è±¡ã€‚</li><li>å¯¹ä¸´æ—¶é‡çš„å¼•ç”¨æ˜¯éæ³•è¡Œä¸ºã€‚</li></ul><h3 id="æŒ‡é’ˆå’Œconst"><a href="#æŒ‡é’ˆå’Œconst" class="headerlink" title="æŒ‡é’ˆå’Œconst"></a>æŒ‡é’ˆå’Œconst</h3><ul><li><strong>pointer to const</strong>ï¼ˆæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆï¼‰ï¼šä¸èƒ½ç”¨äºæ”¹å˜å…¶æ‰€æŒ‡å¯¹è±¡çš„å€¼, å¦‚ <code>const double pi = 3.14; const double *cptr = &amp;pi;</code>ã€‚</li><li><strong>const pointer</strong>ï¼šæŒ‡é’ˆæœ¬èº«æ˜¯å¸¸é‡ï¼Œå¦‚ <code>int i = 0; int *const ptr = &amp;i;</code></li></ul><h3 id="é¡¶å±‚const"><a href="#é¡¶å±‚const" class="headerlink" title="é¡¶å±‚const"></a>é¡¶å±‚const</h3><ul><li><code>é¡¶å±‚const</code>ï¼šæŒ‡é’ˆæœ¬èº«æ˜¯ä¸ªå¸¸é‡ã€‚</li><li><code>åº•å±‚const</code>ï¼šæŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡æ˜¯ä¸ªå¸¸é‡ã€‚æ‹·è´æ—¶ä¸¥æ ¼è¦æ±‚ç›¸åŒçš„åº•å±‚constèµ„æ ¼ã€‚</li></ul><h3 id="constexprå’Œå¸¸é‡è¡¨è¾¾å¼"><a href="#constexprå’Œå¸¸é‡è¡¨è¾¾å¼" class="headerlink" title="constexprå’Œå¸¸é‡è¡¨è¾¾å¼"></a><code>constexpr</code>å’Œå¸¸é‡è¡¨è¾¾å¼</h3><ul><li>å¸¸é‡è¡¨è¾¾å¼ï¼šæŒ‡å€¼ä¸ä¼šæ”¹å˜ï¼Œä¸”åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°±èƒ½å¾—åˆ°è®¡ç®—ç»“æœçš„è¡¨è¾¾å¼ã€‚</li><li><code>C++11</code>æ–°æ ‡å‡†è§„å®šï¼Œå…è®¸å°†å˜é‡å£°æ˜ä¸º<code>constexpr</code>ç±»å‹ä»¥ä¾¿ç”±ç¼–è¯‘å™¨æ¥éªŒè¯å˜é‡çš„å€¼æ˜¯å¦æ˜¯ä¸€ä¸ªå¸¸é‡çš„è¡¨è¾¾å¼ã€‚</li></ul><h2 id="å¤„ç†ç±»å‹"><a href="#å¤„ç†ç±»å‹" class="headerlink" title="å¤„ç†ç±»å‹"></a>å¤„ç†ç±»å‹</h2><h3 id="ç±»å‹åˆ«å"><a href="#ç±»å‹åˆ«å" class="headerlink" title="ç±»å‹åˆ«å"></a>ç±»å‹åˆ«å</h3><ul><li>ä¼ ç»Ÿåˆ«åï¼šä½¿ç”¨<strong>typedef</strong>æ¥å®šä¹‰ç±»å‹çš„åŒä¹‰è¯ã€‚ <code>typedef double wages;</code></li><li>æ–°æ ‡å‡†åˆ«åï¼šåˆ«åå£°æ˜ï¼ˆalias declarationï¼‰ï¼š <code>using SI = Sales_item;</code>ï¼ˆC++11ï¼‰</li></ul><h3 id="autoç±»å‹è¯´æ˜ç¬¦"><a href="#autoç±»å‹è¯´æ˜ç¬¦" class="headerlink" title="autoç±»å‹è¯´æ˜ç¬¦"></a>autoç±»å‹è¯´æ˜ç¬¦</h3><ul><li><strong>auto</strong>ç±»å‹è¯´æ˜ç¬¦ï¼šè®©ç¼–è¯‘å™¨<strong>è‡ªåŠ¨æ¨æ–­ç±»å‹</strong>ã€‚</li><li><code>int i = 0, &amp;r = i; auto a = r;</code> æ¨æ–­<code>a</code>çš„ç±»å‹æ˜¯<code>int</code>ã€‚</li><li>ä¼šå¿½ç•¥<code>é¡¶å±‚const</code>ã€‚</li><li><code>const int ci = 1; const auto f = ci;</code>æ¨æ–­ç±»å‹æ˜¯<code>int</code>ï¼Œéœ€è¦è‡ªå·±åŠ <code>const</code></li><li><code>C++11</code></li></ul><h3 id="decltypeç±»å‹æŒ‡ç¤ºç¬¦"><a href="#decltypeç±»å‹æŒ‡ç¤ºç¬¦" class="headerlink" title="decltypeç±»å‹æŒ‡ç¤ºç¬¦"></a>decltypeç±»å‹æŒ‡ç¤ºç¬¦</h3><ul><li>ä»è¡¨è¾¾å¼çš„ç±»å‹æ¨æ–­å‡ºè¦å®šä¹‰çš„å˜é‡çš„ç±»å‹ã€‚</li><li><strong>decltype</strong>ï¼šé€‰æ‹©å¹¶è¿”å›æ“ä½œæ•°çš„<strong>æ•°æ®ç±»å‹</strong>ã€‚</li><li><code>decltype(f()) sum = x;</code> æ¨æ–­<code>sum</code>çš„ç±»å‹æ˜¯å‡½æ•°<code>f</code>çš„è¿”å›ç±»å‹ã€‚</li><li>ä¸ä¼šå¿½ç•¥<code>é¡¶å±‚const</code>ã€‚</li><li><code>C++11</code></li></ul><h2 id="è‡ªå®šä¹‰æ•°æ®ç»“æ„"><a href="#è‡ªå®šä¹‰æ•°æ®ç»“æ„" class="headerlink" title="è‡ªå®šä¹‰æ•°æ®ç»“æ„"></a>è‡ªå®šä¹‰æ•°æ®ç»“æ„</h2><h3 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h3><ul><li>ç±»å¯ä»¥ä»¥å…³é”®å­—<code>struct</code>å¼€å§‹ï¼Œç´§è·Ÿç±»åå’Œç±»ä½“ã€‚</li><li>ç±»æ•°æ®æˆå‘˜ï¼šç±»ä½“å®šä¹‰ç±»çš„æˆå‘˜ã€‚</li><li><code>C++11</code>ï¼šå¯ä»¥ä¸ºç±»æ•°æ®æˆå‘˜æä¾›ä¸€ä¸ª<strong>ç±»å†…åˆå§‹å€¼</strong>ï¼ˆin-class initializerï¼‰ã€‚</li></ul><h3 id="ç¼–å†™è‡ªå·±çš„å¤´æ–‡ä»¶"><a href="#ç¼–å†™è‡ªå·±çš„å¤´æ–‡ä»¶" class="headerlink" title="ç¼–å†™è‡ªå·±çš„å¤´æ–‡ä»¶"></a>ç¼–å†™è‡ªå·±çš„å¤´æ–‡ä»¶</h3><ul><li>å¤´æ–‡ä»¶é€šå¸¸åŒ…å«å“ªäº›åªèƒ½è¢«å®šä¹‰ä¸€æ¬¡çš„å®ä½“ï¼šç±»ã€<code>const</code>å’Œ<code>constexpr</code>å˜é‡ã€‚</li></ul><p>é¢„å¤„ç†å™¨æ¦‚è¿°ï¼š</p><ul><li><strong>é¢„å¤„ç†å™¨</strong>ï¼ˆpreprocessorï¼‰ï¼šç¡®ä¿å¤´æ–‡ä»¶å¤šæ¬¡åŒ…å«ä»èƒ½å®‰å…¨å·¥ä½œã€‚</li><li>å½“é¢„å¤„ç†å™¨çœ‹åˆ°<code>#include</code>æ ‡è®°æ—¶ï¼Œä¼šç”¨æŒ‡å®šçš„å¤´æ–‡ä»¶å†…å®¹ä»£æ›¿<code>#include</code></li><li><strong>å¤´æ–‡ä»¶ä¿æŠ¤ç¬¦</strong>ï¼ˆheader guardï¼‰ï¼šå¤´æ–‡ä»¶ä¿æŠ¤ç¬¦ä¾èµ–äºé¢„å¤„ç†å˜é‡çš„çŠ¶æ€ï¼šå·²å®šä¹‰å’Œæœªå®šä¹‰ã€‚</li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">SALES_DATA_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SALES_DATA_H</span></span>strct Sale_data<span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°5</title>
      <link href="2021/04/10/notes/ch05/"/>
      <url>2021/04/10/notes/ch05/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬äº”ç« -è¯­å¥"><a href="#ç¬¬äº”ç« -è¯­å¥" class="headerlink" title="ç¬¬äº”ç«  è¯­å¥"></a>ç¬¬äº”ç«  è¯­å¥</h1><h2 id="ç®€å•è¯­å¥"><a href="#ç®€å•è¯­å¥" class="headerlink" title="ç®€å•è¯­å¥"></a>ç®€å•è¯­å¥</h2><ul><li><strong>è¡¨è¾¾å¼è¯­å¥</strong>ï¼šä¸€ä¸ªè¡¨è¾¾å¼æœ«å°¾åŠ ä¸Šåˆ†å·ï¼Œå°±å˜æˆäº†è¡¨è¾¾å¼è¯­å¥ã€‚</li><li><strong>ç©ºè¯­å¥</strong>ï¼šåªæœ‰ä¸€ä¸ªå•ç‹¬çš„åˆ†å·ã€‚</li><li><strong>å¤åˆè¯­å¥ï¼ˆå—ï¼‰</strong>ï¼šç”¨èŠ±æ‹¬å· <code>&#123;&#125;</code>åŒ…è£¹èµ·æ¥çš„è¯­å¥å’Œå£°æ˜çš„åºåˆ—ã€‚ä¸€ä¸ªå—å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸã€‚</li></ul><h2 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h2><ul><li><strong>æ‚¬å‚else</strong>ï¼ˆdangling elseï¼‰ï¼šç”¨æ¥æè¿°åœ¨åµŒå¥—çš„<code>if else</code>è¯­å¥ä¸­ï¼Œå¦‚æœ<code>if</code>æ¯”<code>else</code>å¤šæ—¶å¦‚ä½•å¤„ç†çš„é—®é¢˜ã€‚C++ä½¿ç”¨çš„æ–¹æ³•æ˜¯<code>else</code>åŒ¹é…æœ€è¿‘æ²¡æœ‰é…å¯¹çš„<code>if</code>ã€‚</li></ul><h2 id="è¿­ä»£è¯­å¥"><a href="#è¿­ä»£è¯­å¥" class="headerlink" title="è¿­ä»£è¯­å¥"></a>è¿­ä»£è¯­å¥</h2><ul><li><strong>while</strong>ï¼šå½“ä¸ç¡®å®šåˆ°åº•è¦è¿­ä»£å¤šå°‘æ¬¡æ—¶ï¼Œä½¿ç”¨ <code>while</code>å¾ªç¯æ¯”è¾ƒåˆé€‚ï¼Œæ¯”å¦‚è¯»å–è¾“å…¥çš„å†…å®¹ã€‚</li><li><strong>for</strong>ï¼š <code>for</code>è¯­å¥å¯ä»¥çœç•¥æ‰ <code>init-statement</code>ï¼Œ <code>condition</code>å’Œ <code>expression</code>çš„ä»»ä½•ä¸€ä¸ªï¼›<strong>ç”šè‡³å…¨éƒ¨</strong>ã€‚</li><li><strong>èŒƒå›´for</strong>ï¼š <code>for (declaration: expression) statement</code></li></ul><h2 id="è·³è½¬è¯­å¥"><a href="#è·³è½¬è¯­å¥" class="headerlink" title="è·³è½¬è¯­å¥"></a>è·³è½¬è¯­å¥</h2><ul><li><strong>break</strong>ï¼š<code>break</code>è¯­å¥è´Ÿè´£ç»ˆæ­¢ç¦»å®ƒæœ€è¿‘çš„<code>while</code>ã€<code>do while</code>ã€<code>for</code>æˆ–è€…<code>switch</code>è¯­å¥ï¼Œå¹¶ä»è¿™äº›è¯­å¥ä¹‹åçš„ç¬¬ä¸€æ¡è¯­å¥å¼€å§‹ç»§ç»­æ‰§è¡Œã€‚</li><li><strong>continue</strong>ï¼šç»ˆæ­¢æœ€è¿‘çš„å¾ªç¯ä¸­çš„å½“å‰è¿­ä»£å¹¶ç«‹å³å¼€å§‹ä¸‹ä¸€æ¬¡è¿­ä»£ã€‚åªèƒ½åœ¨<code>while</code>ã€<code>do while</code>ã€<code>for</code>å¾ªç¯çš„å†…éƒ¨ã€‚</li></ul><h2 id="tryè¯­å¥å—å’Œå¼‚å¸¸å¤„ç†"><a href="#tryè¯­å¥å—å’Œå¼‚å¸¸å¤„ç†" class="headerlink" title="tryè¯­å¥å—å’Œå¼‚å¸¸å¤„ç†"></a>tryè¯­å¥å—å’Œå¼‚å¸¸å¤„ç†</h2><ul><li><strong>throwè¡¨è¾¾å¼</strong>ï¼šå¼‚å¸¸æ£€æµ‹éƒ¨åˆ†ä½¿ç”¨ <code>throw</code>è¡¨è¾¾å¼æ¥è¡¨ç¤ºå®ƒé‡åˆ°äº†æ— æ³•å¤„ç†çš„é—®é¢˜ã€‚æˆ‘ä»¬è¯´ <code>throw</code>å¼•å‘ <code>raise</code>äº†å¼‚å¸¸ã€‚</li><li><strong>tryè¯­å¥å—</strong>ï¼šä»¥ <code>try</code>å…³é”®è¯å¼€å§‹ï¼Œä»¥ä¸€ä¸ªæˆ–å¤šä¸ª <code>catch</code>å­—å¥ç»“æŸã€‚ <code>try</code>è¯­å¥å—ä¸­çš„ä»£ç æŠ›å‡ºçš„å¼‚å¸¸é€šå¸¸ä¼šè¢«æŸä¸ª <code>catch</code>æ•è·å¹¶å¤„ç†ã€‚ <code>catch</code>å­å¥ä¹Ÿè¢«ç§°ä¸º<strong>å¼‚å¸¸å¤„ç†ä»£ç </strong>ã€‚</li><li><strong>å¼‚å¸¸ç±»</strong>ï¼šç”¨äºåœ¨ <code>throw</code>è¡¨è¾¾å¼å’Œç›¸å…³çš„ <code>catch</code>å­å¥ä¹‹é—´ä¼ é€’å¼‚å¸¸çš„å…·ä½“ä¿¡æ¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°6</title>
      <link href="2021/04/10/notes/ch06/"/>
      <url>2021/04/10/notes/ch06/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å…­ç« -å‡½æ•°"><a href="#ç¬¬å…­ç« -å‡½æ•°" class="headerlink" title="ç¬¬å…­ç«  å‡½æ•°"></a>ç¬¬å…­ç«  å‡½æ•°</h1><h2 id="å‡½æ•°åŸºç¡€"><a href="#å‡½æ•°åŸºç¡€" class="headerlink" title="å‡½æ•°åŸºç¡€"></a>å‡½æ•°åŸºç¡€</h2><ul><li><strong>å‡½æ•°å®šä¹‰</strong>ï¼šåŒ…æ‹¬è¿”å›ç±»å‹ã€å‡½æ•°åå­—å’Œ0ä¸ªæˆ–è€…å¤šä¸ª<strong>å½¢å‚</strong>ï¼ˆparameterï¼‰ç»„æˆçš„åˆ—è¡¨å’Œå‡½æ•°ä½“ã€‚</li><li><strong>è°ƒç”¨è¿ç®—ç¬¦</strong>ï¼šè°ƒç”¨è¿ç®—ç¬¦çš„å½¢å¼æ˜¯ä¸€å¯¹åœ†æ‹¬å· <code>()</code>ï¼Œä½œç”¨äºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼æ˜¯å‡½æ•°æˆ–è€…æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆã€‚</li><li>åœ†æ‹¬å·å†…æ˜¯ç”¨é€—å·éš”å¼€çš„<strong>å®å‚</strong>ï¼ˆargumentï¼‰åˆ—è¡¨ã€‚</li><li>å‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼š<ul><li>1.ä¸»è°ƒå‡½æ•°ï¼ˆcalling functionï¼‰çš„æ‰§è¡Œè¢«ä¸­æ–­ã€‚</li><li>2.è¢«è°ƒå‡½æ•°ï¼ˆcalled functionï¼‰å¼€å§‹æ‰§è¡Œã€‚</li></ul></li><li><strong>å½¢å‚å’Œå®å‚</strong>ï¼šå½¢å‚å’Œå®å‚çš„<strong>ä¸ªæ•°</strong>å’Œ<strong>ç±»å‹</strong>å¿…é¡»åŒ¹é…ä¸Šã€‚</li><li><strong>è¿”å›ç±»å‹</strong>ï¼š <code>void</code>è¡¨ç¤ºå‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ã€‚å‡½æ•°çš„è¿”å›ç±»å‹ä¸èƒ½æ˜¯æ•°ç»„ç±»å‹æˆ–è€…å‡½æ•°ç±»å‹ï¼Œä½†å¯ä»¥æ˜¯æŒ‡å‘æ•°ç»„æˆ–è€…å‡½æ•°çš„æŒ‡é’ˆã€‚</li><li><strong>åå­—</strong>ï¼šåå­—çš„ä½œç”¨äºæ˜¯ç¨‹åºæ–‡æœ¬çš„ä¸€éƒ¨åˆ†ï¼Œåå­—åœ¨å…¶ä¸­å¯è§ã€‚</li></ul><h3 id="å±€éƒ¨å¯¹è±¡"><a href="#å±€éƒ¨å¯¹è±¡" class="headerlink" title="å±€éƒ¨å¯¹è±¡"></a>å±€éƒ¨å¯¹è±¡</h3><ul><li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­è¯¥å¯¹è±¡å­˜åœ¨çš„ä¸€æ®µæ—¶é—´ã€‚</li><li><strong>å±€éƒ¨å˜é‡</strong>ï¼ˆlocal variableï¼‰ï¼šå½¢å‚å’Œå‡½æ•°ä½“å†…éƒ¨å®šä¹‰çš„å˜é‡ç»Ÿç§°ä¸ºå±€éƒ¨å˜é‡ã€‚å®ƒå¯¹å‡½æ•°è€Œè¨€æ˜¯å±€éƒ¨çš„ï¼Œå¯¹å‡½æ•°å¤–éƒ¨è€Œè¨€æ˜¯<strong>éšè—</strong>çš„ã€‚</li><li><strong>è‡ªåŠ¨å¯¹è±¡</strong>ï¼šåªå­˜åœ¨äºå—æ‰§è¡ŒæœŸé—´çš„å¯¹è±¡ã€‚å½“å—çš„æ‰§è¡Œç»“æŸåï¼Œå®ƒçš„å€¼å°±å˜æˆ<strong>æœªå®šä¹‰</strong>çš„äº†ã€‚</li><li><strong>å±€éƒ¨é™æ€å¯¹è±¡</strong>ï¼š <code>static</code>ç±»å‹çš„å±€éƒ¨å˜é‡ï¼Œç”Ÿå‘½å‘¨æœŸè´¯ç©¿å‡½æ•°è°ƒç”¨å‰åã€‚</li></ul><h3 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h3><ul><li><strong>å‡½æ•°å£°æ˜</strong>ï¼šå‡½æ•°çš„å£°æ˜å’Œå®šä¹‰å”¯ä¸€çš„åŒºåˆ«æ˜¯å£°æ˜æ— éœ€å‡½æ•°ä½“ï¼Œç”¨ä¸€ä¸ªåˆ†å·æ›¿ä»£ã€‚å‡½æ•°å£°æ˜ä¸»è¦ç”¨äºæè¿°å‡½æ•°çš„æ¥å£ï¼Œä¹Ÿç§°<strong>å‡½æ•°åŸå‹</strong>ã€‚</li><li><strong>åœ¨å¤´æ–‡ä»¶ä¸­è¿›è¡Œå‡½æ•°å£°æ˜</strong>ï¼šå»ºè®®å˜é‡åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜ï¼›åœ¨æºæ–‡ä»¶ä¸­å®šä¹‰ã€‚</li><li><strong>åˆ†ç¦»ç¼–è¯‘</strong>ï¼š <code>CC a.cc b.cc</code>ç›´æ¥ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼›<code>CC -c a.cc b.cc</code>ç¼–è¯‘ç”Ÿæˆå¯¹è±¡ä»£ç <code>a.o b.o</code>ï¼› <code>CC a.o b.o</code>ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li></ul><h2 id="å‚æ•°ä¼ é€’"><a href="#å‚æ•°ä¼ é€’" class="headerlink" title="å‚æ•°ä¼ é€’"></a>å‚æ•°ä¼ é€’</h2><ul><li>å½¢å‚åˆå§‹åŒ–çš„æœºç†å’Œå˜é‡åˆå§‹åŒ–ä¸€æ ·ã€‚</li><li><strong>å¼•ç”¨ä¼ é€’</strong>ï¼ˆpassed by referenceï¼‰ï¼šåˆç§°ä¼ å¼•ç”¨è°ƒç”¨ï¼ˆcalled by referenceï¼‰ï¼ŒæŒ‡<strong>å½¢å‚æ˜¯å¼•ç”¨ç±»å‹</strong>ï¼Œå¼•ç”¨å½¢å‚æ˜¯å®ƒå¯¹åº”çš„å®å‚çš„åˆ«åã€‚</li><li><strong>å€¼ä¼ é€’</strong>ï¼ˆpassed by valueï¼‰ï¼šåˆç§°ä¼ å€¼è°ƒç”¨ï¼ˆcalled by valueï¼‰ï¼ŒæŒ‡å®å‚çš„å€¼æ˜¯é€šè¿‡<strong>æ‹·è´</strong>ä¼ é€’ç»™å½¢å‚ã€‚</li></ul><h3 id="ä¼ å€¼å‚æ•°"><a href="#ä¼ å€¼å‚æ•°" class="headerlink" title="ä¼ å€¼å‚æ•°"></a>ä¼ å€¼å‚æ•°</h3><ul><li>å½“åˆå§‹åŒ–ä¸€ä¸ªéå¼•ç”¨ç±»å‹çš„å˜é‡æ—¶ï¼Œåˆå§‹å€¼è¢«æ‹·è´ç»™å˜é‡ã€‚</li><li>å‡½æ•°å¯¹å½¢å‚åšçš„æ‰€æœ‰æ“ä½œéƒ½ä¸ä¼šå½±å“å®å‚ã€‚</li><li><strong>æŒ‡é’ˆå½¢å‚</strong>ï¼šå¸¸ç”¨åœ¨Cä¸­ï¼Œ<code>C++</code>å»ºè®®ä½¿ç”¨å¼•ç”¨ç±»å‹çš„å½¢å‚ä»£æ›¿æŒ‡é’ˆã€‚</li></ul><h3 id="ä¼ å¼•ç”¨å‚æ•°"><a href="#ä¼ å¼•ç”¨å‚æ•°" class="headerlink" title="ä¼ å¼•ç”¨å‚æ•°"></a>ä¼ å¼•ç”¨å‚æ•°</h3><ul><li>é€šè¿‡ä½¿ç”¨å¼•ç”¨å½¢å‚ï¼Œå…è®¸å‡½æ•°æ”¹å˜ä¸€ä¸ªæˆ–å¤šä¸ªå®å‚çš„å€¼ã€‚</li><li>å¼•ç”¨å½¢å‚ç›´æ¥å…³è”åˆ°ç»‘å®šçš„å¯¹è±¡ï¼Œè€Œéå¯¹è±¡çš„å‰¯æœ¬ã€‚</li><li>ä½¿ç”¨å¼•ç”¨å½¢å‚å¯ä»¥ç”¨äº<strong>è¿”å›é¢å¤–çš„ä¿¡æ¯</strong>ã€‚</li><li>ç»å¸¸ç”¨å¼•ç”¨å½¢å‚æ¥é¿å…ä¸å¿…è¦çš„å¤åˆ¶ã€‚</li><li><code>void swap(int &amp;v1, int &amp;v2)</code></li><li>å¦‚æœæ— éœ€æ”¹å˜å¼•ç”¨å½¢å‚çš„å€¼ï¼Œæœ€å¥½å°†å…¶å£°æ˜ä¸ºå¸¸é‡å¼•ç”¨ã€‚</li></ul><h3 id="constå½¢å‚å’Œå®å‚"><a href="#constå½¢å‚å’Œå®å‚" class="headerlink" title="constå½¢å‚å’Œå®å‚"></a>constå½¢å‚å’Œå®å‚</h3><ul><li>å½¢å‚çš„é¡¶å±‚<code>const</code>è¢«å¿½ç•¥ã€‚<code>void func(const int i);</code>è°ƒç”¨æ—¶æ—¢å¯ä»¥ä¼ å…¥<code>const int</code>ä¹Ÿå¯ä»¥ä¼ å…¥<code>int</code>ã€‚</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨éå¸¸é‡åˆå§‹åŒ–ä¸€ä¸ªåº•å±‚<code>const</code>å¯¹è±¡ï¼Œä½†æ˜¯åè¿‡æ¥ä¸è¡Œã€‚</li><li>åœ¨å‡½æ•°ä¸­ï¼Œä¸èƒ½æ”¹å˜å®å‚çš„<strong>å±€éƒ¨å‰¯æœ¬</strong>ã€‚</li><li>å°½é‡ä½¿ç”¨å¸¸é‡å¼•ç”¨ã€‚</li></ul><h3 id="æ•°ç»„å½¢å‚"><a href="#æ•°ç»„å½¢å‚" class="headerlink" title="æ•°ç»„å½¢å‚"></a>æ•°ç»„å½¢å‚</h3><ul><li>å½“æˆ‘ä»¬ä¸ºå‡½æ•°ä¼ é€’ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå®é™…ä¸Šä¼ é€’çš„æ˜¯æŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚</li><li>è¦æ³¨æ„æ•°ç»„çš„å®é™…é•¿åº¦ï¼Œä¸èƒ½è¶Šç•Œã€‚</li></ul><h3 id="mainå¤„ç†å‘½ä»¤è¡Œé€‰é¡¹"><a href="#mainå¤„ç†å‘½ä»¤è¡Œé€‰é¡¹" class="headerlink" title="mainå¤„ç†å‘½ä»¤è¡Œé€‰é¡¹"></a>mainå¤„ç†å‘½ä»¤è¡Œé€‰é¡¹</h3><ul><li><code>int main(int argc, char *argv[])&#123;...&#125;</code></li><li>ç¬¬ä¸€ä¸ªå½¢å‚ä»£è¡¨å‚æ•°çš„ä¸ªæ•°ï¼›ç¬¬äºŒä¸ªå½¢å‚æ˜¯å‚æ•°Cé£æ ¼å­—ç¬¦ä¸²æ•°ç»„ã€‚</li></ul><h3 id="å¯å˜å½¢å‚"><a href="#å¯å˜å½¢å‚" class="headerlink" title="å¯å˜å½¢å‚"></a>å¯å˜å½¢å‚</h3><p><code>initializer_list</code>æä¾›çš„æ“ä½œï¼ˆ<code>C++11</code>ï¼‰ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>initializer_list&lt;T&gt; lst;</code></td><td>é»˜è®¤åˆå§‹åŒ–ï¼›<code>T</code>ç±»å‹å…ƒç´ çš„ç©ºåˆ—è¡¨</td></tr><tr><td><code>initializer_list&lt;T&gt; lst&#123;a,b,c...&#125;;</code></td><td><code>lst</code>çš„å…ƒç´ æ•°é‡å’Œåˆå§‹å€¼ä¸€æ ·å¤šï¼›<code>lst</code>çš„å…ƒç´ æ˜¯å¯¹åº”åˆå§‹å€¼çš„å‰¯æœ¬ï¼›åˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯<code>const</code>ã€‚</td></tr><tr><td><code>lst2(lst)</code></td><td>æ‹·è´æˆ–èµ‹å€¼ä¸€ä¸ª<code>initializer_list</code>å¯¹è±¡ä¸ä¼šæ‹·è´åˆ—è¡¨ä¸­çš„å…ƒç´ ï¼›æ‹·è´åï¼ŒåŸå§‹åˆ—è¡¨å’Œå‰¯æœ¬å…±äº«å…ƒç´ ã€‚</td></tr><tr><td><code>lst2 = lst</code></td><td>åŒä¸Š</td></tr><tr><td><code>lst.size()</code></td><td>åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°é‡</td></tr><tr><td><code>lst.begin()</code></td><td>è¿”å›æŒ‡å‘<code>lst</code>ä¸­é¦–å…ƒç´ çš„æŒ‡é’ˆ</td></tr><tr><td><code>lst.end()</code></td><td>è¿”å›æŒ‡å‘<code>lst</code>ä¸­å¾®å…ƒç´ ä¸‹ä¸€ä½ç½®çš„æŒ‡é’ˆ</td></tr></tbody></table><p><code>initializer_list</code>ä½¿ç”¨demoï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">err_msg</span><span class="token punctuation">(</span>ErrCode e<span class="token punctuation">,</span> initializer_list<span class="token operator">&lt;</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span>msg <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> bed <span class="token operator">=</span> il<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> beg <span class="token operator">!=</span> il<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span> beg<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>beg <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">err_msg</span><span class="token punctuation">(</span><span class="token function">ErrCode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"functionX"</span><span class="token punctuation">,</span> "okay<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ‰€æœ‰å®å‚ç±»å‹ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨ <code>initializer_list</code>çš„æ ‡å‡†åº“ç±»å‹ã€‚</li><li>å®å‚ç±»å‹ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨<code>å¯å˜å‚æ•°æ¨¡æ¿</code>ã€‚</li><li>çœç•¥å½¢å‚ç¬¦ï¼š <code>...</code>ï¼Œä¾¿äº<code>C++</code>è®¿é—®æŸäº›Cä»£ç ï¼Œè¿™äº›Cä»£ç ä½¿ç”¨äº† <code>varargs</code>çš„Cæ ‡å‡†åŠŸèƒ½ã€‚</li></ul><h2 id="è¿”å›ç±»å‹å’Œreturnè¯­å¥"><a href="#è¿”å›ç±»å‹å’Œreturnè¯­å¥" class="headerlink" title="è¿”å›ç±»å‹å’Œreturnè¯­å¥"></a>è¿”å›ç±»å‹å’Œreturnè¯­å¥</h2><h3 id="æ— è¿”å›å€¼å‡½æ•°"><a href="#æ— è¿”å›å€¼å‡½æ•°" class="headerlink" title="æ— è¿”å›å€¼å‡½æ•°"></a>æ— è¿”å›å€¼å‡½æ•°</h3><p>æ²¡æœ‰è¿”å›å€¼çš„ <code>return</code>è¯­å¥åªèƒ½ç”¨åœ¨è¿”å›ç±»å‹æ˜¯ <code>void</code>çš„å‡½æ•°ä¸­ï¼Œè¿”å› <code>void</code>çš„å‡½æ•°ä¸è¦æ±‚éå¾—æœ‰ <code>return</code>è¯­å¥ã€‚</p><h3 id="æœ‰è¿”å›å€¼å‡½æ•°"><a href="#æœ‰è¿”å›å€¼å‡½æ•°" class="headerlink" title="æœ‰è¿”å›å€¼å‡½æ•°"></a>æœ‰è¿”å›å€¼å‡½æ•°</h3><ul><li><code>return</code>è¯­å¥çš„è¿”å›å€¼çš„ç±»å‹å¿…é¡»å’Œå‡½æ•°çš„è¿”å›ç±»å‹ç›¸åŒï¼Œæˆ–è€…èƒ½å¤Ÿ<strong>éšå¼åœ°</strong>è½¬æ¢æˆå‡½æ•°çš„è¿”å›ç±»å‹ã€‚</li><li>å€¼çš„è¿”å›ï¼šè¿”å›çš„å€¼ç”¨äºåˆå§‹åŒ–è°ƒç”¨ç‚¹çš„ä¸€ä¸ª<strong>ä¸´æ—¶é‡</strong>ï¼Œè¯¥ä¸´æ—¶é‡å°±æ˜¯å‡½æ•°è°ƒç”¨çš„ç»“æœã€‚</li><li><strong>ä¸è¦è¿”å›å±€éƒ¨å¯¹è±¡çš„å¼•ç”¨æˆ–æŒ‡é’ˆ</strong>ã€‚</li><li><strong>å¼•ç”¨è¿”å›å·¦å€¼</strong>ï¼šå‡½æ•°çš„è¿”å›ç±»å‹å†³å®šå‡½æ•°è°ƒç”¨æ˜¯å¦æ˜¯å·¦å€¼ã€‚è°ƒç”¨ä¸€ä¸ªè¿”å›å¼•ç”¨çš„å‡½æ•°å¾—åˆ°å·¦å€¼ï¼›å…¶ä»–è¿”å›ç±»å‹å¾—åˆ°å³å€¼ã€‚</li><li><strong>åˆ—è¡¨åˆå§‹åŒ–è¿”å›å€¼</strong>ï¼šå‡½æ•°å¯ä»¥è¿”å›èŠ±æ‹¬å·åŒ…å›´çš„å€¼çš„åˆ—è¡¨ã€‚ï¼ˆ<code>C++11</code>ï¼‰</li><li><strong>ä¸»å‡½æ•°mainçš„è¿”å›å€¼</strong>ï¼šå¦‚æœç»“å°¾æ²¡æœ‰<code>return</code>ï¼Œç¼–è¯‘å™¨å°†éšå¼åœ°æ’å…¥ä¸€æ¡è¿”å›0çš„<code>return</code>è¯­å¥ã€‚è¿”å›0ä»£è¡¨æ‰§è¡ŒæˆåŠŸã€‚</li></ul><h3 id="è¿”å›æ•°ç»„æŒ‡é’ˆ"><a href="#è¿”å›æ•°ç»„æŒ‡é’ˆ" class="headerlink" title="è¿”å›æ•°ç»„æŒ‡é’ˆ"></a>è¿”å›æ•°ç»„æŒ‡é’ˆ</h3><ul><li><code>Type (*function (parameter_list))[dimension]</code></li><li>ä½¿ç”¨ç±»å‹åˆ«åï¼š <code>typedef int arrT[10];</code> æˆ–è€… <code>using arrT = int[10;]</code>ï¼Œç„¶å <code>arrT* func() &#123;...&#125;</code></li><li>ä½¿ç”¨ <code>decltype</code>ï¼š <code>decltype(odd) *arrPtr(int i) &#123;...&#125;</code></li><li><strong>å°¾ç½®è¿”å›ç±»å‹</strong>ï¼š åœ¨å½¢å‚åˆ—è¡¨åé¢ä»¥ä¸€ä¸ª<code>-&gt;</code>å¼€å§‹ï¼š<code>auto func(int i) -&gt; int(*)[10]</code>ï¼ˆ<code>C++11</code>ï¼‰</li></ul><h2 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h2><ul><li><strong>é‡è½½</strong>ï¼šå¦‚æœåŒä¸€ä½œç”¨åŸŸå†…å‡ ä¸ªå‡½æ•°åå­—ç›¸åŒä½†å½¢å‚åˆ—è¡¨ä¸åŒï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé‡è½½ï¼ˆoverloadï¼‰å‡½æ•°ã€‚</li><li><code>main</code>å‡½æ•°ä¸èƒ½é‡è½½ã€‚</li><li><strong>é‡è½½å’Œconstå½¢å‚</strong>ï¼š<ul><li>ä¸€ä¸ªæœ‰é¡¶å±‚constçš„å½¢å‚å’Œæ²¡æœ‰å®ƒçš„å‡½æ•°æ— æ³•åŒºåˆ†ã€‚ <code>Record lookup(Phone* const)</code>å’Œ <code>Record lookup(Phone*)</code>æ— æ³•åŒºåˆ†ã€‚</li><li>ç›¸åï¼Œæ˜¯å¦æœ‰æŸä¸ªåº•å±‚constå½¢å‚å¯ä»¥åŒºåˆ†ã€‚ <code>Record lookup(Account*)</code>å’Œ <code>Record lookup(const Account*)</code>å¯ä»¥åŒºåˆ†ã€‚</li></ul></li><li><strong>é‡è½½å’Œä½œç”¨åŸŸ</strong>ï¼šè‹¥åœ¨å†…å±‚ä½œç”¨åŸŸä¸­å£°æ˜åå­—ï¼Œå®ƒå°†éšè—å¤–å±‚ä½œç”¨åŸŸä¸­å£°æ˜çš„åŒåå®ä½“ï¼Œåœ¨ä¸åŒçš„ä½œç”¨åŸŸä¸­æ— æ³•é‡è½½å‡½æ•°åã€‚</li></ul><h2 id="ç‰¹æ®Šç”¨é€”è¯­è¨€ç‰¹æ€§"><a href="#ç‰¹æ®Šç”¨é€”è¯­è¨€ç‰¹æ€§" class="headerlink" title="ç‰¹æ®Šç”¨é€”è¯­è¨€ç‰¹æ€§"></a>ç‰¹æ®Šç”¨é€”è¯­è¨€ç‰¹æ€§</h2><h3 id="é»˜è®¤å®å‚"><a href="#é»˜è®¤å®å‚" class="headerlink" title="é»˜è®¤å®å‚"></a>é»˜è®¤å®å‚</h3><ul><li><code>string screen(sz ht = 24, sz wid = 80, char backgrnd = &#39; &#39;);</code></li><li>ä¸€æ—¦æŸä¸ªå½¢å‚è¢«èµ‹äºˆäº†é»˜è®¤å€¼ï¼Œé‚£ä¹ˆå®ƒä¹‹åçš„å½¢å‚éƒ½å¿…é¡»è¦æœ‰é»˜è®¤å€¼ã€‚</li></ul><h3 id="å†…è”ï¼ˆinlineï¼‰å‡½æ•°"><a href="#å†…è”ï¼ˆinlineï¼‰å‡½æ•°" class="headerlink" title="å†…è”ï¼ˆinlineï¼‰å‡½æ•°"></a>å†…è”ï¼ˆinlineï¼‰å‡½æ•°</h3><ul><li>æ™®é€šå‡½æ•°çš„ç¼ºç‚¹ï¼šè°ƒç”¨å‡½æ•°æ¯”æ±‚è§£ç­‰ä»·è¡¨è¾¾å¼è¦æ…¢å¾—å¤šã€‚</li><li><code>inline</code>å‡½æ•°å¯ä»¥é¿å…å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶<strong>å†…è”åœ°å±•å¼€</strong>è¯¥å‡½æ•°ã€‚</li><li><code>inline</code>å‡½æ•°åº”è¯¥åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰ã€‚</li></ul><h3 id="constexprå‡½æ•°"><a href="#constexprå‡½æ•°" class="headerlink" title="constexprå‡½æ•°"></a>constexprå‡½æ•°</h3><ul><li>æŒ‡èƒ½ç”¨äºå¸¸é‡è¡¨è¾¾å¼çš„å‡½æ•°ã€‚</li><li><code>constexpr int new_sz() &#123;return 42;&#125;</code></li><li>å‡½æ•°çš„è¿”å›ç±»å‹åŠæ‰€æœ‰å½¢å‚ç±»å‹éƒ½è¦æ˜¯å­—é¢å€¼ç±»å‹ã€‚</li><li><code>constexpr</code>å‡½æ•°åº”è¯¥åœ¨å¤´æ–‡ä»¶ä¸­å®šä¹‰ã€‚</li></ul><h3 id="è°ƒè¯•å¸®åŠ©"><a href="#è°ƒè¯•å¸®åŠ©" class="headerlink" title="è°ƒè¯•å¸®åŠ©"></a>è°ƒè¯•å¸®åŠ©</h3><ul><li><code>assert</code>é¢„å¤„ç†å®ï¼ˆpreprocessor macroï¼‰ï¼š<code>assert(expr);</code></li></ul><p>å¼€å…³è°ƒè¯•çŠ¶æ€ï¼š</p><p><code>CC -D NDEBUG main.c</code>å¯ä»¥å®šä¹‰è¿™ä¸ªå˜é‡<code>NDEBUG</code>ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">NDEBUG</span></span>        cerr <span class="token operator">&lt;&lt;</span> <span class="token constant">__func__</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"..."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‡½æ•°åŒ¹é…"><a href="#å‡½æ•°åŒ¹é…" class="headerlink" title="å‡½æ•°åŒ¹é…"></a>å‡½æ•°åŒ¹é…</h2><ul><li>é‡è½½å‡½æ•°åŒ¹é…çš„<strong>ä¸‰ä¸ªæ­¥éª¤</strong>ï¼š1.å€™é€‰å‡½æ•°ï¼›2.å¯è¡Œå‡½æ•°ï¼›3.å¯»æ‰¾æœ€ä½³åŒ¹é…ã€‚</li><li><strong>å€™é€‰å‡½æ•°</strong>ï¼šé€‰å®šæœ¬æ¬¡è°ƒç”¨å¯¹åº”çš„é‡è½½å‡½æ•°é›†ï¼Œé›†åˆä¸­çš„å‡½æ•°ç§°ä¸ºå€™é€‰å‡½æ•°ï¼ˆcandidate functionï¼‰ã€‚</li><li><strong>å¯è¡Œå‡½æ•°</strong>ï¼šè€ƒå¯Ÿæœ¬æ¬¡è°ƒç”¨æä¾›çš„å®å‚ï¼Œé€‰å‡ºå¯ä»¥è¢«è¿™ç»„å®å‚è°ƒç”¨çš„å‡½æ•°ï¼Œæ–°é€‰å‡ºçš„å‡½æ•°ç§°ä¸ºå¯è¡Œå‡½æ•°ï¼ˆviable functionï¼‰ã€‚</li><li><strong>å¯»æ‰¾æœ€ä½³åŒ¹é…</strong>ï¼šåŸºæœ¬æ€æƒ³ï¼šå®å‚ç±»å‹å’Œå½¢å‚ç±»å‹è¶Šæ¥è¿‘ï¼Œå®ƒä»¬åŒ¹é…åœ°è¶Šå¥½ã€‚</li></ul><h2 id="å‡½æ•°æŒ‡é’ˆ"><a href="#å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="å‡½æ•°æŒ‡é’ˆ"></a>å‡½æ•°æŒ‡é’ˆ</h2><ul><li><strong>å‡½æ•°æŒ‡é’ˆ</strong>ï¼šæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆã€‚</li><li><code>bool (*pf)(const string &amp;, const string &amp;);</code> æ³¨ï¼šä¸¤ç«¯çš„æ‹¬å·ä¸å¯å°‘ã€‚</li><li><strong>å‡½æ•°æŒ‡é’ˆå½¢å‚</strong>ï¼š<ul><li>å½¢å‚ä¸­ä½¿ç”¨å‡½æ•°å®šä¹‰æˆ–è€…å‡½æ•°æŒ‡é’ˆå®šä¹‰æ•ˆæœä¸€æ ·ã€‚</li><li>ä½¿ç”¨ç±»å‹åˆ«åæˆ–è€…<code>decltype</code>ã€‚</li></ul></li><li><strong>è¿”å›æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ</strong>ï¼š1.ç±»å‹åˆ«åï¼›2.å°¾ç½®è¿”å›ç±»å‹ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°8</title>
      <link href="2021/04/10/notes/ch08/"/>
      <url>2021/04/10/notes/ch08/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å…«ç« -IOåº“"><a href="#ç¬¬å…«ç« -IOåº“" class="headerlink" title="ç¬¬å…«ç«  IOåº“"></a>ç¬¬å…«ç«  IOåº“</h1><h2 id="å‰é¢ç« èŠ‚å·²ç»åœ¨ç”¨çš„IOåº“è®¾æ–½"><a href="#å‰é¢ç« èŠ‚å·²ç»åœ¨ç”¨çš„IOåº“è®¾æ–½" class="headerlink" title="å‰é¢ç« èŠ‚å·²ç»åœ¨ç”¨çš„IOåº“è®¾æ–½"></a>å‰é¢ç« èŠ‚å·²ç»åœ¨ç”¨çš„IOåº“è®¾æ–½</h2><ul><li><strong>istream</strong>ï¼šè¾“å…¥æµç±»å‹ï¼Œæä¾›è¾“å…¥æ“ä½œã€‚</li><li><strong>ostream</strong>ï¼šè¾“å‡ºæµç±»å‹ï¼Œæä¾›è¾“å‡ºæ“ä½œ</li><li><strong>cin</strong>ï¼šä¸€ä¸ª<code>istream</code>å¯¹è±¡ï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ã€‚</li><li><strong>cout</strong>ï¼šä¸€ä¸ª<code>ostream</code>å¯¹è±¡ï¼Œå‘æ ‡å‡†è¾“å‡ºå†™å…¥æ•°æ®ã€‚</li><li><strong>cerr</strong>ï¼šä¸€ä¸ª<code>ostream</code>å¯¹è±¡ï¼Œå‘æ ‡å‡†é”™è¯¯å†™å…¥æ¶ˆæ¯ã€‚</li><li><strong>&gt;&gt;è¿ç®—ç¬¦</strong>ï¼šç”¨æ¥ä»ä¸€ä¸ª<code>istream</code>å¯¹è±¡ä¸­è¯»å–è¾“å…¥æ•°æ®ã€‚</li><li><strong>&lt;&lt;è¿ç®—ç¬¦</strong>ï¼šç”¨æ¥å‘ä¸€ä¸ª<code>ostream</code>å¯¹è±¡ä¸­å†™å…¥è¾“å‡ºæ•°æ®ã€‚</li><li><strong>getlineå‡½æ•°</strong>ï¼šä»ä¸€ä¸ªç»™å®šçš„<code>istream</code>å¯¹è±¡ä¸­è¯»å–ä¸€è¡Œæ•°æ®ï¼Œå­˜å…¥åˆ°ä¸€ä¸ªç»™å®šçš„<code>string</code>å¯¹è±¡ä¸­ã€‚</li></ul><h2 id="IOç±»"><a href="#IOç±»" class="headerlink" title="IOç±»"></a>IOç±»</h2><h3 id="æ ‡å‡†åº“å®šä¹‰çš„IOç±»å‹"><a href="#æ ‡å‡†åº“å®šä¹‰çš„IOç±»å‹" class="headerlink" title="æ ‡å‡†åº“å®šä¹‰çš„IOç±»å‹"></a>æ ‡å‡†åº“å®šä¹‰çš„IOç±»å‹</h3><ul><li><code>iostream</code>å¤´æ–‡ä»¶ï¼šä»æ ‡å‡†æµä¸­è¯»å†™æ•°æ®ï¼Œ<code>istream</code>ã€<code>ostream</code>ç­‰ã€‚</li><li><code>fstream</code>å¤´æ–‡ä»¶ï¼šä»æ–‡ä»¶ä¸­è¯»å†™æ•°æ®ï¼Œ<code>ifstream</code>ã€<code>ofstream</code>ç­‰ã€‚</li><li><code>sstream</code>å¤´æ–‡ä»¶ï¼šä»å­—ç¬¦ä¸²ä¸­è¯»å†™æ•°æ®ï¼Œ<code>istringstream</code>ã€<code>ostringstream</code></li></ul><h3 id="IOå¯¹è±¡ä¸å¯å¤åˆ¶æˆ–èµ‹å€¼"><a href="#IOå¯¹è±¡ä¸å¯å¤åˆ¶æˆ–èµ‹å€¼" class="headerlink" title="IOå¯¹è±¡ä¸å¯å¤åˆ¶æˆ–èµ‹å€¼"></a>IOå¯¹è±¡ä¸å¯å¤åˆ¶æˆ–èµ‹å€¼</h3><ul><li>1.IOå¯¹è±¡ä¸èƒ½å­˜åœ¨å®¹å™¨é‡Œ.</li><li>2.å½¢å‚å’Œè¿”å›ç±»å‹ä¹Ÿä¸èƒ½æ˜¯æµç±»å‹ã€‚</li><li>3.å½¢å‚å’Œè¿”å›ç±»å‹ä¸€èˆ¬æ˜¯æµçš„<strong>å¼•ç”¨</strong>ã€‚</li><li>4.è¯»å†™ä¸€ä¸ªIOå¯¹è±¡ä¼šæ”¹å˜å…¶çŠ¶æ€ï¼Œå› æ­¤ä¼ é€’å’Œè¿”å›çš„å¼•ç”¨ä¸èƒ½æ˜¯<code>const</code>çš„ã€‚</li></ul><h3 id="æ¡ä»¶çŠ¶æ€"><a href="#æ¡ä»¶çŠ¶æ€" class="headerlink" title="æ¡ä»¶çŠ¶æ€"></a>æ¡ä»¶çŠ¶æ€</h3><table><thead><tr><th>çŠ¶æ€</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>strm:iostate</code></td><td>æ˜¯ä¸€ç§æœºå™¨æ— å…³çš„<strong>ç±»å‹</strong>ï¼Œæä¾›äº†è¡¨è¾¾æ¡ä»¶çŠ¶æ€çš„å®Œæ•´åŠŸèƒ½</td></tr><tr><td><code>strm:badbit</code></td><td>ç”¨æ¥æŒ‡å‡ºæµå·²ç»å´©æºƒ</td></tr><tr><td><code>strm:failbit</code></td><td>ç”¨æ¥æŒ‡å‡ºä¸€ä¸ªIOæ“ä½œå¤±è´¥äº†</td></tr><tr><td><code>strm:eofbit</code></td><td>ç”¨æ¥æŒ‡å‡ºæµåˆ°è¾¾äº†æ–‡ä»¶ç»“æŸ</td></tr><tr><td><code>strm:goodbit</code></td><td>ç”¨æ¥æŒ‡å‡ºæµæœªå¤„äºé”™è¯¯çŠ¶æ€ï¼Œæ­¤å€¼ä¿è¯ä¸ºé›¶</td></tr><tr><td><code>s.eof()</code></td><td>è‹¥æµ<code>s</code>çš„<code>eofbit</code>ç½®ä½ï¼Œåˆ™è¿”å›<code>true</code></td></tr><tr><td><code>s.fail()</code></td><td>è‹¥æµ<code>s</code>çš„<code>failbit</code>ç½®ä½ï¼Œåˆ™è¿”å›<code>true</code></td></tr><tr><td><code>s.bad()</code></td><td>è‹¥æµ<code>s</code>çš„<code>badbit</code>ç½®ä½ï¼Œåˆ™è¿”å›<code>true</code></td></tr><tr><td><code>s.good()</code></td><td>è‹¥æµ<code>s</code>å¤„äºæœ‰æ•ˆçŠ¶æ€ï¼Œåˆ™è¿”å›<code>true</code></td></tr><tr><td><code>s.clear()</code></td><td>å°†æµ<code>s</code>ä¸­æ‰€æœ‰æ¡ä»¶çŠ¶æ€ä½å¤ä½ï¼Œå°†æµçš„çŠ¶æ€è®¾ç½®æˆæœ‰æ•ˆï¼Œè¿”å›<code>void</code></td></tr><tr><td><code>s.clear(flags)</code></td><td>å°†æµ<code>s</code>ä¸­æŒ‡å®šçš„æ¡ä»¶çŠ¶æ€ä½å¤ä½ï¼Œè¿”å›<code>void</code></td></tr><tr><td><code>s.setstate(flags)</code></td><td>æ ¹æ®ç»™å®šçš„æ ‡å¿—ä½ï¼Œå°†æµ<code>s</code>ä¸­å¯¹åº”çš„æ¡ä»¶çŠ¶æ€ä½ç½®ä½ï¼Œè¿”å›<code>void</code></td></tr><tr><td><code>s.rdstate()</code></td><td>è¿”å›æµ<code>s</code>çš„å½“å‰æ¡ä»¶çŠ¶æ€ï¼Œè¿”å›å€¼ç±»å‹ä¸º<code>strm::iostate</code></td></tr></tbody></table><p>ä¸Šè¡¨ä¸­ï¼Œ<code>strm</code>æ˜¯ä¸€ç§IOç±»å‹ï¼Œï¼ˆå¦‚<code>istream</code>ï¼‰ï¼Œ <code>s</code>æ˜¯ä¸€ä¸ªæµå¯¹è±¡ã€‚</p><h3 id="ç®¡ç†è¾“å‡ºç¼“å†²"><a href="#ç®¡ç†è¾“å‡ºç¼“å†²" class="headerlink" title="ç®¡ç†è¾“å‡ºç¼“å†²"></a>ç®¡ç†è¾“å‡ºç¼“å†²</h3><ul><li>æ¯ä¸ªè¾“å‡ºæµéƒ½ç®¡ç†ä¸€ä¸ªç¼“å†²åŒºï¼Œæ‰§è¡Œè¾“å‡ºçš„ä»£ç ï¼Œæ–‡æœ¬ä¸²å¯èƒ½ç«‹å³æ‰“å°å‡ºæ¥ï¼Œä¹Ÿå¯èƒ½è¢«æ“ä½œç³»ç»Ÿä¿å­˜åœ¨ç¼“å†²åŒºå†…ï¼Œéšåå†æ‰“å°ã€‚</li><li>åˆ·æ–°ç¼“å†²åŒºï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹IOæ“çºµç¬¦ï¼š<ul><li><code>endl</code>ï¼šè¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦å¹¶åˆ·æ–°ç¼“å†²åŒºã€‚</li><li><code>flush</code>ï¼šåˆ·æ–°æµï¼Œå•ä¸æ·»åŠ ä»»ä½•å­—ç¬¦ã€‚</li><li><code>ends</code>ï¼šåœ¨ç¼“å†²åŒºæ’å…¥ç©ºå­—ç¬¦<code>null</code>ï¼Œç„¶ååˆ·æ–°ã€‚</li><li><code>unitbuf</code>ï¼šå‘Šè¯‰æµæ¥ä¸‹æ¥æ¯æ¬¡æ“ä½œä¹‹åéƒ½è¦è¿›è¡Œä¸€æ¬¡<code>flush</code>æ“ä½œã€‚</li><li><code>nounitbuf</code>ï¼šå›åˆ°æ­£å¸¸çš„ç¼“å†²æ–¹å¼ã€‚</li></ul></li></ul><h2 id="æ–‡ä»¶è¾“å…¥è¾“å‡º"><a href="#æ–‡ä»¶è¾“å…¥è¾“å‡º" class="headerlink" title="æ–‡ä»¶è¾“å…¥è¾“å‡º"></a>æ–‡ä»¶è¾“å…¥è¾“å‡º</h2><ul><li>å¤´æ–‡ä»¶<code>fstream</code>å®šä¹‰äº†ä¸‰ä¸ªç±»å‹æ¥æ”¯æŒæ–‡ä»¶IOï¼š<ul><li><code>ifstream</code>ä»ä¸€ä¸ªç»™å®šæ–‡ä»¶è¯»å–æ•°æ®ã€‚</li><li><code>ofstream</code>å‘ä¸€ä¸ªç»™å®šæ–‡ä»¶å†™å…¥æ•°æ®ã€‚</li><li><code>fstream</code>å¯ä»¥è¯»å†™ç»™å®šæ–‡ä»¶ã€‚</li></ul></li><li><strong>æ–‡ä»¶æµ</strong>ï¼šéœ€è¦è¯»å†™æ–‡ä»¶æ—¶ï¼Œå¿…é¡»å®šä¹‰è‡ªå·±çš„æ–‡ä»¶æµå¯¹è±¡ï¼Œå¹¶ç»‘å®šåœ¨éœ€è¦çš„æ–‡ä»¶ä¸Šã€‚</li></ul><h3 id="fstreamç‰¹æœ‰çš„æ“ä½œ"><a href="#fstreamç‰¹æœ‰çš„æ“ä½œ" class="headerlink" title="fstreamç‰¹æœ‰çš„æ“ä½œ"></a>fstreamç‰¹æœ‰çš„æ“ä½œ</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>fstream fstrm;</code></td><td>åˆ›å»ºä¸€ä¸ªæœªç»‘å®šçš„æ–‡ä»¶æµã€‚</td></tr><tr><td><code>fstream fstrm(s);</code></td><td>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æµï¼Œå¹¶æ‰“å¼€åä¸º<code>s</code>çš„æ–‡ä»¶ï¼Œ<code>s</code>å¯ä»¥æ˜¯<code>string</code>ä¹Ÿå¯ä»¥æ˜¯<code>char</code>æŒ‡é’ˆ</td></tr><tr><td><code>fstream fstrm(s, mode);</code></td><td>ä¸å‰ä¸€ä¸ªæ„é€ å‡½æ•°ç±»ä¼¼ï¼Œä½†æŒ‰æŒ‡å®š<code>mode</code>æ‰“å¼€æ–‡ä»¶</td></tr><tr><td><code>fstrm.open(s)</code></td><td>æ‰“å¼€åä¸º<code>s</code>çš„æ–‡ä»¶ï¼Œå¹¶å’Œ<code>fstrm</code>ç»‘å®š</td></tr><tr><td><code>fstrm.close()</code></td><td>å…³é—­å’Œ<code>fstrm</code>ç»‘å®šçš„æ–‡ä»¶</td></tr><tr><td><code>fstrm.is_open()</code></td><td>è¿”å›ä¸€ä¸ª<code>bool</code>å€¼ï¼ŒæŒ‡å‡ºä¸<code>fstrm</code>å…³è”çš„æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ä¸”å°šæœªå…³é—­</td></tr></tbody></table><p>ä¸Šè¡¨ä¸­ï¼Œ<code>fstream</code>æ˜¯å¤´æ–‡ä»¶<code>fstream</code>ä¸­å®šä¹‰çš„ä¸€ä¸ªç±»å‹ï¼Œ<code>fstrm</code>æ˜¯ä¸€ä¸ªæ–‡ä»¶æµå¯¹è±¡ã€‚</p><h3 id="æ–‡ä»¶æ¨¡å¼"><a href="#æ–‡ä»¶æ¨¡å¼" class="headerlink" title="æ–‡ä»¶æ¨¡å¼"></a>æ–‡ä»¶æ¨¡å¼</h3><table><thead><tr><th>æ–‡ä»¶æ¨¡å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>in</code></td><td>ä»¥è¯»çš„æ–¹å¼æ‰“å¼€</td></tr><tr><td><code>out</code></td><td>ä»¥å†™çš„æ–¹å¼æ‰“å¼€</td></tr><tr><td><code>app</code></td><td>æ¯æ¬¡å†™æ“ä½œå‰å‡å®šä½åˆ°æ–‡ä»¶æœ«å°¾</td></tr><tr><td><code>ate</code></td><td>æ‰“å¼€æ–‡ä»¶åç«‹å³å®šä½åˆ°æ–‡ä»¶æœ«å°¾</td></tr><tr><td><code>trunc</code></td><td>æˆªæ–­æ–‡ä»¶</td></tr><tr><td><code>binary</code></td><td>ä»¥äºŒè¿›åˆ¶æ–¹å¼è¿›è¡ŒIOæ“ä½œã€‚</td></tr></tbody></table><h2 id="stringæµ"><a href="#stringæµ" class="headerlink" title="stringæµ"></a>stringæµ</h2><ul><li>å¤´æ–‡ä»¶<code>sstream</code>å®šä¹‰äº†ä¸‰ä¸ªç±»å‹æ¥æ”¯æŒå†…å­˜IOï¼š<ul><li><code>istringstream</code>ä»<code>string</code>è¯»å–æ•°æ®ã€‚</li><li><code>ostringstream</code>å‘<code>string</code>å†™å…¥æ•°æ®ã€‚</li><li><code>stringstream</code>å¯ä»¥è¯»å†™ç»™å®š<code>string</code>ã€‚</li></ul></li></ul><h3 id="stringstreamç‰¹æœ‰çš„æ“ä½œ"><a href="#stringstreamç‰¹æœ‰çš„æ“ä½œ" class="headerlink" title="stringstreamç‰¹æœ‰çš„æ“ä½œ"></a>stringstreamç‰¹æœ‰çš„æ“ä½œ</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>sstream strm</code></td><td>å®šä¹‰ä¸€ä¸ªæœªç»‘å®šçš„<code>stringstream</code>å¯¹è±¡</td></tr><tr><td><code>sstream strm(s)</code></td><td>ç”¨<code>s</code>åˆå§‹åŒ–å¯¹è±¡</td></tr><tr><td><code>strm.str()</code></td><td>è¿”å›<code>strm</code>æ‰€ä¿å­˜çš„<code>string</code>çš„æ‹·è´</td></tr><tr><td><code>strm.str(s)</code></td><td>å°†<code>s</code>æ‹·è´åˆ°<code>strm</code>ä¸­ï¼Œè¿”å›<code>void</code></td></tr></tbody></table><p>ä¸Šè¡¨ä¸­<code>sstream</code>æ˜¯å¤´æ–‡ä»¶<code>sstream</code>ä¸­ä»»æ„ä¸€ä¸ªç±»å‹ã€‚<code>s</code>æ˜¯ä¸€ä¸ª<code>string</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°7</title>
      <link href="2021/04/10/notes/ch07/"/>
      <url>2021/04/10/notes/ch07/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸ƒç« -ç±»-ï¼ˆClassï¼‰"><a href="#ç¬¬ä¸ƒç« -ç±»-ï¼ˆClassï¼‰" class="headerlink" title="ç¬¬ä¸ƒç«  ç±» ï¼ˆClassï¼‰"></a>ç¬¬ä¸ƒç«  ç±» ï¼ˆClassï¼‰</h1><h2 id="å®šä¹‰æŠ½è±¡æ•°æ®ç±»å‹"><a href="#å®šä¹‰æŠ½è±¡æ•°æ®ç±»å‹" class="headerlink" title="å®šä¹‰æŠ½è±¡æ•°æ®ç±»å‹"></a>å®šä¹‰æŠ½è±¡æ•°æ®ç±»å‹</h2><ul><li><strong>ç±»èƒŒåçš„åŸºæœ¬æ€æƒ³</strong>ï¼š<strong>æ•°æ®æŠ½è±¡</strong>ï¼ˆdata abstractionï¼‰å’Œ<strong>å°è£…</strong>ï¼ˆencapsulationï¼‰ã€‚</li><li>æ•°æ®æŠ½è±¡æ˜¯ä¸€ç§ä¾èµ–äº<strong>æ¥å£</strong>ï¼ˆinterfaceï¼‰å’Œ<strong>å®ç°</strong>ï¼ˆimplementationï¼‰åˆ†ç¦»çš„ç¼–ç¨‹æŠ€æœ¯ã€‚</li></ul><h3 id="ç±»æˆå‘˜-ï¼ˆMemberï¼‰"><a href="#ç±»æˆå‘˜-ï¼ˆMemberï¼‰" class="headerlink" title="ç±»æˆå‘˜ ï¼ˆMemberï¼‰"></a>ç±»æˆå‘˜ ï¼ˆMemberï¼‰</h3><ul><li>å¿…é¡»åœ¨ç±»çš„å†…éƒ¨å£°æ˜ï¼Œä¸èƒ½åœ¨å…¶ä»–åœ°æ–¹å¢åŠ æˆå‘˜ã€‚</li><li>æˆå‘˜å¯ä»¥æ˜¯æ•°æ®ï¼Œå‡½æ•°ï¼Œç±»å‹åˆ«åã€‚</li></ul><h3 id="ç±»çš„æˆå‘˜å‡½æ•°"><a href="#ç±»çš„æˆå‘˜å‡½æ•°" class="headerlink" title="ç±»çš„æˆå‘˜å‡½æ•°"></a>ç±»çš„æˆå‘˜å‡½æ•°</h3><ul><li>æˆå‘˜å‡½æ•°çš„<strong>å£°æ˜</strong>å¿…é¡»åœ¨ç±»çš„å†…éƒ¨ã€‚</li><li>æˆå‘˜å‡½æ•°çš„<strong>å®šä¹‰</strong>æ—¢å¯ä»¥åœ¨ç±»çš„å†…éƒ¨ä¹Ÿå¯ä»¥åœ¨å¤–éƒ¨ã€‚</li><li>ä½¿ç”¨ç‚¹è¿ç®—ç¬¦ <code>.</code> è°ƒç”¨æˆå‘˜å‡½æ•°ã€‚</li><li>å¿…é¡»å¯¹ä»»ä½•<code>const</code>æˆ–å¼•ç”¨ç±»å‹æˆå‘˜ä»¥åŠæ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„ç±»ç±»å‹çš„ä»»ä½•æˆå‘˜ä½¿ç”¨åˆå§‹åŒ–å¼ã€‚</li><li><code>ConstRef::ConstRef(int ii): i(ii), ci(i), ri(ii) &#123; &#125;</code></li><li>é»˜è®¤å®å‚ï¼š <code>Sales_item(const std::string &amp;book): isbn(book), units_sold(0), revenue(0.0) &#123; &#125;</code></li><li><code>*this</code>ï¼š<ul><li>æ¯ä¸ªæˆå‘˜å‡½æ•°éƒ½æœ‰ä¸€ä¸ªé¢å¤–çš„ï¼Œéšå«çš„å½¢å‚<code>this</code>ã€‚</li><li><code>this</code>æ€»æ˜¯æŒ‡å‘å½“å‰å¯¹è±¡ï¼Œå› æ­¤<code>this</code>æ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆã€‚</li><li>å½¢å‚è¡¨åé¢çš„<code>const</code>ï¼Œæ”¹å˜äº†éšå«çš„<code>this</code>å½¢å‚çš„ç±»å‹ï¼Œå¦‚ <code>bool same_isbn(const Sales_item &amp;rhs) const</code>ï¼Œè¿™ç§å‡½æ•°ç§°ä¸ºâ€œå¸¸é‡æˆå‘˜å‡½æ•°â€ï¼ˆ<code>this</code>æŒ‡å‘çš„å½“å‰å¯¹è±¡æ˜¯å¸¸é‡ï¼‰ã€‚</li><li><code>return *this;</code>å¯ä»¥è®©æˆå‘˜å‡½æ•°è¿ç»­è°ƒç”¨ã€‚</li><li>æ™®é€šçš„é<code>const</code>æˆå‘˜å‡½æ•°ï¼š<code>this</code>æ˜¯æŒ‡å‘ç±»ç±»å‹çš„<code>const</code>æŒ‡é’ˆï¼ˆå¯ä»¥æ”¹å˜<code>this</code>æ‰€æŒ‡å‘çš„å€¼ï¼Œä¸èƒ½æ”¹å˜<code>this</code>ä¿å­˜çš„åœ°å€ï¼‰ã€‚</li><li><code>const</code>æˆå‘˜å‡½æ•°ï¼š<code>this</code>æ˜¯æŒ‡å‘constç±»ç±»å‹çš„<code>const</code>æŒ‡é’ˆï¼ˆæ—¢ä¸èƒ½æ”¹å˜<code>this</code>æ‰€æŒ‡å‘çš„å€¼ï¼Œä¹Ÿä¸èƒ½æ”¹å˜<code>this</code>ä¿å­˜çš„åœ°å€ï¼‰ã€‚</li></ul></li></ul><h3 id="éæˆå‘˜å‡½æ•°"><a href="#éæˆå‘˜å‡½æ•°" class="headerlink" title="éæˆå‘˜å‡½æ•°"></a>éæˆå‘˜å‡½æ•°</h3><ul><li>å’Œç±»ç›¸å…³çš„éæˆå‘˜å‡½æ•°ï¼Œå®šä¹‰å’Œå£°æ˜éƒ½åº”è¯¥åœ¨ç±»çš„å¤–éƒ¨ã€‚</li></ul><h3 id="ç±»çš„æ„é€ å‡½æ•°"><a href="#ç±»çš„æ„é€ å‡½æ•°" class="headerlink" title="ç±»çš„æ„é€ å‡½æ•°"></a>ç±»çš„æ„é€ å‡½æ•°</h3><ul><li>ç±»é€šè¿‡ä¸€ä¸ªæˆ–è€…å‡ ä¸ªç‰¹æ®Šçš„æˆå‘˜å‡½æ•°æ¥æ§åˆ¶å…¶å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¿™äº›å‡½æ•°å«åš<strong>æ„é€ å‡½æ•°</strong>ã€‚</li><li>æ„é€ å‡½æ•°æ˜¯ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ã€‚</li><li>æ„é€ å‡½æ•°æ”¾åœ¨ç±»çš„<code>public</code>éƒ¨åˆ†ã€‚</li><li>ä¸ç±»åŒåçš„æˆå‘˜å‡½æ•°ã€‚</li><li><code>Sales_item(): units_sold(0), revenue(0.0) &#123; &#125;</code></li><li><code>=default</code>è¦æ±‚ç¼–è¯‘å™¨åˆæˆé»˜è®¤çš„æ„é€ å‡½æ•°ã€‚(<code>C++11</code>)</li><li>åˆå§‹åŒ–åˆ—è¡¨ï¼šå†’å·å’ŒèŠ±æ‹¬å·ä¹‹é—´çš„ä»£ç ï¼š <code>Sales_item(): units_sold(0), revenue(0.0) &#123; &#125;</code></li></ul><h2 id="è®¿é—®æ§åˆ¶ä¸å°è£…"><a href="#è®¿é—®æ§åˆ¶ä¸å°è£…" class="headerlink" title="è®¿é—®æ§åˆ¶ä¸å°è£…"></a>è®¿é—®æ§åˆ¶ä¸å°è£…</h2><ul><li><strong>è®¿é—®è¯´æ˜ç¬¦</strong>ï¼ˆaccess specifiersï¼‰ï¼š<ul><li><code>public</code>ï¼šå®šä¹‰åœ¨ <code>public</code>åé¢çš„æˆå‘˜åœ¨æ•´ä¸ªç¨‹åºå†…å¯ä»¥è¢«è®¿é—®ï¼› <code>public</code>æˆå‘˜å®šä¹‰ç±»çš„æ¥å£ã€‚</li><li><code>private</code>ï¼šå®šä¹‰åœ¨ <code>private</code>åé¢çš„æˆå‘˜å¯ä»¥è¢«ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®ï¼Œä½†ä¸èƒ½è¢«ä½¿ç”¨è¯¥ç±»çš„ä»£ç è®¿é—®ï¼› <code>private</code>éšè—äº†ç±»çš„å®ç°ç»†èŠ‚ã€‚</li></ul></li><li>ä½¿ç”¨ <code>class</code>æˆ–è€… <code>struct</code>ï¼šéƒ½å¯ä»¥è¢«ç”¨äºå®šä¹‰ä¸€ä¸ªç±»ã€‚å”¯ä¸€çš„å´åˆ«åœ¨äºè®¿é—®æƒé™ã€‚<ul><li>ä½¿ç”¨ <code>class</code>ï¼šåœ¨ç¬¬ä¸€ä¸ªè®¿é—®è¯´æ˜ç¬¦ä¹‹å‰çš„æˆå‘˜æ˜¯ <code>priavte</code>çš„ã€‚</li><li>ä½¿ç”¨ <code>struct</code>ï¼šåœ¨ç¬¬ä¸€ä¸ªè®¿é—®è¯´æ˜ç¬¦ä¹‹å‰çš„æˆå‘˜æ˜¯ <code>public</code>çš„ã€‚</li></ul></li></ul><h3 id="å‹å…ƒ"><a href="#å‹å…ƒ" class="headerlink" title="å‹å…ƒ"></a>å‹å…ƒ</h3><ul><li>å…è®¸ç‰¹å®šçš„<strong>éæˆå‘˜å‡½æ•°</strong>è®¿é—®ä¸€ä¸ªç±»çš„<strong>ç§æœ‰æˆå‘˜</strong>.</li><li>å‹å…ƒçš„å£°æ˜ä»¥å…³é”®å­— <code>friend</code>å¼€å§‹ã€‚ <code>friend Sales_data add(const Sales_data&amp;, const Sales_data&amp;);</code>è¡¨ç¤ºéæˆå‘˜å‡½æ•°<code>add</code>å¯ä»¥è®¿é—®ç±»çš„éå…¬æœ‰æˆå‘˜ã€‚</li><li>é€šå¸¸å°†å‹å…ƒå£°æ˜æˆç»„åœ°æ”¾åœ¨<strong>ç±»å®šä¹‰çš„å¼€å§‹æˆ–è€…ç»“å°¾</strong>ã€‚</li><li>ç±»ä¹‹é—´çš„å‹å…ƒï¼š<ul><li>å¦‚æœä¸€ä¸ªç±»æŒ‡å®šäº†å‹å…ƒç±»ï¼Œåˆ™å‹å…ƒç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥è®¿é—®æ­¤ç±»åŒ…æ‹¬éå…¬æœ‰æˆå‘˜åœ¨å†…çš„æ‰€æœ‰æˆå‘˜ã€‚</li></ul></li></ul><h3 id="å°è£…çš„ç›Šå¤„"><a href="#å°è£…çš„ç›Šå¤„" class="headerlink" title="å°è£…çš„ç›Šå¤„"></a>å°è£…çš„ç›Šå¤„</h3><ul><li>ç¡®ä¿ç”¨æˆ·çš„ä»£ç ä¸ä¼šæ— æ„é—´ç ´åå°è£…å¯¹è±¡çš„çŠ¶æ€ã€‚</li><li>è¢«å°è£…çš„ç±»çš„å…·ä½“å®ç°ç»†èŠ‚å¯ä»¥éšæ—¶æ”¹å˜ï¼Œè€Œæ— éœ€è°ƒæ•´ç”¨æˆ·çº§åˆ«çš„ä»£ç ã€‚</li></ul><h2 id="ç±»çš„å…¶ä»–ç‰¹æ€§"><a href="#ç±»çš„å…¶ä»–ç‰¹æ€§" class="headerlink" title="ç±»çš„å…¶ä»–ç‰¹æ€§"></a>ç±»çš„å…¶ä»–ç‰¹æ€§</h2><ul><li>æˆå‘˜å‡½æ•°ä½œä¸ºå†…è”å‡½æ•° <code>inline</code>ï¼š<ul><li>åœ¨ç±»çš„å†…éƒ¨ï¼Œå¸¸æœ‰ä¸€äº›è§„æ¨¡è¾ƒå°çš„å‡½æ•°é€‚åˆäºè¢«å£°æ˜æˆå†…è”å‡½æ•°ã€‚</li><li><strong>å®šä¹‰</strong>åœ¨ç±»å†…éƒ¨çš„å‡½æ•°æ˜¯<strong>è‡ªåŠ¨å†…è”</strong>çš„ã€‚</li><li>åœ¨ç±»å¤–éƒ¨å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œä¹Ÿå¯ä»¥åœ¨å£°æ˜æ—¶æ˜¾å¼åœ°åŠ ä¸Š <code>inline</code>ã€‚</li></ul></li><li><strong>å¯å˜æ•°æ®æˆå‘˜</strong> ï¼ˆmutable data memberï¼‰ï¼š<ul><li><code>mutable size_t access_ctr;</code></li><li>æ°¸è¿œä¸ä¼šæ˜¯<code>const</code>ï¼Œå³ä½¿å®ƒæ˜¯<code>const</code>å¯¹è±¡çš„æˆå‘˜ã€‚</li></ul></li><li><strong>ç±»ç±»å‹</strong>ï¼š<ul><li>æ¯ä¸ªç±»å®šä¹‰äº†å”¯ä¸€çš„ç±»å‹ã€‚</li></ul></li></ul><h2 id="ç±»çš„ä½œç”¨åŸŸ"><a href="#ç±»çš„ä½œç”¨åŸŸ" class="headerlink" title="ç±»çš„ä½œç”¨åŸŸ"></a>ç±»çš„ä½œç”¨åŸŸ</h2><ul><li>æ¯ä¸ªç±»éƒ½ä¼šå®šä¹‰å®ƒè‡ªå·±çš„ä½œç”¨åŸŸã€‚åœ¨ç±»çš„ä½œç”¨åŸŸä¹‹å¤–ï¼Œæ™®é€šçš„æ•°æ®å’Œå‡½æ•°æˆå‘˜åªèƒ½ç”±å¼•ç”¨ã€å¯¹è±¡ã€æŒ‡é’ˆä½¿ç”¨æˆå‘˜è®¿é—®è¿ç®—ç¬¦æ¥è®¿é—®ã€‚</li><li>å‡½æ•°çš„<strong>è¿”å›ç±»å‹</strong>é€šå¸¸åœ¨å‡½æ•°åå‰é¢ï¼Œå› æ­¤å½“æˆå‘˜å‡½æ•°å®šä¹‰åœ¨ç±»çš„å¤–éƒ¨æ—¶ï¼Œè¿”å›ç±»å‹ä¸­ä½¿ç”¨çš„åå­—éƒ½ä½äºç±»çš„ä½œç”¨åŸŸä¹‹å¤–ã€‚</li><li>å¦‚æœæˆå‘˜ä½¿ç”¨äº†å¤–å±‚ä½œç”¨åŸŸä¸­çš„æŸä¸ªåå­—ï¼Œè€Œè¯¥åå­—ä»£è¡¨ä¸€ç§<strong>ç±»å‹</strong>ï¼Œåˆ™ç±»ä¸èƒ½åœ¨ä¹‹åé‡æ–°å®šä¹‰è¯¥åå­—ã€‚</li><li>ç±»ä¸­çš„<strong>ç±»å‹åå®šä¹‰</strong>éƒ½è¦æ”¾åœ¨ä¸€å¼€å§‹ã€‚</li></ul><h2 id="æ„é€ å‡½æ•°å†æ¢"><a href="#æ„é€ å‡½æ•°å†æ¢" class="headerlink" title="æ„é€ å‡½æ•°å†æ¢"></a>æ„é€ å‡½æ•°å†æ¢</h2><ul><li>æ„é€ å‡½æ•°åˆå§‹å€¼åˆ—è¡¨ï¼š<ul><li>ç±»ä¼¼<code>python</code>ä½¿ç”¨èµ‹å€¼çš„æ–¹å¼æœ‰æ—¶å€™ä¸è¡Œï¼Œæ¯”å¦‚<code>const</code>æˆ–è€…å¼•ç”¨ç±»å‹çš„æ•°æ®ï¼Œåªèƒ½åˆå§‹åŒ–ï¼Œä¸èƒ½èµ‹å€¼ã€‚ï¼ˆæ³¨æ„åˆå§‹åŒ–å’Œèµ‹å€¼çš„åŒºåˆ«ï¼‰</li><li>æœ€å¥½è®©æ„é€ å‡½æ•°åˆå§‹å€¼çš„é¡ºåºå’Œæˆå‘˜å£°æ˜çš„é¡ºåºä¿æŒä¸€è‡´ã€‚</li><li>å¦‚æœä¸€ä¸ªæ„é€ å‡½æ•°ä¸ºæ‰€æœ‰å‚æ•°éƒ½æä¾›äº†é»˜è®¤å‚æ•°ï¼Œé‚£ä¹ˆå®ƒå®é™…ä¸Šä¹Ÿå®šä¹‰äº†é»˜è®¤çš„æ„é€ å‡½æ•°ã€‚</li></ul></li></ul><h3 id="å§”æ‰˜æ„é€ å‡½æ•°-ï¼ˆdelegating-constructor-C-11ï¼‰"><a href="#å§”æ‰˜æ„é€ å‡½æ•°-ï¼ˆdelegating-constructor-C-11ï¼‰" class="headerlink" title="å§”æ‰˜æ„é€ å‡½æ•° ï¼ˆdelegating constructor, C++11ï¼‰"></a>å§”æ‰˜æ„é€ å‡½æ•° ï¼ˆdelegating constructor, <code>C++11</code>ï¼‰</h3><ul><li>å§”æ‰˜æ„é€ å‡½æ•°å°†è‡ªå·±çš„èŒè´£å§”æ‰˜ç»™äº†å…¶ä»–æ„é€ å‡½æ•°ã€‚</li><li><code>Sale_data(): Sale_data(&quot;&quot;, 0, 0) &#123;&#125;</code></li></ul><h3 id="éšå¼çš„ç±»å‹è½¬æ¢"><a href="#éšå¼çš„ç±»å‹è½¬æ¢" class="headerlink" title="éšå¼çš„ç±»å‹è½¬æ¢"></a>éšå¼çš„ç±»å‹è½¬æ¢</h3><ul><li>å¦‚æœæ„é€ å‡½æ•°<strong>åªæ¥å—ä¸€ä¸ªå®å‚</strong>ï¼Œåˆ™å®ƒå®é™…ä¸Šå®šä¹‰äº†è½¬æ¢ä¸ºæ­¤ç±»ç±»å‹çš„<strong>éšå¼è½¬æ¢æœºåˆ¶</strong>ã€‚è¿™ç§æ„é€ å‡½æ•°åˆå«<strong>è½¬æ¢æ„é€ å‡½æ•°</strong>ï¼ˆconverting constructorï¼‰ã€‚</li><li>ç¼–è¯‘å™¨åªä¼šè‡ªåŠ¨åœ°æ‰§è¡Œ<code>ä»…ä¸€æ­¥</code>ç±»å‹è½¬æ¢ã€‚</li><li>æŠ‘åˆ¶æ„é€ å‡½æ•°å®šä¹‰çš„éšå¼è½¬æ¢ï¼š<ul><li>å°†æ„é€ å‡½æ•°å£°æ˜ä¸º<code>explicit</code>åŠ ä»¥é˜»æ­¢ã€‚</li><li><code>explicit</code>æ„é€ å‡½æ•°åªèƒ½ç”¨äºç›´æ¥åˆå§‹åŒ–ï¼Œä¸èƒ½ç”¨äºæ‹·è´å½¢å¼çš„åˆå§‹åŒ–ã€‚</li></ul></li></ul><h3 id="èšåˆç±»-ï¼ˆaggregate-classï¼‰"><a href="#èšåˆç±»-ï¼ˆaggregate-classï¼‰" class="headerlink" title="èšåˆç±» ï¼ˆaggregate classï¼‰"></a>èšåˆç±» ï¼ˆaggregate classï¼‰</h3><ul><li>æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶ï¼š<ul><li>æ‰€æœ‰æˆå‘˜éƒ½æ˜¯<code>public</code>çš„ã€‚</li><li>æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ã€‚</li><li>æ²¡æœ‰ç±»å†…åˆå§‹å€¼ã€‚</li><li>æ²¡æœ‰åŸºç±»ï¼Œä¹Ÿæ²¡æœ‰<code>virtual</code>å‡½æ•°ã€‚</li></ul></li><li>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªèŠ±æ‹¬å·æ‹¬èµ·æ¥çš„æˆå‘˜åˆå§‹å€¼åˆ—è¡¨ï¼Œåˆå§‹å€¼çš„é¡ºåºå¿…é¡»å’Œå£°æ˜çš„é¡ºåºä¸€è‡´ã€‚</li></ul><h3 id="å­—é¢å€¼å¸¸é‡ç±»"><a href="#å­—é¢å€¼å¸¸é‡ç±»" class="headerlink" title="å­—é¢å€¼å¸¸é‡ç±»"></a>å­—é¢å€¼å¸¸é‡ç±»</h3><ul><li><code>constexpr</code>å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼å¿…é¡»æ˜¯å­—é¢å€¼ã€‚</li><li><strong>å­—é¢å€¼ç±»å‹</strong>ï¼šé™¤äº†ç®—æœ¯ç±»å‹ã€å¼•ç”¨å’ŒæŒ‡é’ˆå¤–ï¼ŒæŸäº›ç±»ä¹Ÿæ˜¯å­—é¢å€¼ç±»å‹ã€‚</li><li>æ•°æ®æˆå‘˜éƒ½æ˜¯å­—é¢å€¼ç±»å‹çš„èšåˆç±»æ˜¯å­—é¢å€¼å¸¸é‡ç±»ã€‚</li><li>å¦‚æœä¸æ˜¯èšåˆç±»ï¼Œåˆ™å¿…é¡»æ»¡è¶³ä¸‹é¢æ‰€æœ‰æ¡ä»¶ï¼š<ul><li>æ•°æ®æˆå‘˜éƒ½å¿…é¡»æ˜¯å­—é¢å€¼ç±»å‹ã€‚</li><li>ç±»å¿…é¡»è‡³å°‘å«æœ‰ä¸€ä¸ª<code>constexpr</code>æ„é€ å‡½æ•°ã€‚</li><li>å¦‚æœä¸€ä¸ªæ•°æ®æˆå‘˜å«æœ‰ç±»å†…éƒ¨åˆå§‹å€¼ï¼Œåˆ™å†…ç½®ç±»å‹æˆå‘˜çš„åˆå§‹å€¼å¿…é¡»æ˜¯ä¸€æ¡å¸¸é‡è¡¨è¾¾å¼ï¼›æˆ–è€…å¦‚æœæˆå‘˜å±äºæŸç§ç±»ç±»å‹ï¼Œåˆ™åˆå§‹å€¼å¿…é¡»ä½¿ç”¨æˆå‘˜è‡ªå·±çš„<code>constexpr</code>æ„é€ å‡½æ•°ã€‚</li><li>ç±»å¿…é¡»ä½¿ç”¨ææ„å‡½æ•°çš„é»˜è®¤å®šä¹‰ï¼Œè¯¥æˆå‘˜è´Ÿè´£é”€æ¯ç±»çš„å¯¹è±¡ã€‚</li></ul></li></ul><h2 id="ç±»çš„é™æ€æˆå‘˜"><a href="#ç±»çš„é™æ€æˆå‘˜" class="headerlink" title="ç±»çš„é™æ€æˆå‘˜"></a>ç±»çš„é™æ€æˆå‘˜</h2><ul><li>é<code>static</code>æ•°æ®æˆå‘˜å­˜åœ¨äºç±»ç±»å‹çš„æ¯ä¸ªå¯¹è±¡ä¸­ã€‚</li><li><code>static</code>æ•°æ®æˆå‘˜ç‹¬ç«‹äºè¯¥ç±»çš„ä»»æ„å¯¹è±¡è€Œå­˜åœ¨ã€‚</li><li>æ¯ä¸ª<code>static</code>æ•°æ®æˆå‘˜æ˜¯ä¸ç±»å…³è”çš„å¯¹è±¡ï¼Œå¹¶ä¸ä¸è¯¥ç±»çš„å¯¹è±¡ç›¸å…³è”ã€‚</li><li>å£°æ˜ï¼š<ul><li>å£°æ˜ä¹‹å‰åŠ ä¸Šå…³é”®è¯<code>static</code>ã€‚</li></ul></li><li>ä½¿ç”¨ï¼š<ul><li>ä½¿ç”¨<strong>ä½œç”¨åŸŸè¿ç®—ç¬¦</strong><code>::</code>ç›´æ¥è®¿é—®é™æ€æˆå‘˜:<code>r = Account::rate();</code></li><li>ä¹Ÿå¯ä»¥ä½¿ç”¨å¯¹è±¡è®¿é—®ï¼š<code>r = ac.rate();</code></li></ul></li><li>å®šä¹‰ï¼š<ul><li>åœ¨ç±»å¤–éƒ¨å®šä¹‰æ—¶ä¸ç”¨åŠ <code>static</code>ã€‚</li></ul></li><li>åˆå§‹åŒ–ï¼š<ul><li>é€šå¸¸ä¸åœ¨ç±»çš„å†…éƒ¨åˆå§‹åŒ–ï¼Œè€Œæ˜¯åœ¨å®šä¹‰æ—¶è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ <code>double Account::interestRate = initRate();</code></li><li>å¦‚æœä¸€å®šè¦åœ¨ç±»å†…éƒ¨å®šä¹‰ï¼Œåˆ™è¦æ±‚å¿…é¡»æ˜¯å­—é¢å€¼å¸¸é‡ç±»å‹çš„<code>constexpr</code>ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°11</title>
      <link href="2021/04/10/notes/ch11/"/>
      <url>2021/04/10/notes/ch11/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸€ç« -å…³è”å®¹å™¨"><a href="#ç¬¬åä¸€ç« -å…³è”å®¹å™¨" class="headerlink" title="ç¬¬åä¸€ç«  å…³è”å®¹å™¨"></a>ç¬¬åä¸€ç«  å…³è”å®¹å™¨</h1><ul><li>å…³è”å®¹å™¨å’Œé¡ºåºå®¹å™¨çš„ä¸åŒï¼šå…³è”å®¹å™¨ä¸­çš„å…ƒç´ æ—¶æŒ‰ç…§<strong>å…³é”®å­—</strong>æ¥ä¿å­˜å’Œè®¿é—®çš„ã€‚</li><li>å…³è”å®¹å™¨æ”¯æŒé€šè¿‡å…³é”®å­—æ¥é«˜æ•ˆåœ°æŸ¥æ‰¾å’Œè¯»å–å…ƒç´ ï¼ŒåŸºæœ¬çš„å…³è”å®¹å™¨ç±»å‹æ˜¯ <code>map</code>å’Œ <code>set</code>ã€‚</li></ul><p><strong>å…³è”å®¹å™¨ç±»å‹</strong>ï¼š</p><table><thead><tr><th>å®¹å™¨ç±»å‹</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>æŒ‰é¡ºåºå­˜å‚¨</td><td></td></tr><tr><td><code>map</code></td><td>å…³é”®æ•°ç»„ï¼šä¿å­˜<code>å…³é”®å­—-å€¼</code>å¯¹</td></tr><tr><td><code>set</code></td><td>å…³é”®å­—å³å€¼ï¼Œå³åªä¿å­˜å…³é”®å­—çš„å®¹å™¨</td></tr><tr><td><code>multimap</code></td><td>æ”¯æŒåŒä¸€ä¸ªé”®å¤šæ¬¡å‡ºç°çš„<code>map</code></td></tr><tr><td><code>multiset</code></td><td>æ”¯æŒåŒä¸€ä¸ªé”®å¤šæ¬¡å‡ºç°çš„<code>set</code></td></tr><tr><td>æ— åºé›†åˆ</td><td></td></tr><tr><td><code>unordered_map</code></td><td>ç”¨å“ˆå¸Œå‡½æ•°ç»„ç»‡çš„<code>map</code></td></tr><tr><td><code>unordered_set</code></td><td>ç”¨å“ˆå¸Œå‡½æ•°ç»„ç»‡çš„<code>set</code></td></tr><tr><td><code>unordered_multimap</code></td><td>å“ˆå¸Œç»„ç»‡çš„<code>map</code>ï¼Œå…³é”®å­—å¯ä»¥é‡å¤å‡ºç°</td></tr><tr><td><code>unordered_multiset</code></td><td>å“ˆå¸Œç»„ç»‡çš„<code>set</code>ï¼Œå…³é”®å­—å¯ä»¥é‡å¤å‡ºç°</td></tr></tbody></table><h2 id="å…³è”å®¹å™¨æ¦‚è¿°"><a href="#å…³è”å®¹å™¨æ¦‚è¿°" class="headerlink" title="å…³è”å®¹å™¨æ¦‚è¿°"></a>å…³è”å®¹å™¨æ¦‚è¿°</h2><h3 id="å®šä¹‰å…³è”å®¹å™¨"><a href="#å®šä¹‰å…³è”å®¹å™¨" class="headerlink" title="å®šä¹‰å…³è”å®¹å™¨"></a>å®šä¹‰å…³è”å®¹å™¨</h3><ul><li>éœ€è¦æŒ‡å®šå…ƒç´ ç±»å‹ã€‚</li><li>åˆ—è¡¨åˆå§‹åŒ–ï¼š<ul><li><code>map</code>ï¼š<code>map&lt;string, int&gt; word_count = &#123;&#123;"a", 1&#125;, &#123;"b", 2&#125;&#125;;</code></li><li><code>set</code>ï¼š<code>set&lt;string&gt; exclude = &#123;&quot;the&quot;, &quot;a&quot;&#125;;</code></li></ul></li></ul><h3 id="å…³é”®å­—ç±»å‹çš„è¦æ±‚"><a href="#å…³é”®å­—ç±»å‹çš„è¦æ±‚" class="headerlink" title="å…³é”®å­—ç±»å‹çš„è¦æ±‚"></a>å…³é”®å­—ç±»å‹çš„è¦æ±‚</h3><ul><li>å¯¹äºæœ‰åºå®¹å™¨ï¼Œå…³é”®å­—ç±»å‹å¿…é¡»å®šä¹‰å…ƒç´ æ¯”è¾ƒçš„æ–¹æ³•ã€‚é»˜è®¤æ˜¯<code>&lt;</code>ã€‚</li><li>å¦‚æœæƒ³ä¼ é€’ä¸€ä¸ªæ¯”è¾ƒçš„å‡½æ•°ï¼Œå¯ä»¥è¿™æ ·å®šä¹‰ï¼š<code>multiset&lt;Sales_data, decltype(compareIsbn)*&gt; bookstore(compareIsbn);</code></li></ul><h3 id="pair"><a href="#pair" class="headerlink" title="pair"></a>pair</h3><ul><li>åœ¨<code>utility</code>å¤´æ–‡ä»¶ä¸­å®šä¹‰ã€‚</li><li>ä¸€ä¸ª<code>pair</code>ä¿å­˜ä¸¤ä¸ªæ•°æ®æˆå‘˜ï¼Œä¸¤ä¸ªç±»å‹ä¸è¦æ±‚ä¸€æ ·ã€‚</li></ul><p><strong>pairçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>pair&lt;T1, T2&gt; p;</code></td><td><code>p</code>æ˜¯ä¸€ä¸ª<code>pair</code>ï¼Œä¸¤ä¸ªç±»å‹åˆ†åˆ«æ˜¯<code>T1</code>å’Œ<code>T2</code>çš„æˆå‘˜éƒ½è¿›è¡Œäº†å€¼åˆå§‹åŒ–ã€‚</td></tr><tr><td><code>pair&lt;T1, T2&gt; p(v1, v2);</code></td><td><code>first</code>å’Œ<code>second</code>åˆ†åˆ«ç”¨<code>v1</code>å’Œ<code>v2</code>è¿›è¡Œåˆå§‹åŒ–ã€‚</td></tr><tr><td><code>pair&lt;T1, T2&gt;p = &#123;v1, v2&#125;;</code></td><td>ç­‰ä»·äº`p(v1, v2)</td></tr><tr><td><code>make_pair(v1, v2);</code></td><td><code>pair</code>çš„ç±»å‹ä»<code>v1</code>å’Œ<code>v2</code>çš„ç±»å‹æ¨æ–­å‡ºæ¥ã€‚</td></tr><tr><td><code>p.first</code></td><td>è¿”å›<code>p</code>çš„åä¸º<code>first</code>çš„æ•°æ®æˆå‘˜ã€‚</td></tr><tr><td><code>p.second</code></td><td>è¿”å›<code>p</code>çš„åä¸º<code>second</code>çš„æ•°æ®æˆå‘˜ã€‚</td></tr><tr><td><code>p1 relop p2</code></td><td>è¿ç®—å…³ç³»ç¬¦æŒ‰å­—å…¸åºå®šä¹‰ã€‚</td></tr><tr><td><code>p1 == p2</code></td><td>å¿…é¡»ä¸¤å¯¹å…ƒç´ ä¸¤ä¸¤ç›¸ç­‰</td></tr><tr><td><code>p1 != p2</code></td><td>åŒä¸Š</td></tr></tbody></table><h2 id="å…³è”å®¹å™¨æ“ä½œ"><a href="#å…³è”å®¹å™¨æ“ä½œ" class="headerlink" title="å…³è”å®¹å™¨æ“ä½œ"></a>å…³è”å®¹å™¨æ“ä½œ</h2><p><strong>å…³è”å®¹å™¨é¢å¤–çš„ç±»å‹åˆ«å</strong>ï¼š</p><table><thead><tr><th>ç±»å‹åˆ«å</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>key_type</code></td><td>æ­¤å®¹å™¨ç±»å‹çš„å…³é”®å­—ç±»å‹</td></tr><tr><td><code>mapped_type</code></td><td>æ¯ä¸ªå…³é”®å­—å…³è”çš„ç±»å‹ï¼Œåªé€‚ç”¨äº<code>map</code></td></tr><tr><td><code>value_type</code></td><td>å¯¹äº<code>map</code>ï¼Œæ˜¯<code>pair&lt;const key_type, mapped_type&gt;</code>; å¯¹äº<code>set</code>ï¼Œå’Œ<code>key_type</code>ç›¸åŒã€‚</td></tr></tbody></table><h3 id="å…³è”å®¹å™¨è¿­ä»£å™¨"><a href="#å…³è”å®¹å™¨è¿­ä»£å™¨" class="headerlink" title="å…³è”å®¹å™¨è¿­ä»£å™¨"></a>å…³è”å®¹å™¨è¿­ä»£å™¨</h3><ul><li>è§£å¼•ç”¨ä¸€ä¸ªå…³è”å®¹å™¨è¿­ä»£å™¨æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»å‹ä¸ºå®¹å™¨çš„<code>value_type</code>çš„å€¼çš„å¼•ç”¨ã€‚</li><li><code>set</code>çš„è¿­ä»£å™¨æ˜¯<code>const</code>çš„ã€‚</li><li>éå†å…³è”å®¹å™¨ï¼šä½¿ç”¨<code>begin</code>å’Œ<code>end</code>ï¼Œéå†<code>map</code>ã€<code>multimap</code>ã€<code>set</code>ã€<code>multiset</code>æ—¶ï¼Œè¿­ä»£å™¨æŒ‰<strong>å…³é”®å­—å‡åº</strong>éå†å…ƒç´ ã€‚</li></ul><h3 id="æ·»åŠ å…ƒç´ "><a href="#æ·»åŠ å…ƒç´ " class="headerlink" title="æ·»åŠ å…ƒç´ "></a>æ·»åŠ å…ƒç´ </h3><p><strong>å…³è”å®¹å™¨<code>insert</code>æ“ä½œ</strong>ï¼š</p><table><thead><tr><th><code>insert</code>æ“ä½œ</th><th>å…³è”å®¹å™¨</th></tr></thead><tbody><tr><td><code>c.insert(v)</code>  <code>c.emplace(args)</code></td><td><code>v</code>æ˜¯<code>value_type</code>ç±»å‹çš„å¯¹è±¡ï¼›<code>args</code>ç”¨æ¥æ„é€ ä¸€ä¸ªå…ƒç´ ã€‚ å¯¹äº<code>map</code>å’Œ<code>set</code>ï¼Œåªæœ‰å…ƒç´ çš„å…³é”®å­—ä¸å­˜åœ¨<code>c</code>ä¸­æ‰æ’å…¥æˆ–æ„é€ å…ƒç´ ã€‚å‡½æ•°è¿”å›ä¸€ä¸ª<code>pair</code>ï¼ŒåŒ…å«ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘å…·æœ‰æŒ‡å®šå…³é”®å­—çš„å…ƒç´ ï¼Œä»¥åŠä¸€ä¸ªæŒ‡ç¤ºæ’å…¥æ˜¯å¦æˆåŠŸçš„<code>bool</code>å€¼ã€‚å¯¹äº<code>multimap</code>å’Œ<code>multiset</code>åˆ™ä¼šæ’å…¥èŒƒå›´ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</td></tr><tr><td><code>c.insert(b, e)</code> <code>c.insert(il)</code></td><td><code>b</code>å’Œ<code>e</code>æ˜¯è¿­ä»£å™¨ï¼Œè¡¨ç¤ºä¸€ä¸ª<code>c::value_type</code>ç±»å‹å€¼çš„èŒƒå›´ï¼›<code>il</code>æ˜¯è¿™ç§å€¼çš„èŠ±æ‹¬å·åˆ—è¡¨ã€‚å‡½æ•°è¿”å›<code>void</code>ã€‚å¯¹äº <code>map</code>å’Œ<code>set</code>ï¼Œåªæ’å…¥å…³é”®å­—ä¸åœ¨<code>c</code>ä¸­çš„å…ƒç´ ã€‚</td></tr><tr><td><code>c.insert(p, v)</code>  <code>c.emplace(p, args)</code></td><td>ç±»ä¼¼<code>insert(v)</code>ï¼Œä½†å°†è¿­ä»£å™¨<code>p</code>ä½œä¸ºä¸€ä¸ªæç¤ºï¼ŒæŒ‡å‡ºä»å“ªé‡Œå¼€å§‹æœç´¢æ–°å…ƒç´ åº”è¯¥å­˜å‚¨çš„ä½ç½®ã€‚è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘å…·æœ‰ç»™å®šå…³é”®å­—çš„å…ƒç´ ã€‚</td></tr></tbody></table><p>å‘<code>map</code>æ·»åŠ å…ƒç´ ï¼š</p><ul><li><code>word_count.insert(&#123;word, 1&#125;);</code></li><li><code>word_count.insert(make_pair(word, 1));</code></li><li><code>word_count.insert(pair&lt;string, size_t&gt;(word, 1));</code></li><li><code>word_count.insert(map&lt;string, size_t&gt;::value_type (word, 1));</code></li></ul><h3 id="åˆ é™¤å…ƒç´ "><a href="#åˆ é™¤å…ƒç´ " class="headerlink" title="åˆ é™¤å…ƒç´ "></a>åˆ é™¤å…ƒç´ </h3><p><strong>ä»å…³è”å®¹å™¨ä¸­åˆ é™¤å…ƒç´ </strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.erase(k)</code></td><td>ä»<code>c</code>ä¸­åˆ é™¤æ¯ä¸ªå…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ ã€‚è¿”å›ä¸€ä¸ª<code>size_type</code>å€¼ï¼ŒæŒ‡å‡ºåˆ é™¤çš„å…ƒç´ çš„æ•°é‡ã€‚</td></tr><tr><td><code>c.erase(p)</code></td><td>ä»<code>c</code>ä¸­åˆ é™¤è¿­ä»£å™¨<code>p</code>æŒ‡å®šçš„å…ƒç´ ã€‚<code>p</code>å¿…é¡»æŒ‡å‘<code>c</code>ä¸­ä¸€ä¸ªçœŸå®å…ƒç´ ï¼Œä¸èƒ½ç­‰äº<code>c.end()</code>ã€‚è¿”å›ä¸€ä¸ªæŒ‡å‘<code>p</code>ä¹‹åå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥<code>p</code>æŒ‡å‘<code>c</code>ä¸­çš„å°¾å…ƒç´ ï¼Œåˆ™è¿”å›<code>c.end()</code></td></tr><tr><td><code>c.erase(b, e)</code></td><td>åˆ é™¤è¿­ä»£å™¨å¯¹<code>b</code>å’Œ<code>e</code>æ‰€è¡¨ç¤ºèŒƒå›´ä¸­çš„å…ƒç´ ã€‚è¿”å›<code>e</code>ã€‚</td></tr></tbody></table><h3 id="ä¸‹æ ‡æ“ä½œ"><a href="#ä¸‹æ ‡æ“ä½œ" class="headerlink" title="ä¸‹æ ‡æ“ä½œ"></a>ä¸‹æ ‡æ“ä½œ</h3><p><strong><code>map</code>å’Œ<code>unordered_map</code>çš„ä¸‹æ ‡æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c[k]</code></td><td>è¿”å›å…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ ï¼›å¦‚æœ<code>k</code>ä¸åœ¨<code>c</code>ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ ï¼Œå¯¹å…¶å€¼åˆå§‹åŒ–ã€‚</td></tr><tr><td><code>c.at(k)</code></td><td>è®¿é—®å…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ ï¼Œå¸¦å‚æ•°æ£€æŸ¥ï¼›è‹¥<code>k</code>ä¸å­˜åœ¨åœ¨<code>c</code>ä¸­ï¼ŒæŠ›å‡ºä¸€ä¸ª<code>out_of_range</code>å¼‚å¸¸ã€‚</td></tr></tbody></table><h3 id="æŸ¥æ‰¾å…ƒç´ "><a href="#æŸ¥æ‰¾å…ƒç´ " class="headerlink" title="æŸ¥æ‰¾å…ƒç´ "></a>æŸ¥æ‰¾å…ƒç´ </h3><p><strong>åœ¨ä¸€ä¸ªå…³è”å®¹å™¨ä¸­æŸ¥æ‰¾å…ƒç´ </strong>:</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.find(k)</code></td><td>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªå…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ ï¼Œè‹¥<code>k</code>ä¸åœ¨å®¹å™¨ä¸­ï¼Œåˆ™è¿”å›å°¾åè¿­ä»£å™¨</td></tr><tr><td><code>c.count(k)</code></td><td>è¿”å›å…³é”®å­—ç­‰äº<code>k</code>çš„å…ƒç´ çš„æ•°é‡ã€‚å¯¹äºä¸å…è®¸é‡å¤å…³é”®å­—çš„å®¹å™¨ï¼Œè¿”å›å€¼æ°¸è¿œæ˜¯0æˆ–1ã€‚</td></tr><tr><td><code>c.lower_bound(k)</code></td><td>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªå…³é”®å­—<strong>ä¸å°äº</strong><code>k</code>çš„å…ƒç´ ã€‚</td></tr><tr><td><code>c.upper_bound(k)</code></td><td>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªå…³é”®å­—<strong>å¤§äº</strong><code>k</code>çš„å…ƒç´ ã€‚</td></tr><tr><td><code>c.equal_range(k)</code></td><td>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨<code>pair</code>ï¼Œè¡¨ç¤ºå…³é”®å­—ç­‰äº<code>k</code>çš„å…ƒç´ çš„èŒƒå›´ã€‚è‹¥<code>k</code>ä¸å­˜åœ¨ï¼Œ<code>pair</code>çš„ä¸¤ä¸ªæˆå‘˜å‡ç­‰äº<code>c.end()</code>ã€‚</td></tr></tbody></table><ul><li><code>lower_bound</code>å’Œ<code>upper_bound</code>ä¸é€‚ç”¨äºæ— åºå®¹å™¨ã€‚</li><li>ä¸‹æ ‡å’Œ<code>at</code>æ“ä½œåªé€‚ç”¨äºé<code>const</code>çš„<code>map</code>å’Œ<code>unordered_map</code>ã€‚</li></ul><h2 id="æ— åºå®¹å™¨"><a href="#æ— åºå®¹å™¨" class="headerlink" title="æ— åºå®¹å™¨"></a>æ— åºå®¹å™¨</h2><ul><li>æœ‰åºå®¹å™¨ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦æ¥ç»„ç»‡å…ƒç´ ï¼›æ— åºå®¹å™¨ä½¿ç”¨å“ˆå¸Œå‡½æ•°å’Œå…³é”®å­—ç±»å‹çš„<code>==</code>è¿ç®—ç¬¦ã€‚</li><li>ç†è®ºä¸Šå“ˆå¸ŒæŠ€æœ¯å¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</li><li>æ— åºå®¹å™¨åœ¨å­˜å‚¨ä¸Šç»„ç»‡ä¸ºä¸€ç»„æ¡¶(bucket)ï¼Œæ¯ä¸ªæ¡¶ä¿å­˜é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚æ— åºå®¹å™¨ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°å°†å…ƒç´ æ˜ å°„åˆ°æ¡¶ã€‚</li></ul><p><strong>æ— åºå®¹å™¨ç®¡ç†æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><strong>æ¡¶æ¥å£</strong></td><td></td></tr><tr><td><code>c.bucket_count()</code></td><td>æ­£åœ¨ä½¿ç”¨çš„æ¡¶çš„æ•°ç›®</td></tr><tr><td><code>c.max_bucket_count()</code></td><td>å®¹å™¨èƒ½å®¹çº³çš„æœ€å¤šçš„æ¡¶çš„æ•°ç›®</td></tr><tr><td><code>c.bucket_size(n)</code></td><td>ç¬¬<code>n</code>ä¸ªæ¡¶ä¸­æœ‰å¤šå°‘ä¸ªå…ƒç´ </td></tr><tr><td><code>c.bucket(k)</code></td><td>å…³é”®å­—ä¸º<code>k</code>çš„å…ƒç´ åœ¨å“ªä¸ªæ¡¶ä¸­</td></tr><tr><td><strong>æ¡¶è¿­ä»£</strong></td><td></td></tr><tr><td><code>local_iterator</code></td><td>å¯ä»¥ç”¨æ¥è®¿é—®æ¡¶ä¸­å…ƒç´ çš„è¿­ä»£å™¨ç±»å‹</td></tr><tr><td><code>const_local_iterator</code></td><td>æ¡¶è¿­ä»£å™¨çš„<code>const</code>ç‰ˆæœ¬</td></tr><tr><td><code>c.begin(n)</code>ï¼Œ<code>c.end(n)</code></td><td>æ¡¶<code>n</code>çš„é¦–å…ƒç´ è¿­ä»£å™¨</td></tr><tr><td><code>c.cbegin(n)</code>ï¼Œ<code>c.cend(n)</code></td><td>ä¸å‰ä¸¤ä¸ªå‡½æ•°ç±»ä¼¼ï¼Œä½†è¿”å›<code>const_local_iterator</code>ã€‚</td></tr><tr><td><strong>å“ˆå¸Œç­–ç•¥</strong></td><td></td></tr><tr><td><code>c.load_factor()</code></td><td>æ¯ä¸ªæ¡¶çš„å¹³å‡å…ƒç´ æ•°é‡ï¼Œè¿”å›<code>float</code>å€¼ã€‚</td></tr><tr><td><code>c.max_load_factor()</code></td><td><code>c</code>è¯•å›¾ç»´æŠ¤çš„å¹³å‡æ¯”æ¡¶å¤§å°ï¼Œè¿”å›<code>float</code>å€¼ã€‚<code>c</code>ä¼šåœ¨éœ€è¦æ—¶æ·»åŠ æ–°çš„æ¡¶ï¼Œä»¥ä½¿å¾—<code>load_factor&lt;=max_load_factor</code></td></tr><tr><td><code>c.rehash(n)</code></td><td>é‡ç»„å­˜å‚¨ï¼Œä½¿å¾—<code>bucket_count&gt;=n</code>ï¼Œä¸”<code>bucket_count&gt;size/max_load_factor</code></td></tr><tr><td><code>c.reverse(n)</code></td><td>é‡ç»„å­˜å‚¨ï¼Œä½¿å¾—<code>c</code>å¯ä»¥ä¿å­˜<code>n</code>ä¸ªå…ƒç´ ä¸”ä¸å¿…<code>rehash</code>ã€‚</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°12</title>
      <link href="2021/04/10/notes/ch12/"/>
      <url>2021/04/10/notes/ch12/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åäºŒç« -åŠ¨æ€å†…å­˜"><a href="#ç¬¬åäºŒç« -åŠ¨æ€å†…å­˜" class="headerlink" title="ç¬¬åäºŒç«  åŠ¨æ€å†…å­˜"></a>ç¬¬åäºŒç«  åŠ¨æ€å†…å­˜</h1><ul><li><p>å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼š</p><ul><li>å…¨å±€å¯¹è±¡åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ†é…ï¼Œç»“æŸæ—¶é”€æ¯ã€‚</li><li>å±€éƒ¨å¯¹è±¡åœ¨è¿›å…¥ç¨‹åºå—æ—¶åˆ›å»ºï¼Œç¦»å¼€å—æ—¶é”€æ¯ã€‚</li><li>å±€éƒ¨<code>static</code>å¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨å‰åˆ†é…ï¼Œåœ¨ç¨‹åºç»“æŸæ—¶é”€æ¯ã€‚</li><li>åŠ¨æ€åˆ†é…å¯¹è±¡ï¼šåªèƒ½æ˜¾å¼åœ°è¢«é‡Šæ”¾ã€‚</li></ul></li><li><p>å¯¹è±¡çš„å†…å­˜ä½ç½®ï¼š</p><ul><li><strong>é™æ€å†…å­˜</strong>ç”¨æ¥ä¿å­˜å±€éƒ¨<code>static</code>å¯¹è±¡ã€ç±»<code>static</code>å¯¹è±¡ã€å®šä¹‰åœ¨ä»»ä½•å‡½æ•°ä¹‹å¤–çš„å˜é‡ã€‚</li><li><strong>æ ˆå†…å­˜</strong>ç”¨æ¥ä¿å­˜å®šä¹‰åœ¨å‡½æ•°å†…çš„é<code>static</code>å¯¹è±¡ã€‚</li><li><strong>å †å†…å­˜</strong>ï¼Œåˆç§°è‡ªç”±ç©ºé—´ï¼Œç”¨æ¥å­˜å‚¨<strong>åŠ¨æ€åˆ†é…</strong>çš„å¯¹è±¡ã€‚</li></ul></li></ul><h2 id="åŠ¨æ€å†…å­˜ä¸æ™ºèƒ½æŒ‡é’ˆ"><a href="#åŠ¨æ€å†…å­˜ä¸æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="åŠ¨æ€å†…å­˜ä¸æ™ºèƒ½æŒ‡é’ˆ"></a>åŠ¨æ€å†…å­˜ä¸æ™ºèƒ½æŒ‡é’ˆ</h2><ul><li>åŠ¨æ€å†…å­˜ç®¡ç†ï¼š<ul><li><code>new</code>ï¼šåœ¨åŠ¨æ€å†…å­˜ä¸­ä¸ºå¯¹è±¡åˆ†é…ç©ºé—´å¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆã€‚</li><li><code>delete</code>ï¼šæ¥å—ä¸€ä¸ªåŠ¨æ€å¯¹è±¡çš„æŒ‡é’ˆï¼Œé”€æ¯è¯¥å¯¹è±¡ï¼Œå¹¶é‡Šæ”¾ä¸ä¹‹å…³è”çš„å†…å­˜ã€‚</li></ul></li><li>æ™ºèƒ½æŒ‡é’ˆï¼š<ul><li>ç®¡ç†åŠ¨æ€å¯¹è±¡ã€‚</li><li>è¡Œä¸ºç±»ä¼¼å¸¸è§„æŒ‡é’ˆã€‚</li><li>è´Ÿè´£è‡ªåŠ¨é‡Šæ”¾æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚</li><li>æ™ºèƒ½æŒ‡é’ˆä¹Ÿæ˜¯æ¨¡æ¿ã€‚</li></ul></li></ul><h3 id="shared-ptrç±»"><a href="#shared-ptrç±»" class="headerlink" title="shared_ptrç±»"></a>shared_ptrç±»</h3><p><strong>shared_ptrå’Œunique_ptréƒ½æ”¯æŒçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>shared_ptr&lt;T&gt; sp</code>  <code>unique_ptr&lt;T&gt; up</code></td><td>ç©ºæ™ºèƒ½æŒ‡é’ˆï¼Œå¯ä»¥æŒ‡å‘ç±»å‹æ˜¯<code>T</code>çš„å¯¹è±¡</td></tr><tr><td><code>p</code></td><td>å°†<code>p</code>ç”¨ä½œä¸€ä¸ªæ¡ä»¶åˆ¤æ–­ï¼Œè‹¥<code>p</code>æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä¸º<code>true</code></td></tr><tr><td><code>*p</code></td><td>è§£å¼•ç”¨<code>p</code>ï¼Œè·å¾—å®ƒæŒ‡å‘çš„å¯¹è±¡ã€‚</td></tr><tr><td><code>p-&gt;mem</code></td><td>ç­‰ä»·äº<code>(*p).mem</code></td></tr><tr><td><code>p.get()</code></td><td>è¿”å›<code>p</code>ä¸­ä¿å­˜çš„æŒ‡é’ˆï¼Œè¦å°å¿ƒä½¿ç”¨ï¼Œè‹¥æ™ºèƒ½æŒ‡é’ˆé‡Šæ”¾äº†å¯¹è±¡ï¼Œè¿”å›çš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡ä¹Ÿå°±æ¶ˆå¤±äº†ã€‚</td></tr><tr><td><code>swap(p, q)</code> <code>p.swap(q)</code></td><td>äº¤æ¢<code>p</code>å’Œ<code>q</code>ä¸­çš„æŒ‡é’ˆ</td></tr></tbody></table><p><strong>shared_ptrç‹¬æœ‰çš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>make_shared&lt;T&gt;(args)</code></td><td>è¿”å›ä¸€ä¸ª<code>shared_ptr</code>ï¼ŒæŒ‡å‘ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„ç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡ã€‚ä½¿ç”¨<code>args</code>åˆå§‹åŒ–æ­¤å¯¹è±¡ã€‚</td></tr><tr><td><code>shared_ptr&lt;T&gt;p(q)</code></td><td><code>p</code>æ˜¯<code>shared_ptr q</code>çš„æ‹·è´ï¼›æ­¤æ“ä½œä¼š<strong>é€’å¢</strong><code>q</code>ä¸­çš„è®¡æ•°å™¨ã€‚<code>q</code>ä¸­çš„æŒ‡é’ˆå¿…é¡»èƒ½è½¬æ¢ä¸º<code>T*</code></td></tr><tr><td><code>p = q</code></td><td><code>p</code>å’Œ<code>q</code>éƒ½æ˜¯<code>shared_ptr</code>ï¼Œæ‰€ä¿å­˜çš„æŒ‡é’ˆå¿…é¡»èƒ½äº’ç›¸è½¬æ¢ã€‚æ­¤æ“ä½œä¼š<strong>é€’å‡</strong><code>p</code>çš„å¼•ç”¨è®¡æ•°ï¼Œ<strong>é€’å¢</strong><code>q</code>çš„å¼•ç”¨è®¡æ•°ï¼›è‹¥<code>p</code>çš„å¼•ç”¨è®¡æ•°å˜ä¸º0ï¼Œåˆ™å°†å…¶ç®¡ç†çš„åŸå†…å­˜é‡Šæ”¾ã€‚</td></tr><tr><td><code>p.unique()</code></td><td>è‹¥<code>p.use_count()</code>æ˜¯1ï¼Œè¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code></td></tr><tr><td><code>p.use_count()</code></td><td>è¿”å›ä¸<code>p</code>å…±äº«å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆæ•°é‡ï¼›å¯èƒ½å¾ˆæ…¢ï¼Œä¸»è¦ç”¨äºè°ƒè¯•ã€‚</td></tr></tbody></table><ul><li><strong>ä½¿ç”¨åŠ¨æ€å†…å­˜çš„ä¸‰ç§åŸå› </strong>ï¼š<ul><li>ç¨‹åºä¸çŸ¥é“è‡ªå·±éœ€è¦ä½¿ç”¨å¤šå°‘å¯¹è±¡ï¼ˆæ¯”å¦‚å®¹å™¨ç±»ï¼‰ã€‚</li><li>ç¨‹åºä¸çŸ¥é“æ‰€éœ€è¦å¯¹è±¡çš„å‡†ç¡®ç±»å‹ã€‚</li><li>ç¨‹åºéœ€è¦åœ¨å¤šä¸ªå¯¹è±¡é—´å…±äº«æ•°æ®ã€‚</li></ul></li></ul><h3 id="ç›´æ¥ç®¡ç†å†…å­˜"><a href="#ç›´æ¥ç®¡ç†å†…å­˜" class="headerlink" title="ç›´æ¥ç®¡ç†å†…å­˜"></a>ç›´æ¥ç®¡ç†å†…å­˜</h3><ul><li>ç”¨<code>new</code>åŠ¨æ€åˆ†é…å’Œåˆå§‹åŒ–å¯¹è±¡ã€‚<ul><li><code>new</code>æ— æ³•ä¸ºåˆ†é…çš„å¯¹è±¡å‘½åï¼ˆå› ä¸ºè‡ªç”±ç©ºé—´åˆ†é…çš„å†…å­˜æ˜¯æ— åçš„ï¼‰ï¼Œå› æ­¤æ˜¯è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆã€‚</li><li><code>int *pi = new int(123);</code></li><li>ä¸€æ—¦å†…å­˜è€—å°½ï¼Œä¼šæŠ›å‡ºç±»å‹æ˜¯<code>bad_alloc</code>çš„å¼‚å¸¸ã€‚</li></ul></li><li>ç”¨<code>delete</code>å°†åŠ¨æ€å†…å­˜å½’è¿˜ç»™ç³»ç»Ÿã€‚<ul><li>æ¥å—ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘è¦é‡Šæ”¾çš„å¯¹è±¡ã€‚</li><li><code>delete</code>åçš„æŒ‡é’ˆç§°ä¸ºç©ºæ‚¬æŒ‡é’ˆï¼ˆdangling pointerï¼‰ã€‚</li></ul></li><li>ä½¿ç”¨<code>new</code>å’Œ<code>delete</code>ç®¡ç†åŠ¨æ€å†…å­˜å­˜åœ¨ä¸‰ä¸ªå¸¸è§é—®é¢˜ï¼š<ul><li>1.å¿˜è®°<code>delete</code>å†…å­˜ã€‚</li><li>2.ä½¿ç”¨å·²ç»é‡Šæ”¾æ‰çš„å¯¹è±¡ã€‚</li><li>3.åŒä¸€å—å†…å­˜é‡Šæ”¾ä¸¤æ¬¡ã€‚</li></ul></li><li>åšæŒåªä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆå¯ä»¥é¿å…ä¸Šè¿°æ‰€æœ‰é—®é¢˜ã€‚</li></ul><h3 id="shared-ptrå’Œnewç»“åˆä½¿ç”¨"><a href="#shared-ptrå’Œnewç»“åˆä½¿ç”¨" class="headerlink" title="shared_ptrå’Œnewç»“åˆä½¿ç”¨"></a>shared_ptrå’Œnewç»“åˆä½¿ç”¨</h3><p><strong>å®šä¹‰å’Œæ”¹å˜shared_ptrçš„å…¶ä»–æ–¹æ³•</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>shared_ptr&lt;T&gt; p(q)</code></td><td><code>p</code>ç®¡ç†å†…ç½®æŒ‡é’ˆ<code>q</code>æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼›<code>q</code>å¿…é¡»æŒ‡å‘<code>new</code>åˆ†é…çš„å†…å­˜ï¼Œä¸”èƒ½å¤Ÿè½¬æ¢ä¸º<code>T*</code>ç±»å‹</td></tr><tr><td><code>shared_ptr&lt;T&gt; p(u)</code></td><td><code>p</code>ä»<code>unique_ptr u</code>é‚£é‡Œæ¥ç®¡äº†å¯¹è±¡çš„æ‰€æœ‰æƒï¼›å°†<code>u</code>ç½®ä¸ºç©º</td></tr><tr><td><code>shared_ptr&lt;T&gt; p(q, d)</code></td><td><code>p</code>æ¥ç®¡äº†å†…ç½®æŒ‡é’ˆ<code>q</code>æ‰€æŒ‡å‘çš„å¯¹è±¡çš„æ‰€æœ‰æƒã€‚<code>q</code>å¿…é¡»èƒ½è½¬æ¢ä¸º<code>T*</code>ç±»å‹ã€‚<code>p</code>å°†ä½¿ç”¨å¯è°ƒç”¨å¯¹è±¡<code>d</code>æ¥ä»£æ›¿<code>delete</code>ã€‚</td></tr><tr><td><code>shared_ptr&lt;T&gt; p(p2, d)</code></td><td><code>p</code>æ˜¯<code>shared_ptr p2</code>çš„æ‹·è´ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯<code>p</code>å°†å¯è°ƒç”¨å¯¹è±¡<code>d</code>æ¥ä»£æ›¿<code>delete</code>ã€‚</td></tr><tr><td><code>p.reset()</code></td><td>è‹¥<code>p</code>æ˜¯å”¯ä¸€æŒ‡å‘å…¶å¯¹è±¡çš„<code>shared_ptr</code>ï¼Œ<code>reset</code>ä¼šé‡Šæ”¾æ­¤å¯¹è±¡ã€‚è‹¥ä¼ é€’äº†å¯é€‰çš„å‚æ•°å†…ç½®æŒ‡é’ˆ<code>q</code>ï¼Œä¼šä»¤<code>p</code>æŒ‡å‘<code>q</code>ï¼Œå¦åˆ™ä¼šå°†<code>p</code>ç½®ç©ºã€‚è‹¥è¿˜ä¼ é€’äº†å‚æ•°<code>d</code>ï¼Œåˆ™ä¼šè°ƒç”¨<code>d</code>è€Œä¸æ˜¯<code>delete</code>æ¥é‡Šæ”¾<code>q</code>ã€‚</td></tr><tr><td><code>p.reset(q)</code></td><td>åŒä¸Š</td></tr><tr><td><code>p.reset(q, d)</code></td><td>åŒä¸Š</td></tr></tbody></table><h3 id="æ™ºèƒ½æŒ‡é’ˆå’Œå¼‚å¸¸"><a href="#æ™ºèƒ½æŒ‡é’ˆå’Œå¼‚å¸¸" class="headerlink" title="æ™ºèƒ½æŒ‡é’ˆå’Œå¼‚å¸¸"></a>æ™ºèƒ½æŒ‡é’ˆå’Œå¼‚å¸¸</h3><ul><li>å¦‚æœä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œå³ä½¿ç¨‹åºå—ç”±äºå¼‚å¸¸è¿‡æ—©ç»“æŸï¼Œæ™ºèƒ½æŒ‡é’ˆç±»ä¹Ÿèƒ½ç¡®ä¿åœ¨å†…å­˜ä¸éœ€è¦çš„æ—¶å€™å°†å…¶é‡Šæ”¾ã€‚</li><li><strong>æ™ºèƒ½æŒ‡é’ˆé™·é˜±</strong>ï¼š<ul><li>ä¸ç”¨ç›¸åŒçš„å†…ç½®æŒ‡é’ˆåˆå§‹åŒ–ï¼ˆæˆ–<code>reset</code>ï¼‰å¤šä¸ªæ™ºèƒ½æŒ‡é’ˆ</li><li>ä¸<code>delete get()</code>è¿”å›çš„æŒ‡é’ˆã€‚</li><li>å¦‚æœä½ ä½¿ç”¨<code>get()</code>è¿”å›çš„æŒ‡é’ˆï¼Œè®°å¾—å½“æœ€åä¸€ä¸ªå¯¹åº”çš„æ™ºèƒ½æŒ‡é’ˆé”€æ¯åï¼Œä½ çš„æŒ‡é’ˆå°±æ— æ•ˆäº†ã€‚</li><li>å¦‚æœä½ ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆç®¡ç†çš„èµ„æºä¸æ˜¯<code>new</code>åˆ†é…çš„å†…å­˜ï¼Œè®°ä½ä¼ é€’ç»™å®ƒä¸€ä¸ªåˆ é™¤å™¨ã€‚</li></ul></li></ul><h3 id="unique-ptr"><a href="#unique-ptr" class="headerlink" title="unique_ptr"></a>unique_ptr</h3><ul><li>æŸä¸€ä¸ªæ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª<code>unique_ptr</code>æŒ‡å‘ä¸€ä¸ªç»™å®šçš„å¯¹è±¡ã€‚</li><li>ä¸æ”¯æŒæ‹·è´æˆ–è€…èµ‹å€¼æ“ä½œã€‚</li><li>å‘åå…¼å®¹ï¼š<code>auto_ptr</code>ï¼šè€ç‰ˆæœ¬ï¼Œå…·æœ‰<code>unique_ptr</code>çš„éƒ¨åˆ†ç‰¹æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸èƒ½åœ¨å®¹å™¨ä¸­ä¿å­˜<code>auto_ptr</code>ï¼Œä¹Ÿä¸èƒ½ä»å‡½æ•°è¿”å›<code>auto_ptr</code>ã€‚</li></ul><p><strong>unique_ptræ“ä½œ</strong>:</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>unique_ptr&lt;T&gt; u1</code></td><td>ç©º<code>unique_ptr</code>ï¼Œå¯ä»¥æŒ‡å‘ç±»å‹æ˜¯<code>T</code>çš„å¯¹è±¡ã€‚<code>u1</code>ä¼šä½¿ç”¨<code>delete</code>æ¥æ˜¯é‡Šæ”¾å®ƒçš„æŒ‡é’ˆã€‚</td></tr><tr><td><code>unique_ptr&lt;T, D&gt; u2</code></td><td><code>u2</code>ä¼šä½¿ç”¨ä¸€ä¸ªç±»å‹ä¸º<code>D</code>çš„å¯è°ƒç”¨å¯¹è±¡æ¥é‡Šæ”¾å®ƒçš„æŒ‡é’ˆã€‚</td></tr><tr><td><code>unique_ptr&lt;T, D&gt; u(d)</code></td><td>ç©º<code>unique_ptr</code>ï¼ŒæŒ‡å‘ç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡ï¼Œç”¨ç±»å‹ä¸º<code>D</code>çš„å¯¹è±¡<code>d</code>ä»£æ›¿<code>delete</code></td></tr><tr><td><code>u = nullptr</code></td><td>é‡Šæ”¾<code>u</code>æŒ‡å‘çš„å¯¹è±¡ï¼Œå°†<code>u</code>ç½®ä¸ºç©ºã€‚</td></tr><tr><td><code>u.release()</code></td><td><code>u</code>æ”¾å¼ƒå¯¹æŒ‡é’ˆçš„æ§åˆ¶æƒï¼Œè¿”å›æŒ‡é’ˆï¼Œå¹¶å°†<code>u</code>ç½®ç©ºã€‚</td></tr><tr><td><code>u.reset()</code></td><td>é‡Šæ”¾<code>u</code>æŒ‡å‘çš„å¯¹è±¡</td></tr><tr><td><code>u.reset(q)</code></td><td>ä»¤<code>u</code>æŒ‡å‘<code>q</code>æŒ‡å‘çš„å¯¹è±¡</td></tr><tr><td><code>u.reset(nullptr)</code></td><td>å°†<code>u</code>ç½®ç©º</td></tr></tbody></table><h3 id="weak-ptr"><a href="#weak-ptr" class="headerlink" title="weak_ptr"></a>weak_ptr</h3><ul><li><code>weak_ptr</code>æ˜¯ä¸€ç§ä¸æ§åˆ¶æ‰€æŒ‡å‘å¯¹è±¡ç”Ÿå­˜æœŸçš„æ™ºèƒ½æŒ‡é’ˆã€‚</li><li>æŒ‡å‘ä¸€ä¸ªç”±<code>shared_ptr</code>ç®¡ç†çš„å¯¹è±¡ï¼Œä¸æ”¹å˜<code>shared_ptr</code>çš„å¼•ç”¨è®¡æ•°ã€‚</li><li>ä¸€æ—¦æœ€åä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„<code>shared_ptr</code>è¢«é”€æ¯ï¼Œå¯¹è±¡å°±ä¼šè¢«é‡Šæ”¾ï¼Œä¸ç®¡æœ‰æ²¡æœ‰<code>weak_ptr</code>æŒ‡å‘è¯¥å¯¹è±¡ã€‚</li></ul><p><strong>weak_ptræ“ä½œ</strong>:</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>weak_ptr&lt;T&gt; w</code></td><td>ç©º<code>weak_ptr</code>å¯ä»¥æŒ‡å‘ç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡</td></tr><tr><td><code>weak_ptr&lt;T&gt; w(sp)</code></td><td>ä¸<code>shared_ptr</code>æŒ‡å‘ç›¸åŒå¯¹è±¡çš„<code>weak_ptr</code>ã€‚<code>T</code>å¿…é¡»èƒ½è½¬æ¢ä¸º<code>sp</code>æŒ‡å‘çš„ç±»å‹ã€‚</td></tr><tr><td><code>w = p</code></td><td><code>p</code>å¯ä»¥æ˜¯<code>shared_ptr</code>æˆ–ä¸€ä¸ª<code>weak_ptr</code>ã€‚èµ‹å€¼å<code>w</code>å’Œ<code>p</code>å…±äº«å¯¹è±¡ã€‚</td></tr><tr><td><code>w.reset()</code></td><td>å°†<code>w</code>ç½®ä¸ºç©ºã€‚</td></tr><tr><td><code>w.use_count()</code></td><td>ä¸<code>w</code>å…±äº«å¯¹è±¡çš„<code>shared_ptr</code>çš„æ•°é‡ã€‚</td></tr><tr><td><code>w.expired()</code></td><td>è‹¥<code>w.use_count()</code>ä¸º0ï¼Œè¿”å›<code>true</code>ï¼Œå¦åˆ™è¿”å›<code>false</code></td></tr><tr><td><code>w.lock()</code></td><td>å¦‚æœ<code>expired</code>ä¸º<code>true</code>ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©º<code>shared_ptr</code>ï¼›å¦åˆ™è¿”å›ä¸€ä¸ªæŒ‡å‘<code>w</code>çš„å¯¹è±¡çš„<code>shared_ptr</code>ã€‚</td></tr></tbody></table><h2 id="åŠ¨æ€æ•°ç»„"><a href="#åŠ¨æ€æ•°ç»„" class="headerlink" title="åŠ¨æ€æ•°ç»„"></a>åŠ¨æ€æ•°ç»„</h2><h3 id="newå’Œæ•°ç»„"><a href="#newå’Œæ•°ç»„" class="headerlink" title="newå’Œæ•°ç»„"></a>newå’Œæ•°ç»„</h3><ul><li><p><code>new</code>ä¸€ä¸ªåŠ¨æ€æ•°ç»„ï¼š</p><ul><li>ç±»å‹åä¹‹ååŠ ä¸€å¯¹æ–¹æ‹¬å·ï¼ŒæŒ‡æ˜åˆ†é…çš„å¯¹è±¡æ•°ç›®ï¼ˆå¿…é¡»æ˜¯æ•´å‹ï¼Œä¸å¿…æ˜¯å¸¸é‡ï¼‰ã€‚</li><li>è¿”å›<strong>æŒ‡å‘ç¬¬ä¸€ä¸ªå¯¹è±¡çš„æŒ‡é’ˆ</strong>ã€‚</li><li><code>int *p = new int[size];</code></li></ul></li><li><p><code>delete</code>ä¸€ä¸ªåŠ¨æ€æ•°ç»„ï¼š</p><ul><li><code>delete [] p;</code></li></ul></li><li><p><code>unique_ptr</code>å’Œæ•°ç»„ï¼š</p><ul><li>æŒ‡å‘æ•°ç»„çš„<code>unique_ptr</code>ä¸æ”¯æŒæˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆç‚¹å’Œç®­å¤´ï¼‰ã€‚</li></ul></li></ul><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>unique_ptr&lt;T[]&gt; u</code></td><td><code>u</code>å¯ä»¥æŒ‡å‘ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„æ•°ç»„ï¼Œæ•´æ•°å…ƒç´ ç±»å‹ä¸º<code>T</code></td></tr><tr><td><code>unique_ptr&lt;T[]&gt; u(p)</code></td><td><code>u</code>æŒ‡å‘å†…ç½®æŒ‡é’ˆ<code>p</code>æ‰€æŒ‡å‘çš„åŠ¨æ€åˆ†é…çš„æ•°ç»„ã€‚<code>p</code>å¿…é¡»èƒ½è½¬æ¢ä¸ºç±»å‹<code>T*</code>ã€‚</td></tr><tr><td><code>u[i]</code></td><td>è¿”å›<code>u</code>æ‹¥æœ‰çš„æ•°ç»„ä¸­ä½ç½®<code>i</code>å¤„çš„å¯¹è±¡ã€‚<code>u</code>å¿…é¡»æŒ‡å‘ä¸€ä¸ªæ•°ç»„ã€‚</td></tr><tr><td></td><td></td></tr></tbody></table><h3 id="allocatorç±»"><a href="#allocatorç±»" class="headerlink" title="allocatorç±»"></a>allocatorç±»</h3><ul><li>æ ‡å‡†åº“<code>allocator</code>ç±»å®šä¹‰åœ¨å¤´æ–‡ä»¶<code>memory</code>ä¸­ï¼Œå¸®åŠ©æˆ‘ä»¬å°†å†…å­˜åˆ†é…å’Œå¯¹è±¡æ„é€ åˆ†ç¦»å¼€ã€‚</li><li>åˆ†é…çš„æ˜¯åŸå§‹çš„ã€æœªæ„é€ çš„å†…å­˜ã€‚</li><li><code>allocator</code>æ˜¯ä¸€ä¸ªæ¨¡æ¿ã€‚</li><li><code>allocator&lt;string&gt; alloc;</code></li></ul><p><strong>æ ‡å‡†åº“allocatorç±»åŠå…¶ç®—æ³•</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>allocator&lt;T&gt; a</code></td><td>å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>a</code>çš„<code>allocator</code>å¯¹è±¡ï¼Œå®ƒå¯ä»¥ä¸ºç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡åˆ†é…å†…å­˜</td></tr><tr><td><code>a.allocate(n)</code></td><td>åˆ†é…ä¸€æ®µåŸå§‹çš„ã€æœªæ„é€ çš„å†…å­˜ï¼Œä¿å­˜<code>n</code>ä¸ªç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡ã€‚</td></tr><tr><td><code>a.deallocate(p, n)</code></td><td>é‡Šæ”¾ä»<code>T*</code>æŒ‡é’ˆ<code>p</code>ä¸­åœ°å€å¼€å§‹çš„å†…å­˜ï¼Œè¿™å—å†…å­˜ä¿å­˜äº†<code>n</code>ä¸ªç±»å‹ä¸º<code>T</code>çš„å¯¹è±¡ï¼›<code>p</code>å¿…é¡»æ˜¯ä¸€ä¸ªå…ˆå‰ç”±<code>allocate</code>è¿”å›çš„æŒ‡é’ˆã€‚ä¸”<code>n</code>å¿…é¡»æ˜¯<code>p</code>åˆ›å»ºæ—¶æ‰€è¦æ±‚çš„å¤§å°ã€‚åœ¨è°ƒç”¨<code>deallocate</code>ä¹‹å‰ï¼Œç”¨æˆ·å¿…é¡»å¯¹æ¯ä¸ªåœ¨è¿™å—å†…å­˜ä¸­åˆ›å»ºçš„å¯¹è±¡è°ƒç”¨<code>destroy</code>ã€‚</td></tr><tr><td><code>a.construct(p, args)</code></td><td><code>p</code>å¿…é¡»æ˜¯ä¸€ä¸ªç±»å‹æ˜¯<code>T*</code>çš„æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€å—åŸå§‹å†…å­˜ï¼›<code>args</code>è¢«ä¼ é€’ç»™ç±»å‹ä¸º<code>T</code>çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥åœ¨<code>p</code>æŒ‡å‘çš„å†…å­˜ä¸­æ„é€ ä¸€ä¸ªå¯¹è±¡ã€‚</td></tr><tr><td><code>a.destroy(p)</code></td><td><code>p</code>ä¸º<code>T*</code>ç±»å‹çš„æŒ‡é’ˆï¼Œæ­¤ç®—æ³•å¯¹<code>p</code>æŒ‡å‘çš„å¯¹è±¡æ‰§è¡Œææ„å‡½æ•°ã€‚</td></tr></tbody></table><p><strong>allocatorä¼´éšç®—æ³•</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>uninitialized_copy(b, e, b2)</code></td><td>ä»è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>ç»™å®šçš„è¾“å…¥èŒƒå›´ä¸­æ‹·è´å…ƒç´ åˆ°è¿­ä»£å™¨<code>b2</code>æŒ‡å®šçš„æœªæ„é€ çš„åŸå§‹å†…å­˜ä¸­ã€‚<code>b2</code>æŒ‡å‘çš„å†…å­˜å¿…é¡»è¶³å¤Ÿå¤§ï¼Œèƒ½å¤Ÿå®¹çº³è¾“å…¥åºåˆ—ä¸­å…ƒç´ çš„æ‹·è´ã€‚</td></tr><tr><td><code>uninitialized_copy_n(b, n, b2)</code></td><td>ä»è¿­ä»£å™¨<code>b</code>æŒ‡å‘çš„å…ƒç´ å¼€å§‹ï¼Œæ‹·è´<code>n</code>ä¸ªå…ƒç´ åˆ°<code>b2</code>å¼€å§‹çš„å†…å­˜ä¸­ã€‚</td></tr><tr><td><code>uninitialized_fill(b, e, t)</code></td><td>åœ¨è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>æ‰§è¡Œçš„åŸå§‹å†…å­˜èŒƒå›´ä¸­åˆ›å»ºå¯¹è±¡ï¼Œå¯¹è±¡çš„å€¼å‡ä¸º<code>t</code>çš„æ‹·è´ã€‚</td></tr><tr><td><code>uninitialized_fill_n(b, n, t)</code></td><td>ä»è¿­ä»£å™¨<code>b</code>æŒ‡å‘çš„å†…å­˜åœ°å€å¼€å§‹åˆ›å»º<code>n</code>ä¸ªå¯¹è±¡ã€‚<code>b</code>å¿…é¡»æŒ‡å‘è¶³å¤Ÿå¤§çš„æœªæ„é€ çš„åŸå§‹å†…å­˜ï¼Œèƒ½å¤Ÿå®¹çº³ç»™å®šæ•°é‡çš„å¯¹è±¡ã€‚</td></tr></tbody></table><ul><li>å®šä¹‰åœ¨å¤´æ–‡ä»¶<code>memory</code>ä¸­ã€‚</li><li>åœ¨ç»™å®šç›®çš„ä½ç½®åˆ›å»ºå…ƒç´ ï¼Œè€Œä¸æ˜¯ç”±ç³»ç»Ÿåˆ†é…å†…å­˜ç»™ä»–ä»¬ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°13</title>
      <link href="2021/04/10/notes/ch13/"/>
      <url>2021/04/10/notes/ch13/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸‰ç« -æ‹·è´æ§åˆ¶"><a href="#ç¬¬åä¸‰ç« -æ‹·è´æ§åˆ¶" class="headerlink" title="ç¬¬åä¸‰ç«  æ‹·è´æ§åˆ¶"></a>ç¬¬åä¸‰ç«  æ‹·è´æ§åˆ¶</h1><p><strong>æ‹·è´æ§åˆ¶æ“ä½œ</strong>ï¼ˆcopy controlï¼‰:</p><ul><li>æ‹·è´æ„é€ å‡½æ•°ï¼ˆcopy constructorï¼‰</li><li>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼ˆcopy-assignment operatorï¼‰</li><li>ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆmove constructorï¼‰</li><li>ç§»åŠ¨èµ‹å€¼å‡½æ•°ï¼ˆmove-assignement operatorï¼‰</li><li>ææ„å‡½æ•°ï¼ˆdestructorï¼‰</li></ul><h2 id="æ‹·è´ã€èµ‹å€¼å’Œé”€æ¯"><a href="#æ‹·è´ã€èµ‹å€¼å’Œé”€æ¯" class="headerlink" title="æ‹·è´ã€èµ‹å€¼å’Œé”€æ¯"></a>æ‹·è´ã€èµ‹å€¼å’Œé”€æ¯</h2><h3 id="æ‹·è´æ„é€ å‡½æ•°"><a href="#æ‹·è´æ„é€ å‡½æ•°" class="headerlink" title="æ‹·è´æ„é€ å‡½æ•°"></a>æ‹·è´æ„é€ å‡½æ•°</h3><ul><li>å¦‚æœä¸€ä¸ªæ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<strong>è‡ªèº«ç±»ç±»å‹çš„å¼•ç”¨</strong>ï¼Œä¸”ä»»ä½•é¢å¤–å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œåˆ™æ­¤æ„é€ å‡½æ•°æ˜¯<strong>æ‹·è´æ„é€ å‡½æ•°</strong>ã€‚</li><li><code>class Foo&#123; public: Foo(const Foo&amp;); &#125;</code></li><li><strong>åˆæˆçš„æ‹·è´æ„é€ å‡½æ•°</strong>ï¼ˆsynthesized copy constructorï¼‰ï¼šä¼šå°†å‚æ•°çš„æˆå‘˜é€ä¸ªæ‹·è´åˆ°æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡ä¸­ã€‚</li><li><strong>æ‹·è´åˆå§‹åŒ–</strong>ï¼š<ul><li>å°†å³ä¾§è¿ç®—å¯¹è±¡æ‹·è´åˆ°æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡ä¸­ï¼Œå¦‚æœéœ€è¦ï¼Œè¿˜éœ€è¿›è¡Œç±»å‹è½¬æ¢ã€‚</li><li>é€šå¸¸ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°å®Œæˆã€‚</li><li><code>string book = &quot;9-99&quot;;</code></li><li>å‡ºç°åœºæ™¯ï¼š<ul><li>ç”¨<code>=</code>å®šä¹‰å˜é‡æ—¶ã€‚</li><li>å°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå®å‚ä¼ é€’ç»™ä¸€ä¸ªéå¼•ç”¨ç±»å‹çš„å½¢å‚ã€‚</li><li>ä»ä¸€ä¸ªè¿”å›ç±»å‹ä¸ºéå¼•ç”¨ç±»å‹çš„å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>ç”¨èŠ±æ‹¬å·åˆ—è¡¨åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æˆ–è€…ä¸€ä¸ªèšåˆç±»ä¸­çš„æˆå‘˜ã€‚</li></ul></li></ul></li></ul><h3 id="æ‹·è´èµ‹å€¼è¿ç®—ç¬¦"><a href="#æ‹·è´èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="æ‹·è´èµ‹å€¼è¿ç®—ç¬¦"></a>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</h3><ul><li><strong>é‡è½½èµ‹å€¼è¿ç®—ç¬¦</strong>ï¼š<ul><li>é‡å†™ä¸€ä¸ªåä¸º<code>operator=</code>çš„å‡½æ•°.</li><li>é€šå¸¸è¿”å›ä¸€ä¸ªæŒ‡å‘å…¶å·¦ä¾§è¿ç®—å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li><code>Foo&amp; operator=(const Foo&amp;);</code></li></ul></li><li><strong>åˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦</strong>ï¼š<ul><li>å°†å³ä¾§è¿ç®—å¯¹è±¡çš„æ¯ä¸ªé<code>static</code>æˆå‘˜èµ‹äºˆå·¦ä¾§è¿ç®—å¯¹è±¡çš„å¯¹åº”æˆå‘˜ã€‚</li></ul></li></ul><h3 id="ææ„å‡½æ•°"><a href="#ææ„å‡½æ•°" class="headerlink" title="ææ„å‡½æ•°"></a>ææ„å‡½æ•°</h3><ul><li>é‡Šæ”¾å¯¹è±¡æ‰€ä½¿ç”¨çš„èµ„æºï¼Œå¹¶é”€æ¯å¯¹è±¡çš„é<code>static</code>æ•°æ®æˆå‘˜ã€‚</li><li>åå­—ç”±æ³¢æµªå·æ¥ç±»åæ„æˆã€‚æ²¡æœ‰è¿”å›å€¼ï¼Œä¹Ÿä¸æ¥å—å‚æ•°ã€‚</li><li><code>~Foo();</code></li><li>è°ƒç”¨æ—¶æœºï¼š<ul><li>å˜é‡åœ¨ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ã€‚</li><li>å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå…¶æˆå‘˜è¢«é”€æ¯ã€‚</li><li>å®¹å™¨è¢«é”€æ¯æ—¶ï¼Œå…¶å…ƒç´ è¢«é”€æ¯ã€‚</li><li>åŠ¨æ€åˆ†é…çš„å¯¹è±¡ï¼Œå½“å¯¹æŒ‡å‘å®ƒçš„æŒ‡é’ˆåº”ç”¨<code>delete</code>è¿ç®—ç¬¦æ—¶ã€‚</li><li>å¯¹äºä¸´æ—¶å¯¹è±¡ï¼Œå½“åˆ›å»ºå®ƒçš„å®Œæ•´è¡¨è¾¾å¼ç»“æŸæ—¶ã€‚</li></ul></li><li><strong>åˆæˆææ„å‡½æ•°</strong>ï¼š<ul><li>ç©ºå‡½æ•°ä½“æ‰§è¡Œå®Œåï¼Œ<strong>æˆå‘˜ä¼šè¢«è‡ªåŠ¨é”€æ¯ã€‚</strong></li><li>æ³¨æ„ï¼šææ„å‡½æ•°ä½“æœ¬èº«å¹¶ä¸ç›´æ¥é”€æ¯æˆå‘˜ã€‚</li></ul></li></ul><h3 id="ä¸‰-äº”æ³•åˆ™"><a href="#ä¸‰-äº”æ³•åˆ™" class="headerlink" title="ä¸‰/äº”æ³•åˆ™"></a>ä¸‰/äº”æ³•åˆ™</h3><ul><li>éœ€è¦ææ„å‡½æ•°çš„ç±»ä¹Ÿéœ€è¦æ‹·è´å’Œèµ‹å€¼æ“ä½œã€‚</li><li>éœ€è¦æ‹·è´æ“ä½œçš„ç±»ä¹Ÿéœ€è¦èµ‹å€¼æ“ä½œï¼Œåä¹‹äº¦ç„¶ã€‚</li></ul><h3 id="ä½¿ç”¨-default"><a href="#ä½¿ç”¨-default" class="headerlink" title="ä½¿ç”¨=default"></a>ä½¿ç”¨=default</h3><ul><li>å¯ä»¥é€šè¿‡å°†æ‹·è´æ§åˆ¶æˆå‘˜å®šä¹‰ä¸º<code>=default</code>æ¥æ˜¾å¼åœ°è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆåˆæˆçš„ç‰ˆæœ¬ã€‚</li><li>åˆæˆçš„å‡½æ•°å°†éšå¼åœ°å£°æ˜ä¸ºå†…è”çš„ã€‚</li></ul><h3 id="é˜»æ­¢æ‹·è´"><a href="#é˜»æ­¢æ‹·è´" class="headerlink" title="é˜»æ­¢æ‹·è´"></a>é˜»æ­¢æ‹·è´</h3><ul><li>å¤§å¤šæ•°ç±»åº”è¯¥å®šä¹‰é»˜è®¤æ„é€ å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œæ— è®ºæ˜¯éšå¼åœ°è¿˜æ˜¯æ˜¾å¼åœ°ã€‚</li><li>å®šä¹‰åˆ é™¤çš„å‡½æ•°ï¼š<code>=delete</code>ã€‚</li><li>è™½ç„¶å£°æ˜äº†å®ƒä»¬ï¼Œä½†æ˜¯ä¸èƒ½ä»¥ä»»ä½•æ–¹å¼ä½¿ç”¨å®ƒä»¬ã€‚</li><li>ææ„å‡½æ•°ä¸èƒ½æ˜¯åˆ é™¤çš„æˆå‘˜ã€‚</li><li>å¦‚æœä¸€ä¸ªç±»æœ‰æ•°æ®æˆå‘˜ä¸èƒ½é»˜è®¤æ„é€ ã€æ‹·è´ã€å¤åˆ¶æˆ–è€…é”€æ¯ï¼Œåˆ™å¯¹åº”çš„æˆå‘˜å‡½æ•°å°†è¢«å®šä¹‰ä¸ºåˆ é™¤çš„ã€‚</li><li>è€ç‰ˆæœ¬ä½¿ç”¨<code>private</code>å£°æ˜æ¥é˜»æ­¢æ‹·è´ã€‚</li></ul><h2 id="æ‹·è´æ§åˆ¶å’Œèµ„æºç®¡ç†"><a href="#æ‹·è´æ§åˆ¶å’Œèµ„æºç®¡ç†" class="headerlink" title="æ‹·è´æ§åˆ¶å’Œèµ„æºç®¡ç†"></a>æ‹·è´æ§åˆ¶å’Œèµ„æºç®¡ç†</h2><ul><li>ç±»çš„è¡Œä¸ºå¯ä»¥åƒä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥åƒä¸€ä¸ªæŒ‡é’ˆã€‚<ul><li>è¡Œä¸ºåƒå€¼ï¼šå¯¹è±¡æœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œå‰¯æœ¬å’ŒåŸå¯¹è±¡æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</li><li>è¡Œä¸ºåƒæŒ‡é’ˆï¼šå…±äº«çŠ¶æ€ï¼Œæ‹·è´ä¸€ä¸ªè¿™ç§ç±»çš„å¯¹è±¡æ—¶ï¼Œå‰¯æœ¬å’ŒåŸå¯¹è±¡ä½¿ç”¨ç›¸åŒçš„åº•å±‚æ•°æ®ã€‚</li></ul></li></ul><h2 id="äº¤æ¢æ“ä½œ"><a href="#äº¤æ¢æ“ä½œ" class="headerlink" title="äº¤æ¢æ“ä½œ"></a>äº¤æ¢æ“ä½œ</h2><ul><li>ç®¡ç†èµ„æºçš„ç±»é€šå¸¸è¿˜å®šä¹‰ä¸€ä¸ªåä¸º<code>swap</code>çš„å‡½æ•°ã€‚</li><li>ç»å¸¸ç”¨äºé‡æ’å…ƒç´ é¡ºåºçš„ç®—æ³•ã€‚</li><li>ç”¨<code>swap</code>è€Œä¸æ˜¯<code>std::swap</code>ã€‚</li></ul><h2 id="å¯¹è±¡ç§»åŠ¨"><a href="#å¯¹è±¡ç§»åŠ¨" class="headerlink" title="å¯¹è±¡ç§»åŠ¨"></a>å¯¹è±¡ç§»åŠ¨</h2><ul><li>å¾ˆå¤šæ‹·è´æ“ä½œåï¼ŒåŸå¯¹è±¡ä¼šè¢«é”€æ¯ï¼Œå› æ­¤å¼•å…¥ç§»åŠ¨æ“ä½œå¯ä»¥å¤§å¹…åº¦æå‡æ€§èƒ½ã€‚</li><li>åœ¨æ–°æ ‡å‡†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®¹å™¨ä¿å­˜ä¸å¯æ‹·è´çš„ç±»å‹ï¼Œåªè¦å®ƒä»¬å¯ä»¥è¢«ç§»åŠ¨å³å¯ã€‚</li><li>æ ‡å‡†åº“å®¹å™¨ã€<code>string</code>å’Œ<code>shared_ptr</code>ç±»æ—¢å¯ä»¥æ”¯æŒç§»åŠ¨ä¹Ÿæ”¯æŒæ‹·è´ã€‚<code>IO</code>ç±»å’Œ<code>unique_ptr</code>ç±»å¯ä»¥ç§»åŠ¨ä½†ä¸èƒ½æ‹·è´ã€‚</li></ul><h3 id="å³å€¼å¼•ç”¨"><a href="#å³å€¼å¼•ç”¨" class="headerlink" title="å³å€¼å¼•ç”¨"></a>å³å€¼å¼•ç”¨</h3><ul><li>æ–°æ ‡å‡†å¼•å…¥å³å€¼å¼•ç”¨ä»¥æ”¯æŒç§»åŠ¨æ“ä½œã€‚</li><li>é€šè¿‡<code>&amp;&amp;</code>è·å¾—å³å€¼å¼•ç”¨ã€‚</li><li>åªèƒ½ç»‘å®šåˆ°ä¸€ä¸ªå°†è¦é”€æ¯çš„å¯¹è±¡ã€‚</li><li>å¸¸è§„å¼•ç”¨å¯ä»¥ç§°ä¹‹ä¸ºå·¦å€¼å¼•ç”¨ã€‚</li><li>å·¦å€¼æŒä¹…ï¼Œå³å€¼çŸ­æš‚ã€‚</li></ul><p><strong>moveå‡½æ•°</strong>ï¼š</p><ul><li><code>int &amp;&amp;rr2 = std::move(rr1);</code></li><li><code>move</code>å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå·¦å€¼ï¼Œä½†æˆ‘å¸Œæœ›åƒå³å€¼ä¸€æ ·å¤„ç†å®ƒã€‚</li><li>è°ƒç”¨<code>move</code>æ„å‘³ç€ï¼šé™¤äº†å¯¹<code>rr1</code>èµ‹å€¼æˆ–è€…é”€æ¯å®ƒå¤–ï¼Œæˆ‘ä»¬å°†ä¸å†ä½¿ç”¨å®ƒã€‚</li></ul><h3 id="ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦"><a href="#ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦"></a>ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</h3><ul><li><strong>ç§»åŠ¨æ„é€ å‡½æ•°</strong>ï¼š<ul><li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯¥ç±»ç±»å‹çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå…³é”®æ˜¯ï¼Œè¿™ä¸ªå¼•ç”¨å‚æ•°æ˜¯ä¸€ä¸ª<strong>å³å€¼å¼•ç”¨</strong>ã€‚</li><li><code>StrVec::StrVec(StrVec &amp;&amp;s) noexcept&#123;&#125;</code></li><li>ä¸åˆ†é…ä»»ä½•æ–°å†…å­˜ï¼Œåªæ˜¯æ¥ç®¡ç»™å®šçš„å†…å­˜ã€‚</li></ul></li><li><strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</strong>ï¼š<ul><li><code>StrVec&amp; StrVec::operator=(StrVec &amp;&amp; rhs) noexcept&#123;&#125;</code> </li></ul></li><li>ç§»åŠ¨å³å€¼ï¼Œæ‹·è´å·¦å€¼ã€‚</li><li>å¦‚æœæ²¡æœ‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œå³å€¼ä¹Ÿè¢«æ‹·è´ã€‚</li><li>æ›´æ–°ä¸‰/äº”æ³•åˆ™ï¼šå¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†ä»»ä½•ä¸€ä¸ªæ‹·è´æ“ä½œï¼Œå®ƒå°±åº”è¯¥å®šä¹‰æ‰€æœ‰äº”ä¸ªæ“ä½œã€‚</li><li>ç§»åŠ¨è¿­ä»£å™¨ï¼š<ul><li><code>make_move_iterator</code>å‡½æ•°è®²ä¸€ä¸ªæ™®é€šè¿­ä»£å™¨è½¬æ¢ä¸ºä¸€ä¸ªç§»åŠ¨è¿­ä»£å™¨ã€‚</li></ul></li><li>å»ºè®®ï¼šå°å¿ƒåœ°ä½¿ç”¨ç§»åŠ¨æ“ä½œï¼Œä»¥è·å¾—æ€§èƒ½æå‡ã€‚</li></ul><h3 id="å³å€¼å¼•ç”¨å’Œæˆå‘˜å‡½æ•°"><a href="#å³å€¼å¼•ç”¨å’Œæˆå‘˜å‡½æ•°" class="headerlink" title="å³å€¼å¼•ç”¨å’Œæˆå‘˜å‡½æ•°"></a>å³å€¼å¼•ç”¨å’Œæˆå‘˜å‡½æ•°</h3><ul><li>åŒºåˆ†ç§»åŠ¨å’Œæ‹·è´çš„é‡è½½å‡½æ•°é€šå¸¸æœ‰ä¸€ä¸ªç‰ˆæœ¬æ¥å—ä¸€ä¸ª<code>const T&amp;</code>ï¼Œè€Œå¦ä¸€ä¸ªç‰ˆæœ¬æ¥å—ä¸€ä¸ª<code>T&amp;&amp;</code>ã€‚</li><li>å¼•ç”¨é™å®šç¬¦ï¼š<ul><li>åœ¨å‚æ•°åˆ—è¡¨åé¢é˜²æ­¢ä¸€ä¸ª<code>&amp;</code>ï¼Œé™å®šåªèƒ½å‘å¯ä¿®æ”¹çš„å·¦å€¼èµ‹å€¼è€Œä¸èƒ½å‘å³å€¼èµ‹å€¼ã€‚</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°14</title>
      <link href="2021/04/10/notes/ch14/"/>
      <url>2021/04/10/notes/ch14/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå››ç« -é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢"><a href="#ç¬¬åå››ç« -é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢" class="headerlink" title="ç¬¬åå››ç«  é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢"></a>ç¬¬åå››ç«  é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢</h1><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><ul><li>é‡è½½è¿ç®—ç¬¦æ˜¯å…·æœ‰ç‰¹æ®Šåå­—çš„å‡½æ•°ï¼šç”±å…³é”®å­—<code>operator</code>å’Œå…¶åè¦å®šä¹‰çš„è¿ç®—ç¬¦å·å…±åŒç»„æˆã€‚</li><li>å½“ä¸€ä¸ªé‡è½½çš„è¿ç®—ç¬¦æ˜¯æˆå‘˜å‡½æ•°æ—¶ï¼Œ<code>this</code>ç»‘å®šåˆ°å·¦ä¾§è¿ç®—å¯¹è±¡ã€‚åŠ¨æ€è¿ç®—ç¬¦ç¬¦å‡½æ•°çš„å‚æ•°æ•°é‡æ¯”è¿ç®—å¯¹è±¡çš„æ•°é‡<strong>å°‘ä¸€ä¸ª</strong>ã€‚</li><li>åªèƒ½é‡è½½å¤§å¤šæ•°çš„è¿ç®—ç¬¦ï¼Œè€Œä¸èƒ½å‘æ˜æ–°çš„è¿ç®—ç¬¦å·ã€‚</li><li>é‡è½½è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å’Œç»“åˆå¾‹è·Ÿå¯¹åº”çš„å†…ç½®è¿ç®—ç¬¦ä¿æŒä¸€è‡´ã€‚</li><li>è°ƒç”¨æ–¹å¼ï¼š<ul><li><code>data1 + data2;</code></li><li><code>operator+(data1, data2);</code></li></ul></li><li>æ˜¯å¦æ˜¯æˆå‘˜å‡½æ•°ï¼š<ul><li>èµ‹å€¼ï¼ˆ<code>=</code>ï¼‰ã€ä¸‹æ ‡ï¼ˆ<code>[]</code>ï¼‰ã€è°ƒç”¨ï¼ˆ<code>()</code>ï¼‰å’Œæˆå‘˜è®¿é—®ç®­å¤´ï¼ˆ<code>-&gt;</code>ï¼‰è¿ç®—ç¬¦å¿…é¡»æ˜¯æˆå‘˜ã€‚</li><li>å¤åˆèµ‹å€¼è¿ç®—ç¬¦ä¸€èˆ¬æ¥è¯´æ˜¯æˆå‘˜ã€‚</li><li>æ”¹å˜å¯¹è±¡çŠ¶æ€çš„è¿ç®—ç¬¦æˆ–è€…å’Œç»™å®šç±»å‹å¯†åˆ‡ç›¸å…³çš„è¿ç®—ç¬¦é€šå¸¸æ˜¯æˆå‘˜ï¼Œå¦‚é€’å¢ã€è§£å¼•ç”¨ã€‚</li><li>å…·æœ‰å¯¹ç§°æ€§çš„è¿ç®—ç¬¦å¦‚ç®—æœ¯ã€ç›¸ç­‰æ€§ã€å…³ç³»å’Œä½è¿ç®—ç¬¦ç­‰ï¼Œé€šå¸¸æ˜¯éæˆå‘˜å‡½æ•°ã€‚</li></ul></li></ul><p><strong>è¿ç®—ç¬¦</strong>:</p><table><thead><tr><th>å¯ä»¥è¢«é‡è½½</th><th>ä¸å¯ä»¥è¢«é‡è½½</th></tr></thead><tbody><tr><td><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>^</code></td><td><code>::</code>, <code>.*</code>, <code>.</code>, <code>? :</code>,</td></tr><tr><td><code>&amp;</code>, `</td><td><code>, </code>~`, <code>!</code>, <code>,</code>, <code>=</code></td></tr><tr><td><code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>++</code>, <code>--</code></td><td></td></tr><tr><td><code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>==</code>, <code>!=</code>, <code>&amp;&amp;</code>, `</td><td></td></tr><tr><td><code>+=</code>, <code>-=</code>, <code>/=</code>, <code>%=</code>, <code>^=</code>, <code>&amp;=</code></td><td></td></tr><tr><td>&#124;=, <code>*=</code>, <code>&lt;&lt;=</code>, <code>&gt;&gt;=</code>, <code>[]</code>, <code>()</code></td><td></td></tr><tr><td><code>-&gt;</code>, <code>-&gt;*</code>, <code>new</code>, <code>new[]</code>, <code>delete</code>, <code>delete[]</code></td><td></td></tr></tbody></table><h2 id="è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦"><a href="#è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦" class="headerlink" title="è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦"></a>è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦</h2><h3 id="é‡è½½è¾“å‡ºè¿ç®—ç¬¦-lt-lt"><a href="#é‡è½½è¾“å‡ºè¿ç®—ç¬¦-lt-lt" class="headerlink" title="é‡è½½è¾“å‡ºè¿ç®—ç¬¦&lt;&lt;"></a>é‡è½½è¾“å‡ºè¿ç®—ç¬¦&lt;&lt;</h3><ul><li>ç¬¬ä¸€ä¸ªå½¢å‚é€šå¸¸æ˜¯ä¸€ä¸ªéå¸¸é‡çš„<code>ostream</code>å¯¹è±¡çš„å¼•ç”¨ã€‚éå¸¸é‡æ˜¯å› ä¸ºå‘æµä¸­å†™å…¥ä¼šæ”¹å˜å…¶çŠ¶æ€ï¼›è€Œå¼•ç”¨æ˜¯å› ä¸ºæˆ‘ä»¬æ— æ³•å¤åˆ¶ä¸€ä¸ª<code>ostream</code>å¯¹è±¡ã€‚</li><li>è¾“å…¥è¾“å‡ºè¿ç®—ç¬¦å¿…é¡»æ˜¯éæˆå‘˜å‡½æ•°ã€‚</li></ul><h3 id="é‡è½½è¾“å…¥è¿ç®—ç¬¦-gt-gt"><a href="#é‡è½½è¾“å…¥è¿ç®—ç¬¦-gt-gt" class="headerlink" title="é‡è½½è¾“å…¥è¿ç®—ç¬¦&gt;&gt;"></a>é‡è½½è¾“å…¥è¿ç®—ç¬¦&gt;&gt;</h3><ul><li>ç¬¬ä¸€ä¸ªå½¢å‚é€šå¸¸æ˜¯è¿ç®—ç¬¦å°†è¦è¯»å–çš„æµçš„å› ä¸ç”¨ï¼Œç¬¬äºŒä¸ªå½¢å‚æ˜¯å°†è¦è¯»å–åˆ°çš„ï¼ˆéå¸¸é‡ï¼‰å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li>è¾“å…¥è¿ç®—ç¬¦å¿…é¡»å¤„ç†è¾“å…¥å¯èƒ½å¤±è´¥çš„æƒ…å†µï¼Œè€Œè¾“å‡ºè¿ç®—ç¬¦ä¸éœ€è¦ã€‚</li></ul><h2 id="ç®—æ•°å’Œå…³ç³»è¿ç®—ç¬¦ï¼ˆ-ã€-ã€-ã€-ï¼‰"><a href="#ç®—æ•°å’Œå…³ç³»è¿ç®—ç¬¦ï¼ˆ-ã€-ã€-ã€-ï¼‰" class="headerlink" title="ç®—æ•°å’Œå…³ç³»è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰"></a>ç®—æ•°å’Œå…³ç³»è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰</h2><ul><li>å¦‚æœç±»åŒæ—¶å®šä¹‰äº†ç®—æ•°è¿ç®—ç¬¦å’Œç›¸å…³çš„å¤åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™é€šå¸¸æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨å¤åˆèµ‹å€¼æ¥å®ç°ç®—æ•°è¿ç®—ç¬¦ã€‚</li></ul><h3 id="ç›¸ç­‰è¿ç®—ç¬¦"><a href="#ç›¸ç­‰è¿ç®—ç¬¦" class="headerlink" title="ç›¸ç­‰è¿ç®—ç¬¦=="></a>ç›¸ç­‰è¿ç®—ç¬¦==</h3><ul><li>å¦‚æœå®šä¹‰äº†<code>operator==</code>ï¼Œåˆ™è¿™ä¸ªç±»ä¹Ÿåº”è¯¥å®šä¹‰<code>operator!=</code>ã€‚</li><li>ç›¸ç­‰è¿ç®—ç¬¦å’Œä¸ç­‰è¿ç®—ç¬¦çš„ä¸€ä¸ªåº”è¯¥æŠŠå·¥ä½œå§”æ‰˜ç»™å¦ä¸€ä¸ªã€‚</li><li>ç›¸ç­‰è¿ç®—ç¬¦åº”è¯¥å…·æœ‰ä¼ é€’æ€§ã€‚</li><li>å¦‚æœæŸä¸ªç±»åœ¨é€»è¾‘ä¸Šæœ‰ç›¸ç­‰æ€§çš„å«ä¹‰ï¼Œåˆ™è¯¥ç±»åº”è¯¥å®šä¹‰<code>operator==</code>ï¼Œè¿™æ ·åšå¯ä»¥ä½¿ç”¨æˆ·æ›´å®¹æ˜“ä½¿ç”¨æ ‡å‡†åº“ç®—æ³•æ¥å¤„ç†è¿™ä¸ªç±»ã€‚</li></ul><h3 id="å…³ç³»è¿ç®—ç¬¦"><a href="#å…³ç³»è¿ç®—ç¬¦" class="headerlink" title="å…³ç³»è¿ç®—ç¬¦"></a>å…³ç³»è¿ç®—ç¬¦</h3><ul><li>å¦‚æœå­˜åœ¨å”¯ä¸€ä¸€ç§é€»è¾‘å¯é çš„<code>&lt;</code>å®šä¹‰ï¼Œåˆ™åº”è¯¥è€ƒè™‘ä¸ºè¿™ä¸ªç±»å®šä¹‰<code>&lt;</code>è¿ç®—ç¬¦ã€‚å¦‚æœåŒæ—¶è¿˜åŒ…å«<code>==</code>ï¼Œåˆ™å½“ä¸”æ™‹æ¡£<code>&lt;</code>çš„å®šä¹‰å’Œ<code>++</code>äº§ç”Ÿçš„ç»“æœä¸€ç›´æ—¶æ‰å®šä¹‰<code>&lt;</code>è¿ç®—ç¬¦ã€‚</li></ul><h2 id="èµ‹å€¼è¿ç®—ç¬¦"><a href="#èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="èµ‹å€¼è¿ç®—ç¬¦="></a>èµ‹å€¼è¿ç®—ç¬¦=</h2><ul><li>æˆ‘ä»¬å¯ä»¥é‡è½½èµ‹å€¼è¿ç®—ç¬¦ã€‚ä¸è®ºå½¢å‚çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œèµ‹å€¼è¿ç®—ç¬¦éƒ½å¿…é¡»å®šä¹‰ä¸ºæˆå‘˜å‡½æ•°ã€‚</li><li>èµ‹å€¼è¿ç®—ç¬¦å¿…é¡»å®šä¹‰æˆç±»çš„æˆå‘˜ï¼Œå¤åˆèµ‹å€¼è¿ç®—ç¬¦é€šå¸¸æƒ…å†µä¸‹ä¹Ÿåº”è¯¥è¿™ä¹ˆåšã€‚è¿™ä¸¤ç±»è¿ç®—ç¬¦éƒ½åº”è¯¥è¿”å›å·¦ä¾§è¿ç®—å¯¹è±¡çš„å¼•ç”¨ã€‚</li></ul><h2 id="ä¸‹æ ‡è¿ç®—ç¬¦"><a href="#ä¸‹æ ‡è¿ç®—ç¬¦" class="headerlink" title="ä¸‹æ ‡è¿ç®—ç¬¦[]"></a>ä¸‹æ ‡è¿ç®—ç¬¦[]</h2><ul><li>ä¸‹æ ‡è¿ç®—ç¬¦å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°ã€‚</li><li>ä¸€èˆ¬ä¼šå®šä¹‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š<ul><li>1.è¿”å›æ™®é€šå¼•ç”¨ã€‚</li><li>2.ç±»çš„å¸¸é‡æˆå‘˜ï¼Œå¹¶è¿”å›å¸¸é‡å¼•ç”¨ã€‚</li></ul></li></ul><h2 id="é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆ-ã€â€“ï¼‰"><a href="#é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆ-ã€â€“ï¼‰" class="headerlink" title="é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆ++ã€â€“ï¼‰"></a>é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆ++ã€â€“ï¼‰</h2><ul><li>å®šä¹‰é€’å¢å’Œé€’å‡è¿ç®—ç¬¦çš„ç±»åº”è¯¥åŒæ—¶å®šä¹‰å‰ç½®ç‰ˆæœ¬å’Œåç½®ç‰ˆæœ¬ã€‚</li><li>é€šå¸¸åº”è¯¥è¢«å®šä¹‰æˆç±»çš„æˆå‘˜ã€‚</li><li>ä¸ºäº†å’Œå†…ç½®ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼Œå‰ç½®è¿ç®—ç¬¦åº”è¯¥è¿”å›é€’å¢æˆ–é€’å‡åå¯¹è±¡çš„å¼•ç”¨ã€‚</li><li>åŒæ ·ä¸ºäº†å’Œå†…ç½®ç‰ˆæœ¬ä¿æŒä¸€è‡´ï¼Œåç½®è¿ç®—ç¬¦åº”è¯¥è¿”å›é€’å¢æˆ–é€’å‡å‰å¯¹è±¡çš„å€¼ï¼Œè€Œä¸æ˜¯å¼•ç”¨ã€‚</li><li>åç½®ç‰ˆæœ¬æ¥å—ä¸€ä¸ªé¢å¤–çš„ï¼Œä¸è¢«ä½¿ç”¨çš„<code>int</code>ç±»å‹çš„å½¢å‚ã€‚å› ä¸ºä¸ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æ— éœ€å‘½åã€‚</li></ul><h2 id="æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆ-ã€-gt-ï¼‰"><a href="#æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆ-ã€-gt-ï¼‰" class="headerlink" title="æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆ*ã€-&gt;ï¼‰"></a>æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆ*ã€-&gt;ï¼‰</h2><ul><li>ç®­å¤´è¿ç®—ç¬¦å¿…é¡»æ˜¯ç±»çš„æˆå‘˜ã€‚è§£å¼•ç”¨è¿ç®—ç¬¦é€šå¸¸ä¹Ÿæ˜¯ç±»çš„æˆå‘˜ï¼Œå°½ç®¡å¹¶éå¿…é¡»å¦‚æ­¤ã€‚</li><li>é‡è½½çš„ç®­å¤´è¿ç®—ç¬¦å¿…é¡»è¿”å›ç±»çš„æŒ‡é’ˆæˆ–è€…è‡ªå®šä¹‰äº†ç®­å¤´è¿ç®—ç¬¦çš„æŸä¸ªç±»çš„å¯¹è±¡ã€‚</li><li>è§£å¼•ç”¨å’Œä¹˜æ³•çš„åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯ä¸€å…ƒè¿ç®—ç¬¦ï¼Œä¸€ä¸ªæ˜¯äºŒå…ƒè¿ç®—ç¬¦ã€‚</li></ul><h2 id="å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦"><a href="#å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦" class="headerlink" title="å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦"></a>å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦</h2><ul><li>å¯ä»¥åƒä½¿ç”¨å‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨è¯¥ç±»çš„å¯¹è±¡ã€‚å› ä¸ºè¿™æ ·å¯¹å¾…ç±»åŒæ—¶ä¹Ÿèƒ½å­˜å‚¨çŠ¶æ€ï¼Œæ‰€ä»¥ä¸æ™®é€šå‡½æ•°ç›¸æ¯”æ›´åŠ çµæ´»ã€‚</li><li>å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°ã€‚</li><li>ä¸€ä¸ªç±»å¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒç‰ˆæœ¬çš„è°ƒç”¨è¿ç®—ç¬¦ï¼Œç›¸äº’ä¹‹é—´åº”è¯¥åœ¨å‚æ•°æ•°é‡æˆ–ç±»å‹ä¸Šæœ‰æ‰€åŒºåˆ«ã€‚</li><li>å¦‚æœç´¯å®šä¹‰äº†è°ƒç”¨è¿ç®—ç¬¦ï¼Œåˆ™è¯¥ç±»çš„å¯¹è±¡ç§°ä½œ<strong>å‡½æ•°å¯¹è±¡</strong>ã€‚</li></ul><h3 id="lambdaæ˜¯å‡½æ•°å¯¹è±¡"><a href="#lambdaæ˜¯å‡½æ•°å¯¹è±¡" class="headerlink" title="lambdaæ˜¯å‡½æ•°å¯¹è±¡"></a><code>lambda</code>æ˜¯å‡½æ•°å¯¹è±¡</h3><ul><li><code>lambda</code>æ•è·å˜é‡ï¼š<code>lambda</code>äº§ç”Ÿçš„ç±»å¿…é¡»ä¸ºæ¯ä¸ªå€¼æ•è·çš„å˜é‡å»ºç«‹å¯¹åº”çš„æ•°æ®æˆå‘˜ï¼ŒåŒæ—¶åˆ›å»ºæ„é€ å‡½æ•°ã€‚</li></ul><h3 id="æ ‡å‡†åº“å®šä¹‰çš„å‡½æ•°å¯¹è±¡"><a href="#æ ‡å‡†åº“å®šä¹‰çš„å‡½æ•°å¯¹è±¡" class="headerlink" title="æ ‡å‡†åº“å®šä¹‰çš„å‡½æ•°å¯¹è±¡"></a>æ ‡å‡†åº“å®šä¹‰çš„å‡½æ•°å¯¹è±¡</h3><p><strong>æ ‡å‡†åº“å‡½æ•°å¯¹è±¡</strong>:</p><table><thead><tr><th>ç®—æœ¯</th><th>å…³ç³»</th><th>é€»è¾‘</th></tr></thead><tbody><tr><td><code>plus&lt;Type&gt;</code></td><td><code>equal_to&lt;Type&gt;</code></td><td><code>logical_and&lt;Type&gt;</code></td></tr><tr><td><code>minus&lt;Type&gt;</code></td><td><code>not_equal_to&lt;Type&gt;</code></td><td><code>logical_or&lt;Type&gt;</code></td></tr><tr><td><code>multiplies&lt;Type&gt;</code></td><td><code>greater&lt;Type&gt;</code></td><td><code>logical_not&lt;Type&gt;</code></td></tr><tr><td><code>divides&lt;Type&gt;</code></td><td><code>greater_equal&lt;Type&gt;</code></td><td></td></tr><tr><td><code>modulus&lt;Type&gt;</code></td><td><code>less&lt;Type&gt;</code></td><td></td></tr><tr><td><code>negate&lt;Type&gt;</code></td><td><code>less_equal&lt;Type&gt;</code></td><td></td></tr></tbody></table><ul><li>å¯ä»¥åœ¨ç®—æ³•ä¸­ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°å¯¹è±¡ã€‚</li></ul><h3 id="å¯è°ƒç”¨å¯¹è±¡ä¸function"><a href="#å¯è°ƒç”¨å¯¹è±¡ä¸function" class="headerlink" title="å¯è°ƒç”¨å¯¹è±¡ä¸function"></a>å¯è°ƒç”¨å¯¹è±¡ä¸function</h3><p><strong>æ ‡å‡†åº“functionç±»å‹</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>function&lt;T&gt; f;</code></td><td><code>f</code>æ˜¯ä¸€ä¸ªç”¨æ¥å­˜å‚¨å¯è°ƒç”¨å¯¹è±¡çš„ç©º<code>function</code>ï¼Œè¿™äº›å¯è°ƒç”¨å¯¹è±¡çš„è°ƒç”¨å½¢å¼åº”è¯¥ä¸ç±»å‹<code>T</code>ç›¸åŒã€‚</td></tr><tr><td><code>function&lt;T&gt; f(nullptr);</code></td><td>æ˜¾å¼åœ°æ„é€ ä¸€ä¸ªç©º<code>function</code></td></tr><tr><td><code>function&lt;T&gt; f(obj)</code></td><td>åœ¨<code>f</code>ä¸­å­˜å‚¨å¯è°ƒç”¨å¯¹è±¡<code>obj</code>çš„å‰¯æœ¬</td></tr><tr><td><code>f</code></td><td>å°†<code>f</code>ä½œä¸ºæ¡ä»¶ï¼šå½“<code>f</code>å«æœ‰ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡æ—¶ä¸ºçœŸï¼›å¦åˆ™ä¸ºå‡ã€‚</td></tr><tr><td>å®šä¹‰ä¸º<code>function&lt;T&gt;</code>çš„æˆå‘˜çš„ç±»å‹</td><td></td></tr><tr><td><code>result_type</code></td><td>è¯¥<code>function</code>ç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡è¿”å›çš„ç±»å‹</td></tr><tr><td><code>argument_type</code></td><td>å½“<code>T</code>æœ‰ä¸€ä¸ªæˆ–ä¸¤ä¸ªå®å‚æ—¶å®šä¹‰çš„ç±»å‹ã€‚å¦‚æœ<code>T</code>åªæœ‰ä¸€ä¸ªå®å‚ï¼Œåˆ™<code>argument_type</code></td></tr><tr><td><code>first_argument_type</code></td><td>ç¬¬ä¸€ä¸ªå®å‚çš„ç±»å‹</td></tr><tr><td><code>second_argument_type</code></td><td>ç¬¬äºŒä¸ªå®å‚çš„ç±»å‹</td></tr></tbody></table><ul><li>ä¾‹å¦‚ï¼šå£°æ˜ä¸€ä¸ª<code>function</code>ç±»å‹ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºæ¥å—ä¸¤ä¸ª<code>int</code>ï¼Œè¿”å›ä¸€ä¸ª<code>int</code>çš„å¯è°ƒç”¨å¯¹è±¡ã€‚<code>function&lt;int(int, int)&gt;</code></li></ul><h2 id="é‡è½½ã€ç±»å‹è½¬æ¢ã€è¿ç®—ç¬¦"><a href="#é‡è½½ã€ç±»å‹è½¬æ¢ã€è¿ç®—ç¬¦" class="headerlink" title="é‡è½½ã€ç±»å‹è½¬æ¢ã€è¿ç®—ç¬¦"></a>é‡è½½ã€ç±»å‹è½¬æ¢ã€è¿ç®—ç¬¦</h2><h3 id="ç±»å‹è½¬æ¢è¿ç®—ç¬¦"><a href="#ç±»å‹è½¬æ¢è¿ç®—ç¬¦" class="headerlink" title="ç±»å‹è½¬æ¢è¿ç®—ç¬¦"></a>ç±»å‹è½¬æ¢è¿ç®—ç¬¦</h3><ul><li>ç±»å‹è½¬æ¢è¿ç®—ç¬¦æ˜¯ç±»çš„ä¸€ç§ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œå®ƒè´Ÿè´£å°†ä¸€ä¸ªç±»ç±»å‹çš„å€¼è½¬æ¢æˆå…¶ä»–ç±»å‹ã€‚ç±»å‹è½¬æ¢å‡½æ•°çš„ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š<code>operator type() const;</code></li><li>ä¸€ä¸ªç±»å‹è½¬æ¢å‡½æ•°å¿…é¡»æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ï¼›å®ƒä¸èƒ½å£°æ˜è¿”å›ç±»å‹ï¼Œå½¢å‚åˆ—è¡¨ä¹Ÿå¿…é¡»ä¸ºç©ºã€‚ç±»å‹è½¬æ¢å‡½æ•°é€šå¸¸åº”è¯¥æ˜¯<code>const</code>ã€‚</li><li>é¿å…è¿‡åº¦ä½¿ç”¨ç±»å‹è½¬æ¢å‡½æ•°ã€‚</li><li>C++11å¼•å…¥äº†æ˜¾å¼çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ã€‚</li><li>å‘<code>bool</code>çš„ç±»å‹è½¬æ¢é€šå¸¸ç”¨åœ¨æ¡ä»¶éƒ¨åˆ†ï¼Œå› æ­¤<code>operator bool</code>ä¸€èˆ¬å®šä¹‰æˆ<code>explicit</code>çš„ã€‚</li></ul><h3 id="é¿å…æœ‰äºŒä¹‰æ€§çš„ç±»å‹è½¬æ¢"><a href="#é¿å…æœ‰äºŒä¹‰æ€§çš„ç±»å‹è½¬æ¢" class="headerlink" title="é¿å…æœ‰äºŒä¹‰æ€§çš„ç±»å‹è½¬æ¢"></a>é¿å…æœ‰äºŒä¹‰æ€§çš„ç±»å‹è½¬æ¢</h3><ul><li>é€šå¸¸ï¼Œä¸è¦ä¸ºç±»ç¬¬å‡ ä¸ªäº¿ç›¸åŒçš„ç±»å‹è½¬æ¢ï¼Œä¹Ÿä¸è¦åœ¨ç±»ä¸­å®šä¹‰ä¸¤ä¸ªåŠä»¥ä¸Šè½¬æ¢æºæˆ–è½¬æ¢ç›®æ ‡æ˜¯ç®—æœ¯ç±»å‹çš„è½¬æ¢ã€‚</li><li>åœ¨è°ƒç”¨é‡è½½å‡½æ•°æ—¶ï¼Œå¦‚æœéœ€è¦é¢å¤–çš„æ ‡å‡†ç±»å‹è½¬æ¢ï¼Œåˆ™è¯¥è½¬æ¢çš„çº§åˆ«åªæœ‰å½“æ‰€æœ‰å¯è¡Œå‡½æ•°éƒ½è¯·æ±‚åŒä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„ç±»å‹è½¬æ¢æ—¶æ‰æœ‰ç”¨ã€‚å¦‚æœæ‰€éœ€çš„ç”¨æˆ·å®šä¹‰çš„ç±»å‹è½¬æ¢ä¸æ­¢ä¸€ä¸ªï¼Œåˆ™è¯¥è°ƒç”¨å…·æœ‰äºŒä¹‰æ€§ã€‚</li></ul><h3 id="å‡½æ•°åŒ¹é…ä¸é‡è½½è¿ç®—ç¬¦"><a href="#å‡½æ•°åŒ¹é…ä¸é‡è½½è¿ç®—ç¬¦" class="headerlink" title="å‡½æ•°åŒ¹é…ä¸é‡è½½è¿ç®—ç¬¦"></a>å‡½æ•°åŒ¹é…ä¸é‡è½½è¿ç®—ç¬¦</h3><ul><li>å¦‚æœ<code>a</code>æ˜¯ä¸€ç§ç±»å‹ï¼Œåˆ™è¡¨è¾¾å¼<code>a sym b</code>å¯èƒ½æ˜¯ï¼š<ul><li><code>a.operatorsym(b);</code></li><li><code>operatorsym(a,b);</code></li></ul></li><li>å¦‚æœæˆ‘ä»¬é˜ŸåŒä¸€ä¸ªç±»æ—¢æä¾›äº†è½¬æ¢ç›®æ ‡æ˜¯ç®—æœ¯ç±»å‹çš„ç±»å‹è½¬æ¢ï¼Œä¹Ÿæä¾›äº†é‡è½½çš„è¿ç®—ç¬¦ï¼Œåˆ™å°†ä¼šé‡åˆ°é‡è½½è¿ç®—ç¬¦ä¸å†…ç½®è¿ç®—ç¬¦çš„äºŒä¹‰æ€§é—®é¢˜ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°10</title>
      <link href="2021/04/10/notes/ch10/"/>
      <url>2021/04/10/notes/ch10/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åç« -æ³›å‹ç®—æ³•"><a href="#ç¬¬åç« -æ³›å‹ç®—æ³•" class="headerlink" title="ç¬¬åç«  æ³›å‹ç®—æ³•"></a>ç¬¬åç«  æ³›å‹ç®—æ³•</h1><h2 id="æ³›å‹ç®—æ³•"><a href="#æ³›å‹ç®—æ³•" class="headerlink" title="æ³›å‹ç®—æ³•"></a>æ³›å‹ç®—æ³•</h2><ul><li>å› ä¸ºå®ƒä»¬å®ç°å…±åŒçš„æ“ä½œï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºâ€œ<strong>ç®—æ³•</strong>â€ï¼›è€Œâ€œ<strong>æ³›å‹</strong>â€ã€æŒ‡çš„æ˜¯å®ƒä»¬å¯ä»¥æ“ä½œåœ¨å¤šç§å®¹å™¨ç±»å‹ä¸Šã€‚</li><li>æ³›å‹ç®—æ³•æœ¬èº«ä¸æ‰§è¡Œå®¹å™¨æ“ä½œï¼Œåªæ˜¯å•ç‹¬ä¾èµ–è¿­ä»£å™¨å’Œè¿­ä»£å™¨æ“ä½œå®ç°ã€‚</li><li>å¤´æ–‡ä»¶ï¼š <code>#include &lt;algorithm&gt;</code>æˆ–è€… <code>#include &lt;numeric&gt;</code>(ç®—æ•°ç›¸å…³)</li><li>å¤§å¤šæ•°ç®—æ³•æ˜¯é€šè¿‡éå†ä¸¤ä¸ªè¿­ä»£å™¨æ ‡è®°çš„ä¸€æ®µå…ƒç´ æ¥å®ç°å…¶åŠŸèƒ½ã€‚</li><li>å¿…è¦çš„ç¼–ç¨‹å‡å®šï¼šç®—æ³•æ°¸è¿œä¸ä¼šæ”¹å˜åº•å±‚å®¹å™¨çš„å¤§å°ã€‚ç®—æ³•å¯èƒ½æ”¹å˜å®¹å™¨ä¸­ä¿å­˜çš„å…ƒç´ çš„å€¼ï¼Œä¹Ÿå¯èƒ½åœ¨å®¹å™¨å†…ç§»åŠ¨å…ƒç´ ï¼Œä½†ä¸èƒ½ç›´æ¥æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ ã€‚</li></ul><h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><ul><li><code>vector&lt;int&gt;::const_iterator result = find(vec.begin(), vec.end(), search_value);</code></li><li>è¾“å…¥ï¼šä¸¤ä¸ªæ ‡è®°èŒƒå›´çš„è¿­ä»£å™¨å’Œç›®æ ‡æŸ¥æ‰¾å€¼ã€‚è¿”å›ï¼šå¦‚æœæ‰¾åˆ°ï¼Œè¿”å›å¯¹åº”çš„è¿­ä»£å™¨ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³æ ‡è®°ç»“å°¾çš„è¿­ä»£å™¨ã€‚</li></ul><h2 id="åˆè¯†æ³›å‹ç®—æ³•"><a href="#åˆè¯†æ³›å‹ç®—æ³•" class="headerlink" title="åˆè¯†æ³›å‹ç®—æ³•"></a>åˆè¯†æ³›å‹ç®—æ³•</h2><ul><li>æ ‡å‡†åº“æä¾›äº†è¶…è¿‡100ä¸ªç®—æ³•ï¼Œä½†è¿™äº›ç®—æ³•æœ‰ä¸€è‡´çš„ç»“æ„ã€‚</li><li>ç†è§£ç®—æ³•çš„æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯äº†è§£å®ƒä»¬æ˜¯å¦è¯»å–å…ƒç´ ã€æ”¹å˜å…ƒç´ ã€é‡æ’å…ƒç´ é¡ºåºã€‚</li></ul><h3 id="åªè¯»ç®—æ³•"><a href="#åªè¯»ç®—æ³•" class="headerlink" title="åªè¯»ç®—æ³•"></a>åªè¯»ç®—æ³•</h3><ul><li>åªè¯»å–èŒƒå›´ä¸­çš„å…ƒç´ ï¼Œä¸æ”¹å˜å…ƒç´ ã€‚</li><li>å¦‚ <code>find</code>å’Œ <code>accumulate</code>ï¼ˆåœ¨<code>numeric</code>ä¸­å®šä¹‰ï¼Œæ±‚å’Œï¼‰ã€‚</li><li><code>find_first_of</code>ï¼Œè¾“å…¥ï¼šä¸¤å¯¹è¿­ä»£å™¨æ ‡è®°ä¸¤æ®µèŒƒå›´ï¼Œåœ¨ç¬¬ä¸€æ®µä¸­æ‰¾ç¬¬äºŒæ®µä¸­ä»»æ„å…ƒç´ ï¼Œè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ï¼Œæ‰¾ä¸åˆ°è¿”å›ç¬¬ä¸€æ®µçš„<code>end</code>è¿­ä»£å™¨ã€‚</li><li>é€šå¸¸æœ€å¥½ä½¿ç”¨<code>cbegin</code>å’Œ<code>cend</code>ã€‚</li><li><code>equal</code>ï¼šç¡®å®šä¸¤ä¸ªåºåˆ—æ˜¯å¦ä¿å­˜ç›¸åŒçš„å€¼ã€‚</li></ul><h3 id="å†™å®¹å™¨å…ƒç´ çš„ç®—æ³•"><a href="#å†™å®¹å™¨å…ƒç´ çš„ç®—æ³•" class="headerlink" title="å†™å®¹å™¨å…ƒç´ çš„ç®—æ³•"></a>å†™å®¹å™¨å…ƒç´ çš„ç®—æ³•</h3><ul><li>ä¸€äº›ç®—æ³•å°†æ–°å€¼èµ‹äºˆåºåˆ—ä¸­çš„å…ƒç´ ã€‚</li><li>ç®—æ³•ä¸æ£€æŸ¥å†™æ“ä½œã€‚</li><li><code>fill</code>ï¼š <code>fill(vec.begin(), vec.end(), 0);</code> å°†æ¯ä¸ªå…ƒç´ é‡ç½®ä¸º0</li><li><code>fill_n</code>ï¼š <code>fill_n(vec.begin(), 10, 0);</code></li><li>æ’å…¥è¿­ä»£å™¨<code>back_inserter</code>ï¼š<ul><li>ç”¨æ¥ç¡®ä¿ç®—æ³•æœ‰è¶³å¤Ÿçš„ç©ºé—´å­˜å‚¨æ•°æ®ã€‚</li><li><code>#include &lt;iterator&gt;</code></li><li><code>back_inserter(vec)</code></li></ul></li><li>æ‹·è´ç®—æ³•<code>copy</code>ï¼š</li><li>è¾“å…¥ï¼šå‰ä¸¤ä¸ªå‚æ•°æŒ‡å®šè¾“å…¥èŒƒå›´ï¼Œç¬¬ä¸‰ä¸ªæŒ‡å‘ç›®æ ‡åºåˆ—ã€‚</li><li><code>copy (ilst.begin(), ilst.end(), back_inserter(ivec));</code></li><li><code>copy</code>æ—¶å¿…é¡»ä¿è¯ç›®æ ‡ç›®çš„åºåˆ—è‡³å°‘è¦åŒ…å«ä¸è¾“å…¥åºåˆ—ä¸€æ ·å¤šçš„å…ƒç´ ã€‚</li></ul><h3 id="é‡æ’å®¹å™¨å…ƒç´ çš„ç®—æ³•"><a href="#é‡æ’å®¹å™¨å…ƒç´ çš„ç®—æ³•" class="headerlink" title="é‡æ’å®¹å™¨å…ƒç´ çš„ç®—æ³•"></a>é‡æ’å®¹å™¨å…ƒç´ çš„ç®—æ³•</h3><ul><li>è¿™äº›ç®—æ³•ä¼šé‡æ’å®¹å™¨ä¸­å…ƒç´ çš„é¡ºåºã€‚</li><li>æ’åºç®—æ³•<code>sort</code>ï¼š<ul><li>æ¥å—ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œè¡¨ç¤ºè¦æ’åºçš„å…ƒç´ èŒƒå›´ã€‚</li></ul></li><li>æ¶ˆé™¤é‡å¤<code>unique</code>ï¼š<ul><li>ä¹‹å‰è¦å…ˆè°ƒç”¨<code>sort</code></li><li>è¿”å›çš„è¿­ä»£å™¨æŒ‡å‘æœ€åä¸€ä¸ªä¸é‡å¤å…ƒç´ ä¹‹åçš„ä½ç½®ã€‚</li><li>é¡ºåºä¼šå˜ï¼Œé‡å¤çš„å…ƒç´ è¢«â€œåˆ é™¤â€ã€‚</li><li>å¹¶æ²¡æœ‰çœŸæ­£åˆ é™¤ï¼ŒçœŸæ­£åˆ é™¤å¿…é¡»ä½¿ç”¨å®¹å™¨æ“ä½œã€‚</li></ul></li></ul><h2 id="å®šåˆ¶æ“ä½œ"><a href="#å®šåˆ¶æ“ä½œ" class="headerlink" title="å®šåˆ¶æ“ä½œ"></a>å®šåˆ¶æ“ä½œ</h2><h3 id="å‘ç®—æ³•ä¼ é€’å‡½æ•°ï¼š"><a href="#å‘ç®—æ³•ä¼ é€’å‡½æ•°ï¼š" class="headerlink" title="å‘ç®—æ³•ä¼ é€’å‡½æ•°ï¼š"></a>å‘ç®—æ³•ä¼ é€’å‡½æ•°ï¼š</h3><ul><li><p>è°“è¯ï¼ˆ<code>predicate</code>ï¼‰ï¼š</p><ul><li>æ˜¯ä¸€ä¸ª<strong>å¯è°ƒç”¨çš„è¡¨è¾¾å¼</strong>ï¼Œè¿”å›ç»“æœæ˜¯ä¸€ä¸ªèƒ½ç”¨ä½œæ¡ä»¶çš„å€¼</li><li>ä¸€å…ƒè°“è¯ï¼šæ¥å—ä¸€ä¸ªå‚æ•°</li><li>äºŒå…ƒè°“è¯ï¼šæ¥å—ä¸¤ä¸ªå‚æ•°</li></ul></li><li><p>ä¾‹å­ï¼š</p><ul><li><code>stable_sort</code>ï¼š<ul><li>ä¿ç•™ç›¸ç­‰å…ƒç´ çš„åŸå§‹ç›¸å¯¹ä½ç½®ã€‚</li><li><code>stable_sort(words.begin(), words.end(), isShorter);</code></li></ul></li></ul></li></ul><h3 id="lambdaè¡¨è¾¾å¼"><a href="#lambdaè¡¨è¾¾å¼" class="headerlink" title="lambdaè¡¨è¾¾å¼"></a>lambdaè¡¨è¾¾å¼</h3><ul><li><p>æœ‰æ—¶å¯èƒ½å¸Œæœ›æ“ä½œå¯ä»¥æ¥å—æ›´å¤šçš„å‚æ•°ã€‚</p></li><li><p><code>lambda</code>è¡¨è¾¾å¼è¡¨ç¤ºä¸€ä¸ªå¯è°ƒç”¨çš„ä»£ç å•å…ƒï¼Œå¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªæœªå‘½åçš„å†…è”å‡½æ•°ã€‚</p></li><li><p>å½¢å¼ï¼š<code>[capture list](parameter list) -&gt; return type &#123;function body&#125;</code>ã€‚</p><ul><li>å…¶ä¸­<code>capture list</code>æ•è·åˆ—è¡¨æ˜¯ä¸€ä¸ª<code>lambda</code>æ‰€åœ¨å‡½æ•°å®šä¹‰çš„å±€éƒ¨å˜é‡çš„åˆ—è¡¨ï¼ˆé€šå¸¸ä¸ºç©ºï¼‰ã€‚ä¸å¯å¿½ç•¥ã€‚</li><li><code>return type</code>æ˜¯è¿”å›ç±»å‹ã€‚å¯å¿½ç•¥ã€‚</li><li><code>parameter</code>æ˜¯å‚æ•°åˆ—è¡¨ã€‚å¯å¿½ç•¥ã€‚</li><li><code>function body</code>æ˜¯å‡½æ•°ä½“ã€‚ä¸å¯å¿½ç•¥ã€‚</li><li><code>auto f = [] &#123;return 42;&#125;</code></li></ul></li><li><p>ä¾‹å­ï¼š</p><ul><li><code>find_if</code>:<ul><li>æ¥å—ä¸€å¯¹è¡¨ç¤ºèŒƒå›´çš„è¿­ä»£å™¨å’Œä¸€ä¸ªè°“è¯ï¼Œç”¨æ¥æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³ç‰¹å®šè¦æ±‚çš„å…ƒç´ ã€‚è¿”å›ç¬¬ä¸€ä¸ªä½¿è°“è¯è¿”å›é0å€¼çš„å…ƒç´ ã€‚</li><li><code>auto wc = find_if(words.begin(), words.end(), [sz](const string &amp;a)&#123;return a.size() &gt;= sz;&#125;);</code></li></ul></li><li><code>for_each</code>ï¼š<ul><li>æ¥å—ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶å¯¹åºåˆ—ä¸­æ¯ä¸ªå…ƒç´ è°ƒç”¨æ­¤å¯¹è±¡ã€‚</li><li><code>for_each(wc, words.end(), [](const string &amp;s)&#123;cout &lt;&lt; s &lt;&lt; &quot; &quot;;&#125;)</code></li></ul></li></ul></li></ul><h3 id="lambdaæ•è·å’Œè¿”å›"><a href="#lambdaæ•è·å’Œè¿”å›" class="headerlink" title="lambdaæ•è·å’Œè¿”å›"></a>lambdaæ•è·å’Œè¿”å›</h3><ul><li>å®šä¹‰<code>lambda</code>æ—¶ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ç±»ç±»å‹å’Œè¯¥ç±»å‹çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä»<code>lambda</code>ç”Ÿæˆçš„ç±»éƒ½åŒ…å«ä¸€ä¸ªå¯¹åº”è¯¥<code>lambda</code>æ‰€æ•è·çš„å˜é‡çš„æ•°æ®æˆå‘˜ï¼Œåœ¨<code>lambda</code>å¯¹è±¡åˆ›å»ºæ—¶è¢«åˆå§‹åŒ–ã€‚</li><li><strong>å€¼æ•è·</strong>ï¼šå‰ææ˜¯å˜é‡å¯ä»¥æ‹·è´ï¼Œ<code>size_t v1 = 42; auto f = [v1] &#123;return v1;&#125;;</code>ã€‚</li><li><strong>å¼•ç”¨æ•è·</strong>ï¼šå¿…é¡»ä¿è¯åœ¨<code>lambda</code>æ‰§è¡Œæ—¶ï¼Œå˜é‡æ˜¯å­˜åœ¨çš„ï¼Œ<code>auto f2 = [&amp;v1] &#123;return v1;&#125;;</code></li><li>å°½é‡å‡å°‘æ•è·çš„æ•°æ®é‡ï¼Œå°½å¯èƒ½é¿å…æ•è·æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚</li><li><strong>éšå¼æ•è·</strong>ï¼šè®©ç¼–è¯‘å™¨æ¨æ–­æ•è·åˆ—è¡¨ï¼Œåœ¨æ•è·åˆ—è¡¨ä¸­å†™ä¸€ä¸ª<code>&amp;</code>ï¼ˆå¼•ç”¨æ–¹å¼ï¼‰æˆ–<code>=</code>ï¼ˆå€¼æ–¹å¼ï¼‰ã€‚<code>auto f3 = [=] &#123;return v1;&#125;</code></li></ul><p><strong>lambdaæ•è·åˆ—è¡¨</strong>ï¼š</p><table><thead><tr><th>æ•è·åˆ—è¡¨</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>[]</code></td><td>ç©ºæ•è·åˆ—è¡¨ã€‚<code>lambda</code>ä¸èƒ½ä½¿ç”¨æ‰€åœ¨å‡½æ•°ä¸­çš„å˜é‡ã€‚ä¸€ä¸ª<code>lambda</code>åªæœ‰åœ¨æ•è·å˜é‡åæ‰èƒ½ä½¿ç”¨å®ƒä»¬ã€‚</td></tr><tr><td><code>[names]</code></td><td><code>names</code>æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åå­—åˆ—è¡¨ï¼Œè¿™äº›åå­—éƒ½æ˜¯åœ¨<code>lambda</code>æ‰€åœ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œæ•è·åˆ—è¡¨ä¸­çš„å˜é‡éƒ½è¢«æ‹·è´ï¼Œåå­—å‰å¦‚æœä½¿ç”¨äº†<code>&amp;</code>ï¼Œåˆ™é‡‡ç”¨å¼•ç”¨æ•è·æ–¹å¼ã€‚</td></tr><tr><td><code>[&amp;]</code></td><td>éšå¼æ•è·åˆ—è¡¨ï¼Œé‡‡ç”¨å¼•ç”¨æ•è·æ–¹å¼ã€‚<code>lambda</code>ä½“ä¸­æ‰€ä½¿ç”¨çš„æ¥è‡ªæ‰€åœ¨å‡½æ•°çš„å®ä½“éƒ½é‡‡ç”¨å¼•ç”¨æ–¹å¼ä½¿ç”¨ã€‚</td></tr><tr><td><code>[=]</code></td><td>éšå¼æ•è·åˆ—è¡¨ï¼Œé‡‡ç”¨å€¼æ•è·æ–¹å¼ã€‚</td></tr><tr><td><code>[&amp;, identifier_list]</code></td><td><code>identifier_list</code>æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„åˆ—è¡¨ï¼ŒåŒ…å«0ä¸ªæˆ–å¤šä¸ªæ¥è‡ªæ‰€åœ¨å‡½æ•°çš„å˜é‡ã€‚è¿™äº›å˜é‡é‡‡ç”¨å€¼æ•è·æ–¹å¼ï¼Œè€Œä»»ä½•éšå¼æ•è·çš„å˜é‡éƒ½é‡‡ç”¨å¼•ç”¨æ–¹å¼æ•è·ã€‚<code>identifier_list</code>ä¸­çš„åå­—å‰é¢ä¸èƒ½ä½¿ç”¨<code>&amp;</code></td></tr><tr><td><code>[=, identifier_list]</code></td><td><code>identifier_list</code>ä¸­çš„å˜é‡é‡‡ç”¨å¼•ç”¨æ–¹å¼æ•è·ï¼Œè€Œä»»ä½•éšå¼æ•è·çš„å˜é‡éƒ½é‡‡ç”¨å€¼æ–¹å¼æ•è·ã€‚<code>identifier_list</code>ä¸­çš„åå­—ä¸èƒ½åŒ…æ‹¬<code>this</code>ï¼Œä¸”å‰é¢å¿…é¡»ä½¿ç”¨<code>&amp;</code></td></tr></tbody></table><h3 id="å‚æ•°ç»‘å®š"><a href="#å‚æ•°ç»‘å®š" class="headerlink" title="å‚æ•°ç»‘å®š"></a>å‚æ•°ç»‘å®š</h3><ul><li><code>lambda</code>è¡¨è¾¾å¼æ›´é€‚åˆåœ¨ä¸€ä¸¤ä¸ªåœ°æ–¹ä½¿ç”¨çš„ç®€å•æ“ä½œã€‚</li><li>å¦‚æœæ˜¯å¾ˆå¤šåœ°æ–¹ä½¿ç”¨ç›¸åŒçš„æ“ä½œï¼Œè¿˜æ˜¯éœ€è¦å®šä¹‰å‡½æ•°ã€‚</li><li>å‡½æ•°å¦‚ä½•åŒ…è£…æˆä¸€å…ƒè°“è¯ï¼Ÿä½¿ç”¨å‚æ•°ç»‘å®šã€‚</li><li>æ ‡å‡†åº“<code>bind</code>å‡½æ•°ï¼š<ul><li>å®šä¹‰åœ¨å¤´æ–‡ä»¶<code>functional</code>ä¸­ï¼Œå¯ä»¥çœ‹åšä¸ºä¸€ä¸ªé€šç”¨çš„å‡½æ•°é€‚é…å™¨ã€‚</li><li><code>auto newCallable = bind(callable, arg_list);</code></li><li>æˆ‘ä»¬å†è°ƒç”¨<code>newCallable</code>çš„æ—¶å€™ï¼Œ<code>newCallable</code>ä¼šè°ƒç”¨<code>callable</code>å¹¶ä¼ é€’ç»™å®ƒ<code>arg_list</code>ä¸­çš„å‚æ•°ã€‚</li><li><code>_n</code>ä»£è¡¨ç¬¬nä¸ªä½ç½®çš„å‚æ•°ã€‚å®šä¹‰åœ¨<code>placeholders</code>çš„å‘½åç©ºé—´ä¸­ã€‚<code>using std::placeholder::_1;</code></li><li><code>auto g = bind(f, a, b, _2, c, _1);</code>ï¼Œè°ƒç”¨<code>g(_1, _2)</code>å®é™…ä¸Šè°ƒç”¨<code>f(a, b, _2, c, _1)</code></li><li>éå ä½ç¬¦çš„å‚æ•°è¦ä½¿ç”¨å¼•ç”¨ä¼ å‚ï¼Œå¿…é¡»ä½¿ç”¨æ ‡å‡†åº“<code>ref</code>å‡½æ•°æˆ–è€…<code>cref</code>å‡½æ•°ã€‚</li></ul></li></ul><h2 id="å†æ¢è¿­ä»£å™¨"><a href="#å†æ¢è¿­ä»£å™¨" class="headerlink" title="å†æ¢è¿­ä»£å™¨"></a>å†æ¢è¿­ä»£å™¨</h2><h3 id="æ’å…¥è¿­ä»£å™¨"><a href="#æ’å…¥è¿­ä»£å™¨" class="headerlink" title="æ’å…¥è¿­ä»£å™¨"></a>æ’å…¥è¿­ä»£å™¨</h3><ul><li>æ’å…¥å™¨æ˜¯ä¸€ç§è¿­ä»£å™¨é€‚é…å™¨ï¼Œæ¥å—ä¸€ä¸ªå®¹å™¨ï¼Œç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨ï¼Œèƒ½å®ç°å‘ç»™å®šå®¹å™¨æ·»åŠ å…ƒç´ ã€‚</li><li>ä¸‰ç§ç±»å‹ï¼š<ul><li><code>back_inserter</code>ï¼šåˆ›å»ºä¸€ä¸ªä½¿ç”¨<code>push_back</code>çš„è¿­ä»£å™¨ã€‚</li><li><code>front_inserter</code>åˆ›å»ºä¸€ä¸ªä½¿ç”¨<code>push_front</code>çš„è¿­ä»£å™¨ã€‚</li><li><code>inserter</code>åˆ›å»ºä¸€ä¸ªä½¿ç”¨<code>insert</code>çš„è¿­ä»£å™¨ã€‚æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ä¸€ä¸ªæŒ‡å‘ç»™å®šå®¹å™¨çš„è¿­ä»£å™¨ï¼Œå…ƒç´ ä¼šè¢«æŸ¥åˆ°è¿­ä»£å™¨æ‰€æŒ‡å‘çš„å…ƒç´ ä¹‹å‰ã€‚</li></ul></li></ul><p><strong>æ’å…¥è¿­ä»£å™¨æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>it=t</code></td><td>åœ¨<code>it</code>æŒ‡å®šçš„å½“å‰ä½ç½®æ’å…¥å€¼<code>t</code>ã€‚å‡å®š<code>c</code>æ˜¯<code>it</code>ç»‘å®šçš„å®¹å™¨ï¼Œä¾èµ–äºæ’å…¥è¿­ä»£å™¨çš„ä¸åŒç§ç±»ï¼Œæ­¤èµ‹å€¼ä¼šåˆ†åˆ«è°ƒç”¨<code>c.push_back(t)</code>ã€<code>c.push_front(t)</code>ã€<code>c.insert(t, p)</code>ï¼Œå…¶ä¸­<code>p</code>æ˜¯ä¼ é€’ç»™<code>inserter</code>çš„è¿­ä»£å™¨ä½ç½®</td></tr><tr><td><code>*it, ++it, it++</code></td><td>è¿™äº›æ“ä½œè™½ç„¶å­˜åœ¨ï¼Œä½†ä¸ä¼šå¯¹<code>it</code>åšä»»ä½•äº‹æƒ…ï¼Œæ¯ä¸ªæ“ä½œéƒ½è¿”å›<code>it</code></td></tr></tbody></table><h3 id="iostreamè¿­ä»£å™¨"><a href="#iostreamè¿­ä»£å™¨" class="headerlink" title="iostreamè¿­ä»£å™¨"></a>iostreamè¿­ä»£å™¨</h3><ul><li>è¿­ä»£å™¨å¯ä¸è¾“å…¥æˆ–è¾“å‡ºæµç»‘å®šåœ¨ä¸€èµ·ï¼Œç”¨äºè¿­ä»£éå†æ‰€å…³è”çš„ IO æµã€‚</li><li>é€šè¿‡ä½¿ç”¨æµè¿­ä»£å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ³›å‹ç®—æ³•ä»æµå¯¹è±¡ä¸­è¯»å–æ•°æ®ä»¥åŠå‘å…¶å†™å…¥æ•°æ®ã€‚</li></ul><p><strong>istream_iteratorçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>istream_iterator&lt;T&gt; in(is);</code></td><td><code>in</code>ä»è¾“å…¥æµ<code>is</code>è¯»å–ç±»å‹ä¸º<code>T</code>çš„å€¼</td></tr><tr><td><code>istream_iterator&lt;T&gt; end;</code></td><td>è¯»å–ç±»å‹æ˜¯<code>T</code>çš„å€¼çš„<code>istream_iterator</code>è¿­ä»£å™¨ï¼Œè¡¨ç¤ºå°¾åä½ç½®</td></tr><tr><td><code>in1 == in2</code></td><td><code>in1</code>å’Œ<code>in2</code>å¿…é¡»è¯»å–ç›¸åŒç±»å‹ã€‚å¦‚æœä»–ä»¬éƒ½æ˜¯å°¾åè¿­ä»£å™¨ï¼Œæˆ–ç»‘å®šåˆ°ç›¸åŒçš„è¾“å…¥ï¼Œåˆ™ä¸¤è€…ç›¸ç­‰ã€‚</td></tr><tr><td><code>in1 != in2</code></td><td>ç±»ä¼¼ä¸Šæ¡</td></tr><tr><td><code>*in</code></td><td>è¿”å›ä»æµä¸­è¯»å–çš„å€¼</td></tr><tr><td><code>in-&gt;mem</code></td><td>ä¸<code>*(in).mem</code>å«ä¹‰ç›¸åŒ</td></tr><tr><td><code>++in, in++</code></td><td>ä½¿ç”¨å…ƒç´ ç±»å‹æ‰€å®šä¹‰çš„<code>&gt;&gt;</code>è¿ç®—ç¬¦ä»æµä¸­è¯»å–ä¸‹ä¸€ä¸ªå€¼ã€‚å‰ç½®ç‰ˆæœ¬è¿”å›ä¸€ä¸ªæŒ‡å‘é€’å¢åè¿­ä»£å™¨çš„å¼•ç”¨ï¼Œåç½®ç‰ˆæœ¬è¿”å›æ—§å€¼ã€‚</td></tr></tbody></table><p><strong>ostream_iteratorçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>ostream_iterator&lt;T&gt; out(os);</code></td><td><code>out</code>å°†ç±»å‹ä¸º<code>T</code>çš„å€¼å†™åˆ°è¾“å‡ºæµ<code>os</code>ä¸­</td></tr><tr><td><code>ostream_iterator&lt;T&gt; out(os, d);</code></td><td><code>out</code>å°†ç±»å‹ä¸º<code>T</code>çš„å€¼å†™åˆ°è¾“å‡ºæµ<code>os</code>ä¸­ï¼Œæ¯ä¸ªå€¼åé¢éƒ½è¾“å‡ºä¸€ä¸ª<code>d</code>ã€‚<code>d</code>æŒ‡å‘ä¸€ä¸ªç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„ã€‚</td></tr><tr><td><code>out = val</code></td><td>ç”¨<code>&lt;&lt;</code>è¿ç®—ç¬¦å°†<code>val</code>å†™å…¥åˆ°<code>out</code>æ‰€ç»‘å®šçš„<code>ostream</code>ä¸­ã€‚<code>val</code>çš„ç±»å‹å¿…é¡»å’Œ<code>out</code>å¯å†™çš„ç±»å‹å…¼å®¹ã€‚</td></tr><tr><td><code>*out, ++out, out++</code></td><td>è¿™äº›è¿ç®—ç¬¦æ˜¯å­˜åœ¨çš„ï¼Œä½†ä¸å¯¹<code>out</code>åšä»»ä½•äº‹æƒ…ã€‚æ¯ä¸ªè¿ç®—ç¬¦éƒ½è¿”å›<code>out</code>ã€‚</td></tr></tbody></table><h3 id="åå‘è¿­ä»£å™¨"><a href="#åå‘è¿­ä»£å™¨" class="headerlink" title="åå‘è¿­ä»£å™¨"></a>åå‘è¿­ä»£å™¨</h3><ul><li>åå‘è¿­ä»£å™¨å°±æ˜¯åœ¨å®¹å™¨ä¸­ä»å°¾å…ƒç´ å‘é¦–å…ƒç´ åå‘ç§»åŠ¨çš„è¿­ä»£å™¨ã€‚</li><li>å¯¹äºåå‘è¿­ä»£å™¨ï¼Œé€’å¢å’Œé€’å‡çš„æ“ä½œå«ä¹‰ä¼šé¢ å€’ã€‚</li><li>å®ç°å‘åéå†ï¼Œé…åˆ<code>rbegin</code>å’Œ<code>rend</code>ã€‚</li></ul><h2 id="æ³›å‹ç®—æ³•ç»“æ„"><a href="#æ³›å‹ç®—æ³•ç»“æ„" class="headerlink" title="æ³›å‹ç®—æ³•ç»“æ„"></a>æ³›å‹ç®—æ³•ç»“æ„</h2><h3 id="5ç±»è¿­ä»£å™¨"><a href="#5ç±»è¿­ä»£å™¨" class="headerlink" title="5ç±»è¿­ä»£å™¨"></a>5ç±»è¿­ä»£å™¨</h3><table><thead><tr><th>è¿­ä»£å™¨ç±»åˆ«</th><th>è§£é‡Š</th><th>æ”¯æŒçš„æ“ä½œ</th></tr></thead><tbody><tr><td>è¾“å…¥è¿­ä»£å™¨</td><td>åªè¯»ï¼Œä¸å†™ï¼›å•éæ‰«æï¼Œåªèƒ½é€’å¢</td><td><code>==</code>,<code>!=</code>,<code>++</code>,<code>*</code>,<code>-&gt;</code></td></tr><tr><td>è¾“å‡ºè¿­ä»£å™¨</td><td>åªå†™ï¼Œä¸è¯»ï¼›å•éæ‰«æï¼Œåªèƒ½é€’å¢</td><td><code>++</code>,<code>*</code></td></tr><tr><td>å‰å‘è¿­ä»£å™¨</td><td>å¯è¯»å†™ï¼›å¤šéæ‰«æï¼Œåªèƒ½é€’å¢</td><td><code>==</code>,<code>!=</code>,<code>++</code>,<code>*</code>,<code>-&gt;</code></td></tr><tr><td>åŒå‘è¿­ä»£å™¨</td><td>å¯è¯»å†™ï¼›å¤šéæ‰«æï¼Œå¯é€’å¢é€’å‡</td><td><code>==</code>,<code>!=</code>,<code>++</code>,<code>--</code>,<code>*</code>,<code>-&gt;</code></td></tr><tr><td>éšæœºè®¿é—®è¿­ä»£å™¨</td><td>å¯è¯»å†™ï¼Œå¤šéæ‰«æï¼Œæ”¯æŒå…¨éƒ¨è¿­ä»£å™¨è¿ç®—</td><td><code>==</code>,<code>!=</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;</code>,<code>&gt;=</code>,<code>++</code>,<code>--</code>,<code>+</code>,<code>+=</code>,<code>-</code>,<code>-=</code>,<code>*</code>,<code>-&gt;</code>,<code>iter[n]</code>==<code>*(iter[n])</code></td></tr></tbody></table><h3 id="ç®—æ³•çš„å½¢å‚æ¨¡å¼"><a href="#ç®—æ³•çš„å½¢å‚æ¨¡å¼" class="headerlink" title="ç®—æ³•çš„å½¢å‚æ¨¡å¼"></a>ç®—æ³•çš„å½¢å‚æ¨¡å¼</h3><ul><li><code>alg(beg, end, other args);</code></li><li><code>alg(beg, end, dest, other args);</code></li><li><code>alg(beg, end, beg2, other args);</code></li><li><code>alg(beg, end, beg2, end2, other args);</code></li></ul><p>å…¶ä¸­ï¼Œ<code>alg</code>æ˜¯ç®—æ³•åç§°ï¼Œ<code>beg</code>å’Œ<code>end</code>è¡¨ç¤ºç®—æ³•æ‰€æ“ä½œçš„è¾“å…¥èŒƒå›´ã€‚<code>dest</code>ã€<code>beg2</code>ã€<code>end2</code>éƒ½æ˜¯è¿­ä»£å™¨å‚æ•°ï¼Œæ˜¯å¦ä½¿ç”¨è¦ä¾èµ–äºæ‰§è¡Œçš„æ“ä½œã€‚</p><h3 id="ç®—æ³•å‘½åè§„èŒƒ"><a href="#ç®—æ³•å‘½åè§„èŒƒ" class="headerlink" title="ç®—æ³•å‘½åè§„èŒƒ"></a>ç®—æ³•å‘½åè§„èŒƒ</h3><ul><li>ä¸€äº›ç®—æ³•ä½¿ç”¨é‡è½½å½¢å¼ä¼ é€’ä¸€ä¸ªè°“è¯ã€‚</li><li>æ¥å—ä¸€ä¸ªå…ƒç´ å€¼çš„ç®—æ³•é€šå¸¸æœ‰ä¸€ä¸ª<strong>ä¸åŒå</strong>çš„ç‰ˆæœ¬ï¼šåŠ <code>_if</code>ï¼Œæ¥å—ä¸€ä¸ªè°“è¯ä»£æ›¿å…ƒç´ å€¼ã€‚</li><li>åŒºåˆ†æ‹·è´å…ƒç´ çš„ç‰ˆæœ¬å’Œä¸æ‹·è´çš„ç‰ˆæœ¬ï¼šæ‹·è´ç‰ˆæœ¬é€šå¸¸åŠ <code>_copy</code>ã€‚</li></ul><h2 id="ç‰¹å®šå®¹å™¨ç®—æ³•"><a href="#ç‰¹å®šå®¹å™¨ç®—æ³•" class="headerlink" title="ç‰¹å®šå®¹å™¨ç®—æ³•"></a>ç‰¹å®šå®¹å™¨ç®—æ³•</h2><ul><li>å¯¹äº<code>list</code>å’Œ<code>forward_list</code>ï¼Œä¼˜å…ˆä½¿ç”¨æˆå‘˜å‡½æ•°ç‰ˆæœ¬çš„ç®—æ³•è€Œä¸æ˜¯é€šç”¨ç®—æ³•ã€‚</li></ul><p><strong>listå’Œforward_listæˆå‘˜å‡½æ•°ç‰ˆæœ¬çš„ç®—æ³•</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>lst.merge(lst2)</code></td><td>å°†æ¥è‡ª<code>lst2</code>çš„å…ƒç´ åˆå¹¶å…¥<code>lst</code>ï¼ŒäºŒè€…éƒ½å¿…é¡»æ˜¯æœ‰åºçš„ï¼Œå…ƒç´ å°†ä»<code>lst2</code>ä¸­åˆ é™¤ã€‚</td></tr><tr><td><code>lst.merge(lst2, comp)</code></td><td>åŒä¸Šï¼Œç»™å®šæ¯”è¾ƒæ“ä½œã€‚</td></tr><tr><td><code>lst.remove(val)</code></td><td>è°ƒç”¨<code>erase</code>åˆ é™¤æ‰ä¸ç»™å®šå€¼ç›¸ç­‰(==)çš„æ¯ä¸ªå…ƒç´ </td></tr><tr><td><code>lst.remove_if(pred)</code></td><td>è°ƒç”¨<code>erase</code>åˆ é™¤æ‰ä»¤ä¸€å…ƒè°“è¯ä¸ºçœŸçš„æ¯ä¸ªå…ƒç´ </td></tr><tr><td><code>lst.reverse()</code></td><td>åè½¬<code>lst</code>ä¸­å…ƒç´ çš„é¡ºåº</td></tr><tr><td><code>lst.sort()</code></td><td>ä½¿ç”¨<code>&lt;</code>æ’åºå…ƒç´ </td></tr><tr><td><code>lst.sort(comp)</code></td><td>ä½¿ç”¨ç»™å®šæ¯”è¾ƒæ“ä½œæ’åºå…ƒç´ </td></tr><tr><td><code>lst.unique()</code></td><td>è°ƒç”¨<code>erase</code>åˆ é™¤åŒä¸€ä¸ªå€¼çš„è¿ç»­æ‹·è´ã€‚ä½¿ç”¨<code>==</code>ã€‚</td></tr><tr><td><code>lst.unique(pred)</code></td><td>è°ƒç”¨<code>erase</code>åˆ é™¤åŒä¸€ä¸ªå€¼çš„è¿ç»­æ‹·è´ã€‚ä½¿ç”¨ç»™å®šçš„äºŒå…ƒè°“è¯ã€‚</td></tr></tbody></table><ul><li>ä¸Šé¢çš„æ“ä½œéƒ½è¿”å›<code>void</code></li></ul><p><strong>listå’Œforward_listçš„spliceæˆå‘˜å‡½æ•°ç‰ˆæœ¬çš„å‚æ•°</strong>ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>(p, lst2)</code></td><td><code>p</code>æ˜¯ä¸€ä¸ªæŒ‡å‘<code>lst</code>ä¸­å…ƒç´ çš„è¿­ä»£å™¨ï¼Œæˆ–è€…ä¸€ä¸ªæŒ‡å‘<code>flst</code>é¦–å‰ä½ç½®çš„è¿­ä»£å™¨ã€‚å‡½æ•°å°†<code>lst2</code>ä¸­çš„æ‰€æœ‰å…ƒç´ ç§»åŠ¨åˆ°<code>lst</code>ä¸­<code>p</code>ä¹‹å‰çš„ä½ç½®æˆ–æ˜¯<code>flst</code>ä¸­<code>p</code>ä¹‹åçš„ä½ç½®ã€‚å°†å…ƒç´ ä»<code>lst2</code>ä¸­åˆ é™¤ã€‚<code>lst2</code>çš„ç±»å‹å¿…é¡»å’Œ<code>lst</code>ç›¸åŒï¼Œè€Œä¸”ä¸èƒ½æ˜¯åŒä¸€ä¸ªé“¾è¡¨ã€‚</td></tr><tr><td><code>(p, lst2, p2)</code></td><td>åŒä¸Šï¼Œ<code>p2</code>æ˜¯ä¸€ä¸ªæŒ‡å‘<code>lst2</code>ä¸­ä½ç½®çš„æœ‰æ•ˆçš„è¿­ä»£å™¨ï¼Œå°†<code>p2</code>æŒ‡å‘çš„å…ƒç´ ç§»åŠ¨åˆ°<code>lst</code>ä¸­ï¼Œæˆ–å°†<code>p2</code>ä¹‹åçš„å…ƒç´ ç§»åŠ¨åˆ°<code>flst</code>ä¸­ã€‚<code>lst2</code>å¯ä»¥æ˜¯äº<code>lst</code>æˆ–<code>flst</code>ç›¸åŒçš„é“¾è¡¨ã€‚</td></tr><tr><td><code>(p, lst2, b, e)</code></td><td><code>b</code>å’Œ<code>e</code>è¡¨ç¤º<code>lst2</code>ä¸­çš„åˆæ³•èŒƒå›´ã€‚å°†ç»™å®šèŒƒå›´ä¸­çš„å…ƒç´ ä»<code>lst2</code>ç§»åŠ¨åˆ°<code>lst</code>æˆ–<code>first</code>ä¸­ã€‚<code>lst2</code>ä¸<code>lst</code>å¯ä»¥ä½¿ç›¸åŒçš„é“¾è¡¨ï¼Œä½†<code>p</code>ä¸èƒ½æŒ‡å‘ç»™å®šèŒƒå›´ä¸­çš„å…ƒç´ ã€‚</td></tr></tbody></table><ul><li>ä½¿ç”¨<code>lst.splice(args)</code>æˆ–<code>flst.splice_after(args)</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°15</title>
      <link href="2021/04/10/notes/ch15/"/>
      <url>2021/04/10/notes/ch15/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åäº”ç« -é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡"><a href="#ç¬¬åäº”ç« -é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡" class="headerlink" title="ç¬¬åäº”ç«  é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡"></a>ç¬¬åäº”ç«  é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡</h1><h2 id="OOPï¼šæ¦‚è¿°"><a href="#OOPï¼šæ¦‚è¿°" class="headerlink" title="OOPï¼šæ¦‚è¿°"></a>OOPï¼šæ¦‚è¿°</h2><ul><li>é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆobject-oriented programmingï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ•°æ®æŠ½è±¡ã€ç»§æ‰¿å’ŒåŠ¨æ€ç»‘å®šã€‚</li><li><strong>ç»§æ‰¿</strong>ï¼ˆinheritanceï¼‰ï¼š<ul><li>é€šè¿‡ç»§æ‰¿è”ç³»åœ¨ä¸€èµ·çš„ç±»æ„æˆä¸€ç§å±‚æ¬¡å…³ç³»ã€‚</li><li>é€šå¸¸åœ¨å±‚æ¬¡å…³ç³»çš„æ ¹éƒ¨æœ‰ä¸€ä¸ª<strong>åŸºç±»</strong>ï¼ˆbase classï¼‰ã€‚</li><li>å…¶ä»–ç±»ç›´æ¥æˆ–è€…ç®€ä»‹ä»åŸºç±»ç»§æ‰¿è€Œæ¥ï¼Œè¿™äº›ç»§æ‰¿å¾—åˆ°çš„ç±»æˆä¸º<strong>æ´¾ç”Ÿç±»</strong>ï¼ˆderived classï¼‰ã€‚</li><li>åŸºç±»è´Ÿè´£å®šä¹‰åœ¨å±‚æ¬¡å…³ç³»ä¸­æ‰€æœ‰ç±»å…±åŒæ‹¥æœ‰çš„æˆå‘˜ï¼Œè€Œæ¯ä¸ªæ´¾ç”Ÿç±»å®šä¹‰å„è‡ªç‰¹æœ‰çš„æˆå‘˜ã€‚</li><li>å¯¹äºæŸäº›å‡½æ•°ï¼ŒåŸºç±»å¸Œæœ›å®ƒçš„æ´¾ç”Ÿç±»ä¸ªè‡ªå®šä¹‰é€‚åˆè‡ªå·±çš„ç‰ˆæœ¬ï¼Œæ­¤æ—¶åŸºç±»å°±å°†è¿™äº›å‡½æ•°å£°æ˜æˆ<strong>è™šå‡½æ•°</strong>ï¼ˆvirtual functionï¼‰ã€‚</li><li>æ´¾ç”Ÿç±»å¿…é¡»é€šè¿‡ä½¿ç”¨<strong>ç±»æ´¾ç”Ÿåˆ—è¡¨</strong>ï¼ˆclass derivation listï¼‰æ˜ç¡®æŒ‡å‡ºå®ƒæ˜¯ä»å“ªä¸ªåŸºç±»ç»§æ‰¿è€Œæ¥ã€‚å½¢å¼ï¼šä¸€ä¸ªå†’å·ï¼Œåé¢ç´§è·Ÿä»¥é€—å·åˆ†éš”çš„åŸºç±»åˆ—è¡¨ï¼Œæ¯ä¸ªåŸºç±»å‰éƒ½å¯ä»¥æœ‰è®¿é—®è¯´æ˜ç¬¦ã€‚<code>class Bulk_quote : public Quote&#123;&#125;;</code></li><li>æ´¾ç”Ÿç±»å¿…é¡»åœ¨å…¶å†…éƒ¨å¯¹æ‰€æœ‰é‡æ–°å®šä¹‰çš„è™šå‡½æ•°è¿›è¡Œå£°æ˜ã€‚å¯ä»¥åœ¨å‡½æ•°ä¹‹å‰åŠ ä¸Š<code>virtual</code>å…³é”®å­—ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ã€‚C++11æ–°æ ‡å‡†å…è®¸æ´¾ç”Ÿç±»æ˜¾å¼åœ°æ³¨æ˜å®ƒå°†ä½¿ç”¨å“ªä¸ªæˆå‘˜å‡½æ•°æ”¹å†™åŸºç±»çš„è™šå‡½æ•°ï¼Œå³åœ¨å‡½æ•°çš„å½¢å‚åˆ—è¡¨ä¹‹ååŠ ä¸€ä¸ª<code>override</code>å…³é”®å­—ã€‚</li></ul></li><li><strong>åŠ¨æ€ç»‘å®š</strong>ï¼ˆdynamic bindingï¼Œåˆç§°è¿è¡Œæ—¶ç»‘å®šï¼‰ï¼š<ul><li>ä½¿ç”¨åŒä¸€æ®µä»£ç å¯ä»¥åˆ†åˆ«å¤„ç†åŸºç±»å’Œæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</li><li>å‡½æ•°çš„è¿è¡Œç‰ˆæœ¬ç”±å®å‚å†³å®šï¼Œå³åœ¨è¿è¡Œæ—¶é€‰æ‹©å‡½æ•°çš„ç‰ˆæœ¬ã€‚</li></ul></li></ul><h2 id="å®šä¹‰åŸºç±»å’Œæ´¾ç”Ÿç±»"><a href="#å®šä¹‰åŸºç±»å’Œæ´¾ç”Ÿç±»" class="headerlink" title="å®šä¹‰åŸºç±»å’Œæ´¾ç”Ÿç±»"></a>å®šä¹‰åŸºç±»å’Œæ´¾ç”Ÿç±»</h2><h3 id="å®šä¹‰åŸºç±»"><a href="#å®šä¹‰åŸºç±»" class="headerlink" title="å®šä¹‰åŸºç±»"></a>å®šä¹‰åŸºç±»</h3><ul><li>åŸºç±»é€šå¸¸éƒ½åº”è¯¥å®šä¹‰ä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œå³ä½¿è¯¥å‡½æ•°ä¸æ‰§è¡Œä»»ä½•å®é™…æ“ä½œä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li><li>åŸºç±»é€šè¿‡åœ¨å…¶æˆå‘˜å‡½æ•°çš„å£°æ˜è¯­å¥å‰åŠ ä¸Šå…³é”®å­—<code>virtual</code>ä½¿å¾—è¯¥å‡½æ•°æ‰§è¡Œ<strong>åŠ¨æ€ç»‘å®š</strong>ã€‚</li><li>å¦‚æœæˆå‘˜å‡½æ•°æ²¡æœ‰è¢«å£°æ˜ä¸ºè™šå‡½æ•°ï¼Œåˆ™è§£æè¿‡ç¨‹å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶è€Œéè¿è¡Œæ—¶ã€‚</li><li>è®¿é—®æ§åˆ¶ï¼š<ul><li><code>protected</code> ï¼š åŸºç±»å’Œå’Œå…¶æ´¾ç”Ÿç±»è¿˜æœ‰å‹å…ƒå¯ä»¥è®¿é—®ã€‚</li><li><code>private</code> ï¼š åªæœ‰åŸºç±»æœ¬èº«å’Œå‹å…ƒå¯ä»¥è®¿é—®ã€‚</li></ul></li></ul><h3 id="å®šä¹‰æ´¾ç”Ÿç±»"><a href="#å®šä¹‰æ´¾ç”Ÿç±»" class="headerlink" title="å®šä¹‰æ´¾ç”Ÿç±»"></a>å®šä¹‰æ´¾ç”Ÿç±»</h3><ul><li>æ´¾ç”Ÿç±»å¿…é¡»é€šè¿‡ç±»æ´¾ç”Ÿåˆ—è¡¨ï¼ˆclass derivation listï¼‰æ˜ç¡®æŒ‡å‡ºå®ƒæ˜¯ä»å“ªä¸ªåŸºç±»ç»§æ‰¿è€Œæ¥ã€‚å½¢å¼ï¼šå†’å·ï¼Œåé¢ç´§è·Ÿä»¥é€—å·åˆ†éš”çš„åŸºç±»åˆ—è¡¨ï¼Œæ¯ä¸ªåŸºç±»å‰é¢å¯ä»¥æœ‰ä¸€ä¸‹ä¸‰ç§è®¿é—®è¯´æ˜ç¬¦çš„ä¸€ä¸ªï¼š<code>public</code>ã€<code>protected</code>ã€<code>private</code>ã€‚</li><li>C++11æ–°æ ‡å‡†å…è®¸æ´¾ç”Ÿç±»æ˜¾å¼åœ°æ³¨æ˜å®ƒå°†ä½¿ç”¨å“ªä¸ªæˆå‘˜å‡½æ•°æ”¹å†™åŸºç±»çš„è™šå‡½æ•°ï¼Œå³åœ¨å‡½æ•°çš„å½¢å‚åˆ—è¡¨ä¹‹ååŠ ä¸€ä¸ª<code>override</code>å…³é”®å­—ã€‚</li><li>æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ï¼šæ´¾ç”Ÿç±»å¿…é¡»ä½¿ç”¨åŸºç±»çš„æ„é€ å‡½æ•°å»åˆå§‹åŒ–å®ƒçš„åŸºç±»éƒ¨åˆ†ã€‚</li><li>é™æ€æˆå‘˜ï¼šå¦‚æœåŸºç±»å®šä¹‰äº†ä¸€ä¸ªåŸºç±»æˆå‘˜ï¼Œåˆ™åœ¨æ•´ä¸ªç»§æ‰¿ä½“ç³»ä¸­åªå­˜åœ¨è¯¥æˆå‘˜çš„å”¯ä¸€å®šä¹‰ã€‚</li><li>æ´¾ç”Ÿç±»çš„å£°æ˜ï¼šå£°æ˜ä¸­ä¸åŒ…å«å®ƒçš„æ´¾ç”Ÿåˆ—è¡¨ã€‚</li><li>C++11æ–°æ ‡å‡†æä¾›äº†ä¸€ç§é˜²æ­¢ç»§æ‰¿çš„æ–¹æ³•ï¼Œåœ¨ç±»ååé¢è·Ÿä¸€ä¸ªå…³é”®å­—<code>final</code>ã€‚</li></ul><h3 id="ç±»å‹è½¬æ¢ä¸ç»§æ‰¿"><a href="#ç±»å‹è½¬æ¢ä¸ç»§æ‰¿" class="headerlink" title="ç±»å‹è½¬æ¢ä¸ç»§æ‰¿"></a>ç±»å‹è½¬æ¢ä¸ç»§æ‰¿</h3><ul><li>ç†è§£åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´çš„ç±»å‹æŠ“æ¢æ˜¯ç†è§£C++è¯­è¨€é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å…³é”®æ‰€åœ¨ã€‚</li><li>å¯ä»¥å°†åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ç»‘å®šåˆ°æ´¾ç”Ÿç±»å¯¹è±¡ä¸Šã€‚</li><li>ä¸å­˜åœ¨ä»åŸºç±»å‘æ´¾ç”Ÿç±»çš„éšå¼ç±»å‹è½¬æ¢ã€‚</li><li>æ´¾ç”Ÿç±»å‘åŸºç±»çš„è‡ªåŠ¨ç±»å‹è½¬æ¢åªå¯¹æŒ‡é’ˆæˆ–å¼•ç”¨ç±»å‹æœ‰æ•ˆï¼Œå¯¹è±¡ä¹‹é—´ä¸å­˜åœ¨ç±»å‹è½¬æ¢ã€‚</li></ul><h2 id="è™šå‡½æ•°"><a href="#è™šå‡½æ•°" class="headerlink" title="è™šå‡½æ•°"></a>è™šå‡½æ•°</h2><ul><li>ä½¿ç”¨è™šå‡½æ•°å¯ä»¥æ‰§è¡ŒåŠ¨æ€ç»‘å®šã€‚</li><li>OOPçš„æ ¸å¿ƒæ€æƒ³æ˜¯å¤šæ€æ€§ï¼ˆpolymorphismï¼‰ã€‚</li><li>å½“ä¸”ä»…å½“å¯¹é€šè¿‡æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œæ‰ä¼šåœ¨è¿è¡Œæ—¶è§£æè¯¥è°ƒç”¨ï¼Œä¹Ÿåªæœ‰åœ¨è¿™ç§æƒ…å†µä¸‹å¯¹è±¡çš„åŠ¨æ€ç±»å‹æ‰æœ‰å¯èƒ½ä¸é™æ€ç±»å‹ä¸åŒã€‚</li><li>æ´¾ç”Ÿç±»å¿…é¡»åœ¨å…¶å†…éƒ¨å¯¹æ‰€æœ‰é‡æ–°å®šä¹‰çš„è™šå‡½æ•°è¿›è¡Œå£°æ˜ã€‚å¯ä»¥åœ¨å‡½æ•°ä¹‹å‰åŠ ä¸Š<code>virtual</code>å…³é”®å­—ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ã€‚</li><li>C++11æ–°æ ‡å‡†å…è®¸æ´¾ç”Ÿç±»æ˜¾å¼åœ°æ³¨æ˜å®ƒå°†ä½¿ç”¨å“ªä¸ªæˆå‘˜å‡½æ•°æ”¹å†™åŸºç±»çš„è™šå‡½æ•°ï¼Œå³åœ¨å‡½æ•°çš„å½¢å‚åˆ—è¡¨ä¹‹ååŠ ä¸€ä¸ª<code>override</code>å…³é”®å­—ã€‚</li><li>å¦‚æœæˆ‘ä»¬æƒ³è¦†ç›–æŸä¸ªè™šå‡½æ•°ï¼Œä½†ä¸å°å¿ƒæŠŠå½¢å‚åˆ—è¡¨å¼„é”™äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸ä¼šè¦†ç›–åŸºç±»ä¸­çš„è™šå‡½æ•°ã€‚åŠ ä¸Š<code>override</code>å¯ä»¥æ˜ç¡®ç¨‹åºå‘˜çš„æ„å›¾ï¼Œè®©ç¼–è¯‘å™¨å¸®å¿™ç¡®è®¤å‚æ•°åˆ—è¡¨æ˜¯å¦å‡ºé”™ã€‚</li><li>å¦‚æœè™šå‡½æ•°ä½¿ç”¨é»˜è®¤å®å‚ï¼Œåˆ™åŸºç±»å’Œæ´¾ç”Ÿç±»ä¸­å®šä¹‰çš„é»˜è®¤å®å‚æœ€å¥½ä¸€è‡´ã€‚</li><li>é€šå¸¸ï¼Œåªæœ‰æˆå‘˜å‡½æ•°ï¼ˆæˆ–å‹å…ƒï¼‰ä¸­çš„ä»£ç æ‰éœ€è¦ä½¿ç”¨<strong>ä½œç”¨åŸŸè¿ç®—ç¬¦</strong>ï¼ˆ<code>::</code>ï¼‰æ¥å›é¿è™šå‡½æ•°çš„æœºåˆ¶ã€‚</li></ul><h2 id="æŠ½è±¡åŸºç±»"><a href="#æŠ½è±¡åŸºç±»" class="headerlink" title="æŠ½è±¡åŸºç±»"></a>æŠ½è±¡åŸºç±»</h2><ul><li><strong>çº¯è™šå‡½æ•°</strong>ï¼ˆpure virtualï¼‰ï¼šæ¸…æ™°åœ°å‘Šè¯‰ç”¨æˆ·å½“å‰çš„å‡½æ•°æ˜¯æ²¡æœ‰å®é™…æ„ä¹‰çš„ã€‚çº¯è™šå‡½æ•°æ— éœ€å®šä¹‰ï¼Œåªç”¨åœ¨å‡½æ•°ä½“çš„ä½ç½®å‰ä¹¦å†™<code>=0</code>å°±å¯ä»¥å°†ä¸€ä¸ªè™šå‡½æ•°è¯´æ˜ä¸ºçº¯è™šå‡½æ•°ã€‚</li><li>å«æœ‰çº¯è™šå‡½æ•°çš„ç±»æ˜¯<strong>æŠ½è±¡åŸºç±»</strong>ï¼ˆabstract base classï¼‰ã€‚ä¸èƒ½åˆ›å»ºæŠ½è±¡åŸºç±»çš„å¯¹è±¡ã€‚</li></ul><h2 id="è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿"><a href="#è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿" class="headerlink" title="è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿"></a>è®¿é—®æ§åˆ¶ä¸ç»§æ‰¿</h2><ul><li>å—ä¿æŠ¤çš„æˆå‘˜ï¼š<ul><li><code>protected</code>è¯´æ˜ç¬¦å¯ä»¥çœ‹åšæ˜¯<code>public</code>å’Œ<code>private</code>ä¸­çš„äº§ç‰©ã€‚</li><li>ç±»ä¼¼äºç§æœ‰æˆå‘˜ï¼Œå—ä¿æŠ¤çš„æˆå‘˜å¯¹ç±»çš„ç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è®¿é—®çš„ã€‚</li><li>ç±»ä¼¼äºå…¬æœ‰æˆå‘˜ï¼Œå—ä¿æŠ¤çš„æˆå‘˜å¯¹äºæ´¾ç”Ÿç±»çš„æˆå‘˜å’Œå‹å…ƒæ¥è¯´æ˜¯å¯è®¿é—®çš„ã€‚</li><li>æ´¾ç”Ÿç±»çš„æˆå‘˜æˆ–å‹å…ƒåªèƒ½é€šè¿‡æ´¾ç”Ÿç±»å¯¹è±¡æ¥è®¿é—®åŸºç±»çš„å—ä¿æŠ¤æˆå‘˜ã€‚æ´¾ç”Ÿç±»å¯¹äºä¸€ä¸ªåŸºç±»å¯¹è±¡ä¸­çš„å—ä¿æŠ¤æˆå‘˜æ²¡æœ‰ä»»ä½•è®¿é—®ç‰¹æƒã€‚</li></ul></li><li>æ´¾ç”Ÿè®¿é—®è¯´æ˜ç¬¦ï¼š<ul><li>å¯¹äºæ´¾ç”Ÿç±»çš„æˆå‘˜ï¼ˆåŠå‹å…ƒï¼‰èƒ½å¦è®¿é—®å…¶ç›´æ¥ç§¯ç´¯çš„æˆå‘˜æ²¡ä»€ä¹ˆå½±å“ã€‚</li><li>æ´¾ç”Ÿè®¿é—®è¯´æ˜ç¬¦çš„ç›®çš„æ˜¯ï¼šæ§åˆ¶æ´¾ç”Ÿç±»ç”¨æˆ·å¯¹äºåŸºç±»æˆå‘˜çš„è®¿é—®æƒé™ã€‚æ¯”å¦‚<code>struct Priv_Drev: private Base&#123;&#125;</code>æ„å‘³ç€åœ¨æ´¾ç”Ÿç±»<code>Priv_Drev</code>ä¸­ï¼Œä»<code>Base</code>ç»§æ‰¿è€Œæ¥çš„éƒ¨åˆ†éƒ½æ˜¯<code>private</code>çš„ã€‚</li></ul></li><li>å‹å…ƒå…³ç³»ä¸èƒ½ç»§æ‰¿ã€‚</li><li>æ”¹å˜ä¸ªåˆ«æˆå‘˜çš„å¯è®¿é—®æ€§ï¼šä½¿ç”¨<code>using</code>ã€‚</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>class</code>å…³é”®å­—å®šä¹‰çš„æ´¾ç”Ÿç±»æ˜¯ç§æœ‰ç»§æ‰¿çš„ï¼›ä½¿ç”¨<code>struct</code>å…³é”®å­—å®šä¹‰çš„æ´¾ç”Ÿç±»æ˜¯å…¬æœ‰ç»§æ‰¿çš„ã€‚</li></ul><h2 id="ç»§æ‰¿ä¸­çš„ç±»ä½œç”¨åŸŸ"><a href="#ç»§æ‰¿ä¸­çš„ç±»ä½œç”¨åŸŸ" class="headerlink" title="ç»§æ‰¿ä¸­çš„ç±»ä½œç”¨åŸŸ"></a>ç»§æ‰¿ä¸­çš„ç±»ä½œç”¨åŸŸ</h2><ul><li>æ¯ä¸ªç±»å®šä¹‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œåœ¨è¿™ä¸ªä½œç”¨åŸŸå†…æˆ‘ä»¬å®šä¹‰ç±»çš„æˆå‘˜ã€‚å½“å­˜åœ¨ç»§æ‰¿å…³ç³»æ—¶ï¼Œæ´¾ç”Ÿç±»çš„ä½œç”¨åŸŸåµŒå¥—åœ¨å…¶åŸºç±»çš„ä½œç”¨åŸŸä¹‹å†…ã€‚</li><li>æ´¾ç”Ÿç±»çš„æˆå‘˜å°†éšè—åŒåçš„åŸºç±»æˆå‘˜ã€‚</li><li>é™¤äº†è¦†ç›–ç»§æ‰¿è€Œæ¥çš„è™šå‡½æ•°ä¹‹å¤–ï¼Œæ´¾ç”Ÿç±»æœ€å¥½ä¸è¦é‡ç”¨å…¶ä»–å®šä¹‰åœ¨åŸºç±»ä¸­çš„åå­—ã€‚</li></ul><h2 id="æ„é€ å‡½æ•°ä¸æ‹·è´æ§åˆ¶"><a href="#æ„é€ å‡½æ•°ä¸æ‹·è´æ§åˆ¶" class="headerlink" title="æ„é€ å‡½æ•°ä¸æ‹·è´æ§åˆ¶"></a>æ„é€ å‡½æ•°ä¸æ‹·è´æ§åˆ¶</h2><h3 id="è™šææ„å‡½æ•°"><a href="#è™šææ„å‡½æ•°" class="headerlink" title="è™šææ„å‡½æ•°"></a>è™šææ„å‡½æ•°</h3><ul><li>åŸºç±»é€šå¸¸åº”è¯¥å®šä¹‰ä¸€ä¸ªè™šææ„å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åŠ¨æ€åˆ†é…ç»§æ‰¿ä½“ç³»ä¸­çš„å¯¹è±¡äº†ã€‚</li><li>å¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œåˆ™<code>delete</code>ä¸€ä¸ªæŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡çš„åŸºç±»æŒ‡é’ˆå°†äº§ç”Ÿæœªå®šä¹‰çš„è¡Œä¸ºã€‚</li><li>è™šææ„å‡½æ•°å°†é˜»æ­¢åˆæˆç§»åŠ¨æ“ä½œã€‚</li></ul><h3 id="åˆæˆæ‹·è´æ§åˆ¶ä¸ç»§æ‰¿"><a href="#åˆæˆæ‹·è´æ§åˆ¶ä¸ç»§æ‰¿" class="headerlink" title="åˆæˆæ‹·è´æ§åˆ¶ä¸ç»§æ‰¿"></a>åˆæˆæ‹·è´æ§åˆ¶ä¸ç»§æ‰¿</h3><ul><li>åŸºç±»æˆ–æ´¾ç”Ÿç±»çš„åˆæˆæ‹·è´æ§åˆ¶æˆå‘˜çš„è¡Œä¸ºå’Œå…¶ä»–åˆæˆçš„æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦æˆ–ææ„å‡½æ•°ç±»ä¼¼ï¼šä»–ä»¬å¯¹ç±»æœ¬èº«çš„æˆå‘˜ä¾æ¬¡è¿›è¡Œåˆå§‹åŒ–ã€èµ‹å€¼æˆ–é”€æ¯çš„æ“ä½œã€‚</li></ul><h3 id="æ´¾ç”Ÿç±»çš„æ‹·è´æ§åˆ¶æˆå‘˜"><a href="#æ´¾ç”Ÿç±»çš„æ‹·è´æ§åˆ¶æˆå‘˜" class="headerlink" title="æ´¾ç”Ÿç±»çš„æ‹·è´æ§åˆ¶æˆå‘˜"></a>æ´¾ç”Ÿç±»çš„æ‹·è´æ§åˆ¶æˆå‘˜</h3><ul><li>å½“æ´¾ç”Ÿç±»å®šä¹‰äº†æ‹·è´æˆ–ç§»åŠ¨æ“ä½œæ—¶ï¼Œè¯¥æ“ä½œè´Ÿè´£æ‹·è´æˆ–ç§»åŠ¨åŒ…æ‹¬åŸºç±»éƒ¨åˆ†æˆå‘˜åœ¨å†…çš„æ•´ä¸ªå¯¹è±¡ã€‚</li><li>æ´¾ç”Ÿç±»ææ„å‡½æ•°ï¼šæ´¾ç”Ÿç±»ææ„å‡½æ•°å…ˆæ‰§è¡Œï¼Œç„¶åæ‰§è¡ŒåŸºç±»çš„ææ„å‡½æ•°ã€‚</li></ul><h3 id="ç»§æ‰¿çš„æ„é€ å‡½æ•°"><a href="#ç»§æ‰¿çš„æ„é€ å‡½æ•°" class="headerlink" title="ç»§æ‰¿çš„æ„é€ å‡½æ•°"></a>ç»§æ‰¿çš„æ„é€ å‡½æ•°</h3><ul><li>C++11æ–°æ ‡å‡†ä¸­ï¼Œæ´¾ç”Ÿç±»å¯ä»¥é‡ç”¨å…¶ç›´æ¥åŸºç±»å®šä¹‰çš„æ„é€ å‡½æ•°ã€‚</li><li>å¦‚<code>using Disc_quote::Disc_quote;</code>ï¼Œæ³¨æ˜äº†è¦ç»§æ‰¿<code>Disc_quote</code>çš„æ„é€ å‡½æ•°ã€‚</li></ul><h2 id="å®¹å™¨ä¸ç»§æ‰¿"><a href="#å®¹å™¨ä¸ç»§æ‰¿" class="headerlink" title="å®¹å™¨ä¸ç»§æ‰¿"></a>å®¹å™¨ä¸ç»§æ‰¿</h2><ul><li>å½“æˆ‘ä»¬ä½¿ç”¨å®¹å™¨å­˜æ”¾ç»§æ‰¿ä½“ç³»ä¸­çš„å¯¹è±¡æ—¶ï¼Œé€šå¸¸å¿…é¡»é‡‡ç”¨é—´æ¥å­˜å‚¨çš„æ–¹å¼ã€‚</li><li>æ´¾ç”Ÿç±»å¯¹è±¡ç›´æ¥èµ‹å€¼ç»™ç§¯ç´¯å¯¹è±¡ï¼Œå…¶ä¸­çš„æ´¾ç”Ÿç±»éƒ¨åˆ†ä¼šè¢«åˆ‡æ‰ã€‚</li><li>åœ¨å®¹å™¨ä¸­æ”¾ç½®ï¼ˆæ™ºèƒ½ï¼‰æŒ‡é’ˆè€Œéå¯¹è±¡ã€‚</li><li>å¯¹äºC++é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ¥è¯´ï¼Œä¸€ä¸ªæ‚–è®ºæ˜¯æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨å¯¹è±¡è¿›è¡Œé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨æŒ‡é’ˆå’Œå¼•ç”¨ã€‚å› ä¸ºæŒ‡é’ˆä¼šå¢åŠ ç¨‹åºçš„å¤æ‚æ€§ï¼Œæ‰€ä»¥ç»å¸¸å®šä¹‰ä¸€äº›è¾…åŠ©çš„ç±»æ¥å¤„ç†è¿™äº›å¤æ‚çš„æƒ…å†µã€‚</li></ul><h2 id="æ–‡æœ¬æŸ¥è¯¢ç¨‹åºå†æ¢"><a href="#æ–‡æœ¬æŸ¥è¯¢ç¨‹åºå†æ¢" class="headerlink" title="æ–‡æœ¬æŸ¥è¯¢ç¨‹åºå†æ¢"></a>æ–‡æœ¬æŸ¥è¯¢ç¨‹åºå†æ¢</h2><ul><li>ä½¿ç³»ç»Ÿæ”¯æŒï¼šå•è¯æŸ¥è¯¢ã€é€»è¾‘éæŸ¥è¯¢ã€é€»è¾‘æˆ–æŸ¥è¯¢ã€é€»è¾‘ä¸æŸ¥è¯¢ã€‚</li></ul><h3 id="é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆ"><a href="#é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆ"></a>é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆ</h3><ul><li>å°†å‡ ç§ä¸åŒçš„æŸ¥è¯¢å»ºæ¨¡æˆç›¸äº’ç‹¬ç«‹çš„ç±»ï¼Œè¿™äº›ç±»å…±äº«ä¸€ä¸ªå…¬å…±åŸºç±»ï¼š<ul><li><code>WordQuery</code></li><li><code>NotQuery</code></li><li><code>OrQuery</code></li><li><code>AndQuery</code>  </li></ul></li><li>è¿™äº›ç±»åŒ…å«ä¸¤ä¸ªæ“ä½œï¼š<ul><li><code>eval</code>ï¼šæ¥å—ä¸€ä¸ª<code>TextQuery</code>å¯¹è±¡å¹¶è¿”å›ä¸€ä¸ª<code>QueryResult</code>ã€‚</li><li><code>rep</code>ï¼šè¿”å›åŸºç¡€æŸ¥è¯¢çš„<code>string</code>è¡¨ç¤ºå½¢å¼ã€‚</li></ul></li><li>ç»§æ‰¿å’Œç»„åˆï¼š<ul><li>å½“æˆ‘ä»¬ä»¤ä¸€ä¸ªç±»å…¬æœ‰åœ°ç»§æ‰¿å¦ä¸€ä¸ªç±»æ—¶ï¼Œæ´¾ç”Ÿç±»åº”å½“åæ˜ ä¸åŸºç±»çš„â€œæ˜¯ä¸€ç§ï¼ˆIs Aï¼‰â€çš„å…³ç³»ã€‚</li><li>ç±»å‹ä¹‹é—´å¦ä¸€ç§å¸¸è§çš„å…³ç³»æ˜¯â€œæœ‰ä¸€ä¸ªï¼ˆHas Aï¼‰â€çš„å…³ç³»ã€‚</li></ul></li><li>å¯¹äºé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ–°æ‰‹æ¥è¯´ï¼Œæƒ³è¦ç†è§£ä¸€ä¸ªç¨‹åºï¼Œæœ€å›°éš¾çš„éƒ¨åˆ†å¾€å¾€æ˜¯ç†è§£ç¨‹åºçš„è®¾è®¡æ€è·¯ã€‚ä¸€æ—¦æŒæ¡äº†è®¾è®¡æ€è·¯ï¼Œæ¥ä¸‹æ¥çš„å®ç°ä¹Ÿå°±æ°´åˆ°æ¸ æˆäº†ã€‚</li></ul><p><strong>Queryç¨‹åºè®¾è®¡</strong>:</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>Query</code>ç¨‹åºæ¥å£ç±»å’Œæ“ä½œ</td><td></td></tr><tr><td><code>TextQuery</code></td><td>è¯¥ç±»è¯»å…¥ç»™å®šçš„æ–‡ä»¶å¹¶æ„å»ºä¸€ä¸ªæŸ¥æ‰¾å›¾ã€‚åŒ…å«ä¸€ä¸ª<code>query</code>æ“ä½œï¼Œå®ƒæ¥å—ä¸€ä¸ª<code>string</code>å®å‚ï¼Œè¿”å›ä¸€ä¸ª<code>QueryResult</code>å¯¹è±¡ï¼›è¯¥<code>QueryResult</code>å¯¹è±¡è¡¨ç¤º<code>string</code>å‡ºç°çš„è¡Œã€‚</td></tr><tr><td><code>QueryResult</code></td><td>è¯¥ç±»ä¿å­˜ä¸€ä¸ª<code>query</code>æ“ä½œçš„ç»“æœã€‚</td></tr><tr><td><code>Query</code></td><td>æ˜¯ä¸€ä¸ªæ¥å£ç±»ï¼ŒæŒ‡å‘<code>Query_base</code>æ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚</td></tr><tr><td><code>Query q(s)</code></td><td>å°†<code>Query</code>å¯¹è±¡<code>q</code>ç»‘å®šåˆ°ä¸€ä¸ªå­˜æ”¾ç€<code>string s</code>çš„æ–°<code>WordQuery</code>å¯¹è±¡ä¸Šã€‚</td></tr><tr><td><code>q1 &amp; q2</code></td><td>è¿”å›ä¸€ä¸ª<code>Query</code>å¯¹è±¡ï¼Œè¯¥<code>Query</code>ç»‘å®šåˆ°ä¸€ä¸ªå­˜æ”¾<code>q1</code>å’Œ<code>q2</code>çš„æ–°<code>AndQuery</code>å¯¹è±¡ä¸Šã€‚</td></tr><tr><td>`q1</td><td>q2`</td></tr><tr><td><code>~q</code></td><td>è¿”å›ä¸€ä¸ª<code>Query</code>å¯¹è±¡ï¼Œè¯¥<code>Query</code>ç»‘å®šåˆ°ä¸€ä¸ªå­˜æ”¾<code>q</code>çš„æ–°<code>NotQuery</code>å¯¹è±¡ä¸Šã€‚</td></tr><tr><td><code>Query</code>ç¨‹åºå®ç°ç±»</td><td></td></tr><tr><td><code>Query_base</code></td><td>æŸ¥è¯¢ç±»çš„æŠ½è±¡åŸºç±»</td></tr><tr><td><code>WordQuery</code></td><td><code>Query_base</code>çš„æ´¾ç”Ÿç±»ï¼Œç”¨äºæŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å•è¯</td></tr><tr><td><code>NotQuery</code></td><td><code>Query_base</code>çš„æ´¾ç”Ÿç±»ï¼Œç”¨äºæŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å•è¯</td></tr><tr><td><code>BinaryQuery</code></td><td><code>Query_base</code>çš„æ´¾ç”Ÿç±»ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯<code>Query</code>è¿ç®—å¯¹è±¡æ²¡æœ‰å‡ºç°çš„è¡Œçš„é›†åˆ</td></tr><tr><td><code>OrQuery</code></td><td><code>Query_base</code>çš„æ´¾ç”Ÿç±»ï¼Œè¿”å›å®ƒçš„ä¸¤ä¸ªè¿ç®—å¯¹è±¡åˆ†åˆ«å‡ºç°çš„è¡Œçš„å¹¶é›†</td></tr><tr><td><code>AndQuery</code></td><td><code>Query_base</code>çš„æ´¾ç”Ÿç±»ï¼Œè¿”å›å®ƒçš„ä¸¤ä¸ªè¿ç®—å¯¹è±¡åˆ†åˆ«å‡ºç°çš„è¡Œçš„äº¤é›†</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°18</title>
      <link href="2021/04/10/notes/ch18/"/>
      <url>2021/04/10/notes/ch18/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå…«ç« -ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·"><a href="#ç¬¬åå…«ç« -ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·" class="headerlink" title="ç¬¬åå…«ç«  ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·"></a>ç¬¬åå…«ç«  ç”¨äºå¤§å‹ç¨‹åºçš„å·¥å…·</h1><p>å¤§è§„æ¨¡åº”ç”¨ç¨‹åºçš„ç‰¹æ®Šè¦æ±‚åŒ…æ‹¬ï¼š</p><ul><li>åœ¨ç‹¬ç«‹å¼€å‘çš„å­ç³»ç»Ÿä¹‹é—´ååŒå¤„ç†é”™è¯¯çš„èƒ½åŠ›ã€‚</li><li>ä½¿ç”¨å„ç§åº“è¿›è¡ŒååŒå¼€å‘çš„èƒ½åŠ›ã€‚</li><li>å¯¹æ¯”è¾ƒå¤æ‚çš„åº”ç”¨æ¦‚å¿µå»ºæ¨¡çš„èƒ½åŠ›ã€‚</li></ul><h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><p><strong>å¼‚å¸¸å¤„ç†</strong>ï¼ˆexception handlingï¼‰æœºåˆ¶å…è®¸ç¨‹åºä¸­ç‹¬ç«‹å¼€å‘çš„éƒ¨åˆ†èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶å°±å‡ºç°çš„é—®é¢˜è¿›è¡Œé€šä¿¡å¹¶ä½œå‡ºç›¸åº”çš„å¤„ç†ã€‚</p><h3 id="æŠ›å‡ºå¼‚å¸¸"><a href="#æŠ›å‡ºå¼‚å¸¸" class="headerlink" title="æŠ›å‡ºå¼‚å¸¸"></a>æŠ›å‡ºå¼‚å¸¸</h3><p>åœ¨C++è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<strong>æŠ›å‡º</strong>ï¼ˆthrowingï¼‰ä¸€æ¡è¡¨è¾¾å¼æ¥<strong>å¼•å‘</strong>ï¼ˆraisedï¼‰ä¸€ä¸ªå¼‚å¸¸ã€‚å¼‚å¸¸ç±»å‹å’Œå½“å‰çš„è°ƒç”¨é“¾å†³å®šäº†å“ªæ®µ<strong>å¤„ç†ä»£ç </strong>ï¼ˆhandlerï¼‰å°†ç”¨æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚</p><p>ç¨‹åºçš„æ§åˆ¶æƒä»<code>throw</code>è½¬ç§»åˆ°<code>catch</code>æ¨¡å—ã€‚</p><p><strong>æ ˆå±•å¼€</strong>ï¼šå½“<code>throw</code>å‡ºç°åœ¨ä¸€ä¸ª<code>tryè¯­å¥å—</code>æ—¶ï¼Œæ£€æŸ¥è¯¥<code>tryè¯­å¥å—</code>ç›¸å…³çš„<code>catch</code>å­—å¥ï¼Œè‹¥æœ‰åŒ¹é…åˆ™å¤„ç†ï¼›è‹¥æ— åŒ¹é…ï¼Œåˆ™ç»§ç»­æ£€æŸ¥å¤–å±‚çš„<code>try</code>åŒ¹é…çš„<code>catch</code>ã€‚</p><p>è‹¥ä¸€ä¸ªå¼‚å¸¸æ²¡æœ‰è¢«æ•è·ï¼Œåˆ™å®ƒå°†ç»ˆæ­¢å½“å‰çš„ç¨‹åºã€‚</p><p>å¯¹è±¡é”€æ¯ï¼š</p><ul><li>å—é€€å‡ºåï¼Œå®ƒçš„å±€éƒ¨å¯¹è±¡å°†è¢«é”€æ¯ã€‚</li><li>è‹¥å¼‚å¸¸å‘ç”Ÿåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œå³ä½¿æŸä¸ªå¯¹è±¡åªæ„é€ äº†ä¸€éƒ¨åˆ†ï¼Œä¹Ÿè¦ç¡®ä¿å·²æ„é€ çš„æˆå‘˜æ­£ç¡®åœ°è¢«é”€æ¯ã€‚</li><li>å°†èµ„æºé‡Šæ”¾æ”¾åœ¨ç±»çš„ææ„å‡½æ•°ä¸­ï¼Œä»¥ä¿è¯èµ„æºèƒ½è¢«æ­£ç¡®é‡Šæ”¾ã€‚ææ„å‡½æ•°æœ¬èº«ä¸ä¼šå¼•å‘å¼‚å¸¸ã€‚</li></ul><h3 id="æ•è·å¼‚å¸¸"><a href="#æ•è·å¼‚å¸¸" class="headerlink" title="æ•è·å¼‚å¸¸"></a>æ•è·å¼‚å¸¸</h3><p>è‹¥æ— éœ€è®¿é—®æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ï¼Œåˆ™å¯ä»¥å¿½ç•¥æ•è·å½¢å‚çš„åå­—ã€‚</p><p>é€šå¸¸ï¼Œè‹¥<code>catch</code>æ¥å—çš„å¼‚å¸¸ä¸æŸä¸ªç»§æ‰¿ä½“ç³»æœ‰å…³ï¼Œåˆ™æœ€å¥½å°†è¯¥<code>catch</code>çš„å‚æ•°å®šä¹‰æˆå¼•ç”¨ç±»å‹ã€‚</p><p>æœç´¢<code>catch</code>æœªå¿…æ˜¯æœ€ä½³åŒ¹é…ï¼Œè€Œæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå› æ­¤ï¼Œè¶Šç»†åŒ–çš„<code>catch</code>è¶Šåº”è¯¥æ”¾åœ¨<code>catch</code>åˆ—è¡¨å‰æ®µã€‚</p><p>é‡æ–°æŠ›å‡ºï¼š<code>catch</code>ä»£ç æ‰§è¡Œä¸€æ¡<code>throw;</code>å°†å¼‚å¸¸ä¼ é€’ç»™å¦ä¸€ä¸ª<code>catch</code>è¯­å¥ã€‚</p><p>æ•è·æ‰€æœ‰å¼‚å¸¸ï¼š<code>catch(...)</code></p><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p>å¤„ç†æ„é€ å‡½æ•°åˆå§‹å€¼å¼‚å¸¸çš„å”¯ä¸€æ–¹æ³•æ˜¯å°†æ„é€ å‡½æ•°åç¨‹å‡½æ•°<code>try</code>è¯­å¥å—ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Blob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">></span> il<span class="token punctuation">)</span> <span class="token keyword">try</span><span class="token operator">:</span>     <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">></span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">/*å‡½æ•°ä½“*/</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>bad_alloc <span class="token operator">&amp;</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token function">handle_out_of_memory</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="noexceptå¼‚å¸¸è¯´æ˜"><a href="#noexceptå¼‚å¸¸è¯´æ˜" class="headerlink" title="noexceptå¼‚å¸¸è¯´æ˜"></a>noexceptå¼‚å¸¸è¯´æ˜</h3><p>ä½¿ç”¨<code>noexcept</code>è¯´æ˜æŒ‡å®šæŸä¸ªå‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">recoup</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">;</span> <span class="token comment">//C++11</span>coid <span class="token function">recoup</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">throw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è€ç‰ˆæœ¬</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å¼‚å¸¸ç±»å±‚æ¬¡"><a href="#å¼‚å¸¸ç±»å±‚æ¬¡" class="headerlink" title="å¼‚å¸¸ç±»å±‚æ¬¡"></a>å¼‚å¸¸ç±»å±‚æ¬¡</h3><p>æ ‡å‡†exceptionå±‚æ¬¡ï¼š</p><ul><li>exception<ul><li>bad_cast</li><li>bad_alloc</li><li>runtime_error<ul><li>overflow_error</li><li>underflow_error</li><li>range_error</li></ul></li><li>logic_error<ul><li>domain_error</li><li>invalid_argument</li><li>out_of_range</li><li>length_error</li></ul></li></ul></li></ul><p>è‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼š</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">out_of_stock</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> std<span class="token operator">::</span><span class="token class-name">runtime_error</span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">explicit</span> <span class="token function">out_of_stock</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token operator">:</span>    std<span class="token operator">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h2><p>å¤šä¸ªåº“å°†åå­—æ”¾ç½®åœ¨å…¨å±€å‘½åç©ºé—´ä¸­å°†å¼•å‘<strong>å‘½åç©ºé—´æ±¡æŸ“</strong>ï¼ˆnamespace pollutionï¼‰ã€‚<strong>å‘½åç©ºé—´</strong>ï¼ˆnamespaceï¼‰åˆ†å‰²äº†å…¨å±€å‘½åç©ºé—´ï¼Œå…¶ä¸­æ¯ä¸ªå‘½åç©ºé—´æ˜¯ä¸€ä¸ªä½œç”¨åŸŸã€‚</p><h3 id="å‘½åç©ºé—´å®šä¹‰"><a href="#å‘½åç©ºé—´å®šä¹‰" class="headerlink" title="å‘½åç©ºé—´å®šä¹‰"></a>å‘½åç©ºé—´å®šä¹‰</h3><p>å‘½åç©ºé—´çš„å®šä¹‰åŒ…å«ä¸¤éƒ¨åˆ†ï¼š1.å…³é”®å­—<code>namespace</code>ï¼›2.å‘½åç©ºé—´åç§°ã€‚åé¢æ˜¯ä¸€ç³»åˆ—ç”±èŠ±æ‹¬å·æ‹¬èµ·æ¥çš„å£°æ˜å’Œå®šä¹‰ã€‚å‘½åç©ºé—´ä½œç”¨åŸŸåé¢æ— éœ€åˆ†å·ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> cplusplus_primer<span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ¯ä¸ªå‘½åç©ºé—´éƒ½æ˜¯ä¸€ä¸ª<strong>ä½œç”¨åŸŸ</strong>ã€‚å®šä¹‰åœ¨æŸä¸ªå‘½åç©ºé—´å†…çš„åå­—å¯ä»¥è¢«è¯¥å‘½åç©ºé—´å†…çš„å…¶ä»–æˆå‘˜ç›´æ¥è®¿é—®ï¼Œä¹Ÿå¯ä»¥è¢«è¿™äº›æˆå‘˜å†…åµŒå¥—ä½œç”¨åŸŸä¸­çš„ä»»ä½•å•ä½è®¿é—®ã€‚ä½äºè¯¥å‘½åç©ºé—´ä¹‹å¤–çš„ä»£ç å¿…é¡»æ˜ç¡®æŒ‡å‡ºæ‰€ç”¨çš„åå­—æ˜¯å±äºå“ªä¸ªå‘½åç©ºé—´çš„ã€‚</p><p>å‘½åç©ºé—´å¯ä»¥æ˜¯<strong>ä¸è¿ç»­</strong>çš„ã€‚è¿™ç‚¹ä¸åŒäºå…¶ä»–ä½œç”¨åŸŸï¼Œæ„å‘³ç€åŒä¸€å‘½åç©ºé—´å¯ä»¥åœ¨å¤šå¤„å‡ºç°ã€‚</p><p><strong>å†…è”å‘½åç©ºé—´</strong>ï¼ˆC++11ï¼‰ï¼š</p><p>æ— éœ€ä½¿ç”¨è¯¥å‘½åç©ºé—´çš„å‰ç¼€ï¼Œé€šè¿‡å¤–å±‚å‘½åç©ºé—´å°±å¯ä»¥ç›´æ¥è®¿é—®ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> cplusplus_primer<span class="token punctuation">&#123;</span>    <span class="token keyword">inline</span> <span class="token keyword">namespace</span> FifthEd<span class="token punctuation">&#123;</span>        <span class="token comment">// è¡¨ç¤ºæœ¬ä¹¦ç¬¬5ç‰ˆä»£ç </span>        <span class="token keyword">class</span> <span class="token class-name">Query_base</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>cplusplus_primer<span class="token operator">::</span>Query_base qb<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æœªå‘½åçš„å‘½åç©ºé—´</strong>ï¼š</p><p>æŒ‡å…³é”®å­—<code>namespace</code>åé¢ç´§è·ŸèŠ±æ‹¬å·çš„ç”¨æ³•ã€‚æœªå‘½åçš„å‘½åç©ºé—´ä¸­å®šä¹‰çš„å˜é‡æ‹¥æœ‰é™æ€çš„å£°æ˜å‘¨æœŸï¼šåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨å‰åˆ›å»ºï¼Œç›´åˆ°ç¨‹åºç»“æŸæ‰é”€æ¯ã€‚ä¸èƒ½è·¨è¶Šå¤šä¸ªæ–‡ä»¶ã€‚</p><h3 id="ä½¿ç”¨å‘½åç©ºé—´æˆå‘˜"><a href="#ä½¿ç”¨å‘½åç©ºé—´æˆå‘˜" class="headerlink" title="ä½¿ç”¨å‘½åç©ºé—´æˆå‘˜"></a>ä½¿ç”¨å‘½åç©ºé—´æˆå‘˜</h3><p>åƒ<code>namespace_name::member_name</code>è¿™æ ·ä½¿ç”¨å‘½åç©ºé—´çš„æˆå‘˜éå¸¸ç¹çã€‚</p><p><strong>å‘½åç©ºé—´çš„åˆ«å</strong>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> primer <span class="token operator">=</span> cplusplus_primer<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>usingå£°æ˜</strong>ï¼ˆusing declarationï¼‰ï¼š</p><p>ä¸€æ¡<code>using</code>å£°æ˜è¯­å¥ä¸€æ¬¡åªå¼•å…¥å‘½åç©ºé—´çš„ä¸€ä¸ªæˆå‘˜ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span>string s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>usingæŒ‡ç¤º</strong>ï¼ˆusing directiveï¼‰ï¼š</p><p>ä½¿å¾—æŸä¸ªç‰¹å®šçš„å‘½åç©ºé—´ä¸­æ‰€æœ‰çš„åå­—éƒ½å¯è§ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>string s <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ç±»ã€å‘½åç©ºé—´ä¸ä½œç”¨åŸŸ"><a href="#ç±»ã€å‘½åç©ºé—´ä¸ä½œç”¨åŸŸ" class="headerlink" title="ç±»ã€å‘½åç©ºé—´ä¸ä½œç”¨åŸŸ"></a>ç±»ã€å‘½åç©ºé—´ä¸ä½œç”¨åŸŸ</h3><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">namespace</span> A<span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name">C1</span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span><span class="token operator">:</span>            <span class="token keyword">int</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>A<span class="token operator">::</span>C1<span class="token operator">::</span>f3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é‡è½½ä¸å‘½åç©ºé—´"><a href="#é‡è½½ä¸å‘½åç©ºé—´" class="headerlink" title="é‡è½½ä¸å‘½åç©ºé—´"></a>é‡è½½ä¸å‘½åç©ºé—´</h3><p><code>using</code>å£°æ˜è¯­å¥å£°æ˜çš„æ˜¯ä¸€ä¸ªåå­—ï¼Œè€Œéç‰¹å®šçš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åŒ…æ‹¬è¯¥å‡½æ•°çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œéƒ½è¢«å¼•å…¥åˆ°å½“å‰ä½œç”¨åŸŸä¸­ã€‚</p><h2 id="å¤šé‡ç»§æ‰¿ä¸è™šç»§æ‰¿"><a href="#å¤šé‡ç»§æ‰¿ä¸è™šç»§æ‰¿" class="headerlink" title="å¤šé‡ç»§æ‰¿ä¸è™šç»§æ‰¿"></a>å¤šé‡ç»§æ‰¿ä¸è™šç»§æ‰¿</h2><h3 id="å¤šé‡ç»§æ‰¿"><a href="#å¤šé‡ç»§æ‰¿" class="headerlink" title="å¤šé‡ç»§æ‰¿"></a>å¤šé‡ç»§æ‰¿</h3><h3 id="ç±»å‹è½¬æ¢ä¸å¤šä¸ªåŸºç±»"><a href="#ç±»å‹è½¬æ¢ä¸å¤šä¸ªåŸºç±»" class="headerlink" title="ç±»å‹è½¬æ¢ä¸å¤šä¸ªåŸºç±»"></a>ç±»å‹è½¬æ¢ä¸å¤šä¸ªåŸºç±»</h3><h3 id="å¤šé‡ç»§æ‰¿ä¸‹çš„ç±»ä½œç”¨åŸŸ"><a href="#å¤šé‡ç»§æ‰¿ä¸‹çš„ç±»ä½œç”¨åŸŸ" class="headerlink" title="å¤šé‡ç»§æ‰¿ä¸‹çš„ç±»ä½œç”¨åŸŸ"></a>å¤šé‡ç»§æ‰¿ä¸‹çš„ç±»ä½œç”¨åŸŸ</h3><ul><li>å½“ä¸€ä¸ªç±»æ‹¥æœ‰å¤šä¸ªåŸºç±»æ—¶ï¼Œæœ‰å¯èƒ½å‡ºç°æ´¾ç”Ÿç±»ä»ä¸¤ä¸ªæˆ–æ›´å¤šåŸºç±»ä¸­ç»§æ‰¿äº†åŒåæˆå‘˜çš„æƒ…å†µã€‚æ­¤æ—¶ï¼Œä¸åŠ å‰ç¼€é™å®šç¬¦ç›´æ¥ä½¿ç”¨è¯¥åå­—å°†å¼•å‘äºŒä¹‰æ€§ã€‚</li></ul><h3 id="è™šç»§æ‰¿"><a href="#è™šç»§æ‰¿" class="headerlink" title="è™šç»§æ‰¿"></a>è™šç»§æ‰¿</h3><ul><li>è™šç»§æ‰¿çš„ç›®çš„æ˜¯ä»¤æŸä¸ªç±»åšå‡ºå£°æ˜ï¼Œæ‰¿è¯ºæ„¿æ„å…±äº«å®ƒçš„åŸºç±»ã€‚å…¶ä¸­ï¼Œå…±äº«çš„åŸºç±»å­å¯¹è±¡æˆä¸º<strong>è™šåŸºç±»</strong>ã€‚åœ¨è¿™ç§æœºåˆ¶ä¸‹ï¼Œä¸è®ºè™šåŸºç±»åœ¨ç»§æ‰¿ä½“ç³»ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œåœ¨æ´¾ç”Ÿç±»ä¸­éƒ½åªåŒ…å«å”¯ä¸€ä¸€ä¸ªå…±äº«çš„è™šåŸºç±»å­å¯¹è±¡ã€‚</li><li>è™šæ´¾ç”Ÿåªå½±å“ä»æŒ‡å®šäº†è™šåŸºç±»çš„æ´¾ç”Ÿç±»ä¸­è¿›ä¸€æ­¥æ´¾ç”Ÿå‡ºçš„ç±»ï¼Œå®ƒä¸ä¼šå½±å“æ´¾ç”Ÿç±»æœ¬èº«ã€‚</li></ul><h3 id="æ„é€ å‡½æ•°ä¸è™šç»§æ‰¿"><a href="#æ„é€ å‡½æ•°ä¸è™šç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°ä¸è™šç»§æ‰¿"></a>æ„é€ å‡½æ•°ä¸è™šç»§æ‰¿</h3><ul><li>hå«æœ‰è™šåŸºç±»çš„å¯¹è±¡çš„æ„é€ é¡ºåºä¸ä¸€èˆ¬çš„é¡ºåºç¨æœ‰<strong>åŒºåˆ«</strong>ï¼šé¦–å…ˆä½¿ç”¨æä¾›ç»™æœ€åº•å±‚æ´¾ç”Ÿç±»æ„é€ å‡½æ•°çš„åˆå§‹å€¼åˆå§‹åŒ–è¯¥å¯¹è±¡çš„è™šåŸºç±»å­éƒ¨åˆ†ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§ç›´æ¥åŸºç±»åœ¨æ´¾ç”Ÿåˆ—è¡¨ä¸­å‡ºç°çš„æ¬¡åºå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>è™šåŸºç±»æ€»æ˜¯å…ˆäºéè™šåŸºç±»æ„é€ ï¼Œä¸å®ƒä»¬åœ¨ç»§æ‰¿ä½“ç³»ä¸­çš„æ¬¡åºå’Œä½ç½®æ— å…³ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°19</title>
      <link href="2021/04/10/notes/ch19/"/>
      <url>2021/04/10/notes/ch19/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¹ç« -ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯"><a href="#ç¬¬åä¹ç« -ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯" class="headerlink" title="ç¬¬åä¹ç«  ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯"></a>ç¬¬åä¹ç«  ç‰¹æ®Šå·¥å…·ä¸æŠ€æœ¯</h1><h2 id="æ§åˆ¶å†…å­˜åˆ†é…"><a href="#æ§åˆ¶å†…å­˜åˆ†é…" class="headerlink" title="æ§åˆ¶å†…å­˜åˆ†é…"></a>æ§åˆ¶å†…å­˜åˆ†é…</h2><h3 id="é‡è½½newå’Œdelete"><a href="#é‡è½½newå’Œdelete" class="headerlink" title="é‡è½½newå’Œdelete"></a>é‡è½½newå’Œdelete</h3><ul><li><strong><code>new</code>è¡¨è¾¾å¼çš„å·¥ä½œæœºç†</strong>ï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">string *sp &#x3D; new string(&quot;a value&quot;); &#x2F;&#x2F;åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªstringå¯¹è±¡string *arr &#x3D; new string[10];   &#x2F;&#x2F; åˆ†é…10ä¸ªé»˜è®¤åˆå§‹åŒ–çš„stringå¯¹è±¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><p>ä¸Šè¿°ä»£ç å®é™…æ‰§è¡Œäº†<strong>ä¸‰æ­¥æ“ä½œ</strong>ï¼š</p><ul><li><code>new</code>è¡¨è¾¾å¼è°ƒç”¨ä¸€ä¸ªåä¸º<code>operator new</code>(æˆ–<code>operator new []</code>)çš„æ ‡å‡†åº“å‡½æ•°ï¼Œå®ƒåˆ†é…ä¸€å—<strong>è¶³å¤Ÿå¤§çš„</strong>ã€<strong>åŸå§‹çš„</strong>ã€<strong>æœªå‘½åçš„</strong>å†…å­˜ç©ºé—´ä»¥ä¾¿å­˜å‚¨ç‰¹å®šç±»å‹çš„å¯¹è±¡(æˆ–å¯¹è±¡çš„æ•°ç»„)ã€‚</li><li>ç¼–è¯‘å™¨è¿è¡Œç›¸åº”çš„æ„é€ å‡½æ•°ä»¥æ„é€ è¿™äº›å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶ä¼ å…¥åˆå§‹å€¼ã€‚</li><li>å¯¹è±¡è¢«åˆ†é…äº†ç©ºé—´å¹¶æ„é€ å®Œæˆï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆã€‚</li></ul></li><li><p><strong><code>delete</code>è¡¨è¾¾å¼çš„å·¥ä½œæœºç†</strong>ï¼š</p></li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">delete sp;  &#x2F;&#x2F; é”€æ¯*spï¼Œç„¶åé‡Šæ”¾spæŒ‡å‘çš„å†…å­˜ç©ºé—´delete [] arr;  &#x2F;&#x2F; é”€æ¯æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œç„¶åé‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>ä¸Šè¿°ä»£ç å®é™…æ‰§è¡Œäº†<strong>ä¸¤æ­¥æ“ä½œ</strong>ï¼š<ul><li>å¯¹<code>sp</code>æ‰€æŒ‡å‘çš„å¯¹è±¡æˆ–è€…<code>arr</code>æ‰€æŒ‡çš„æ•°ç»„ä¸­çš„å…ƒç´ æ‰§è¡Œå¯¹åº”çš„ææ„å‡½æ•°ã€‚</li><li>ç¼–è¯‘å™¨è°ƒç”¨åä¸º<code>operator delete</code>(æˆ–<code>operator delete[]</code>)çš„æ ‡å‡†åº“å‡½æ•°é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚</li></ul></li><li>å½“è‡ªå®šä¹‰äº†å…¨å±€çš„<code>operator new</code>å‡½æ•°å’Œ<code>operator delete</code>å‡½æ•°åï¼Œæˆ‘ä»¬å°±æ‹…è´Ÿèµ·äº†æ§åˆ¶åŠ¨æ€å†…å­˜åˆ†é…çš„èŒè´£ã€‚è¿™ä¸¤ä¸ªå‡½æ•°<strong>å¿…é¡»æ˜¯æ­£ç¡®çš„</strong>ã€‚å› ä¸ºå®ƒä»¬æ˜¯ç¨‹åºæ•´ä¸ªå¤„ç†è¿‡ç¨‹ä¸­è‡³å…³é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚</li><li>æ ‡å‡†åº“å®šä¹‰äº†<code>operator new</code>å‡½æ•°å’Œ<code>operator delete</code>å‡½æ•°çš„8ä¸ªé‡è½½ç‰ˆæœ¬ï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F; è¿™äº›ç‰ˆæœ¬å¯èƒ½æŠ›å‡ºå¼‚å¸¸void *operator new(size_t); &#x2F;&#x2F; åˆ†é…ä¸€ä¸ªå¯¹è±¡void *operator new[](size_t);   &#x2F;&#x2F; åˆ†é…ä¸€ä¸ªæ•°ç»„void *operator delete(void*) noexcept;  &#x2F;&#x2F; é‡Šæ”¾ä¸€ä¸ªå¯¹è±¡void *operator delete[](void*) noexcept;    &#x2F;&#x2F; é‡Šæ”¾ä¸€ä¸ªæ•°ç»„&#x2F;&#x2F; è¿™äº›ç‰ˆæœ¬æ‰¿è¯ºä¸ä¼šæŠ›å‡ºå¼‚å¸¸void *operator new(size_t, nothrow_t&amp;) noexcept;void *operator new[](size_t, nothrow_t&amp;) noexcept;void *operator delete(void*, nothrow_t&amp;) noexcept;void *operator delete[](void*, nothrow_t&amp;) noexcept;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åº”ç”¨ç¨‹åºå¯ä»¥è‡ªå®šä¹‰ä¸Šé¢å‡½æ•°ç‰ˆæœ¬ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œå‰ææ˜¯è‡ªå®šä¹‰çš„ç‰ˆæœ¬å¿…é¡»ä½äº<strong>å…¨å±€ä½œç”¨åŸŸ</strong>æˆ–è€…<strong>ç±»ä½œç”¨åŸŸ</strong>ä¸­ã€‚</li><li><strong>æ³¨æ„ï¼š</strong> æä¾›æ–°çš„<code>operator new</code>å‡½æ•°å’Œ<code>operator delete</code>å‡½æ•°çš„ç›®çš„åœ¨äºæ”¹å˜å†…å­˜åˆ†é…çš„æ–¹å¼ï¼Œä½†æ˜¯ä¸ç®¡æ€æ ·ï¼Œéƒ½ä¸èƒ½æ”¹å˜<code>new</code>è¿ç®—ç¬¦å’Œ<code>delete</code>è¿ç®—ç¬¦çš„åŸºæœ¬å«ä¹‰ã€‚</li><li>ä½¿ç”¨ä»Cè¯­è¨€ç»§æ‰¿çš„å‡½æ•°<code>malloc</code>å’Œ<code>free</code>å‡½æ•°èƒ½å®ç°ä»¥æŸç§æ–¹å¼æ‰§è¡Œåˆ†é…å†…å­˜å’Œé‡Šæ”¾å†…å­˜çš„æ“ä½œï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;cstdlib&gt;void *operator new(size_t size) &#123;    if(void *mem &#x3D; malloc(size))        return mme;    else        throw bad_alloc();&#125;void operator delete(void *mem) noexcept &#123;    free(mem);&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®šä½newè¡¨è¾¾å¼"><a href="#å®šä½newè¡¨è¾¾å¼" class="headerlink" title="å®šä½newè¡¨è¾¾å¼"></a>å®šä½newè¡¨è¾¾å¼</h3><ul><li>åº”è¯¥ä½¿ç”¨newçš„å®šä½<code>new(placement new)</code>å½¢å¼ä¼ é€’ä¸€ä¸ªåœ°å€ï¼Œå®šä½<code>new</code>çš„å½¢å¼å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">new (place_address) typenew (place_address) type (initializers)new (place_address) type [size]new (place_address) type [size] &#123;braced initializer list&#125;&#x2F;&#x2F; place_addresså¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒåŒæ—¶åœ¨initializersä¸­æä¾›ä¸€ä¸ª(å¯èƒ½ä¸ºç©ºçš„)ä»¥é€—å·åˆ†éš”çš„åˆå§‹å€¼åˆ—è¡¨ï¼Œè¯¥åˆå§‹å€¼åˆ—è¡¨å°†ç”¨äºæ„é€ æ–°åˆ†é…çš„å¯¹è±¡ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å½“åªä¼ å…¥ä¸€ä¸ªæŒ‡é’ˆç±»å‹çš„å®å‚æ—¶ï¼Œå®šä½<code>new</code>è¡¨è¾¾å¼æ„é€ å¯¹è±¡ä½†æ˜¯ä¸åˆ†é…å†…å­˜ã€‚</li><li>è°ƒç”¨ææ„å‡½æ•°ä¼šé”€æ¯å¯¹è±¡ï¼Œä½†æ˜¯ä¸ä¼šé‡Šæ”¾å†…å­˜ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">string *sp &#x3D; new string(&quot;a value&quot;); &#x2F;&#x2F; åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªstringå¯¹è±¡sp-&gt;~string();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="è¿è¡Œæ—¶ç±»å‹è¯†åˆ«"><a href="#è¿è¡Œæ—¶ç±»å‹è¯†åˆ«" class="headerlink" title="è¿è¡Œæ—¶ç±»å‹è¯†åˆ«"></a>è¿è¡Œæ—¶ç±»å‹è¯†åˆ«</h2><ul><li>è¿è¡Œæ—¶ç±»å‹è¯†åˆ«<code>(run-time type identification, RTTI)</code>çš„åŠŸèƒ½ç”±ä¸¤ä¸ªè¿ç®—ç¬¦å®ç°ï¼š<ul><li><code>typeid</code>è¿ç®—ç¬¦ï¼Œ ç”¨äºè¿”å›è¡¨è¾¾å¼çš„ç±»å‹ã€‚</li><li><code>dynamic_cast</code>è¿ç®—ç¬¦ï¼Œç”¨äºå°†åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨å®‰å…¨åœ°è½¬æ¢æ›¾æ´¾ç”Ÿç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚</li></ul></li><li>ä½¿ç”¨<code>RTTI</code>å¿…é¡»è¦åŠ å€å°å¿ƒã€‚åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½å®šä¹‰è™šå‡½æ•°è€Œéç›´æ¥æ¥ç®¡ç±»å‹ç®¡ç†çš„é‡ä»»ã€‚</li></ul><h3 id="dynamic-castè¿ç®—ç¬¦"><a href="#dynamic-castè¿ç®—ç¬¦" class="headerlink" title="dynamic_castè¿ç®—ç¬¦"></a>dynamic_castè¿ç®—ç¬¦</h3><ul><li>dynamic_castè¿ç®—ç¬¦çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">dynamic_cast&lt;type*&gt;(e)  &#x2F;&#x2F; eå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æŒ‡é’ˆdynamic_cast&lt;type&amp;&gt;(e)  &#x2F;&#x2F; eå¿…é¡»æ˜¯ä¸€ä¸ªå·¦å€¼dynamic_cast&lt;type&amp;&amp;&gt;(e) &#x2F;&#x2F; eä¸èƒ½æ˜¯å·¦å€¼&#x2F;&#x2F; ä»¥ä¸Šï¼Œtypeç±»å‹å¿…é¡»æ—¶ä¸€ä¸ªç±»ç±»å‹ï¼Œå¹¶ä¸”é€šå¸¸æƒ…å†µä¸‹è¯¥ç±»å‹åº”è¯¥å«æœ‰è™šå‡½æ•°ã€‚&#x2F;&#x2F; eçš„ç±»å‹å¿…é¡»ç¬¦åˆä¸‰ä¸ªæ¡ä»¶ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œå®ƒä»¬æ˜¯ï¼š&#x2F;&#x2F; 1. eçš„ç±»å‹æ˜¯ç›®æ ‡typeçš„å…¬æœ‰æ´¾ç”Ÿç±»ï¼›&#x2F;&#x2F; 2. eçš„ç±»å‹æ˜¯ç›®æ ‡typeçš„å…±æœ‰åŸºç±»ï¼›&#x2F;&#x2F; 3. eçš„ç±»å‹å°±æ˜¯ç›®æ ‡typeçš„ç±»å‹ï¼›&#x2F;&#x2F; æŒ‡é’ˆç±»å‹çš„dynamic_cast&#x2F;&#x2F; å‡è®¾Baseç±»è‡³å°‘å«æœ‰ä¸€ä¸ªè™šå‡½æ•°ï¼ŒDerivedæ˜¯Baseçš„å…±æœ‰æ´¾ç”Ÿç±»ã€‚if (Derived *dp &#x3D; dynamic_cast&lt;Derived*&gt;(bp)) &#123;    &#x2F;&#x2F; ä½¿ç”¨dpæŒ‡å‘çš„Derivedå¯¹è±¡&#125; else &#123;    &#x2F;&#x2F; bpæŒ‡å‘ä¸€ä¸ªBaseå¯¹è±¡    &#x2F;&#x2F; ä½¿ç”¨dpæŒ‡å‘çš„Baseå¯¹è±¡&#125;&#x2F;&#x2F; å¼•ç”¨ç±»å‹çš„dynamic_castvoid f(const Base &amp;b) &#123;    try &#123;        const Derived &amp;d &#x3D; dynamic_cast&lt;const Derived&amp;&gt;(b);        &#x2F;&#x2F; ä½¿ç”¨bå¼•ç”¨çš„Derivedå¯¹è±¡    &#125; catch (bad_cast) &#123;        &#x2F;&#x2F; å¤„ç†ç±»å‹è½¬æ¢å¤±è´¥çš„æƒ…å†µ    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å¯ä»¥å¯¹ä¸€ä¸ªç©ºæŒ‡é’ˆæ‰§è¡Œ<code>dynamic_cast</code>ï¼Œç»“æœæ˜¯æ‰€éœ€ç±»å‹çš„ç©ºæŒ‡é’ˆã€‚</li></ul><h3 id="typeidè¿ç®—ç¬¦"><a href="#typeidè¿ç®—ç¬¦" class="headerlink" title="typeidè¿ç®—ç¬¦"></a>typeidè¿ç®—ç¬¦</h3><ul><li><code>typeidè¿ç®—ç¬¦(typeid operator)</code>ï¼Œå®ƒå…è®¸ç¨‹åºå‘è¡¨è¾¾å¼æé—®ï¼š<strong>ä½ çš„å¯¹è±¡æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ</strong></li><li><code>typeid</code>è¡¨è¾¾å¼çš„å½¢å¼æ˜¯<code>typeid(e)</code>ï¼Œå…¶ä¸­<code>e</code>å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼æˆ–ç±»å‹çš„åå­—ï¼Œå®ƒæ“ä½œçš„ç»“æœæ˜¯ä¸€ä¸ªå¸¸é‡å¯¹è±¡çš„å¼•ç”¨ã€‚å®ƒå¯ä»¥ä½œç”¨äºä»»æ„ç±»å‹çš„è¡¨è¾¾å¼ã€‚</li><li>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½¿ç”¨typeidæ¯”è¾ƒä¸¤æ¡è¡¨è¾¾å¼çš„ç±»å‹æ˜¯å¦ç›¸åŒï¼Œæˆ–è€…æ¯”è¾ƒä¸€æ¡è¡¨è¾¾å¼çš„ç±»å‹æ˜¯å¦ä¸æŒ‡å®šç±»å‹ç›¸åŒï¼š</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">Derived *dp &#x3D; new Derived;Base *bp &#x3D; dp;if (typeid(*bp) &#x3D;&#x3D; typeid(*dp)) &#123;    &#x2F;&#x2F; bpå’ŒdpæŒ‡å‘åŒä¸€ç±»å‹çš„å¯¹è±¡&#125;if (typeid(*bp) &#x3D;&#x3D; typeid(Derived)) &#123;    &#x2F;&#x2F; bpå®é™…æŒ‡å‘Derivedå¯¹è±¡&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å½“typeidä½œç”¨äºæŒ‡é’ˆæ—¶(è€ŒéæŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡)ï¼Œè¿”å›çš„ç»“æœæ˜¯è¯¥æŒ‡é’ˆçš„é™æ€ç¼–è¯‘æ—¶ç±»å‹ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F; ä¸‹é¢çš„æ£€æŸ¥æ°¸è¿œæ˜¯å¤±è´¥çš„ï¼šbpçš„ç±»å‹æ˜¯æŒ‡å‘Baseçš„æŒ‡é’ˆif (typeid(bp) &#x3D;&#x3D; typeid(Derived)) &#123;    &#x2F;&#x2F; æ°¸è¿œä¸ä¼šæ‰§è¡Œ&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä½¿ç”¨RTTI"><a href="#ä½¿ç”¨RTTI" class="headerlink" title="ä½¿ç”¨RTTI"></a>ä½¿ç”¨RTTI</h3><ul><li>ç”¨é€”ï¼šä¸ºå…·æœ‰ç»§æ‰¿å…³ç³»çš„ç±»å®ç°ç›¸ç­‰è¿ç®—ç¬¦æ—¶ã€‚å¯¹äºä¸¤ä¸ªå¯¹è±¡æ¥è¯´ï¼Œå¦‚æœå®ƒä»¬çš„ç±»å‹ç›¸åŒå¹¶ä¸”å¯¹åº”çš„æ•°æ®æˆå‘˜å–å€¼ç›¸åŒï¼Œåˆ™è¯´è¿™ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F; ç±»çš„å±‚æ¬¡å…³ç³»class Base &#123;    friend bool operator&#x3D;&#x3D;(const Base&amp;, const Base&amp;);public:    &#x2F;&#x2F; Baseçš„æ¥å£æˆå‘˜protected:    virtual bool equal(const Base&amp;) const;    &#x2F;&#x2F; Baseçš„æ•°æ®æˆå‘˜å’Œå…¶ä»–ç”¨äºå®ç°çš„æˆå‘˜&#125;;class Derived: public Base &#123;public:    &#x2F;&#x2F; Derivedçš„å…¶ä»–æ¥å£æˆå‘˜protected:    bool equal(const Base&amp;) const;    &#x2F;&#x2F; Derivedçš„æ•°æ®æˆå‘˜å’Œå…¶ä»–ç”¨äºå®ç°çš„æˆå‘˜&#125;;&#x2F;&#x2F; ç±»å‹æ•æ„Ÿçš„ç›¸ç­‰è¿ç®—ç¬¦bool operator&#x3D;&#x3D;(const Base &amp;lhs, const Base &amp;rhs) &#123;    &#x2F;&#x2F; å¦‚æœtypeidä¸ç›¸åŒï¼Œè¿”å›falseï¼›å¦åˆ™è™šè°ƒç”¨equal    return typeid(lhs) &#x3D;&#x3D; typeid(rhs) &amp;&amp; lhs.equal(rhs);&#125;&#x2F;&#x2F; è™šequalå‡½æ•°bool Derived::equal(const Base &amp;rhs) const &#123;    auto r &#x3D; dynamic_cast&lt;const Derived&amp;&gt;(rhs);    &#x2F;&#x2F; æ‰§è¡Œæ¯”è¾ƒä¸¤ä¸ªDerivedå¯¹è±¡çš„æ“ä½œå¹¶è¿”å›ç»“æœ&#125;&#x2F;&#x2F; åŸºç±»equalå‡½æ•°bool Base::equal(const Base &amp;rhs) const &#123;    &#x2F;&#x2F; æ‰§è¡Œæ¯”è¾ƒBaseå¯¹è±¡çš„æ“ä½œ&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="type-infoç±»"><a href="#type-infoç±»" class="headerlink" title="type_infoç±»"></a>type_infoç±»</h3><h2 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a>æšä¸¾ç±»å‹</h2><ul><li>æšä¸¾ç±»å‹<code>(enumeration)</code>ä½¿æˆ‘ä»¬å¯ä»¥å°†ä¸€ç»„æ•´å‹å¸¸é‡ç»„ç»‡åœ¨ä¸€èµ·ã€‚æšä¸¾å±äºå­—é¢å€¼å¸¸é‡ç±»å‹ã€‚</li><li>**é™å®šä½œç”¨åŸŸçš„æšä¸¾ç±»å‹(scoped enumeration)**ï¼šé¦–å…ˆæ˜¯å…³é”®å­—<code>enum class(æˆ–enum struct)</code>ï¼Œéšåæ˜¯æšä¸¾ç±»å‹åå­—ä»¥åŠç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥çš„ä»¥é€—å·åˆ†éš”çš„æšä¸¾æˆå‘˜åˆ—è¡¨ï¼Œæœ€åæ˜¯ä¸€ä¸ªåˆ†å·ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">enum class open_modes &#123;input, output, append&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ä¸é™å®šä½œç”¨åŸŸçš„æšä¸¾ç±»å‹<code>(unscoped enumeration)</code>ï¼šçœç•¥å…³é”®å­—<code>class(æˆ–struct)</code>ï¼Œæšä¸¾ç±»å‹çš„åå­—æ˜¯å¯é€‰çš„ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">enum color &#123;red, yellow, green&#125;;enum &#123;floatPrec &#x3D; 6, doublePrec &#x3D; 10, double_doublePrec &#x3D; 10&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç±»æˆå‘˜æŒ‡é’ˆ"><a href="#ç±»æˆå‘˜æŒ‡é’ˆ" class="headerlink" title="ç±»æˆå‘˜æŒ‡é’ˆ"></a>ç±»æˆå‘˜æŒ‡é’ˆ</h2><p><strong>æˆå‘˜æŒ‡é’ˆ</strong>ï¼šæŒ‡å¯ä»¥æŒ‡å‘ç±»çš„éé™æ€æˆå‘˜çš„æŒ‡é’ˆã€‚</p><h3 id="æ•°æ®æˆå‘˜æŒ‡é’ˆ"><a href="#æ•°æ®æˆå‘˜æŒ‡é’ˆ" class="headerlink" title="æ•°æ®æˆå‘˜æŒ‡é’ˆ"></a>æ•°æ®æˆå‘˜æŒ‡é’ˆ</h3><ul><li>å’Œå…¶ä»–æŒ‡é’ˆä¸€æ ·ï¼Œåœ¨å£°æ˜æˆå‘˜æŒ‡é’ˆæ—¶ä¹Ÿä½¿ç”¨*æ¥è¡¨ç¤ºå½“å‰å£°æ˜çš„åå­—æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚ä¸æ™®é€šæŒ‡é’ˆä¸åŒçš„æ—¶ï¼Œæˆå‘˜æŒ‡é’ˆè¿˜å¿…é¡»åŒ…å«æˆå‘˜æ‰€å±çš„ç±»ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F; pdataå¯ä»¥æŒ‡å‘ä¸€ä¸ªå¸¸é‡(éå¸¸é‡)Screenå¯¹è±¡çš„stringæˆå‘˜const string Screen::*pdata;&#x2F;&#x2F; C++11auto pdata &#x3D; &amp;Screen::contents;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å½“æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæˆå‘˜æŒ‡é’ˆæˆ–ä¸ºæˆå‘˜æŒ‡é’ˆèµ‹å€¼æ—¶ï¼Œè¯¥æŒ‡é’ˆæ²¡æœ‰æŒ‡å‘ä»»ä½•æ•°æ®ã€‚æˆå‘˜æŒ‡é’ˆæŒ‡å®šäº†æˆå‘˜è€Œéè¯¥æˆå‘˜æ‰€å±çš„å¯¹è±¡ï¼Œåªæœ‰å½“è§£å¼•ç”¨æˆå‘˜æŒ‡é’ˆæ—¶æ‰æä¾›å¯¹è±¡çš„ä¿¡æ¯ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">Screen myScreen, *pScreen &#x3D; &amp;myScreen;auto s &#x3D; myScreen.*pdata;s &#x3D; pScreen-&gt;*pdata;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æˆå‘˜å‡½æ•°æŒ‡é’ˆ"><a href="#æˆå‘˜å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="æˆå‘˜å‡½æ•°æŒ‡é’ˆ"></a>æˆå‘˜å‡½æ•°æŒ‡é’ˆ</h3><ul><li>å› ä¸ºå‡½æ•°è°ƒç”¨è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ‰€ä»¥åœ¨å£°æ˜æŒ‡å‘æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆå¹¶ä½¿ç”¨è¿™äº›çš„æŒ‡é’ˆè¿›è¡Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œæ‹¬å·å¿…ä¸å¯å°‘ï¼š<code>(C::*p)(parms)</code>å’Œ<code>(obj.*p)(args)</code>ã€‚</li></ul><h3 id="å°†æˆå‘˜å‡½æ•°ç”¨ä½œå¯è°ƒç”¨å¯¹è±¡"><a href="#å°†æˆå‘˜å‡½æ•°ç”¨ä½œå¯è°ƒç”¨å¯¹è±¡" class="headerlink" title="å°†æˆå‘˜å‡½æ•°ç”¨ä½œå¯è°ƒç”¨å¯¹è±¡"></a>å°†æˆå‘˜å‡½æ•°ç”¨ä½œå¯è°ƒç”¨å¯¹è±¡</h3><h2 id="åµŒå¥—ç±»"><a href="#åµŒå¥—ç±»" class="headerlink" title="åµŒå¥—ç±»"></a>åµŒå¥—ç±»</h2><ul><li>ä¸€ä¸ªç±»å¯ä»¥å®šä¹‰åœ¨å¦ä¸€ä¸ªç±»çš„å†…éƒ¨ï¼Œå‰è€…ç§°ä¸ºåµŒå¥—ç±»(nested class)æˆ–åµŒå¥—ç±»å‹(nested type)ã€‚<strong>åµŒå¥—ç±»å¸¸ç”¨äºå®šä¹‰ä½œä¸ºå®ç°éƒ¨åˆ†çš„ç±»</strong>ã€‚</li><li>åµŒå¥—ç±»æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç±»ï¼Œä¸å¤–å±‚ç±»åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¤–å±‚ç±»çš„å¯¹è±¡å’ŒåµŒå¥—ç±»çš„å¯¹è±¡æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</li><li>åµŒå¥—ç±»çš„åå­—åœ¨å¤–å±‚ç±»ä½œç”¨åŸŸä¸­æ˜¯å¯è§çš„ï¼Œåœ¨å¤–å±‚ç±»ä½œç”¨åŸŸä¹‹å¤–ä¸å¯è§ã€‚</li></ul><h2 id="unionï¼šä¸€ç§èŠ‚çœç©ºé—´çš„ç±»"><a href="#unionï¼šä¸€ç§èŠ‚çœç©ºé—´çš„ç±»" class="headerlink" title="unionï¼šä¸€ç§èŠ‚çœç©ºé—´çš„ç±»"></a>unionï¼šä¸€ç§èŠ‚çœç©ºé—´çš„ç±»</h2><ul><li><code>è”åˆ(union)</code>æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ã€‚ä¸€ä¸ª<code>union</code>å¯ä»¥æœ‰å¤šä¸ªæ•°æ®æˆå‘˜ï¼Œä½†æ˜¯åœ¨ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªæ•°æ®æˆå‘˜å¯ä»¥æœ‰å€¼ã€‚<strong>å®ƒä¸èƒ½å«æœ‰å¼•ç”¨ç±»å‹çš„æˆå‘˜å’Œè™šå‡½æ•°</strong>ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">&#x2F;&#x2F; Tokenç±»å‹çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªæˆå‘˜ï¼Œè¯¥æˆå‘˜çš„ç±»å‹å¯èƒ½æ˜¯ä¸‹åˆ—ç±»å‹ä¸­çš„ä»»æ„ä¸€ç§union Token &#123;    &#x2F;&#x2F; é»˜è®¤æƒ…å†µä¸‹æˆå‘˜æ˜¯å…±æœ‰çš„    char cval;    int ival;    double dval;&#125;ï¼›<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>åŒ¿åunion(anonymous union)</code>æ˜¯ä¸€ä¸ªæœªå‘½åçš„<code>union</code>ï¼Œå¹¶ä¸”åœ¨å³èŠ±æ‹¬å·å’Œåˆ†å·ä¹‹é—´æ²¡æœ‰ä»»ä½•å£°æ˜ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">union &#123;    char cval;    int ival;    double dval;&#125;;&#x2F;&#x2F; å¯ä»¥ç›´æ¥è®¿é—®å®ƒçš„æˆå‘˜cal &#x3D; &#39;c&#39;;ival &#x3D; 42;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æ³¨æ„ï¼š</strong> <code>åŒ¿åunion</code>ä¸èƒ½åŒ…å«å—ä¿æŠ¤çš„æˆå‘˜æˆ–ç§æœ‰æˆå‘˜ï¼Œä¹Ÿä¸èƒ½å®šä¹‰æˆå‘˜å‡½æ•°ã€‚</li></ul><h2 id="å±€éƒ¨ç±»"><a href="#å±€éƒ¨ç±»" class="headerlink" title="å±€éƒ¨ç±»"></a>å±€éƒ¨ç±»</h2><ul><li><code>å±€éƒ¨ç±»(local class)</code>ï¼šå¯ä»¥å®šä¹‰åœ¨æŸä¸ªå‡½æ•°çš„å†…éƒ¨çš„ç±»ã€‚å®ƒçš„ç±»å‹åªåœ¨å®šä¹‰å®ƒçš„ä½œç”¨åŸŸå†…å¯è§ã€‚å’ŒåµŒå¥—ç±»ä¸åŒï¼Œå±€éƒ¨ç±»çš„æˆå‘˜å—åˆ°ä¸¥æ ¼é™åˆ¶ã€‚</li><li>å±€éƒ¨ç±»çš„æ‰€æœ‰æˆå‘˜(åŒ…æ‹¬å‡½æ•°åœ¨å†…)éƒ½å¿…é¡»å®Œæ•´å®šä¹‰åœ¨ç±»çš„å†…éƒ¨ã€‚å› æ­¤ï¼Œå±€éƒ¨ç±»çš„ä½œç”¨ä¸åµŒå¥—ç±»ç›¸æ¯”ç›¸å·®å¾ˆè¿œã€‚</li><li><strong>å±€éƒ¨ç±»ä¸èƒ½ä½¿ç”¨å‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡ã€‚</strong></li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">int a, val;void foo(int val) &#123;    static inti si;    enum loc &#123; a &#x3D; 1024, b&#125;;    &#x2F;&#x2F; Baræ˜¯fooçš„å±€éƒ¨ç±»    struct Bar &#123;        Loc locVal; &#x2F;&#x2F; æ­£ç¡®ï¼šä½¿ç”¨ä¸€ä¸ªå±€éƒ¨ç±»å‹å        int barVal;        void fooBar(Loc l &#x3D; a) &#123;    &#x2F;&#x2F; æ­£ç¡®ï¼šé»˜è®¤å®å‚æ˜¯Loc::a            barVal &#x3D; val;   &#x2F;&#x2F; é”™è¯¯ï¼švalæ˜¯fooçš„å±€éƒ¨å˜é‡            barVal &#x3D;&#x3D; ::val;    &#x2F;&#x2F; æ­£ç¡®ï¼šä½¿ç”¨ä¸€ä¸ªå…¨å±€å¯¹è±¡            barVal &#x3D; si;    &#x2F;&#x2F; æ­£ç¡®ï¼šä½¿ç”¨ä¸€ä¸ªé™æ€å±€éƒ¨å¯¹è±¡            locVal &#x3D; b; &#x2F;&#x2F; æ­£ç¡®ï¼šä½¿ç”¨ä¸€ä¸ªæšä¸¾æˆå‘˜        &#125;    &#125;ï¼›&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å›ºæœ‰çš„ä¸å¯ç§»æ¤çš„ç‰¹æ€§"><a href="#å›ºæœ‰çš„ä¸å¯ç§»æ¤çš„ç‰¹æ€§" class="headerlink" title="å›ºæœ‰çš„ä¸å¯ç§»æ¤çš„ç‰¹æ€§"></a>å›ºæœ‰çš„ä¸å¯ç§»æ¤çš„ç‰¹æ€§</h2><p>æ‰€è°“ä¸å¯ç§»æ¤çš„ç‰¹æ€§æ˜¯æŒ‡<strong>å› æœºå™¨è€Œå¼‚çš„ç‰¹æ€§</strong>ï¼Œå½“å°†å«æœ‰ä¸å¯ç§»æ¤ç‰¹æ€§çš„ç¨‹åºä»ä¸€å°æœºå™¨è½¬ç§»åˆ°å¦ä¸€å°æœºå™¨ä¸Šæ—¶ï¼Œé€šå¸¸éœ€è¦é‡æ–°ç¼–å†™è¯¥ç¨‹åºã€‚</p><h3 id="ä½åŸŸ"><a href="#ä½åŸŸ" class="headerlink" title="ä½åŸŸ"></a>ä½åŸŸ</h3><ul><li>ç±»å¯ä»¥å°†å…¶(éé™æ€)æ•°æ®æˆå‘˜å®šä¹‰æˆ**ä½åŸŸ(bit-field)**ï¼Œåœ¨ä¸€ä¸ªä½åŸŸä¸­å«æœ‰ä¸€å®šæ•°é‡çš„äºŒè¿›åˆ¶ä½ã€‚å½“ä¸€ä¸ªç¨‹åºéœ€è¦å‘å…¶ä»–ç¨‹åºæˆ–ç¡¬ä»¶è®¾å¤‡ä¼ é€’äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ°ä½åŸŸã€‚</li><li>ä½åŸŸåœ¨å†…å­˜ä¸­çš„å¸ƒå±€æ˜¯ä¸æœºå™¨ç›¸å…³çš„ã€‚</li><li>ä½åŸŸçš„ç±»å‹å¿…é¡»æ˜¯æ•´å‹æˆ–æšä¸¾ç±»å‹ã€‚å› ä¸ºå¸¦ç¬¦å·ä½åŸŸçš„è¡Œä¸ºæ˜¯ç”±å…·ä½“å®ç°ç¡®å®šçš„ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨æ— ç¬¦å·ç±»å‹ä¿å­˜ä¸€ä¸ªä½åŸŸã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">typedef unsigned int Bit;class File &#123;    Bit mode: 2;    Bit modified: 1;    Bit prot_owner: 3;    Bit prot_group: 3;    Bit prot_world: 3;public:    enum modes &#123;READ &#x3D; 01, WRITE &#x3D; 02, EXECUTE &#x3D; 03&#125;;    File &amp;open(modes);    void close();    void write();    bool isRead() const;    void setWrite();&#125;&#x2F;&#x2F; ä½¿ç”¨ä½åŸŸvoid File::write() &#123;    modified &#x3D; 1;    &#x2F;&#x2F; ...&#125;void File::close() &#123;    if( modified)        &#x2F;&#x2F; ...ä¿å­˜å†…å®¹&#125;File &amp;File::open(File::modes m) &#123;    mode |&#x3D; READ;   &#x2F;&#x2F; æŒ‰é»˜è®¤æ–¹å¼è®¾ç½®READ    &#x2F;&#x2F; å…¶ä»–å¤„ç†    if(m &amp; WRITE)   &#x2F;&#x2F; å¦‚æœæ‰“å¼€äº†READå’ŒWRITE        &#x2F;&#x2F; æŒ‰ç…§è¯»&#x2F;å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶    return *this;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="volatileé™å®šç¬¦"><a href="#volatileé™å®šç¬¦" class="headerlink" title="volatileé™å®šç¬¦"></a>volatileé™å®šç¬¦</h3><ul><li>å½“å¯¹è±¡çš„å€¼å¯èƒ½åœ¨ç¨‹åºçš„æ§åˆ¶æˆ–æ£€æµ‹ä¹‹å¤–è¢«æ”¹å˜æ—¶ï¼Œåº”è¯¥å°†è¯¥å¯¹è±¡å£°æ˜ä¸º<code>volatile</code>ã€‚å…³é”®å­—<code>volatile</code>å‘Šè¯‰ç¼–è¯‘å™¨ä¸åº”å¯¹è¿™æ ·çš„å¯¹è±¡è¿›è¡Œä¼˜åŒ–ã€‚</li><li><code>const</code>å’Œ<code>volatile</code>çš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯ä¸èƒ½ä½¿ç”¨åˆæˆçš„æ‹·è´/ç§»åŠ¨æ„é€ å‡½æ•°åŠèµ‹å€¼è¿ç®—ç¬¦åˆå§‹åŒ–<code>volatile</code>å¯¹è±¡æˆ–è€…ä»<code>volatile</code>å¯¹è±¡èµ‹å€¼ã€‚</li></ul><h3 id="é“¾æ¥æŒ‡ç¤ºï¼šextern-â€œCâ€"><a href="#é“¾æ¥æŒ‡ç¤ºï¼šextern-â€œCâ€" class="headerlink" title="é“¾æ¥æŒ‡ç¤ºï¼šextern â€œCâ€"></a>é“¾æ¥æŒ‡ç¤ºï¼šextern â€œCâ€</h3><ul><li><code>C++</code>ä½¿ç”¨<code>é“¾æ¥æŒ‡ç¤º(linkage directive)</code>æŒ‡å‡ºä»»æ„é<code>C++</code>å‡½æ•°æ‰€ç”¨çš„è¯­è¨€ã€‚</li><li>è¦æƒ³æŠŠ<code>C++</code>ä»£ç å’Œå…¶ä»–è¯­è¨€(åŒ…æ‹¬<code>C</code>è¯­è¨€)ç¼–å†™çš„ä»£ç æ”¾åœ¨ä¸€èµ·ä½¿ç”¨ï¼Œè¦æ±‚æˆ‘ä»¬å¿…é¡»æœ‰æƒè®¿é—®è¯¥è¯­è¨€çš„ç¼–è¯‘å™¨ï¼Œå¹¶ä¸”è¿™ä¸ªç¼–è¯‘å™¨ä¸å½“å‰çš„<code>C++</code>ç¼–è¯‘å™¨æ˜¯å…¼å®¹çš„ã€‚</li><li><code>C++</code>ä»Cè¯­è¨€ç»§æ‰¿çš„æ ‡å‡†åº“å‡½æ•°å¯ä»¥å®šä¹‰ä¸º<code>C</code>å‡½æ•°ï¼Œä½†å¹¶éå¿…é¡»ï¼šå†³å®šä½¿ç”¨<code>C</code>è¿˜æ˜¯<code>C++</code>å®ç°çš„<code>C</code>æ ‡å‡†åº“ï¼Œæ˜¯æ¯ä¸ª<code>C++</code>å®ç°çš„äº‹æƒ…ã€‚</li><li>æœ‰æ—¶éœ€è¦åœ¨Cå’ŒC++ä¸­ç¼–è¯‘åŒä¸€ä¸ªæºæ–‡ä»¶ï¼Œä¸ºäº†å®ç°è¿™ä¸€ç›®çš„ï¼Œåœ¨ç¼–è¯‘C++ç‰ˆæœ¬çš„ç¨‹åºæ—¶é¢„å¤„ç†å™¨å®šä¹‰<code>__cplusplus</code>ã€‚</li></ul><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#ifdef __cplusplusextern &quot;C&quot;#endifint strcmp(const char*, const char*);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°16</title>
      <link href="2021/04/10/notes/ch16/"/>
      <url>2021/04/10/notes/ch16/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå…­ç« -æ¨¡æ¿å’Œæ³›å‹ç¼–ç¨‹"><a href="#ç¬¬åå…­ç« -æ¨¡æ¿å’Œæ³›å‹ç¼–ç¨‹" class="headerlink" title="ç¬¬åå…­ç«  æ¨¡æ¿å’Œæ³›å‹ç¼–ç¨‹"></a>ç¬¬åå…­ç«  æ¨¡æ¿å’Œæ³›å‹ç¼–ç¨‹</h1><ul><li>é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œæ³›å‹ç¼–ç¨‹éƒ½èƒ½å¤„ç†åœ¨ç¼–å†™ç¨‹åºæ—¶ä¸çŸ¥é“ç±»å‹çš„æƒ…å†µã€‚<ul><li>OOPèƒ½å¤„ç†ç±»å‹åœ¨ç¨‹åºè¿è¡Œä¹‹å‰éƒ½æœªçŸ¥çš„æƒ…å†µï¼›</li><li>æ³›å‹ç¼–ç¨‹ä¸­ï¼Œåœ¨ç¼–è¯‘æ—¶å°±å¯ä»¥è·çŸ¥ç±»å‹ã€‚</li></ul></li></ul><h2 id="å®šä¹‰æ¨¡æ¿"><a href="#å®šä¹‰æ¨¡æ¿" class="headerlink" title="å®šä¹‰æ¨¡æ¿"></a>å®šä¹‰æ¨¡æ¿</h2><ul><li><strong>æ¨¡æ¿</strong>ï¼šæ¨¡æ¿æ˜¯æ³›å‹ç¼–ç¨‹çš„åŸºç¡€ã€‚ä¸€ä¸ªæ¨¡æ¿å°±æ˜¯ä¸€ä¸ªåˆ›å»ºç±»æˆ–å‡½æ•°çš„è“å›¾æˆ–è€…è¯´å…¬å¼ã€‚</li></ul><h3 id="å‡½æ•°æ¨¡æ¿"><a href="#å‡½æ•°æ¨¡æ¿" class="headerlink" title="å‡½æ•°æ¨¡æ¿"></a>å‡½æ•°æ¨¡æ¿</h3><ul><li><code>template &lt;typename T&gt; int compare(const T &amp;v1, const T &amp;v2)&#123;&#125;</code></li><li>æ¨¡æ¿å®šä¹‰ä»¥å…³é”®å­— <code>template</code>å¼€å§‹ï¼Œåæ¥<strong>æ¨¡æ¿å½¢å‚è¡¨</strong>ï¼Œæ¨¡æ¿å½¢å‚è¡¨æ˜¯ç”¨<strong>å°–æ‹¬å·</strong><code>&lt;&gt;</code>æ‹¬ä½çš„ä¸€ä¸ªæˆ–å¤šä¸ª<strong>æ¨¡æ¿å½¢å‚</strong>çš„åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”ï¼Œ<strong>ä¸èƒ½ä¸ºç©º</strong>ã€‚</li><li>ä½¿ç”¨æ¨¡æ¿æ—¶ï¼Œæˆ‘ä»¬æ˜¾å¼æˆ–éšå¼åœ°æŒ‡å®šæ¨¡æ¿å®å‚ï¼Œå°†å…¶ç»‘å®šåˆ°æ¨¡æ¿å‚æ•°ä¸Šã€‚</li><li>æ¨¡æ¿ç±»å‹å‚æ•°ï¼šç±»å‹å‚æ•°å‰å¿…é¡»ä½¿ç”¨å…³é”®å­—<code>class</code>æˆ–è€…<code>typename</code>ï¼Œè¿™ä¸¤ä¸ªå…³é”®å­—å«ä¹‰ç›¸åŒï¼Œå¯ä»¥äº’æ¢ä½¿ç”¨ã€‚æ—§çš„ç¨‹åºåªèƒ½ä½¿ç”¨<code>class</code>ã€‚</li><li>éç±»å‹æ¨¡æ¿å‚æ•°ï¼šè¡¨ç¤ºä¸€ä¸ªå€¼è€Œéä¸€ä¸ªç±»å‹ã€‚å®å‚å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ã€‚<code>template &lt;class T, size_t N&gt; void array_init(T (&amp;parm)[N])&#123;&#125;</code></li><li>å†…è”å‡½æ•°æ¨¡æ¿ï¼š <code>template &lt;typename T&gt; inline T min(const T&amp;, const T&amp;);</code></li><li>æ¨¡æ¿ç¨‹åºåº”è¯¥å°½é‡å‡å°‘å¯¹å®å‚ç±»å‹çš„è¦æ±‚ã€‚</li><li>å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿æˆå‘˜å‡½æ•°çš„å®šä¹‰é€šå¸¸æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ã€‚</li></ul><h3 id="ç±»æ¨¡æ¿"><a href="#ç±»æ¨¡æ¿" class="headerlink" title="ç±»æ¨¡æ¿"></a>ç±»æ¨¡æ¿</h3><ul><li>ç±»æ¨¡æ¿ç”¨äºç”Ÿæˆç±»çš„è“å›¾ã€‚</li><li>ä¸åŒäºå‡½æ•°æ¨¡æ¿ï¼Œç¼–è¯‘å™¨ä¸èƒ½æ¨æ–­æ¨¡æ¿å‚æ•°ç±»å‹ã€‚</li><li><strong>å®šä¹‰ç±»æ¨¡æ¿</strong>ï¼š<ul><li><code>template &lt;class Type&gt; class Queue &#123;&#125;;</code></li></ul></li><li>å®ä¾‹åŒ–ç±»æ¨¡æ¿ï¼šæä¾›æ˜¾å¼æ¨¡æ¿å®å‚åˆ—è¡¨ï¼Œæ¥å®ä¾‹åŒ–å‡ºç‰¹å®šçš„ç±»ã€‚</li><li>ä¸€ä¸ªç±»æ¨¡æ¿ä¸­æ‰€æœ‰çš„å®ä¾‹éƒ½å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„ç±»ã€‚</li><li><strong>æ¨¡æ¿å½¢å‚ä½œç”¨åŸŸ</strong>ï¼šæ¨¡æ¿å½¢å‚çš„åå­—å¯ä»¥åœ¨å£°æ˜ä¸ºæ¨¡æ¿å½¢å‚ä¹‹åç›´åˆ°æ¨¡æ¿å£°æ˜æˆ–å®šä¹‰çš„æœ«å°¾å¤„ä½¿ç”¨ã€‚</li><li>ç±»æ¨¡æ¿çš„æˆå‘˜å‡½æ•°ï¼š<ul><li><code>template &lt;typename T&gt; ret-type Blob::member-name(parm-list)</code></li></ul></li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºä¸€ä¸ªå®ä¾‹åŒ–äº†çš„ç±»æ¨¡æ¿ï¼Œå…¶æˆå‘˜åªæœ‰åœ¨ä½¿ç”¨æ—¶æ‰è¢«å®ä¾‹åŒ–ã€‚</li><li>æ–°æ ‡å‡†å…è®¸æ¨¡æ¿å°†è‡ªå·±çš„ç±»å‹å‚æ•°æˆä¸ºå‹å…ƒã€‚<code>template &lt;typename T&gt; class Bar&#123;friend T;&#125;;</code>ã€‚</li><li>æ¨¡æ¿ç±»å‹åˆ«åï¼šå› ä¸ºæ¨¡æ¿ä¸æ˜¯ä¸€ä¸ªç±»å‹ï¼Œå› æ­¤æ— æ³•å®šä¹‰ä¸€ä¸ª<code>typedef</code>å¼•ç”¨ä¸€ä¸ªæ¨¡æ¿ï¼Œä½†æ˜¯æ–°æ ‡å‡†å…è®¸æˆ‘ä»¬ä¸ºç±»æ¨¡æ¿å®šä¹‰ä¸€ä¸ªç±»å‹åˆ«åï¼š<code>template&lt;typename T&gt; using twin = pair&lt;T, T&gt;;</code></li></ul><h3 id="æ¨¡æ¿å‚æ•°"><a href="#æ¨¡æ¿å‚æ•°" class="headerlink" title="æ¨¡æ¿å‚æ•°"></a>æ¨¡æ¿å‚æ•°</h3><ul><li>æ¨¡æ¿å‚æ•°ä¸ä½œç”¨åŸŸï¼šä¸€ä¸ªæ¨¡æ¿å‚æ•°åçš„å¯ç”¨èŒƒå›´æ˜¯åœ¨å£°æ˜ä¹‹åï¼Œè‡³æ¨¡æ¿å£°æ˜æˆ–å®šä¹‰ç»“æŸå‰ã€‚</li><li>ä¸€ä¸ªç‰¹å®šæ–‡ä»¶æ‰€éœ€è¦çš„æ‰€æœ‰æ¨¡æ¿çš„å£°æ˜é€šå¸¸ä¸€èµ·æ”¾ç½®åœ¨æ–‡ä»¶å¼€å§‹ä½ç½®ã€‚</li><li>å½“æˆ‘ä»¬å¸Œæœ›é€šçŸ¥ç¼–è¯‘å™¨ä¸€ä¸ªåå­—è¡¨ç¤ºç±»å‹æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å…³é”®å­—<code>typename</code>ï¼Œè€Œä¸èƒ½ä½¿ç”¨<code>class</code>ã€‚</li><li>é»˜è®¤æ¨¡æ¿å®å‚ï¼š<code>template &lt;class T = int&gt; class Numbers&#123;&#125;</code></li></ul><h3 id="æˆå‘˜æ¨¡æ¿"><a href="#æˆå‘˜æ¨¡æ¿" class="headerlink" title="æˆå‘˜æ¨¡æ¿"></a>æˆå‘˜æ¨¡æ¿</h3><ul><li>æˆå‘˜æ¨¡æ¿ï¼ˆmember templateï¼‰ï¼šæœ¬èº«æ˜¯æ¨¡æ¿çš„å‡½æ•°æˆå‘˜ã€‚<ul><li>æ™®é€šï¼ˆéæ¨¡æ¿ï¼‰ç±»çš„æˆå‘˜æ¨¡æ¿ã€‚</li><li>ç±»æ¨¡æ¿çš„æˆå‘˜æ¨¡æ¿ã€‚</li></ul></li></ul><h3 id="æ§åˆ¶å®ä¾‹åŒ–"><a href="#æ§åˆ¶å®ä¾‹åŒ–" class="headerlink" title="æ§åˆ¶å®ä¾‹åŒ–"></a>æ§åˆ¶å®ä¾‹åŒ–</h3><ul><li>åŠ¨æœºï¼šåœ¨å¤šä¸ªæ–‡ä»¶ä¸­å®ä¾‹åŒ–ç›¸åŒæ¨¡æ¿çš„é¢å¤–å¼€é”€å¯èƒ½éå¸¸ä¸¥é‡ã€‚</li><li>æ˜¾å¼å®ä¾‹åŒ–ï¼š<ul><li><code>extern template declaration;  // å®ä¾‹åŒ–å£°æ˜</code></li><li><code>template declaration;  // å®ä¾‹åŒ–å®šä¹‰</code></li></ul></li></ul><h3 id="æ•ˆç‡ä¸çµæ´»æ€§"><a href="#æ•ˆç‡ä¸çµæ´»æ€§" class="headerlink" title="æ•ˆç‡ä¸çµæ´»æ€§"></a>æ•ˆç‡ä¸çµæ´»æ€§</h3><h2 id="æ¨¡æ¿å®å‚æ¨æ–­"><a href="#æ¨¡æ¿å®å‚æ¨æ–­" class="headerlink" title="æ¨¡æ¿å®å‚æ¨æ–­"></a>æ¨¡æ¿å®å‚æ¨æ–­</h2><ul><li>å¯¹å‡½æ•°æ¨¡æ¿ï¼Œç¼–è¯‘å™¨åˆ©ç”¨è°ƒç”¨ä¸­çš„å‡½æ•°å®å‚æ¥ç¡®å®šå…¶æ¨¡æ¿å‚æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹å«<strong>æ¨¡æ¿å®å‚æ¨æ–­</strong>ã€‚</li></ul><h3 id="ç±»å‹è½¬æ¢ä¸æ¨¡æ¿ç±»å‹å‚æ•°"><a href="#ç±»å‹è½¬æ¢ä¸æ¨¡æ¿ç±»å‹å‚æ•°" class="headerlink" title="ç±»å‹è½¬æ¢ä¸æ¨¡æ¿ç±»å‹å‚æ•°"></a>ç±»å‹è½¬æ¢ä¸æ¨¡æ¿ç±»å‹å‚æ•°</h3><ul><li>èƒ½å¤Ÿè‡ªåŠ¨è½¬æ¢ç±»å‹çš„åªæœ‰ï¼š<ul><li>å’Œå…¶ä»–å‡½æ•°ä¸€æ ·ï¼Œé¡¶å±‚<code>const</code>ä¼šè¢«å¿½ç•¥ã€‚</li><li>æ•°ç»„å®å‚æˆ–å‡½æ•°å®å‚è½¬æ¢ä¸ºæŒ‡é’ˆã€‚</li></ul></li></ul><h3 id="å‡½æ•°æ¨¡æ¿æ˜¾å¼å®å‚"><a href="#å‡½æ•°æ¨¡æ¿æ˜¾å¼å®å‚" class="headerlink" title="å‡½æ•°æ¨¡æ¿æ˜¾å¼å®å‚"></a>å‡½æ•°æ¨¡æ¿æ˜¾å¼å®å‚</h3><ul><li>æŸäº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨æ— æ³•æ¨æ–­å‡ºæ¨¡æ¿å®å‚çš„ç±»å‹ã€‚</li><li>å®šä¹‰ï¼š<code>template &lt;typename T1, typename T2, typename T3&gt; T1 sum(T2, T3);</code></li><li>ä½¿ç”¨å‡½æ•°æ˜¾å¼å®å‚è°ƒç”¨ï¼š<code>auto val3 = sum&lt;long long&gt;(i, lng); // T1æ˜¯æ˜¾å¼æŒ‡å®šï¼ŒT2å’ŒT3éƒ½æ˜¯ä»å‡½æ•°å®å‚ç±»å‹æ¨æ–­è€Œæ¥</code></li><li><strong>æ³¨æ„</strong>ï¼šæ­£å¸¸ç±»å‹è½¬æ¢å¯ä»¥åº”ç”¨äºæ˜¾å¼æŒ‡å®šçš„å®å‚ã€‚</li></ul><h3 id="å°¾ç½®è¿”å›ç±»å‹ä¸ç±»å‹è½¬æ¢"><a href="#å°¾ç½®è¿”å›ç±»å‹ä¸ç±»å‹è½¬æ¢" class="headerlink" title="å°¾ç½®è¿”å›ç±»å‹ä¸ç±»å‹è½¬æ¢"></a>å°¾ç½®è¿”å›ç±»å‹ä¸ç±»å‹è½¬æ¢</h3><ul><li>ä½¿ç”¨åœºæ™¯ï¼šå¹¶ä¸æ¸…æ¥šè¿”å›ç»“æœçš„å‡†ç¡®ç±»å‹ï¼Œä½†çŸ¥é“æ‰€éœ€ç±»å‹æ˜¯å’Œå‚æ•°ç›¸å…³çš„ã€‚</li><li><code>template &lt;typename It&gt; auto fcn(It beg, It end) -&gt; decltype(*beg)</code></li><li>å°¾ç½®è¿”å›å…è®¸æˆ‘ä»¬åœ¨å‚æ•°åˆ—è¡¨ä¹‹åå£°æ˜è¿”å›ç±»å‹ã€‚</li></ul><p>æ ‡å‡†åº“çš„<strong>ç±»å‹è½¬æ¢</strong>æ¨¡æ¿ï¼š</p><ul><li>å®šä¹‰åœ¨å¤´æ–‡ä»¶<code>type_traits</code>ä¸­ã€‚</li></ul><table><thead><tr><th>å¯¹<code>Mod&lt;T&gt;</code>ï¼Œå…¶ä¸­<code>Mod</code>æ˜¯ï¼š</th><th>è‹¥<code>T</code>æ˜¯ï¼š</th><th>åˆ™<code>Mod&lt;T&gt;::type</code>æ˜¯ï¼š</th></tr></thead><tbody><tr><td><code>remove_reference</code></td><td><code>X&amp;</code>æˆ–<code>X&amp;&amp;</code></td><td><code>X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr><tr><td><code>add_const</code></td><td><code>X&amp;</code>æˆ–<code>const X</code>æˆ–å‡½æ•°</td><td><code>T</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>const T</code></td></tr><tr><td><code>add_lvalue_reference</code></td><td><code>X&amp;</code></td><td><code>T</code></td></tr><tr><td></td><td><code>X&amp;&amp;</code></td><td><code>X&amp;</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T&amp;</code></td></tr><tr><td><code>add_rvalue_reference</code></td><td><code>X&amp;</code>æˆ–<code>X&amp;&amp;</code></td><td><code>T</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T&amp;&amp;</code></td></tr><tr><td><code>remove_pointer</code></td><td><code>X*</code></td><td><code>X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr><tr><td><code>add_pointer</code></td><td><code>X&amp;</code>æˆ–<code>X&amp;&amp;</code></td><td><code>X*</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T*</code></td></tr><tr><td><code>make_signed</code></td><td><code>unsigned X</code></td><td><code>X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr><tr><td><code>make_unsigned</code></td><td>å¸¦ç¬¦å·ç±»å‹</td><td><code>unsigned X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr><tr><td><code>remove_extent</code></td><td><code>X[n]</code></td><td><code>X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr><tr><td><code>remove_all_extents</code></td><td><code>X[n1][n2]...</code></td><td><code>X</code></td></tr><tr><td></td><td>å¦åˆ™</td><td><code>T</code></td></tr></tbody></table><h3 id="å‡½æ•°æŒ‡é’ˆå’Œå®å‚æ¨æ–­"><a href="#å‡½æ•°æŒ‡é’ˆå’Œå®å‚æ¨æ–­" class="headerlink" title="å‡½æ•°æŒ‡é’ˆå’Œå®å‚æ¨æ–­"></a>å‡½æ•°æŒ‡é’ˆå’Œå®å‚æ¨æ–­</h3><ul><li>å½“ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æ¨¡æ¿åˆå§‹åŒ–ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæˆ–ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆèµ‹å€¼æ—¶ï¼Œç¼–è¯‘å™¨ä½¿ç”¨æŒ‡é’ˆçš„ç±»å‹æ¥æ¨æ–­æ¨¡æ¿å®å‚ã€‚</li></ul><h3 id="æ¨¡æ¿å®å‚æ¨æ–­å’Œå¼•ç”¨"><a href="#æ¨¡æ¿å®å‚æ¨æ–­å’Œå¼•ç”¨" class="headerlink" title="æ¨¡æ¿å®å‚æ¨æ–­å’Œå¼•ç”¨"></a>æ¨¡æ¿å®å‚æ¨æ–­å’Œå¼•ç”¨</h3><ul><li>ä»å·¦å€¼å¼•ç”¨å‡½æ•°æ¨æ–­ç±»å‹ï¼šè‹¥å½¢å¦‚<code>T&amp;</code>ï¼Œåˆ™åªèƒ½ä¼ é€’ç»™å®ƒä¸€ä¸ªå·¦å€¼ã€‚ä½†å¦‚æœæ˜¯<code>const T&amp;</code>ï¼Œåˆ™å¯ä»¥æ¥å—ä¸€ä¸ªå³å€¼ã€‚</li><li>ä»å³å€¼å¼•ç”¨å‡½æ•°æ¨æ–­ç±»å‹ï¼šè‹¥å½¢å¦‚<code>T&amp;&amp;</code>ï¼Œåˆ™åªèƒ½ä¼ é€’ç»™å®ƒä¸€ä¸ªå³å€¼ã€‚</li><li>å¼•ç”¨æŠ˜å å’Œå³å€¼å¼•ç”¨å‚æ•°ï¼š<ul><li>è§„åˆ™1ï¼šå½“æˆ‘ä»¬å°†ä¸€ä¸ªå·¦å€¼ä¼ é€’ç»™å‡½æ•°çš„å³å€¼å¼•ç”¨å‚æ•°ï¼Œä¸”å³å€¼å¼•ç”¨æŒ‡å‘æ¨¡æ¿ç±»å‹å‚æ•°æ—¶ï¼ˆå¦‚<code>T&amp;&amp;</code>ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šæ¨æ–­æ¨¡æ¿ç±»å‹å‚æ•°ä¸ºå®å‚çš„å·¦å€¼å¼•ç”¨ç±»å‹ã€‚</li><li>è§„åˆ™2ï¼šå¦‚æœæˆ‘ä»¬é—´æ¥åˆ›é€ ä¸€ä¸ªå¼•ç”¨çš„å¼•ç”¨ï¼Œåˆ™è¿™äº›å¼•ç”¨å½¢æˆäº†<strong>æŠ˜å </strong>ã€‚æŠ˜å å¼•ç”¨åªèƒ½åº”ç”¨åœ¨é—´æ¥åˆ›é€ çš„å¼•ç”¨çš„å¼•ç”¨ï¼Œå¦‚ç±»å‹åˆ«åæˆ–æ¨¡æ¿å‚æ•°ã€‚å¯¹äºä¸€ä¸ªç»™å®šç±»å‹<code>X</code>ï¼š<ul><li><code>X&amp; &amp;</code>ã€<code>X&amp; &amp;&amp;</code>å’Œ<code>X&amp;&amp; &amp;</code>éƒ½æŠ˜å æˆç±»å‹<code>X&amp;</code>ã€‚</li><li>ç±»å‹<code>X&amp;&amp; &amp;&amp;</code>æŠ˜å æˆ<code>X&amp;&amp;</code>ã€‚</li></ul></li><li>ä¸Šé¢ä¸¤ä¸ªä¾‹å¤–è§„åˆ™å¯¼è‡´ä¸¤ä¸ªé‡è¦ç»“æœï¼š<ul><li>1.å¦‚æœä¸€ä¸ªå‡½æ•°å‚æ•°æ˜¯ä¸€ä¸ªæŒ‡å‘æ¨¡æ¿ç±»å‹å‚æ•°çš„å³å€¼å¼•ç”¨ï¼ˆå¦‚<code>T&amp;&amp;</code>ï¼‰ï¼Œåˆ™å®ƒå¯ä»¥è¢«ç»‘å®šåˆ°ä¸€ä¸ªå·¦å€¼ä¸Šï¼›</li><li>2.å¦‚æœå®å‚æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œåˆ™æ¨æ–­å‡ºçš„æ¨¡æ¿å®å‚ç±»å‹å°†æ˜¯ä¸€ä¸ªå·¦å€¼å¼•ç”¨ï¼Œä¸”å‡½æ•°å‚æ•°å°†è¢«å®ä¾‹åŒ–ä¸ºä¸€ä¸ªå·¦å€¼å¼•ç”¨å‚æ•°ï¼ˆ<code>T&amp;</code>ï¼‰ã€‚</li></ul></li></ul></li></ul><h3 id="ç†è§£std-move"><a href="#ç†è§£std-move" class="headerlink" title="ç†è§£std::move"></a>ç†è§£std::move</h3><ul><li>æ ‡å‡†åº“<code>move</code>å‡½æ•°æ˜¯ä½¿ç”¨å³å€¼å¼•ç”¨çš„æ¨¡æ¿çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚</li><li>ä»ä¸€ä¸ªå·¦å€¼<code>static_cast</code>åˆ°ä¸€ä¸ªå³å€¼å¼•ç”¨æ˜¯å…è®¸çš„ã€‚</li></ul><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">typename</span> <span class="token class-name">remove_reference</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span>type<span class="token operator">&amp;&amp;</span> <span class="token function">move</span><span class="token punctuation">(</span>T<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">remove_reference</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span>type<span class="token operator">&amp;&amp;</span><span class="token operator">></span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è½¬å‘"><a href="#è½¬å‘" class="headerlink" title="è½¬å‘"></a>è½¬å‘</h3><ul><li>ä½¿ç”¨ä¸€ä¸ªåä¸º<code>forward</code>çš„æ–°æ ‡å‡†åº“è®¾æ–½æ¥ä¼ é€’å‚æ•°ï¼Œå®ƒèƒ½å¤Ÿä¿æŒåŸå§‹å®å‚çš„ç±»å‹ã€‚</li><li>å®šä¹‰åœ¨å¤´æ–‡ä»¶<code>utility</code>ä¸­ã€‚</li><li>å¿…é¡»é€šè¿‡æ˜¾å¼æ¨¡æ¿å®å‚æ¥è°ƒç”¨ã€‚</li><li><code>forward</code>è¿”å›æ˜¾å¼å®å‚ç±»å‹çš„å³å€¼å¼•ç”¨ã€‚å³ï¼Œ<code>forward&lt;T&gt;</code>çš„è¿”å›ç±»å‹æ˜¯<code>T&amp;&amp;</code>ã€‚</li></ul><h2 id="é‡è½½ä¸æ¨¡æ¿"><a href="#é‡è½½ä¸æ¨¡æ¿" class="headerlink" title="é‡è½½ä¸æ¨¡æ¿"></a>é‡è½½ä¸æ¨¡æ¿</h2><ul><li>å¤šä¸ªå¯è¡Œæ¨¡æ¿ï¼šå½“æœ‰å¤šä¸ªé‡è½½æ¨¡æ¿å¯¹ä¸€ä¸ªè°ƒç”¨æä¾›åŒæ ·å¥½çš„åŒ¹é…æ—¶ï¼Œä¼šé€‰æ‹©æœ€ç‰¹ä¾‹åŒ–çš„ç‰ˆæœ¬ã€‚</li><li>éæ¨¡æ¿å’Œæ¨¡æ¿é‡è½½ï¼šå¯¹äºä¸€ä¸ªè°ƒç”¨ï¼Œå¦‚æœä¸€ä¸ªéå‡½æ•°æ¨¡æ¿ä¸ä¸€ä¸ªå‡½æ•°æ¨¡æ¿æä¾›åŒæ ·å¥½çš„åŒ¹é…ï¼Œåˆ™é€‰æ‹©éæ¨¡æ¿ç‰ˆæœ¬ã€‚</li></ul><h2 id="å¯å˜å‚æ•°æ¨¡æ¿"><a href="#å¯å˜å‚æ•°æ¨¡æ¿" class="headerlink" title="å¯å˜å‚æ•°æ¨¡æ¿"></a>å¯å˜å‚æ•°æ¨¡æ¿</h2><p><strong>å¯å˜å‚æ•°æ¨¡æ¿</strong>å°±æ˜¯ä¸€ä¸ªæ¥å—å¯å˜æ•°ç›®å‚æ•°çš„æ¨¡æ¿å‡½æ•°æˆ–æ¨¡æ¿ç±»ã€‚</p><ul><li>å¯å˜æ•°ç›®çš„å‚æ•°è¢«ç§°ä¸ºå‚æ•°åŒ…ã€‚<ul><li>æ¨¡æ¿å‚æ•°åŒ…ï¼šæ ‡è¯†å¦ä¸ªæˆ–å¤šä¸ªæ¨¡æ¿å‚æ•°ã€‚</li><li>å‡½æ•°å‚æ•°åŒ…ï¼šæ ‡è¯†å¦ä¸ªæˆ–è€…å¤šä¸ªå‡½æ•°å‚æ•°ã€‚</li></ul></li><li>ç”¨ä¸€ä¸ªçœç•¥å·æ¥æŒ‡å‡ºä¸€ä¸ªæ¨¡æ¿å‚æ•°æˆ–å‡½æ•°å‚æ•°ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒ…ã€‚</li><li><code>template &lt;typename T, typename... Args&gt;</code>ï¼Œ<code>Args</code>ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°åŒ…ã€‚</li><li><code>void foo(const T &amp;t, const Args&amp; ... rest);</code>ï¼Œ<code>rest</code>æ˜¯ä¸€ä¸ªå‡½æ•°å‚æ•°åŒ…ã€‚</li><li><code>sizeof...</code>è¿ç®—ç¬¦ï¼Œè¿”å›å‚æ•°çš„æ•°ç›®ã€‚</li></ul><h3 id="ç¼–å†™å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿"><a href="#ç¼–å†™å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿" class="headerlink" title="ç¼–å†™å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿"></a>ç¼–å†™å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿</h3><ul><li>å¯å˜å‚æ•°å‡½æ•°é€šå¸¸æ˜¯é€’å½’çš„ï¼šç¬¬ä¸€æ­¥è°ƒç”¨å¤„ç†åŒ…ä¸­çš„ç¬¬ä¸€ä¸ªå®å‚ï¼Œç„¶åç”¨å‰©ä½™å®å‚è°ƒç”¨è‡ªèº«ã€‚</li></ul><h3 id="åŒ…æ‰©å±•"><a href="#åŒ…æ‰©å±•" class="headerlink" title="åŒ…æ‰©å±•"></a>åŒ…æ‰©å±•</h3><ul><li>å¯¹äºä¸€ä¸ªå‚æ•°åŒ…ï¼Œé™¤äº†è·å–å®ƒçš„å¤§å°ï¼Œå”¯ä¸€èƒ½åšçš„äº‹æƒ…å°±æ˜¯<strong>æ‰©å±•</strong>ï¼ˆexpandï¼‰ã€‚</li><li>æ‰©å±•ä¸€ä¸ªåŒ…æ—¶ï¼Œè¿˜è¦æä¾›ç”¨äºæ¯ä¸ªæ‰©å±•å…ƒç´ çš„<strong>æ¨¡å¼</strong>ï¼ˆpatternï¼‰ã€‚</li></ul><h3 id="è½¬å‘å‚æ•°åŒ…"><a href="#è½¬å‘å‚æ•°åŒ…" class="headerlink" title="è½¬å‘å‚æ•°åŒ…"></a>è½¬å‘å‚æ•°åŒ…</h3><ul><li>æ–°æ ‡å‡†ä¸‹å¯ä»¥ç»„åˆä½¿ç”¨å¯å˜å‚æ•°æ¨¡æ¿å’Œ<code>forward</code>æœºåˆ¶ï¼Œå®ç°å°†å®å‚ä¸å˜åœ°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ã€‚</li></ul><h2 id="æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼ˆSpecializationsï¼‰"><a href="#æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼ˆSpecializationsï¼‰" class="headerlink" title="æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼ˆSpecializationsï¼‰"></a>æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼ˆSpecializationsï¼‰</h2><ul><li>å®šä¹‰å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼šå…³é”®å­—<code>template</code>åé¢è·Ÿä¸€ä¸ªç©ºå°–æ‹¬å·å¯¹ï¼ˆ<code>&lt;&gt;</code>ï¼‰ã€‚</li><li>ç‰¹ä¾‹åŒ–çš„æœ¬è´¨æ˜¯å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡æ¿ï¼Œè€Œä¸æ˜¯é‡è½½å®ƒã€‚ç‰¹ä¾‹åŒ–ä¸å½±å“å‡½æ•°åŒ¹é…ã€‚</li><li>æ¨¡æ¿åŠå…¶ç‰¹ä¾‹åŒ–ç‰ˆæœ¬åº”è¯¥å£°æ˜åœ¨åŒä¸€ä¸ªå¤´æ–‡ä»¶ä¸­ã€‚æ‰€æœ‰åŒåæ¨¡æ¿çš„å£°æ˜åº”è¯¥æ”¾åœ¨å‰é¢ï¼Œç„¶åæ˜¯ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ã€‚</li><li>æˆ‘ä»¬å¯ä»¥éƒ¨åˆ†ç‰¹ä¾‹åŒ–ç±»æ¨¡æ¿ï¼Œä½†ä¸èƒ½éƒ¨åˆ†ç‰¹ä¾‹åŒ–å‡½æ•°æ¨¡æ¿ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ2</title>
      <link href="2021/04/10/excersize/ch02/"/>
      <url>2021/04/10/excersize/ch02/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬äºŒç« -å˜é‡å’ŒåŸºæœ¬ç±»å‹"><a href="#ç¬¬äºŒç« -å˜é‡å’ŒåŸºæœ¬ç±»å‹" class="headerlink" title="ç¬¬äºŒç«  å˜é‡å’ŒåŸºæœ¬ç±»å‹"></a>ç¬¬äºŒç«  å˜é‡å’ŒåŸºæœ¬ç±»å‹</h1><h2 id="ç»ƒä¹ 2-1"><a href="#ç»ƒä¹ 2-1" class="headerlink" title="ç»ƒä¹ 2.1"></a>ç»ƒä¹ 2.1</h2><p>ç±»å‹ intã€longã€long long å’Œ short çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ— ç¬¦å·ç±»å‹å’Œå¸¦ç¬¦å·ç±»å‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿfloat å’Œ doubleçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>C++ è§„å®š short å’Œ int è‡³å°‘16ä½ï¼Œlong è‡³å°‘32ä½ï¼Œlong long è‡³å°‘64ä½ã€‚ å¸¦ç¬¦å·ç±»å‹èƒ½å¤Ÿè¡¨ç¤ºæ­£æ•°ã€è´Ÿæ•°å’Œ 0 ï¼Œè€Œæ— ç¬¦å·ç±»å‹åªèƒ½å¤Ÿè¡¨ç¤º 0 å’Œæ­£æ•´æ•°ã€‚</p><h2 id="ç»ƒä¹ 2-2"><a href="#ç»ƒä¹ 2-2" class="headerlink" title="ç»ƒä¹ 2.2"></a>ç»ƒä¹ 2.2</h2><p>è®¡ç®—æŒ‰æ­è´·æ¬¾æ—¶ï¼Œå¯¹äºåˆ©ç‡ã€æœ¬é‡‘å’Œä»˜æ¬¾åˆ†åˆ«åº”é€‰æ‹©ä½•ç§æ•°æ®ç±»å‹ï¼Ÿè¯´æ˜ä½ çš„ç†ç”±ã€‚</p><p>è§£ï¼š</p><p>ä½¿ç”¨<code>double</code>ã€‚éœ€è¦è¿›è¡Œæµ®ç‚¹è®¡ç®—ã€‚</p><h2 id="ç»ƒä¹ 2-3"><a href="#ç»ƒä¹ 2-3" class="headerlink" title="ç»ƒä¹ 2.3"></a>ç»ƒä¹ 2.3</h2><p>è¯»ç¨‹åºå†™ç»“æœã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> u <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> u2 <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> u2 <span class="token operator">-</span> u <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> u <span class="token operator">-</span> u2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> i2 <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i2 <span class="token operator">-</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">-</span> i2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">-</span> u <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> u <span class="token operator">-</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">32429496726432-3200<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-4"><a href="#ç»ƒä¹ 2-4" class="headerlink" title="ç»ƒä¹ 2.4"></a>ç»ƒä¹ 2.4</h2><p>ç¼–å†™ç¨‹åºæ£€æŸ¥ä½ çš„ä¼°è®¡æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®ï¼Œè¯·ä»”ç»†ç ”è¯»æœ¬èŠ‚ç›´åˆ°å¼„æ˜ç™½é—®é¢˜æ‰€åœ¨ã€‚</p><h2 id="ç»ƒä¹ 2-5"><a href="#ç»ƒä¹ 2-5" class="headerlink" title="ç»ƒä¹ 2.5"></a>ç»ƒä¹ 2.5</h2><p>æŒ‡å‡ºä¸‹è¿°å­—é¢å€¼çš„æ•°æ®ç±»å‹å¹¶è¯´æ˜æ¯ä¸€ç»„å†…å‡ ç§å­—é¢å€¼çš„åŒºåˆ«ï¼š</p><pre class="line-numbers language-none"><code class="language-none">(a) &#39;a&#39;, L&#39;a&#39;, &quot;a&quot;, L&quot;a&quot;(b) 10, 10u, 10L, 10uL, 012, 0xC(c) 3.14, 3.14f, 3.14L(d) 10, 10u, 10., 10e-2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a): å­—ç¬¦å­—é¢å€¼ï¼Œå®½å­—ç¬¦å­—é¢å€¼ï¼Œå­—ç¬¦ä¸²å­—é¢å€¼ï¼Œå®½å­—ç¬¦ä¸²å­—é¢å€¼ã€‚</li><li>(b): åè¿›åˆ¶æ•´å‹ï¼Œåè¿›åˆ¶æ— ç¬¦å·æ•´å‹ï¼Œåè¿›åˆ¶é•¿æ•´å‹ï¼Œå…«è¿›åˆ¶æ•´å‹ï¼Œåå…­è¿›åˆ¶æ•´å‹ã€‚</li><li>(c): double, float, long double</li><li>(d): åè¿›åˆ¶æ•´å‹ï¼Œåè¿›åˆ¶æ— ç¬¦å·æ•´å‹ï¼Œdouble, double</li></ul><h2 id="ç»ƒä¹ 2-6"><a href="#ç»ƒä¹ 2-6" class="headerlink" title="ç»ƒä¹ 2.6"></a>ç»ƒä¹ 2.6</h2><p>ä¸‹é¢ä¸¤ç»„å®šä¹‰æ˜¯å¦æœ‰åŒºåˆ«ï¼Œå¦‚æœæœ‰ï¼Œè¯·å™è¿°ä¹‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> day <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span><span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">09</span><span class="token punctuation">,</span> day <span class="token operator">=</span> <span class="token number">07</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç¬¬ä¸€è¡Œå®šä¹‰çš„æ˜¯åè¿›åˆ¶çš„æ•´å‹ï¼Œç¬¬äºŒè¡Œå®šä¹‰çš„æ˜¯å…«è¿›åˆ¶çš„æ•´å‹ã€‚ä½†æ˜¯monthå˜é‡æœ‰è¯¯ï¼Œå…«è¿›åˆ¶ä¸èƒ½ç›´æ¥å†™9ã€‚</p><h2 id="ç»ƒä¹ 2-7"><a href="#ç»ƒä¹ 2-7" class="headerlink" title="ç»ƒä¹ 2.7"></a>ç»ƒä¹ 2.7</h2><p>ä¸‹è¿°å­—é¢å€¼è¡¨ç¤ºä½•ç§å«ä¹‰ï¼Ÿå®ƒä»¬å„è‡ªçš„æ•°æ®ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token string">"Who goes with F\145rgus?\012"</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token number">3.14e1L</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">1024f</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token number">3.14L</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) Who goes with Fergus?(æ¢è¡Œ)ï¼Œstring ç±»å‹</li><li>(b) long double</li><li>(c) æ— æ•ˆï¼Œå› ä¸ºåç¼€<code>f</code>åªèƒ½ç”¨äºæµ®ç‚¹å­—é¢é‡ï¼Œè€Œ1024æ˜¯æ•´å‹ã€‚</li><li>(d) long double</li></ul><h2 id="ç»ƒä¹ 2-8"><a href="#ç»ƒä¹ 2-8" class="headerlink" title="ç»ƒä¹ 2.8"></a>ç»ƒä¹ 2.8</h2><p>è¯·åˆ©ç”¨è½¬ä¹‰åºåˆ—ç¼–å†™ä¸€æ®µç¨‹åºï¼Œè¦æ±‚å…ˆè¾“å‡º 2Mï¼Œç„¶åè½¬åˆ°æ–°ä¸€è¡Œã€‚ä¿®æ”¹ç¨‹åºä½¿å…¶å…ˆè¾“å‡º 2ï¼Œç„¶åè¾“å‡ºåˆ¶è¡¨ç¬¦ï¼Œå†è¾“å‡º Mï¼Œæœ€åè½¬åˆ°æ–°ä¸€è¡Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\115\012"</span><span class="token punctuation">;</span>   std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\t\115\012"</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>```   ## ç»ƒä¹ <span class="token number">2.9</span>è§£é‡Šä¸‹åˆ—å®šä¹‰çš„å«ä¹‰ï¼Œå¯¹äºéæ³•çš„å®šä¹‰ï¼Œè¯·è¯´æ˜é”™åœ¨ä½•å¤„å¹¶å°†å…¶æ”¹æ­£ã€‚<span class="token operator">-</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> <span class="token keyword">int</span> input_value<span class="token punctuation">;</span><span class="token operator">-</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">3.14</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token operator">-</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">double</span> salary <span class="token operator">=</span> wage <span class="token operator">=</span> <span class="token number">9999.99</span><span class="token punctuation">;</span><span class="token operator">-</span> <span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>è§£ï¼š <span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">:</span> åº”è¯¥å…ˆå®šä¹‰å†ä½¿ç”¨ã€‚```cpp<span class="token keyword">int</span> input_value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> input_value<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(b): ç”¨åˆ—è¡¨åˆå§‹åŒ–å†…ç½®ç±»å‹çš„å˜é‡æ—¶ï¼Œå¦‚æœå­˜åœ¨ä¸¢å¤±ä¿¡æ¯çš„é£é™©ï¼Œåˆ™ç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> i <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">3.14</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(c): åœ¨è¿™é‡Œ<code>wage</code>æ˜¯æœªå®šä¹‰çš„ï¼Œåº”è¯¥åœ¨æ­¤ä¹‹å‰å°†å…¶å®šä¹‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> wage<span class="token punctuation">;</span><span class="token keyword">double</span> salary <span class="token operator">=</span> wage <span class="token operator">=</span> <span class="token number">9999.99</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>(d): ä¸æŠ¥é”™ï¼Œä½†æ˜¯å°æ•°éƒ¨åˆ†ä¼šè¢«æˆªæ–­ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> i <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-10"><a href="#ç»ƒä¹ 2-10" class="headerlink" title="ç»ƒä¹ 2.10"></a>ç»ƒä¹ 2.10</h2><p>ä¸‹åˆ—å˜é‡çš„åˆå€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>string global_str<span class="token punctuation">;</span><span class="token keyword">int</span> global_int<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> local_int<span class="token punctuation">;</span>    std<span class="token operator">::</span>string local_str<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>global_str</code>å’Œ<code>global_int</code>æ˜¯å…¨å±€å˜é‡ï¼Œæ‰€ä»¥åˆå€¼åˆ†åˆ«ä¸ºç©ºå­—ç¬¦ä¸²å’Œ0ã€‚<br><code>local_int</code>æ˜¯å±€éƒ¨å˜é‡å¹¶ä¸”æ²¡æœ‰åˆå§‹åŒ–ï¼Œå®ƒçš„åˆå€¼æ˜¯æœªå®šä¹‰çš„ã€‚<br><code>local_str</code> æ˜¯ <code>string</code> ç±»çš„å¯¹è±¡ï¼Œå®ƒçš„å€¼ç”±ç±»ç¡®å®šï¼Œä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p><h2 id="ç»ƒä¹ 2-11"><a href="#ç»ƒä¹ 2-11" class="headerlink" title="ç»ƒä¹ 2.11"></a>ç»ƒä¹ 2.11</h2><p>æŒ‡å‡ºä¸‹é¢çš„è¯­å¥æ˜¯å£°æ˜è¿˜æ˜¯å®šä¹‰ï¼š</p><ul><li>(a) extern int ix = 1024;</li><li>(b) int iy;</li><li>(c) extern int iz;</li></ul><p>è§£ï¼š</p><p>(a): å®šä¹‰<br>(b): å®šä¹‰<br>(c): å£°æ˜</p><h2 id="ç»ƒä¹ 2-12"><a href="#ç»ƒä¹ 2-12" class="headerlink" title="ç»ƒä¹ 2.12"></a>ç»ƒä¹ 2.12</h2><p>è¯·æŒ‡å‡ºä¸‹é¢çš„åå­—ä¸­å“ªäº›æ˜¯éæ³•çš„ï¼Ÿ</p><ul><li>(a) int double = 3.14;</li><li>(b) int _;</li><li>(c) int catch-22;</li><li>(d) int 1_or_2 = 1;</li><li>(e) double Double = 3.14;</li></ul><p>è§£ï¼š</p><p>(a), (c), (d) éæ³•ã€‚</p><h2 id="ç»ƒä¹ 2-13"><a href="#ç»ƒä¹ 2-13" class="headerlink" title="ç»ƒä¹ 2.13"></a>ç»ƒä¹ 2.13</h2><p>ä¸‹é¢ç¨‹åºä¸­<code>j</code>çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>j</code>çš„å€¼æ˜¯100ï¼Œå±€éƒ¨å˜é‡<code>i</code>è¦†ç›–äº†å…¨å±€å˜é‡<code>i</code>ã€‚</p><h2 id="ç»ƒä¹ 2-14"><a href="#ç»ƒä¹ 2-14" class="headerlink" title="ç»ƒä¹ 2.14"></a>ç»ƒä¹ 2.14</h2><p>ä¸‹é¢çš„ç¨‹åºåˆæ³•å—ï¼Ÿå¦‚æœåˆæ³•ï¼Œå®ƒå°†è¾“å‡ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>    sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åˆæ³•ã€‚è¾“å‡ºæ˜¯ 100 45 ã€‚</p><h2 id="ç»ƒä¹ 2-15"><a href="#ç»ƒä¹ 2-15" class="headerlink" title="ç»ƒä¹ 2.15"></a>ç»ƒä¹ 2.15</h2><p>ä¸‹é¢çš„å“ªä¸ªå®šä¹‰æ˜¯ä¸åˆæ³•çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><ul><li>(a) int ival = 1.01;</li><li>(b) int &amp;rval1 = 1.01;</li><li>(c) int &amp;rval2 = ival;</li><li>(d) int &rval3;</li></ul><p>è§£ï¼š</p><p>(b)å’Œ(d)ä¸åˆæ³•ï¼Œ(b)å¼•ç”¨å¿…é¡»ç»‘å®šåœ¨å¯¹è±¡ä¸Šï¼Œ(d)å¼•ç”¨å¿…é¡»åˆå§‹åŒ–ã€‚</p><h2 id="ç»ƒä¹ 2-16"><a href="#ç»ƒä¹ 2-16" class="headerlink" title="ç»ƒä¹ 2.16"></a>ç»ƒä¹ 2.16</h2><p>è€ƒå¯Ÿä¸‹é¢çš„æ‰€æœ‰èµ‹å€¼ç„¶åå›ç­”ï¼šå“ªäº›èµ‹å€¼æ˜¯ä¸åˆæ³•çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå“ªäº›èµ‹å€¼æ˜¯åˆæ³•çš„ï¼Ÿå®ƒä»¬æ‰§è¡Œäº†å“ªäº›æ“ä½œï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r1 <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r2 <span class="token operator">=</span> d<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>(a) r2 = 3.14159;</li><li>(b) r2 = r1;</li><li>(c) i = r2;</li><li>(d) r1 = d;</li></ul><p>è§£ï¼š</p><ul><li>(a): åˆæ³•ã€‚ç»™ d èµ‹å€¼ä¸º 3.14159ã€‚</li><li>(b): åˆæ³•ã€‚ä¼šæ‰§è¡Œè‡ªåŠ¨è½¬æ¢ï¼ˆint-&gt;doubleï¼‰ã€‚</li><li>(c): åˆæ³•ã€‚ä¼šå‘ç”Ÿå°æ•°æˆªå–ã€‚</li><li>(d): åˆæ³•ã€‚ä¼šå‘ç”Ÿå°æ•°æˆªå–ã€‚</li></ul><h2 id="ç»ƒä¹ 2-17"><a href="#ç»ƒä¹ 2-17" class="headerlink" title="ç»ƒä¹ 2.17"></a>ç»ƒä¹ 2.17</h2><p>æ‰§è¡Œä¸‹é¢çš„ä»£ç æ®µå°†è¾“å‡ºä»€ä¹ˆç»“æœï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ri <span class="token operator">=</span> i<span class="token punctuation">;</span>i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> ri <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> ri <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¾“å‡ºï¼š10, 10</p><h2 id="ç»ƒä¹ 2-18"><a href="#ç»ƒä¹ 2-18" class="headerlink" title="ç»ƒä¹ 2.18"></a>ç»ƒä¹ 2.18</h2><p>ç¼–å†™ä»£ç åˆ†åˆ«æ”¹å˜æŒ‡é’ˆçš„å€¼ä»¥åŠæŒ‡é’ˆæ‰€æŒ‡å¯¹è±¡çš„å€¼ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span><span class="token comment">// change the value of a pointer.</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span><span class="token comment">// change the value to which the pointer points</span><span class="token operator">*</span>p2 <span class="token operator">=</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-19"><a href="#ç»ƒä¹ 2-19" class="headerlink" title="ç»ƒä¹ 2.19"></a>ç»ƒä¹ 2.19</h2><p>è¯´æ˜æŒ‡é’ˆå’Œå¼•ç”¨çš„ä¸»è¦åŒºåˆ«</p><p>è§£ï¼š</p><p>å¼•ç”¨æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„åˆ«åï¼Œè€ŒæŒ‡é’ˆæœ¬èº«å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚<br>å¼•ç”¨å¿…é¡»åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸€æ—¦å®šä¹‰äº†å¼•ç”¨å°±æ— æ³•å†ç»‘å®šåˆ°å…¶ä»–å¯¹è±¡ã€‚è€ŒæŒ‡é’ˆæ— é¡»åœ¨å®šä¹‰æ—¶èµ‹åˆå€¼ï¼Œä¹Ÿå¯ä»¥é‡æ–°èµ‹å€¼è®©å…¶æŒ‡å‘å…¶ä»–å¯¹è±¡ã€‚</p><h2 id="ç»ƒä¹ 2-20"><a href="#ç»ƒä¹ 2-20" class="headerlink" title="ç»ƒä¹ 2.20"></a>ç»ƒä¹ 2.20</h2><p>è¯·å™è¿°ä¸‹é¢è¿™æ®µä»£ç çš„ä½œç”¨ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">*</span>p1 <span class="token operator">*</span> <span class="token operator">*</span>p1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è®©æŒ‡é’ˆ pi æŒ‡å‘ iï¼Œç„¶åå°† i çš„å€¼é‡æ–°èµ‹å€¼ä¸º 42 * 42 (1764)ã€‚</p><h2 id="ç»ƒä¹ 2-21"><a href="#ç»ƒä¹ 2-21" class="headerlink" title="ç»ƒä¹ 2.21"></a>ç»ƒä¹ 2.21</h2><p>è¯·è§£é‡Šä¸‹è¿°å®šä¹‰ã€‚åœ¨è¿™äº›å®šä¹‰ä¸­æœ‰éæ³•çš„å—ï¼Ÿå¦‚æœæœ‰ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p><code>int i = 0;</code></p><ul><li>(a) double* dp = &i;</li><li>(b) int *ip = i;</li><li>(c) int *p = &i;</li></ul><p>è§£ï¼š</p><ul><li>(a): éæ³•ã€‚ä¸èƒ½å°†ä¸€ä¸ªæŒ‡å‘ <code>double</code> çš„æŒ‡é’ˆæŒ‡å‘ <code>int</code> ã€‚</li><li>(b): éæ³•ã€‚ä¸èƒ½å°† <code>int</code> å˜é‡èµ‹ç»™æŒ‡é’ˆã€‚</li><li>(c): åˆæ³•ã€‚</li></ul><h2 id="ç»ƒä¹ 2-22"><a href="#ç»ƒä¹ 2-22" class="headerlink" title="ç»ƒä¹ 2.22"></a>ç»ƒä¹ 2.22</h2><p>å‡è®¾ p æ˜¯ä¸€ä¸ª int å‹æŒ‡é’ˆï¼Œè¯·è¯´æ˜ä¸‹è¿°ä»£ç çš„å«ä¹‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token comment">// ...</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token comment">// ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç¬¬ä¸€å¥åˆ¤æ–­ p æ˜¯ä¸æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆ,<br>ç¬¬äºŒå¥åˆ¤æ–­ p æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å€¼æ˜¯ä¸æ˜¯ä¸º0</p><h2 id="ç»ƒä¹ 2-23"><a href="#ç»ƒä¹ 2-23" class="headerlink" title="ç»ƒä¹ 2.23"></a>ç»ƒä¹ 2.23</h2><p>ç»™å®šæŒ‡é’ˆ pï¼Œä½ èƒ½çŸ¥é“å®ƒæ˜¯å¦æŒ‡å‘äº†ä¸€ä¸ªåˆæ³•çš„å¯¹è±¡å—ï¼Ÿå¦‚æœèƒ½ï¼Œå™è¿°åˆ¤æ–­çš„æ€è·¯ï¼›å¦‚æœä¸èƒ½ï¼Œä¹Ÿè¯·è¯´æ˜åŸå› ã€‚</p><p>è§£ï¼š</p><p>ä¸èƒ½ï¼Œå› ä¸ºé¦–å…ˆè¦ç¡®å®šè¿™ä¸ªæŒ‡é’ˆæ˜¯ä¸æ˜¯åˆæ³•çš„ï¼Œæ‰èƒ½åˆ¤æ–­å®ƒæ‰€æŒ‡å‘çš„å¯¹è±¡æ˜¯ä¸æ˜¯åˆæ³•çš„ã€‚</p><h2 id="ç»ƒä¹ 2-24"><a href="#ç»ƒä¹ 2-24" class="headerlink" title="ç»ƒä¹ 2.24"></a>ç»ƒä¹ 2.24</h2><p>åœ¨ä¸‹é¢è¿™æ®µä»£ç ä¸­ä¸ºä»€ä¹ˆ p åˆæ³•è€Œ lp éæ³•ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span><span class="token keyword">long</span> <span class="token operator">*</span>lp <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>void *</code>æ˜¯ä»Cè¯­è¨€é‚£é‡Œç»§æ‰¿è¿‡æ¥çš„ï¼Œå¯ä»¥æŒ‡å‘ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚<br>è€Œå…¶ä»–æŒ‡é’ˆç±»å‹å¿…é¡»è¦ä¸æ‰€æŒ‡å¯¹è±¡ä¸¥æ ¼åŒ¹é…ã€‚</p><h2 id="ç»ƒä¹ 2-25"><a href="#ç»ƒä¹ 2-25" class="headerlink" title="ç»ƒä¹ 2.25"></a>ç»ƒä¹ 2.25</h2><p>è¯´æ˜ä¸‹åˆ—å˜é‡çš„ç±»å‹å’Œå€¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token operator">*</span> ip<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token operator">*</span>ip <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token operator">*</span> ip<span class="token punctuation">,</span> ip2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a): ip æ˜¯ä¸€ä¸ªæŒ‡å‘ int çš„æŒ‡é’ˆ, i æ˜¯ä¸€ä¸ª int, r æ˜¯ i çš„å¼•ç”¨ã€‚</li><li>(b): i æ˜¯ int , ip æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆã€‚</li><li>(c): ip æ˜¯ä¸€ä¸ªæŒ‡å‘ int çš„æŒ‡é’ˆ, ip2 æ˜¯ä¸€ä¸ª intã€‚</li></ul><h2 id="ç»ƒä¹ 2-26"><a href="#ç»ƒä¹ 2-26" class="headerlink" title="ç»ƒä¹ 2.26"></a>ç»ƒä¹ 2.26</h2><p>ä¸‹é¢å“ªäº›è¯­å¥æ˜¯åˆæ³•çš„ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œè¯·è¯´æ˜ä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> buf<span class="token punctuation">;</span>      <span class="token comment">// ä¸åˆæ³•, const å¯¹è±¡å¿…é¡»åˆå§‹åŒ–</span><span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// åˆæ³•</span><span class="token keyword">const</span> <span class="token keyword">int</span> sz <span class="token operator">=</span> cnt<span class="token punctuation">;</span> <span class="token comment">// åˆæ³•</span><span class="token operator">++</span>cnt<span class="token punctuation">;</span> <span class="token operator">++</span>sz<span class="token punctuation">;</span>        <span class="token comment">// ä¸åˆæ³•, const å¯¹è±¡ä¸èƒ½è¢«æ”¹å˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-27"><a href="#ç»ƒä¹ 2-27" class="headerlink" title="ç»ƒä¹ 2.27"></a>ç»ƒä¹ 2.27</h2><p>ä¸‹é¢çš„å“ªäº›åˆå§‹åŒ–æ˜¯åˆæ³•çš„ï¼Ÿè¯·è¯´æ˜åŸå› ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">// ä¸åˆæ³•, r å¿…é¡»å¼•ç”¨ä¸€ä¸ªå¯¹è±¡</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>i2<span class="token punctuation">;</span>        <span class="token comment">// åˆæ³•ï¼Œå¸¸é‡æŒ‡é’ˆ</span><span class="token keyword">const</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">// åˆæ³•</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token operator">&amp;</span>i2<span class="token punctuation">;</span>  <span class="token comment">// åˆæ³•</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i2<span class="token punctuation">;</span>        <span class="token comment">// åˆæ³•</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span><span class="token keyword">const</span> r2<span class="token punctuation">;</span>        <span class="token comment">// ä¸åˆæ³•, r2 æ˜¯å¼•ç”¨ï¼Œå¼•ç”¨æ²¡æœ‰é¡¶å±‚ const</span><span class="token keyword">const</span> <span class="token keyword">int</span> i2 <span class="token operator">=</span> i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> i<span class="token punctuation">;</span>   <span class="token comment">// åˆæ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-28"><a href="#ç»ƒä¹ 2-28" class="headerlink" title="ç»ƒä¹ 2.28"></a>ç»ƒä¹ 2.28</h2><p>è¯´æ˜ä¸‹é¢çš„è¿™äº›å®šä¹‰æ˜¯ä»€ä¹ˆæ„æ€ï¼ŒæŒ‘å‡ºå…¶ä¸­ä¸åˆæ³•çš„ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">const</span> cp<span class="token punctuation">;</span>       <span class="token comment">// ä¸åˆæ³•, const æŒ‡é’ˆå¿…é¡»åˆå§‹åŒ–</span><span class="token keyword">int</span> <span class="token operator">*</span>p1<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">const</span> p2<span class="token punctuation">;</span>     <span class="token comment">// ä¸åˆæ³•, const æŒ‡é’ˆå¿…é¡»åˆå§‹åŒ–</span><span class="token keyword">const</span> <span class="token keyword">int</span> ic<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> ic<span class="token punctuation">;</span>  <span class="token comment">// ä¸åˆæ³•, const int å¿…é¡»åˆå§‹åŒ–</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> p3<span class="token punctuation">;</span>    <span class="token comment">// ä¸åˆæ³•, const æŒ‡é’ˆå¿…é¡»åˆå§‹åŒ–</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>           <span class="token comment">// åˆæ³•. ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ const int</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-29"><a href="#ç»ƒä¹ 2-29" class="headerlink" title="ç»ƒä¹ 2.29"></a>ç»ƒä¹ 2.29</h2><p>å‡è®¾å·²æœ‰ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­å®šä¹‰çš„é‚£äº›å˜é‡ï¼Œåˆ™ä¸‹é¢çš„å“ªäº›è¯­å¥æ˜¯åˆæ³•çš„ï¼Ÿè¯·è¯´æ˜åŸå› ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">i <span class="token operator">=</span> ic<span class="token punctuation">;</span>     <span class="token comment">// åˆæ³•, å¸¸é‡èµ‹å€¼ç»™æ™®é€šå˜é‡</span>p1 <span class="token operator">=</span> p3<span class="token punctuation">;</span>    <span class="token comment">// ä¸åˆæ³•, p3 æ˜¯constæŒ‡é’ˆä¸èƒ½èµ‹å€¼ç»™æ™®é€šæŒ‡é’ˆ</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>ic<span class="token punctuation">;</span>   <span class="token comment">// ä¸åˆæ³•, æ™®é€šæŒ‡é’ˆä¸èƒ½æŒ‡å‘å¸¸é‡</span>p3 <span class="token operator">=</span> <span class="token operator">&amp;</span>ic<span class="token punctuation">;</span>   <span class="token comment">// åˆæ³•, p3 æ˜¯å¸¸é‡æŒ‡é’ˆä¸”æŒ‡å‘å¸¸é‡</span>p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span>    <span class="token comment">// åˆæ³•, å¯ä»¥å°†æ™®é€šæŒ‡é’ˆèµ‹å€¼ç»™å¸¸é‡æŒ‡é’ˆ</span>ic <span class="token operator">=</span> <span class="token operator">*</span>p3<span class="token punctuation">;</span>   <span class="token comment">// åˆæ³•, å¯¹ p3 å–å€¼åæ˜¯ä¸€ä¸ª int ç„¶åèµ‹å€¼ç»™ ic</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-30"><a href="#ç»ƒä¹ 2-30" class="headerlink" title="ç»ƒä¹ 2.30"></a>ç»ƒä¹ 2.30</h2><p>å¯¹äºä¸‹é¢çš„è¿™äº›è¯­å¥ï¼Œè¯·è¯´æ˜å¯¹è±¡è¢«å£°æ˜æˆäº†é¡¶å±‚constè¿˜æ˜¯åº•å±‚constï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> v2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">int</span> v1 <span class="token operator">=</span> v2<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r1 <span class="token operator">=</span> v1<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r2 <span class="token operator">=</span> v2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>v2 æ˜¯é¡¶å±‚constï¼Œp2 æ˜¯åº•å±‚constï¼Œp3 æ—¢æ˜¯é¡¶å±‚conståˆæ˜¯åº•å±‚constï¼Œr2 æ˜¯åº•å±‚constã€‚</p><h2 id="ç»ƒä¹ 2-31"><a href="#ç»ƒä¹ 2-31" class="headerlink" title="ç»ƒä¹ 2.31"></a>ç»ƒä¹ 2.31</h2><p>å‡è®¾å·²æœ‰ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­æ‰€åšçš„é‚£äº›å£°æ˜ï¼Œåˆ™ä¸‹é¢çš„å“ªäº›è¯­å¥æ˜¯åˆæ³•çš„ï¼Ÿè¯·è¯´æ˜é¡¶å±‚constå’Œåº•å±‚conståœ¨æ¯ä¸ªä¾‹å­ä¸­æœ‰ä½•ä½“ç°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">r1 <span class="token operator">=</span> v2<span class="token punctuation">;</span> <span class="token comment">// åˆæ³•, é¡¶å±‚conståœ¨æ‹·è´æ—¶ä¸å—å½±å“</span>p1 <span class="token operator">=</span> p2<span class="token punctuation">;</span> <span class="token comment">// ä¸åˆæ³•, p2 æ˜¯åº•å±‚constï¼Œå¦‚æœè¦æ‹·è´å¿…é¡»è¦æ±‚ p1 ä¹Ÿæ˜¯åº•å±‚const</span>p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span> <span class="token comment">// åˆæ³•, int* å¯ä»¥è½¬æ¢æˆconst int*</span>p1 <span class="token operator">=</span> p3<span class="token punctuation">;</span> <span class="token comment">// ä¸åˆæ³•, p3 æ˜¯ä¸€ä¸ªåº•å±‚constï¼Œp1 ä¸æ˜¯</span>p2 <span class="token operator">=</span> p3<span class="token punctuation">;</span> <span class="token comment">// åˆæ³•, p2 å’Œ p3 éƒ½æ˜¯åº•å±‚constï¼Œæ‹·è´æ—¶å¿½ç•¥æ‰é¡¶å±‚const</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-32"><a href="#ç»ƒä¹ 2-32" class="headerlink" title="ç»ƒä¹ 2.32"></a>ç»ƒä¹ 2.32</h2><p>ä¸‹é¢çš„ä»£ç æ˜¯å¦åˆæ³•ï¼Ÿå¦‚æœéæ³•ï¼Œè¯·è®¾æ³•å°†å…¶ä¿®æ”¹æ­£ç¡®ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> null <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span>p <span class="token operator">=</span> null<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>åˆæ³•ã€‚æŒ‡é’ˆå¯ä»¥åˆå§‹åŒ–ä¸º 0 è¡¨ç¤ºä¸ºç©ºæŒ‡é’ˆã€‚</p><h2 id="ç»ƒä¹ 2-33"><a href="#ç»ƒä¹ 2-33" class="headerlink" title="ç»ƒä¹ 2.33"></a>ç»ƒä¹ 2.33</h2><p>åˆ©ç”¨æœ¬èŠ‚å®šä¹‰çš„å˜é‡ï¼Œåˆ¤æ–­ä¸‹åˆ—è¯­å¥çš„è¿è¡Œç»“æœã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">a<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// a æ˜¯ int</span>b<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// b æ˜¯ä¸€ä¸ª int,(ciçš„é¡¶å±‚conståœ¨æ‹·è´æ—¶è¢«å¿½ç•¥æ‰äº†)</span>c<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// c ä¹Ÿæ˜¯ä¸€ä¸ªint</span>d<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// d æ˜¯ä¸€ä¸ª int *,æ‰€ä»¥è¯­å¥éæ³•</span>e<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// e æ˜¯ä¸€ä¸ª const int *, æ‰€ä»¥è¯­å¥éæ³•</span>g<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">;</span> <span class="token comment">// g æ˜¯ä¸€ä¸ª const int çš„å¼•ç”¨ï¼Œå¼•ç”¨éƒ½æ˜¯åº•å±‚constï¼Œæ‰€ä»¥ä¸èƒ½è¢«èµ‹å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-34"><a href="#ç»ƒä¹ 2-34" class="headerlink" title="ç»ƒä¹ 2.34"></a>ç»ƒä¹ 2.34</h2><p>åŸºäºä¸Šä¸€ä¸ªç»ƒä¹ ä¸­çš„å˜é‡å’Œè¯­å¥ç¼–å†™ä¸€æ®µç¨‹åºï¼Œè¾“å‡ºèµ‹å€¼å‰åå˜é‡çš„å†…å®¹ï¼Œä½ åˆšæ‰çš„æ¨æ–­æ­£ç¡®å—ï¼Ÿå¦‚æœä¸å¯¹ï¼Œè¯·åå¤ç ”è¯»æœ¬èŠ‚çš„ç¤ºä¾‹ç›´åˆ°ä½ æ˜ç™½é”™åœ¨ä½•å¤„ä¸ºæ­¢ã€‚</p><h2 id="ç»ƒä¹ 2-35"><a href="#ç»ƒä¹ 2-35" class="headerlink" title="ç»ƒä¹ 2.35"></a>ç»ƒä¹ 2.35</h2><p>åˆ¤æ–­ä¸‹åˆ—å®šä¹‰æ¨æ–­å‡ºçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œç„¶åç¼–å†™ç¨‹åºè¿›è¡ŒéªŒè¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span class="token keyword">auto</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>k <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token keyword">auto</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span> <span class="token keyword">const</span> <span class="token keyword">auto</span> j2 <span class="token operator">=</span> i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>k2 <span class="token operator">=</span> i<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>j æ˜¯ intï¼Œk æ˜¯ const intçš„å¼•ç”¨ï¼Œp æ˜¯const int *ï¼Œj2 æ˜¯const intï¼Œk2 æ˜¯ const int çš„å¼•ç”¨ã€‚</p><h2 id="ç»ƒä¹ 2-36"><a href="#ç»ƒä¹ 2-36" class="headerlink" title="ç»ƒä¹ 2.36"></a>ç»ƒä¹ 2.36</h2><p>å…³äºä¸‹é¢çš„ä»£ç ï¼Œè¯·æŒ‡å‡ºæ¯ä¸€ä¸ªå˜é‡çš„ç±»å‹ä»¥åŠç¨‹åºç»“æŸæ—¶å®ƒä»¬å„è‡ªçš„å€¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> c <span class="token operator">=</span> a<span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> d <span class="token operator">=</span> a<span class="token punctuation">;</span><span class="token operator">++</span>c<span class="token punctuation">;</span><span class="token operator">++</span>d<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>c æ˜¯ int ç±»å‹ï¼Œå€¼ä¸º 4ã€‚d æ˜¯ int &amp; ç±»å‹ï¼Œç»‘å®šåˆ° aï¼Œa çš„å€¼ä¸º 4 ã€‚</p><h2 id="ç»ƒä¹ 2-37"><a href="#ç»ƒä¹ 2-37" class="headerlink" title="ç»ƒä¹ 2.37"></a>ç»ƒä¹ 2.37</h2><p>èµ‹å€¼æ˜¯ä¼šäº§ç”Ÿå¼•ç”¨çš„ä¸€ç±»å…¸å‹è¡¨è¾¾å¼ï¼Œå¼•ç”¨çš„ç±»å‹å°±æ˜¯å·¦å€¼çš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ i æ˜¯ intï¼Œåˆ™è¡¨è¾¾å¼ i=x çš„ç±»å‹æ˜¯ int&amp;ã€‚æ ¹æ®è¿™ä¸€ç‰¹ç‚¹ï¼Œè¯·æŒ‡å‡ºä¸‹é¢çš„ä»£ç ä¸­æ¯ä¸€ä¸ªå˜é‡çš„ç±»å‹å’Œå€¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> c <span class="token operator">=</span> a<span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>a <span class="token operator">=</span> b<span class="token punctuation">)</span> d <span class="token operator">=</span> a<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>c æ˜¯ int ç±»å‹ï¼Œå€¼ä¸º 3ã€‚d æ˜¯ int&amp; ç±»å‹ï¼Œç»‘å®šåˆ° aã€‚</p><h2 id="ç»ƒä¹ 2-38"><a href="#ç»ƒä¹ 2-38" class="headerlink" title="ç»ƒä¹ 2.38"></a>ç»ƒä¹ 2.38</h2><p>è¯´æ˜ç”±decltype æŒ‡å®šç±»å‹å’Œç”±autoæŒ‡å®šç±»å‹æœ‰ä½•åŒºåˆ«ã€‚è¯·ä¸¾ä¸€ä¸ªä¾‹å­ï¼ŒdecltypeæŒ‡å®šçš„ç±»å‹ä¸autoæŒ‡å®šçš„ç±»å‹ä¸€æ ·ï¼›å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼ŒdecltypeæŒ‡å®šçš„ç±»å‹ä¸autoæŒ‡å®šçš„ç±»å‹ä¸ä¸€æ ·ã€‚</p><p>è§£ï¼š</p><p>decltype å¤„ç†é¡¶å±‚constå’Œå¼•ç”¨çš„æ–¹å¼ä¸ autoä¸åŒï¼Œdecltypeä¼šå°†é¡¶å±‚constå’Œå¼•ç”¨ä¿ç•™èµ·æ¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>r <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token comment">//ç›¸åŒ</span><span class="token keyword">auto</span> a <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> b <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token comment">//ä¸åŒ d æ˜¯ä¸€ä¸ª int&amp;</span><span class="token keyword">auto</span> c <span class="token operator">=</span> r<span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> d <span class="token operator">=</span> r<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-39"><a href="#ç»ƒä¹ 2-39" class="headerlink" title="ç»ƒä¹ 2.39"></a>ç»ƒä¹ 2.39</h2><p>ç¼–è¯‘ä¸‹é¢çš„ç¨‹åºè§‚å¯Ÿå…¶è¿è¡Œç»“æœï¼Œæ³¨æ„ï¼Œå¦‚æœå¿˜è®°å†™ç±»å®šä¹‰ä½“åé¢çš„åˆ†å·ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿè®°å½•ä¸‹ç›¸å…³çš„ä¿¡æ¯ï¼Œä»¥åå¯èƒ½ä¼šæœ‰ç”¨ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Foo</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* æ­¤å¤„ä¸ºç©º  */</span> <span class="token punctuation">&#125;</span> <span class="token comment">// æ³¨æ„ï¼šæ²¡æœ‰åˆ†å·</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æç¤ºåº”è¾“å…¥åˆ†å·ã€‚</p><h2 id="ç»ƒä¹ 2-40"><a href="#ç»ƒä¹ 2-40" class="headerlink" title="ç»ƒä¹ 2.40"></a>ç»ƒä¹ 2.40</h2><p>æ ¹æ®è‡ªå·±çš„ç†è§£å†™å‡º Sales_data ç±»ï¼Œæœ€å¥½ä¸ä¹¦ä¸­çš„ä¾‹å­æœ‰æ‰€åŒºåˆ«ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Sale_data</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    std<span class="token operator">::</span>string bookName<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-41"><a href="#ç»ƒä¹ 2-41" class="headerlink" title="ç»ƒä¹ 2.41"></a>ç»ƒä¹ 2.41</h2><p>ä½¿ç”¨ä½ è‡ªå·±çš„Sale_dataç±»é‡å†™1.5.1èŠ‚ï¼ˆç¬¬20é¡µï¼‰ã€1.5.2èŠ‚ï¼ˆç¬¬21é¡µï¼‰å’Œ1.6èŠ‚ï¼ˆç¬¬22é¡µï¼‰çš„ç»ƒä¹ ã€‚çœ¼ä¸‹å…ˆæŠŠSales_dataç±»çš„å®šä¹‰å’Œmainå‡½æ•°æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// 1.5.1</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">Sale_data</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sale_data book<span class="token punctuation">;</span>    <span class="token keyword">double</span> price<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> book<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> book<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    book<span class="token punctuation">.</span>revenue <span class="token operator">=</span> book<span class="token punctuation">.</span>units_sold <span class="token operator">*</span> price<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> price<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// 1.5.2</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">Sale_data</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sale_data book1<span class="token punctuation">,</span> book2<span class="token punctuation">;</span>    <span class="token keyword">double</span> price1<span class="token punctuation">,</span> price2<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> book1<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> book1<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price1<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> book2<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> book2<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price2<span class="token punctuation">;</span>    book1<span class="token punctuation">.</span>revenue <span class="token operator">=</span> book1<span class="token punctuation">.</span>units_sold <span class="token operator">*</span> price1<span class="token punctuation">;</span>    book2<span class="token punctuation">.</span>revenue <span class="token operator">=</span> book2<span class="token punctuation">.</span>units_sold <span class="token operator">*</span> price2<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>book1<span class="token punctuation">.</span>bookNo <span class="token operator">==</span> book2<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">unsigned</span> totalCnt <span class="token operator">=</span> book1<span class="token punctuation">.</span>units_sold <span class="token operator">+</span> book2<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>        <span class="token keyword">double</span> totalRevenue <span class="token operator">=</span> book1<span class="token punctuation">.</span>revenue <span class="token operator">+</span> book2<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> book1<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> totalCnt <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> totalRevenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>totalCnt <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> totalRevenue <span class="token operator">/</span> totalCnt <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">else</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"(no sales)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Data must refer to same ISBN"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// indicate failure</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// 1.6</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">Sale_data</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sale_data total<span class="token punctuation">;</span>    <span class="token keyword">double</span> totalPrice<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> total<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> total<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> totalPrice<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        total<span class="token punctuation">.</span>revenue <span class="token operator">=</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">*</span> totalPrice<span class="token punctuation">;</span>        Sale_data trans<span class="token punctuation">;</span>        <span class="token keyword">double</span> transPrice<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> trans<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> trans<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> transPrice<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            trans<span class="token punctuation">.</span>revenue <span class="token operator">=</span> trans<span class="token punctuation">.</span>units_sold <span class="token operator">*</span> transPrice<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>bookNo <span class="token operator">==</span> trans<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                total<span class="token punctuation">.</span>units_sold <span class="token operator">+=</span> trans<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>                total<span class="token punctuation">.</span>revenue <span class="token operator">+=</span> trans<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>units_sold <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">/</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                <span class="token keyword">else</span>                    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"(no sales)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                total<span class="token punctuation">.</span>bookNo <span class="token operator">=</span> trans<span class="token punctuation">.</span>bookNo<span class="token punctuation">;</span>                total<span class="token punctuation">.</span>units_sold <span class="token operator">=</span> trans<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>                total<span class="token punctuation">.</span>revenue <span class="token operator">=</span> trans<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>units_sold <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">/</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">else</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"(no sales)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// indicate failure</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 2-42"><a href="#ç»ƒä¹ 2-42" class="headerlink" title="ç»ƒä¹ 2.42"></a>ç»ƒä¹ 2.42</h2><p>æ ¹æ®ä½ è‡ªå·±çš„ç†è§£é‡å†™ä¸€ä¸ªSales_data.hå¤´æ–‡ä»¶ï¼Œå¹¶ä»¥æ­¤ä¸ºåŸºç¡€é‡åš2.6.2èŠ‚ï¼ˆç¬¬67é¡µï¼‰çš„ç»ƒä¹ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ3</title>
      <link href="2021/04/10/excersize/ch03/"/>
      <url>2021/04/10/excersize/ch03/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸‰ç« -å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„"><a href="#ç¬¬ä¸‰ç« -å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„" class="headerlink" title="ç¬¬ä¸‰ç«  å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„"></a>ç¬¬ä¸‰ç«  å­—ç¬¦ä¸²ã€å‘é‡å’Œæ•°ç»„</h1><h2 id="ç»ƒä¹ 3-1"><a href="#ç»ƒä¹ 3-1" class="headerlink" title="ç»ƒä¹ 3.1"></a>ç»ƒä¹ 3.1</h2><p>ä½¿ç”¨æ°å½“çš„using å£°æ˜é‡åš 1.4.1èŠ‚å’Œ2.6.2èŠ‚çš„ç»ƒä¹ ã€‚</p><p>è§£ï¼š</p><p>1.4.1</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> val <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> val <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>val<span class="token punctuation">)</span> sum <span class="token operator">+=</span> val<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Sum of 1 to 10 inclusive is "</span> <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.6.2 ç±»ä¼¼</p><h2 id="ç»ƒä¹ 3-2"><a href="#ç»ƒä¹ 3-2" class="headerlink" title="ç»ƒä¹ 3.2"></a>ç»ƒä¹ 3.2</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºä»æ ‡å‡†è¾“å…¥ä¸­ä¸€æ¬¡è¯»å…¥ä¸€è¡Œï¼Œç„¶åä¿®æ”¹è¯¥ç¨‹åºä½¿å…¶ä¸€æ¬¡è¯»å…¥ä¸€ä¸ªè¯ã€‚</p><p>è§£ï¼š</p><p>ä¸€æ¬¡è¯»å…¥ä¸€è¡Œï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>getline<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€æ¬¡è¯»å…¥ä¸€ä¸ªè¯</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>getline<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-3"><a href="#ç»ƒä¹ 3-3" class="headerlink" title="ç»ƒä¹ 3.3"></a>ç»ƒä¹ 3.3</h2><p>è¯·è¯´æ˜stringç±»çš„è¾“å…¥è¿ç®—ç¬¦å’Œgetlineå‡½æ•°åˆ†åˆ«æ˜¯å¦‚ä½•å¤„ç†ç©ºç™½å­—ç¬¦çš„ã€‚</p><p>è§£ï¼š</p><ul><li>ç±»ä¼¼<code>is &gt;&gt; s</code>çš„è¯»å–ï¼šstringå¯¹è±¡ä¼šå¿½ç•¥å¼€å¤´çš„ç©ºç™½å¹¶ä»ç¬¬ä¸€ä¸ªçœŸæ­£çš„å­—ç¬¦å¼€å§‹ï¼Œç›´åˆ°é‡è§ä¸‹ä¸€<strong>ç©ºç™½</strong>ä¸ºæ­¢ã€‚</li><li>ç±»ä¼¼<code>getline(is, s)</code>çš„è¯»å–ï¼šstringå¯¹è±¡ä¼šä»è¾“å…¥æµä¸­è¯»å–å­—ç¬¦ï¼Œç›´åˆ°é‡è§<strong>æ¢è¡Œç¬¦</strong>ä¸ºæ­¢ã€‚</li></ul><h2 id="ç»ƒä¹ 3-4"><a href="#ç»ƒä¹ 3-4" class="headerlink" title="ç»ƒä¹ 3.4"></a>ç»ƒä¹ 3.4</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºè¯»å–ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”è¾ƒå…¶æ˜¯å¦ç›¸ç­‰å¹¶è¾“å‡ºç»“æœã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œè¾“å‡ºæ¯”è¾ƒå¤§çš„é‚£ä¸ªå­—ç¬¦ä¸²ã€‚æ”¹å†™ä¸Šè¿°ç¨‹åºï¼Œæ¯”è¾ƒè¾“å…¥çš„ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç­‰é•¿ï¼Œå¦‚æœä¸ç­‰é•¿ï¼Œè¾“å‡ºé•¿åº¦è¾ƒå¤§çš„é‚£ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>è§£ï¼š</p><p>æ¯”è¾ƒå¤§çš„</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string str1<span class="token punctuation">,</span> str2<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> str1 <span class="token operator">>></span> str2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>str1 <span class="token operator">==</span> str2<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two strings are equal."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">else</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The larger string is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>str1 <span class="token operator">></span> str2<span class="token punctuation">)</span> <span class="token operator">?</span> str1 <span class="token operator">:</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é•¿åº¦å¤§çš„</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string str1<span class="token punctuation">,</span> str2<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> str1 <span class="token operator">>></span> str2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>str1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> str2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two strings have the same length."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">else</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The longer string is "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> str2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> str1 <span class="token operator">:</span> str2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-5"><a href="#ç»ƒä¹ 3-5" class="headerlink" title="ç»ƒä¹ 3.5"></a>ç»ƒä¹ 3.5</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºä»æ ‡å‡†è¾“å…¥ä¸­è¯»å…¥å¤šä¸ªå­—ç¬¦ä¸²å¹¶å°†ä»–ä»¬è¿æ¥èµ·æ¥ï¼Œè¾“å‡ºè¿æ¥æˆçš„å¤§å­—ç¬¦ä¸²ã€‚ç„¶åä¿®æ”¹ä¸Šè¿°ç¨‹åºï¼Œç”¨ç©ºæ ¼æŠŠè¾“å…¥çš„å¤šä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¼€æ¥ã€‚</p><p>è§£ï¼š</p><p>æœªéš”å¼€çš„ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string result<span class="token punctuation">,</span> s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>result <span class="token operator">+=</span> s<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> result <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éš”å¼€çš„ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string result<span class="token punctuation">,</span> s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>result <span class="token operator">+=</span> s <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> result <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-6"><a href="#ç»ƒä¹ 3-6" class="headerlink" title="ç»ƒä¹ 3.6"></a>ç»ƒä¹ 3.6</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä½¿ç”¨èŒƒå›´forè¯­å¥å°†å­—ç¬¦ä¸²å†…æ‰€æœ‰å­—ç¬¦ç”¨Xä»£æ›¿ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s <span class="token operator">=</span> <span class="token string">"this is a string"</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>x <span class="token operator">:</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>x <span class="token operator">=</span> <span class="token string">'X'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-7"><a href="#ç»ƒä¹ 3-7" class="headerlink" title="ç»ƒä¹ 3.7"></a>ç»ƒä¹ 3.7</h2><p>å°±ä¸Šä¸€é¢˜å®Œæˆçš„ç¨‹åºè€Œè¨€ï¼Œå¦‚æœå°†å¾ªç¯æ§åˆ¶çš„å˜é‡è®¾ç½®ä¸ºcharå°†å‘ç”Ÿä»€ä¹ˆï¼Ÿå…ˆä¼°è®¡ä¸€ä¸‹ç»“æœï¼Œç„¶åå®é™…ç¼–ç¨‹è¿›è¡ŒéªŒè¯ã€‚</p><p>è§£ï¼š</p><p>å¦‚æœè®¾ç½®ä¸ºcharï¼Œé‚£ä¹ˆåŸæ¥çš„å­—ç¬¦ä¸²ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p><h2 id="ç»ƒä¹ 3-8"><a href="#ç»ƒä¹ 3-8" class="headerlink" title="ç»ƒä¹ 3.8"></a>ç»ƒä¹ 3.8</h2><p>åˆ†åˆ«ç”¨whileå¾ªç¯å’Œä¼ ç»Ÿforå¾ªç¯é‡å†™ç¬¬ä¸€é¢˜çš„ç¨‹åºï¼Œä½ è§‰å¾—å“ªç§å½¢å¼æ›´å¥½å‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s <span class="token operator">=</span> <span class="token string">"this is a string"</span><span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'X'</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Y'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>èŒƒå›´forè¯­å¥æ›´å¥½ï¼Œä¸ç›´æ¥æ“ä½œç´¢å¼•ï¼Œæ›´ç®€æ´ã€‚</p><h2 id="ç»ƒä¹ 3-9"><a href="#ç»ƒä¹ 3-9" class="headerlink" title="ç»ƒä¹ 3.9"></a>ç»ƒä¹ 3.9</h2><p>ä¸‹é¢çš„ç¨‹åºæœ‰ä½•ä½œç”¨ï¼Ÿå®ƒåˆæ³•å—ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string s<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆæ³•ã€‚ä½¿ç”¨ä¸‹æ ‡è®¿é—®ç©ºå­—ç¬¦ä¸²æ˜¯éæ³•çš„è¡Œä¸ºã€‚</p><h2 id="ç»ƒä¹ 3-10"><a href="#ç»ƒä¹ 3-10" class="headerlink" title="ç»ƒä¹ 3.10"></a>ç»ƒä¹ 3.10</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œè¯»å…¥ä¸€ä¸ªåŒ…å«æ ‡ç‚¹ç¬¦å·çš„å­—ç¬¦ä¸²ï¼Œå°†æ ‡ç‚¹ç¬¦å·å»é™¤åè¾“å‡ºå­—ç¬¦ä¸²å‰©ä½™çš„éƒ¨åˆ†ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s <span class="token operator">=</span> <span class="token string">"this, is. a :string!"</span><span class="token punctuation">;</span>string result<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> x <span class="token operator">:</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ispunct</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>result <span class="token operator">+=</span> x<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> result <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-11"><a href="#ç»ƒä¹ 3-11" class="headerlink" title="ç»ƒä¹ 3.11"></a>ç»ƒä¹ 3.11</h2><p>ä¸‹é¢çš„èŒƒå›´forè¯­å¥åˆæ³•å—ï¼Ÿå¦‚æœåˆæ³•ï¼Œcçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> string s <span class="token operator">=</span> <span class="token string">"Keep out!"</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>c <span class="token operator">:</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¦æ ¹æ®forå¾ªç¯ä¸­çš„ä»£ç æ¥çœ‹æ˜¯å¦åˆæ³•ï¼Œcæ˜¯string å¯¹è±¡ä¸­å­—ç¬¦çš„å¼•ç”¨ï¼Œsæ˜¯å¸¸é‡ã€‚å› æ­¤å¦‚æœforå¾ªç¯ä¸­çš„ä»£ç é‡æ–°ç»™cèµ‹å€¼å°±ä¼šéæ³•ï¼Œå¦‚æœä¸æ”¹å˜cçš„å€¼ï¼Œé‚£ä¹ˆåˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 3-12"><a href="#ç»ƒä¹ 3-12" class="headerlink" title="ç»ƒä¹ 3.12"></a>ç»ƒä¹ 3.12</h2><p>ä¸‹åˆ—vectorå¯¹è±¡çš„å®šä¹‰æœ‰ä¸æ­£ç¡®çš„å—ï¼Ÿå¦‚æœæœ‰ï¼Œè¯·æŒ‡å‡ºæ¥ã€‚å¯¹äºæ­£ç¡®çš„ï¼Œæè¿°å…¶æ‰§è¡Œç»“æœï¼›å¯¹äºä¸æ­£ç¡®çš„ï¼Œè¯´æ˜å…¶é”™è¯¯çš„åŸå› ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> ivec<span class="token punctuation">;</span>         <span class="token comment">// åœ¨C++11å½“ä¸­åˆæ³•</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> svec <span class="token operator">=</span> ivec<span class="token punctuation">;</span>       <span class="token comment">// ä¸åˆæ³•ï¼Œç±»å‹ä¸ä¸€æ ·</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">svec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// åˆæ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-13"><a href="#ç»ƒä¹ 3-13" class="headerlink" title="ç»ƒä¹ 3.13"></a>ç»ƒä¹ 3.13</h2><p>ä¸‹åˆ—çš„vectorå¯¹è±¡å„åŒ…å«å¤šå°‘ä¸ªå…ƒç´ ï¼Ÿè¿™äº›å…ƒç´ çš„å€¼åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v1<span class="token punctuation">;</span>         <span class="token comment">// size:0,  no values.</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// size:10, value:0</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// size:10, value:42</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v4<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>     <span class="token comment">// size:1,  value:10</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v5<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// size:2,  value:10, 42</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v6<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// size:10, value:""</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v7<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"hi"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// size:10, value:"hi"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-14"><a href="#ç»ƒä¹ 3-14" class="headerlink" title="ç»ƒä¹ 3.14"></a>ç»ƒä¹ 3.14</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œç”¨cinè¯»å…¥ä¸€ç»„æ•´æ•°å¹¶æŠŠå®ƒä»¬å­˜å…¥ä¸€ä¸ªvectorå¯¹è±¡ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-15"><a href="#ç»ƒä¹ 3-15" class="headerlink" title="ç»ƒä¹ 3.15"></a>ç»ƒä¹ 3.15</h2><p>æ”¹å†™ä¸Šé¢˜ç¨‹åºï¼Œä¸è¿‡è¿™æ¬¡è¯»å…¥çš„æ˜¯å­—ç¬¦ä¸²ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v<span class="token punctuation">;</span>string i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-16"><a href="#ç»ƒä¹ 3-16" class="headerlink" title="ç»ƒä¹ 3.16"></a>ç»ƒä¹ 3.16</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼ŒæŠŠç»ƒä¹ 3.13ä¸­vectorå¯¹è±¡çš„å®¹é‡å’Œå…·ä½“å†…å®¹è¾“å‡ºå‡ºæ¥</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v1<span class="token punctuation">;</span>         <span class="token comment">// size:0,  no values.</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// size:10, value:0</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// size:10, value:42</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v4<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>     <span class="token comment">// size:1,  value:10</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v5<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// size:2,  value:10, 42</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v6<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// size:10, value:""</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v7<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"hi"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// size:10, value:"hi"</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v1 size :"</span> <span class="token operator">&lt;&lt;</span> v1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v2 size :"</span> <span class="token operator">&lt;&lt;</span> v2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v3 size :"</span> <span class="token operator">&lt;&lt;</span> v3<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v4 size :"</span> <span class="token operator">&lt;&lt;</span> v4<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v5 size :"</span> <span class="token operator">&lt;&lt;</span> v5<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v6 size :"</span> <span class="token operator">&lt;&lt;</span> v6<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v7 size :"</span> <span class="token operator">&lt;&lt;</span> v7<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v1 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v2 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v3 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v3<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v4 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v4<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v5 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v5<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v6 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v6<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"v7 content: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v7<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" , "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-17"><a href="#ç»ƒä¹ 3-17" class="headerlink" title="ç»ƒä¹ 3.17"></a>ç»ƒä¹ 3.17</h2><p>ä»cinè¯»å…¥ä¸€ç»„è¯å¹¶æŠŠå®ƒä»¬å­˜å…¥ä¸€ä¸ªvectorå¯¹è±¡ï¼Œç„¶åè®¾æ³•æŠŠæ‰€æœ‰è¯éƒ½æ”¹ä¸ºå¤§å†™å½¢å¼ã€‚è¾“å‡ºæ”¹å˜åçš„ç»“æœï¼Œæ¯ä¸ªè¯å ä¸€è¡Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v<span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>str <span class="token operator">:</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>c <span class="token operator">:</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>c <span class="token operator">=</span> <span class="token function">toupper</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-18"><a href="#ç»ƒä¹ 3-18" class="headerlink" title="ç»ƒä¹ 3.18"></a>ç»ƒä¹ 3.18</h2><p>ä¸‹é¢çš„ç¨‹åºåˆæ³•å—ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œä½ å‡†å¤‡å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec<span class="token punctuation">;</span>ivec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆæ³•ã€‚åº”æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">ivec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-19"><a href="#ç»ƒä¹ 3-19" class="headerlink" title="ç»ƒä¹ 3.19"></a>ç»ƒä¹ 3.19</h2><p>å¦‚æœæƒ³å®šä¹‰ä¸€ä¸ªå«æœ‰10ä¸ªå…ƒç´ çš„vectorå¯¹è±¡ï¼Œæ‰€æœ‰å…ƒç´ çš„å€¼éƒ½æ˜¯42ï¼Œè¯·ä¾‹ä¸¾ä¸‰ç§ä¸åŒçš„å®ç°æ–¹æ³•ï¼Œå“ªç§æ–¹å¼æ›´å¥½å‘¢ï¼Ÿ</p><p>å¦‚ä¸‹ä¸‰ç§ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">ivec1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec2<span class="token punctuation">&#123;</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">42</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec3<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>ivec3<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸€ç§æ–¹å¼æœ€å¥½ã€‚</p><h2 id="ç»ƒä¹ 3-20"><a href="#ç»ƒä¹ 3-20" class="headerlink" title="ç»ƒä¹ 3.20"></a>ç»ƒä¹ 3.20</h2><p>è¯»å…¥ä¸€ç»„æ•´æ•°å¹¶æŠŠä»–ä»¬å­˜å…¥ä¸€ä¸ªvectorå¯¹è±¡ï¼Œå°†æ¯å¯¹ç›¸é‚»æ•´æ•°çš„å’Œè¾“å‡ºå‡ºæ¥ã€‚æ”¹å†™ä½ çš„ç¨‹åºï¼Œè¿™æ¬¡è¦æ±‚å…ˆè¾“å‡ºç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ çš„å’Œï¼Œæ¥ç€è¾“å‡ºç¬¬äºŒä¸ªå’Œå€’æ•°ç¬¬äºŒä¸ªå…ƒç´ çš„å’Œï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>ivec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ivec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> ivec<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> ivec<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//---------------------------------</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"---------------------------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> n <span class="token operator">=</span> ivec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> ivec<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">+</span> ivec<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token operator">++</span>m<span class="token punctuation">;</span><span class="token operator">--</span>n<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-21"><a href="#ç»ƒä¹ 3-21" class="headerlink" title="ç»ƒä¹ 3.21"></a>ç»ƒä¹ 3.21</h2><p>è¯·ä½¿ç”¨è¿­ä»£å™¨é‡åš3.3.3èŠ‚çš„ç¬¬ä¸€ä¸ªç»ƒä¹ ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">check_and_print</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"  content: ["</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">","</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"]\n"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">check_and_print</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"size: "</span> <span class="token operator">&lt;&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"  content: ["</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">","</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"]\n"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v1<span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v4<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v5<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">42</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v6<span class="token punctuation">&#123;</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v7<span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"hi"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">check_and_print</span><span class="token punctuation">(</span>v7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-22"><a href="#ç»ƒä¹ 3-22" class="headerlink" title="ç»ƒä¹ 3.22"></a>ç»ƒä¹ 3.22</h2><p>ä¿®æ”¹ä¹‹å‰é‚£ä¸ªè¾“å‡ºtextç¬¬ä¸€æ®µçš„ç¨‹åºï¼Œé¦–å…ˆæŠŠtextçš„ç¬¬ä¸€æ®µå…¨éƒ¨æ”¹æˆå¤§å†™å½¢å¼ï¼Œç„¶åè¾“å‡ºå®ƒã€‚</p><p>è§£ï¼š ç•¥   </p><h2 id="ç»ƒä¹ 3-23"><a href="#ç»ƒä¹ 3-23" class="headerlink" title="ç»ƒä¹ 3.23"></a>ç»ƒä¹ 3.23</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œåˆ›å»ºä¸€ä¸ªå«æœ‰10ä¸ªæ•´æ•°çš„vectorå¯¹è±¡ï¼Œç„¶åä½¿ç”¨è¿­ä»£å™¨å°†æ‰€æœ‰å…ƒç´ çš„å€¼éƒ½å˜æˆåŸæ¥çš„ä¸¤å€ã€‚è¾“å‡ºvectorå¯¹è±¡çš„å†…å®¹ï¼Œæ£€éªŒç¨‹åºæ˜¯å¦æ­£ç¡®ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it<span class="token operator">=</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">!=</span>v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token operator">*</span>it <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> one <span class="token operator">:</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> one <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-24"><a href="#ç»ƒä¹ 3-24" class="headerlink" title="ç»ƒä¹ 3.24"></a>ç»ƒä¹ 3.24</h2><p>è¯·ä½¿ç”¨è¿­ä»£å™¨é‡åš3.3.3èŠ‚çš„æœ€åä¸€ä¸ªç»ƒä¹ ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ivec<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>ivec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> ivec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> ivec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//---------------------------------</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"---------------------------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">auto</span> it1 <span class="token operator">=</span> ivec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> it2 <span class="token operator">=</span> ivec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>it1 <span class="token operator">&lt;</span> it2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it1 <span class="token operator">+</span> <span class="token operator">*</span>it2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token operator">++</span>it1<span class="token punctuation">;</span><span class="token operator">--</span>it2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-25"><a href="#ç»ƒä¹ 3-25" class="headerlink" title="ç»ƒä¹ 3.25"></a>ç»ƒä¹ 3.25</h2><p>3.3.3èŠ‚åˆ’åˆ†åˆ†æ•°æ®µçš„ç¨‹åºæ˜¯ä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦å®ç°çš„ï¼Œè¯·åˆ©ç”¨è¿­ä»£å™¨æ”¹å†™è¯¥ç¨‹åºå®ç°å®Œå…¨ç›¸åŒçš„åŠŸèƒ½ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">scores</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> grade<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> grade<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>grade <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>scores<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> grade <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> s <span class="token operator">:</span> scores<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-26"><a href="#ç»ƒä¹ 3-26" class="headerlink" title="ç»ƒä¹ 3.26"></a>ç»ƒä¹ 3.26</h2><p>åœ¨100é¡µçš„äºŒåˆ†æœç´¢ç¨‹åºä¸­ï¼Œä¸ºä»€ä¹ˆç”¨çš„æ˜¯ <code>mid = beg + (end - beg) / 2</code>, è€Œé <code>mid = (beg + end) / 2 ;</code> ?</p><p>è§£ï¼š</p><p>å› ä¸ºä¸¤ä¸ªè¿­ä»£å™¨ç›¸äº’ä¹‹é—´æ”¯æŒçš„è¿ç®—åªæœ‰ <code>-</code> ï¼Œè€Œæ²¡æœ‰ <code>+</code> ã€‚<br>ä½†æ˜¯è¿­ä»£å™¨å’Œè¿­ä»£å™¨å·®å€¼ï¼ˆæ•´æ•°å€¼ï¼‰ä¹‹é—´æ”¯æŒ <code>+</code>ã€‚</p><h2 id="ç»ƒä¹ 3-27"><a href="#ç»ƒä¹ 3-27" class="headerlink" title="ç»ƒä¹ 3.27"></a>ç»ƒä¹ 3.27</h2><p>å‡è®¾<code>txt_size</code>æ˜¯ä¸€ä¸ªæ— å‚å‡½æ•°ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯<code>int</code>ã€‚è¯·å›ç­”ä¸‹åˆ—å“ªä¸ªå®šä¹‰æ˜¯éæ³•çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> buf_size <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> ia<span class="token punctuation">[</span>buf_size<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">7</span> <span class="token operator">-</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token function">txt_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">char</span> st<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"fundamental"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) éæ³•ã€‚ç»´åº¦å¿…é¡»æ˜¯ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ã€‚</li><li>(b) åˆæ³•ã€‚</li><li>(c) éæ³•ã€‚txt_size() çš„å€¼å¿…é¡»è¦åˆ°è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ã€‚</li><li>(d) éæ³•ã€‚æ•°ç»„çš„å¤§å°åº”è¯¥æ˜¯12ã€‚</li></ul><h2 id="ç»ƒä¹ 3-28"><a href="#ç»ƒä¹ 3-28" class="headerlink" title="ç»ƒä¹ 3.28"></a>ç»ƒä¹ 3.28</h2><p>ä¸‹åˆ—æ•°ç»„ä¸­å…ƒç´ çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string sa<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>string sa2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> ia2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ•°ç»„çš„å…ƒç´ ä¼šè¢«é»˜è®¤åˆå§‹åŒ–ã€‚<br><code>sa</code>çš„å…ƒç´ å€¼å…¨éƒ¨ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œ<code>ia</code> çš„å…ƒç´ å€¼å…¨éƒ¨ä¸º0ã€‚<br><code>sa2</code>çš„å…ƒç´ å€¼å…¨éƒ¨ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œ<code>ia2</code>çš„å…ƒç´ å€¼å…¨éƒ¨æœªå®šä¹‰ã€‚</p><h2 id="ç»ƒä¹ 3-29"><a href="#ç»ƒä¹ 3-29" class="headerlink" title="ç»ƒä¹ 3.29"></a>ç»ƒä¹ 3.29</h2><p>ç›¸æ¯”äºvector æ¥è¯´ï¼Œæ•°ç»„æœ‰å“ªäº›ç¼ºç‚¹ï¼Œè¯·ä¾‹ä¸¾ä¸€äº›ã€‚</p><p>è§£ï¼š</p><ul><li>æ•°ç»„çš„å¤§å°æ˜¯ç¡®å®šçš„ã€‚</li><li>ä¸èƒ½éšæ„å¢åŠ å…ƒç´ ã€‚</li><li>ä¸å…è®¸æ‹·è´å’Œèµ‹å€¼ã€‚</li></ul><h2 id="ç»ƒä¹ 3-30"><a href="#ç»ƒä¹ 3-30" class="headerlink" title="ç»ƒä¹ 3.30"></a>ç»ƒä¹ 3.30</h2><p>æŒ‡å‡ºä¸‹é¢ä»£ç ä¸­çš„ç´¢å¼•é”™è¯¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">constexpr</span> size_t array_size <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">int</span> ia<span class="token punctuation">[</span>array_size<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t ix <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ix <span class="token operator">&lt;=</span> array_size<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span>ia<span class="token punctuation">[</span>ix<span class="token punctuation">]</span> <span class="token operator">=</span> ix<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å½“<code>ix</code>å¢é•¿åˆ° 10 çš„æ—¶å€™ï¼Œ<code>ia[ix]</code>çš„ä¸‹æ ‡è¶Šç•Œã€‚</p><h2 id="ç»ƒä¹ 3-31"><a href="#ç»ƒä¹ 3-31" class="headerlink" title="ç»ƒä¹ 3.31"></a>ç»ƒä¹ 3.31</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œå®šä¹‰ä¸€ä¸ªå«æœ‰10ä¸ªintçš„æ•°ç»„ï¼Œä»¤æ¯ä¸ªå…ƒç´ çš„å€¼å°±æ˜¯å…¶ä¸‹æ ‡å€¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> arr<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-32"><a href="#ç»ƒä¹ 3-32" class="headerlink" title="ç»ƒä¹ 3.32"></a>ç»ƒä¹ 3.32</h2><p>å°†ä¸Šä¸€é¢˜åˆšåˆšåˆ›å»ºçš„æ•°ç»„æ‹·è´ç»™å¦ä¸€æ•°ç»„ã€‚åˆ©ç”¨vectoré‡å†™ç¨‹åºï¼Œå®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// array</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token keyword">int</span> arr2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">// vector</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v2</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v2<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-33"><a href="#ç»ƒä¹ 3-33" class="headerlink" title="ç»ƒä¹ 3.33"></a>ç»ƒä¹ 3.33</h2><p>å¯¹äº104é¡µçš„ç¨‹åºæ¥è¯´ï¼Œå¦‚æœä¸åˆå§‹åŒ–scoreså°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ çš„å€¼å°†ä¼šæœªå®šä¹‰ã€‚</p><h2 id="ç»ƒä¹ 3-34"><a href="#ç»ƒä¹ 3-34" class="headerlink" title="ç»ƒä¹ 3.34"></a>ç»ƒä¹ 3.34</h2><p>å‡å®š<code>p1</code> å’Œ <code>p2</code> éƒ½æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œåˆ™ä¸‹é¢ç¨‹åºçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹è¯¥ç¨‹åºæ˜¯éæ³•çš„ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">p1 <span class="token operator">+=</span> p2 <span class="token operator">-</span> p1<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å°† <code>p1</code> ç§»åŠ¨åˆ° <code>p2</code> çš„ä½ç½®ã€‚ä»»ä½•æƒ…å†µä¸‹éƒ½åˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 3-35"><a href="#ç»ƒä¹ 3-35" class="headerlink" title="ç»ƒä¹ 3.35"></a>ç»ƒä¹ 3.35</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œåˆ©ç”¨æŒ‡é’ˆå°†æ•°ç»„ä¸­çš„å…ƒç´ ç½®ä¸º0ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span>size<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ptr <span class="token operator">=</span> arr<span class="token punctuation">;</span> ptr <span class="token operator">!=</span> arr <span class="token operator">+</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>ptr<span class="token punctuation">)</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> arr<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-36"><a href="#ç»ƒä¹ 3-36" class="headerlink" title="ç»ƒä¹ 3.36"></a>ç»ƒä¹ 3.36</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œæ¯”è¾ƒä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸ç­‰ã€‚å†å†™ä¸€æ®µç¨‹åºï¼Œæ¯”è¾ƒä¸¤ä¸ªvectorå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>begin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>end<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token comment">// pb point to begin of the array, pe point to end of the array.</span><span class="token keyword">bool</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> <span class="token keyword">const</span> pb1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> <span class="token keyword">const</span> pe1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> <span class="token keyword">const</span> pb2<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> <span class="token keyword">const</span> pe2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pe1 <span class="token operator">-</span> pb1<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>pe2 <span class="token operator">-</span> pb2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// have different size.</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> i <span class="token operator">=</span> pb1<span class="token punctuation">,</span> <span class="token operator">*</span>j <span class="token operator">=</span> pb2<span class="token punctuation">;</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> pe1<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>j <span class="token operator">!=</span> pe2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">,</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>i <span class="token operator">!=</span> <span class="token operator">*</span>j<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> arr1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">begin</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two arrays are equal."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two arrays are not equal."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"=========="</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>vec1 <span class="token operator">==</span> vec2<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two vectors are equal."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"The two vectors are not equal."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-37"><a href="#ç»ƒä¹ 3-37" class="headerlink" title="ç»ƒä¹ 3.37"></a>ç»ƒä¹ 3.37</h2><p>ä¸‹é¢çš„ç¨‹åºæ˜¯ä½•å«ä¹‰ï¼Œç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span> ca<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'o'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>cp <span class="token operator">=</span> ca<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>cp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>cp <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token operator">++</span>cp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¼šå°†ca å­—ç¬¦æ•°ç»„ä¸­çš„å…ƒç´ æ‰“å°å‡ºæ¥ã€‚ä½†æ˜¯å› ä¸ºæ²¡æœ‰ç©ºå­—ç¬¦çš„å­˜åœ¨ï¼Œç¨‹åºä¸ä¼šé€€å‡ºå¾ªç¯ã€‚</p><h2 id="ç»ƒä¹ 3-38"><a href="#ç»ƒä¹ 3-38" class="headerlink" title="ç»ƒä¹ 3.38"></a>ç»ƒä¹ 3.38</h2><p>åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬æåˆ°ï¼Œå°†ä¸¤ä¸ªæŒ‡é’ˆç›¸åŠ ä¸ä½†æ˜¯éæ³•çš„ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚è¯·é—®ä¸ºä»€ä¹ˆä¸¤ä¸ªæŒ‡é’ˆç›¸åŠ æ²¡æœ‰æ„ä¹‰ï¼Ÿ</p><p>è§£ï¼š</p><p>å°†ä¸¤ä¸ªæŒ‡é’ˆç›¸å‡å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªæŒ‡é’ˆ(åœ¨åŒä¸€æ•°ç»„ä¸­)ç›¸è·çš„è·ç¦»ï¼Œå°†æŒ‡é’ˆåŠ ä¸Šä¸€ä¸ªæ•´æ•°ä¹Ÿå¯ä»¥è¡¨ç¤ºç§»åŠ¨è¿™ä¸ªæŒ‡é’ˆåˆ°æŸä¸€ä½ç½®ã€‚ä½†æ˜¯ä¸¤ä¸ªæŒ‡é’ˆç›¸åŠ å¹¶æ²¡æœ‰é€»è¾‘ä¸Šçš„æ„ä¹‰ï¼Œå› æ­¤ä¸¤ä¸ªæŒ‡é’ˆä¸èƒ½ç›¸åŠ ã€‚</p><h2 id="ç»ƒä¹ 3-39"><a href="#ç»ƒä¹ 3-39" class="headerlink" title="ç»ƒä¹ 3.39"></a>ç»ƒä¹ 3.39</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œæ¯”è¾ƒä¸¤ä¸ª <code>string</code> å¯¹è±¡ã€‚å†ç¼–å†™ä¸€æ®µç¨‹åºï¼Œæ¯”è¾ƒä¸¤ä¸ªCé£æ ¼å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// use string.</span>    string <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"Mooophy"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">s2</span><span class="token punctuation">(</span><span class="token string">"Pezy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"same string."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1 <span class="token operator">></span> s2<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Mooophy > Pezy"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Mooophy &lt; Pezy"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"========="</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// use C-Style character strings.</span>    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> cs1 <span class="token operator">=</span> <span class="token string">"Wangyue"</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> cs2 <span class="token operator">=</span> <span class="token string">"Pezy"</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> result <span class="token operator">=</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>cs1<span class="token punctuation">,</span> cs2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"same string."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Wangyue &lt; Pezy"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Wangyue > Pezy"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-40"><a href="#ç»ƒä¹ 3-40" class="headerlink" title="ç»ƒä¹ 3.40"></a>ç»ƒä¹ 3.40</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œå®šä¹‰ä¸¤ä¸ªå­—ç¬¦æ•°ç»„å¹¶ç”¨å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ–å®ƒä»¬ï¼›æ¥ç€å†å®šä¹‰ä¸€ä¸ªå­—ç¬¦æ•°ç»„å­˜æ”¾å‰é¢ä¸¤ä¸ªæ•°ç»„è¿æ¥åçš„ç»“æœã€‚ä½¿ç”¨<code>strcpy</code>å’Œ<code>strcat</code>æŠŠå‰ä¸¤ä¸ªæ•°ç»„çš„å†…å®¹æ‹·è´åˆ°ç¬¬ä¸‰ä¸ªæ•°ç»„å½“ä¸­ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token keyword">const</span> <span class="token keyword">char</span> cstr1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"Hello"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> cstr2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"world!"</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">constexpr</span> size_t new_size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>cstr1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>cstr2<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> cstr3<span class="token punctuation">[</span>new_size<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>cstr3<span class="token punctuation">,</span> cstr1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcat</span><span class="token punctuation">(</span>cstr3<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcat</span><span class="token punctuation">(</span>cstr3<span class="token punctuation">,</span> cstr2<span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> cstr3 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-41"><a href="#ç»ƒä¹ 3-41" class="headerlink" title="ç»ƒä¹ 3.41"></a>ç»ƒä¹ 3.41</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œç”¨æ•´å‹æ•°ç»„åˆå§‹åŒ–ä¸€ä¸ªvectorå¯¹è±¡ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>begin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>end<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-42"><a href="#ç»ƒä¹ 3-42" class="headerlink" title="ç»ƒä¹ 3.42"></a>ç»ƒä¹ 3.42</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œå°†å«æœ‰æ•´æ•°å…ƒç´ çš„ <code>vector</code> å¯¹è±¡æ‹·è´ç»™ä¸€ä¸ªæ•´å‹æ•°ç»„ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>begin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>end<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> arr<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-43"><a href="#ç»ƒä¹ 3-43" class="headerlink" title="ç»ƒä¹ 3.43"></a>ç»ƒä¹ 3.43</h2><p>ç¼–å†™3ä¸ªä¸åŒç‰ˆæœ¬çš„ç¨‹åºï¼Œä»¤å…¶å‡èƒ½è¾“å‡º<code>ia</code>çš„å…ƒç´ ã€‚<br>ç‰ˆæœ¬1ä½¿ç”¨èŒƒå›´<code>for</code>è¯­å¥ç®¡ç†è¿­ä»£è¿‡ç¨‹ï¼›ç‰ˆæœ¬2å’Œç‰ˆæœ¬3éƒ½ä½¿ç”¨æ™®é€š<code>for</code>è¯­å¥ï¼Œå…¶ä¸­ç‰ˆæœ¬2è¦æ±‚ä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦ï¼Œç‰ˆæœ¬3è¦æ±‚ä½¿ç”¨æŒ‡é’ˆã€‚<br>æ­¤å¤–ï¼Œåœ¨æ‰€æœ‰3ä¸ªç‰ˆæœ¬çš„ç¨‹åºä¸­éƒ½è¦ç›´æ¥å†™å‡ºæ•°æ®ç±»å‹ï¼Œè€Œä¸èƒ½ä½¿ç”¨ç±»å‹åˆ«åã€<code>auto</code>å…³é”®å­—å’Œ<code>decltype</code>å…³é”®å­—ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span>     <span class="token punctuation">&#123;</span>         <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">&#123;</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">// range for</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>row<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">:</span> arr<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">:</span> row<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> col <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// for loop</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// using pointers.</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>row<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">;</span> row <span class="token operator">!=</span> arr <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>row<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>col <span class="token operator">=</span> <span class="token operator">*</span>row<span class="token punctuation">;</span> col <span class="token operator">!=</span> <span class="token operator">*</span>row <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>col<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>col <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-44"><a href="#ç»ƒä¹ 3-44" class="headerlink" title="ç»ƒä¹ 3.44"></a>ç»ƒä¹ 3.44</h2><p>æ”¹å†™ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­çš„ç¨‹åºï¼Œä½¿ç”¨ç±»å‹åˆ«åæ¥ä»£æ›¿å¾ªç¯æ§åˆ¶å˜é‡çš„ç±»å‹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">// a range for to manage the iteration</span>    <span class="token comment">// use type alias</span>    <span class="token keyword">using</span> int_array <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>int_array<span class="token operator">&amp;</span> p <span class="token operator">:</span> ia<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> q <span class="token operator">:</span> p<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> q <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// ordinary for loop using subscripts</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// using pointers.</span>    <span class="token comment">// use type alias</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>int_array<span class="token operator">*</span> p <span class="token operator">=</span> ia<span class="token punctuation">;</span> p <span class="token operator">!=</span> ia <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>p<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>q <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span> q <span class="token operator">!=</span> <span class="token operator">*</span>p <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>q<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>q <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 3-45"><a href="#ç»ƒä¹ 3-45" class="headerlink" title="ç»ƒä¹ 3.45"></a>ç»ƒä¹ 3.45</h2><p>å†ä¸€æ¬¡æ”¹å†™ç¨‹åºï¼Œè¿™æ¬¡ä½¿ç”¨ <code>auto</code> å…³é”®å­—ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">// a range for to manage the iteration</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> p <span class="token operator">:</span> ia<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> q <span class="token operator">:</span> p<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> q <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// ordinary for loop using subscripts</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// using pointers.</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">=</span> ia<span class="token punctuation">;</span> p <span class="token operator">!=</span> ia <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>p<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>q <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span> q <span class="token operator">!=</span> <span class="token operator">*</span>p <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>q<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>q <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ5</title>
      <link href="2021/04/10/excersize/ch05/"/>
      <url>2021/04/10/excersize/ch05/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬äº”ç« -è¯­å¥"><a href="#ç¬¬äº”ç« -è¯­å¥" class="headerlink" title="ç¬¬äº”ç«  è¯­å¥"></a>ç¬¬äº”ç«  è¯­å¥</h1><h2 id="ç»ƒä¹ 5-1"><a href="#ç»ƒä¹ 5-1" class="headerlink" title="ç»ƒä¹ 5.1"></a>ç»ƒä¹ 5.1</h2><p>ä»€ä¹ˆæ˜¯ç©ºè¯­å¥ï¼Ÿä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ç©ºè¯­å¥ï¼Ÿ</p><p>è§£ï¼š</p><p>åªå«ä¹‰ä¸€ä¸ªå•ç‹¬çš„åˆ†å·çš„è¯­å¥æ˜¯ç©ºè¯­å¥ã€‚å¦‚ï¼š<code>;</code>ã€‚</p><p>å¦‚æœåœ¨ç¨‹åºçš„æŸä¸ªåœ°æ–¹ï¼Œè¯­æ³•ä¸Šéœ€è¦ä¸€æ¡è¯­å¥ä½†æ˜¯é€»è¾‘ä¸Šä¸éœ€è¦ï¼Œæ­¤æ—¶åº”è¯¥ä½¿ç”¨ç©ºè¯­å¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> sought<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-2"><a href="#ç»ƒä¹ 5-2" class="headerlink" title="ç»ƒä¹ 5.2"></a>ç»ƒä¹ 5.2</h2><p>ä»€ä¹ˆæ˜¯å—ï¼Ÿä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°å—ï¼Ÿ</p><p>è§£ï¼š</p><p>ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥çš„è¯­å¥å’Œå£°æ˜çš„åºåˆ—å°±æ˜¯å—ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">&#123;</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœåœ¨ç¨‹åºçš„æŸä¸ªåœ°æ–¹ï¼Œè¯­æ³•ä¸Šéœ€è¦ä¸€æ¡è¯­å¥ï¼Œè€Œé€»è¾‘ä¸Šéœ€è¦å¤šæ¡è¯­å¥ï¼Œæ­¤æ—¶åº”è¯¥ä½¿ç”¨å—</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>sum <span class="token operator">+=</span> val<span class="token punctuation">;</span><span class="token operator">++</span>val<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-3"><a href="#ç»ƒä¹ 5-3" class="headerlink" title="ç»ƒä¹ 5.3"></a>ç»ƒä¹ 5.3</h2><p>ä½¿ç”¨é€—å·è¿ç®—ç¬¦é‡å†™1.4.1èŠ‚çš„<code>while</code>å¾ªç¯ï¼Œä½¿å®ƒä¸å†éœ€è¦å—ï¼Œè§‚å¯Ÿæ”¹å†™ä¹‹åçš„ä»£ç å¯è¯»æ€§æé«˜äº†è¿˜æ˜¯é™ä½äº†ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span>    sum <span class="token operator">+=</span> val<span class="token punctuation">,</span> <span class="token operator">++</span>val<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»£ç çš„å¯è¯»æ€§åè€Œé™ä½äº†ã€‚</p><h2 id="ç»ƒä¹ 5-4"><a href="#ç»ƒä¹ 5-4" class="headerlink" title="ç»ƒä¹ 5.4"></a>ç»ƒä¹ 5.4</h2><p>è¯´æ˜ä¸‹åˆ—ä¾‹å­çš„å«ä¹‰ï¼Œå¦‚æœå­˜åœ¨é—®é¢˜ï¼Œè¯•ç€ä¿®æ”¹å®ƒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>string<span class="token operator">::</span>iterator iter <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* . . . */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">bool</span> status <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* . . . */</span> <span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>status<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* . . . */</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) è¿™ä¸ªå¾ªç¯è¯•å›¾ç”¨è¿­ä»£å™¨éå†<code>string</code>ï¼Œä½†æ˜¯å˜é‡çš„å®šä¹‰åº”è¯¥æ”¾åœ¨å¾ªç¯çš„å¤–é¢ï¼Œç›®å‰æ¯æ¬¡å¾ªç¯éƒ½ä¼šé‡æ–°å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œæ˜æ˜¾æ˜¯é”™è¯¯çš„ã€‚</li><li>(b) è¿™ä¸ªå¾ªç¯çš„<code>while</code>å’Œ<code>if</code>æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¯­å¥ï¼Œ<code>if</code>è¯­å¥ä¸­æ— æ³•è®¿é—®<code>status</code>å˜é‡ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯åº”è¯¥å°†<code>if</code>è¯­å¥åŒ…å«åœ¨<code>while</code>é‡Œé¢ã€‚</li></ul><h2 id="ç»ƒä¹ 5-5"><a href="#ç»ƒä¹ 5-5" class="headerlink" title="ç»ƒä¹ 5.5"></a>ç»ƒä¹ 5.5</h2><p>å†™ä¸€æ®µè‡ªå·±çš„ç¨‹åºï¼Œä½¿ç”¨<code>if else</code>è¯­å¥å®ç°æŠŠæ•°å­—è½¬æ¢ä¸ºå­—æ¯æˆç»©çš„è¦æ±‚ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> scores <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"A++"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> g<span class="token punctuation">;</span> cin <span class="token operator">>></span> g<span class="token punctuation">;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string letter<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            letter <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            letter <span class="token operator">=</span> scores<span class="token punctuation">[</span><span class="token punctuation">(</span>g <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>g <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span>                letter <span class="token operator">+=</span> g <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">></span> <span class="token number">7</span> <span class="token operator">?</span> <span class="token string">"+"</span> <span class="token operator">:</span> g <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">?</span> <span class="token string">"-"</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        cout <span class="token operator">&lt;&lt;</span> letter <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-6"><a href="#ç»ƒä¹ 5-6" class="headerlink" title="ç»ƒä¹ 5.6"></a>ç»ƒä¹ 5.6</h2><p>æ”¹å†™ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦ä»£æ›¿<code>if else</code>è¯­å¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> scores <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"A++"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> grade <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> grade<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string lettergrade <span class="token operator">=</span> grade <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token operator">?</span> scores<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">:</span> scores<span class="token punctuation">[</span><span class="token punctuation">(</span>grade <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        lettergrade <span class="token operator">+=</span> <span class="token punctuation">(</span>grade <span class="token operator">==</span> <span class="token number">100</span> <span class="token operator">||</span> grade <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token punctuation">(</span>grade <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"+"</span> <span class="token operator">:</span> <span class="token punctuation">(</span>grade <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"-"</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> lettergrade <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-7"><a href="#ç»ƒä¹ 5-7" class="headerlink" title="ç»ƒä¹ 5.7"></a>ç»ƒä¹ 5.7</h2><p>æ”¹å†™ä¸‹åˆ—ä»£ç æ®µä¸­çš„é”™è¯¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ival1 <span class="token operator">!=</span> ival2<span class="token punctuation">)</span> ival1 <span class="token operator">=</span> ival2    <span class="token keyword">else</span>     ival1 <span class="token operator">=</span> ival2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ival <span class="token operator">&lt;</span> minval<span class="token punctuation">)</span> minval <span class="token operator">=</span> ival<span class="token punctuation">;</span>    occurs <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ival <span class="token operator">=</span> <span class="token function">get_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ival = "</span> <span class="token operator">&lt;&lt;</span> ival <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ival<span class="token punctuation">)</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ival = 0\n"</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ival <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>    ival <span class="token operator">=</span> <span class="token function">get_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) <code>ival1 = ival2</code> åé¢å°‘äº†åˆ†å·ã€‚</li><li>(b) åº”è¯¥ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ã€‚</li><li>(c) <code>if (!ival)</code> åº”è¯¥æ”¹ä¸º <code>else</code>ã€‚</li><li>(d) <code>if (ival = 0)</code> åº”è¯¥æ”¹ä¸º <code>if (ival == 0)</code>ã€‚</li></ul><h2 id="ç»ƒä¹ 5-8"><a href="#ç»ƒä¹ 5-8" class="headerlink" title="ç»ƒä¹ 5.8"></a>ç»ƒä¹ 5.8</h2><p>ä»€ä¹ˆæ˜¯â€œæ‚¬å‚elseâ€ï¼ŸC++è¯­è¨€æ˜¯å¦‚ä½•å¤„ç†elseå­å¥çš„ï¼Ÿ</p><p>è§£ï¼š</p><p>ç”¨æ¥æè¿°åœ¨åµŒå¥—çš„<code>if else</code>è¯­å¥ä¸­ï¼Œå¦‚æœ<code>if</code>æ¯”<code>else</code>å¤šæ—¶å¦‚ä½•å¤„ç†çš„é—®é¢˜ã€‚C++ä½¿ç”¨çš„æ–¹æ³•æ˜¯<code>else</code>åŒ¹é…æœ€è¿‘æ²¡æœ‰é…å¯¹çš„<code>if</code>ã€‚</p><h2 id="ç»ƒä¹ 5-9"><a href="#ç»ƒä¹ 5-9" class="headerlink" title="ç»ƒä¹ 5.9"></a>ç»ƒä¹ 5.9</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä½¿ç”¨ä¸€ç³»åˆ—<code>if</code>è¯­å¥ç»Ÿè®¡ä»<code>cin</code>è¯»å…¥çš„æ–‡æœ¬ä¸­æœ‰å¤šå°‘å…ƒéŸ³å­—æ¯ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> uCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> ch<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">++</span>aCnt<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token operator">++</span>eCnt<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'i'</span><span class="token punctuation">)</span> <span class="token operator">++</span>iCnt<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'o'</span><span class="token punctuation">)</span> <span class="token operator">++</span>oCnt<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'u'</span><span class="token punctuation">)</span> <span class="token operator">++</span>uCnt<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel a: \t"</span> <span class="token operator">&lt;&lt;</span> aCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel e: \t"</span> <span class="token operator">&lt;&lt;</span> eCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel i: \t"</span> <span class="token operator">&lt;&lt;</span> iCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel o: \t"</span> <span class="token operator">&lt;&lt;</span> oCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel u: \t"</span> <span class="token operator">&lt;&lt;</span> uCnt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-10"><a href="#ç»ƒä¹ 5-10" class="headerlink" title="ç»ƒä¹ 5.10"></a>ç»ƒä¹ 5.10</h2><p>æˆ‘ä»¬ä¹‹å‰å®ç°çš„ç»Ÿè®¡å…ƒéŸ³å­—æ¯çš„ç¨‹åºå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœå…ƒéŸ³å­—æ¯ä»¥å¤§å†™å½¢å¼å‡ºç°ï¼Œä¸ä¼šè¢«ç»Ÿè®¡åœ¨å†…ã€‚ç¼–å†™ä¸€æ®µç¨‹åºï¼Œæ—¢ç»Ÿè®¡å…ƒéŸ³å­—æ¯çš„å°å†™å½¢å¼ï¼Œä¹Ÿç»Ÿè®¡å…ƒéŸ³å­—æ¯çš„å¤§å†™å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°ç¨‹åºé‡åˆ°â€™aâ€™å’Œâ€™Aâ€™éƒ½åº”è¯¥é€’å¢<code>aCnt</code>çš„å€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> uCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> ch<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> ch<span class="token punctuation">)</span><span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'A'</span><span class="token operator">:</span><span class="token operator">++</span>aCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'e'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'E'</span><span class="token operator">:</span><span class="token operator">++</span>eCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'i'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'I'</span><span class="token operator">:</span><span class="token operator">++</span>iCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'o'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'O'</span><span class="token operator">:</span><span class="token operator">++</span>oCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'u'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'U'</span><span class="token operator">:</span><span class="token operator">++</span>uCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel a(A): \t"</span> <span class="token operator">&lt;&lt;</span> aCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel e(E): \t"</span> <span class="token operator">&lt;&lt;</span> eCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel i(I): \t"</span> <span class="token operator">&lt;&lt;</span> iCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel o(O): \t"</span> <span class="token operator">&lt;&lt;</span> oCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel u(U): \t"</span> <span class="token operator">&lt;&lt;</span> uCnt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-11"><a href="#ç»ƒä¹ 5-11" class="headerlink" title="ç»ƒä¹ 5.11"></a>ç»ƒä¹ 5.11</h2><p>ä¿®æ”¹ç»Ÿè®¡å…ƒéŸ³å­—æ¯çš„ç¨‹åºï¼Œä½¿å…¶ä¹Ÿèƒ½ç»Ÿè®¡ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€å’Œæ¢è¡Œç¬¦çš„æ•°é‡ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> uCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> spaceCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> tabCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newLineCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> ch<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> std<span class="token operator">::</span>noskipws <span class="token operator">>></span> ch<span class="token punctuation">)</span>  <span class="token comment">//noskipws(no skip whitespce)</span><span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'A'</span><span class="token operator">:</span><span class="token operator">++</span>aCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'e'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'E'</span><span class="token operator">:</span><span class="token operator">++</span>eCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'i'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'I'</span><span class="token operator">:</span><span class="token operator">++</span>iCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'o'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'O'</span><span class="token operator">:</span><span class="token operator">++</span>oCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'u'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'U'</span><span class="token operator">:</span><span class="token operator">++</span>uCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">' '</span><span class="token operator">:</span><span class="token operator">++</span>spaceCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'\t'</span><span class="token operator">:</span><span class="token operator">++</span>tabCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'\n'</span><span class="token operator">:</span><span class="token operator">++</span>newLineCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel a(A): \t"</span> <span class="token operator">&lt;&lt;</span> aCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel e(E): \t"</span> <span class="token operator">&lt;&lt;</span> eCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel i(I): \t"</span> <span class="token operator">&lt;&lt;</span> iCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel o(O): \t"</span> <span class="token operator">&lt;&lt;</span> oCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel u(U): \t"</span> <span class="token operator">&lt;&lt;</span> uCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of space: \t"</span> <span class="token operator">&lt;&lt;</span> spaceCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of tab char: \t"</span> <span class="token operator">&lt;&lt;</span> tabCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of new line: \t"</span> <span class="token operator">&lt;&lt;</span> newLineCnt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œä½¿ç”¨ <code>std::noskipws</code>å¯ä»¥ä¿ç•™é»˜è®¤è·³è¿‡çš„ç©ºæ ¼ã€‚</p><h2 id="ç»ƒä¹ 5-12"><a href="#ç»ƒä¹ 5-12" class="headerlink" title="ç»ƒä¹ 5.12"></a>ç»ƒä¹ 5.12</h2><p>ä¿®æ”¹ç»Ÿè®¡å…ƒéŸ³å­—æ¯çš„ç¨‹åºï¼Œä½¿å…¶èƒ½ç»Ÿè®¡å«ä»¥ä¸‹ä¸¤ä¸ªå­—ç¬¦çš„å­—ç¬¦åºåˆ—çš„æ•°é‡ï¼š<code>ff</code>ã€<code>fl</code>å’Œ<code>fi</code>ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> uCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> spaceCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> tabCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newLineCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ffCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> flCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fiCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> prech <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> std<span class="token operator">::</span>noskipws <span class="token operator">>></span> ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'A'</span><span class="token operator">:</span><span class="token operator">++</span>aCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'e'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'E'</span><span class="token operator">:</span><span class="token operator">++</span>eCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'i'</span><span class="token operator">:</span><span class="token keyword">if</span> <span class="token punctuation">(</span>prech <span class="token operator">==</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token operator">++</span>fiCnt<span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'I'</span><span class="token operator">:</span><span class="token operator">++</span>iCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'o'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'O'</span><span class="token operator">:</span><span class="token operator">++</span>oCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'u'</span><span class="token operator">:</span><span class="token keyword">case</span> <span class="token string">'U'</span><span class="token operator">:</span><span class="token operator">++</span>uCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">' '</span><span class="token operator">:</span><span class="token operator">++</span>spaceCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'\t'</span><span class="token operator">:</span><span class="token operator">++</span>tabCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'\n'</span><span class="token operator">:</span><span class="token operator">++</span>newLineCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'f'</span><span class="token operator">:</span><span class="token keyword">if</span> <span class="token punctuation">(</span>prech <span class="token operator">==</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token operator">++</span>ffCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'l'</span><span class="token operator">:</span><span class="token keyword">if</span> <span class="token punctuation">(</span>prech <span class="token operator">==</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token operator">++</span>flCnt<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>prech <span class="token operator">=</span> ch<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel a(A): \t"</span> <span class="token operator">&lt;&lt;</span> aCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel e(E): \t"</span> <span class="token operator">&lt;&lt;</span> eCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel i(I): \t"</span> <span class="token operator">&lt;&lt;</span> iCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel o(O): \t"</span> <span class="token operator">&lt;&lt;</span> oCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of vowel u(U): \t"</span> <span class="token operator">&lt;&lt;</span> uCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of space: \t"</span> <span class="token operator">&lt;&lt;</span> spaceCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of tab char: \t"</span> <span class="token operator">&lt;&lt;</span> tabCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of new line: \t"</span> <span class="token operator">&lt;&lt;</span> newLineCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of ff: \t"</span> <span class="token operator">&lt;&lt;</span> ffCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of fl: \t"</span> <span class="token operator">&lt;&lt;</span> flCnt <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"Number of fi: \t"</span> <span class="token operator">&lt;&lt;</span> fiCnt <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-13"><a href="#ç»ƒä¹ 5-13" class="headerlink" title="ç»ƒä¹ 5.13"></a>ç»ƒä¹ 5.13</h2><p>ä¸‹é¢æ˜¾ç¤ºçš„æ¯ä¸ªç¨‹åºéƒ½å«æœ‰ä¸€ä¸ªå¸¸è§çš„ç¼–ç é”™è¯¯ï¼ŒæŒ‡å‡ºé”™è¯¯åœ¨å“ªé‡Œï¼Œç„¶åä¿®æ”¹å®ƒä»¬ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iouCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">next_text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span> aCnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">'e'</span><span class="token operator">:</span> eCnt<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token operator">:</span> iouCnt<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">unsigned</span> index <span class="token operator">=</span> <span class="token function">some_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>            <span class="token keyword">int</span> ix <span class="token operator">=</span> <span class="token function">get_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ivec<span class="token punctuation">[</span> ix <span class="token punctuation">]</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token operator">:</span>            ix <span class="token operator">=</span> ivec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            ivec<span class="token punctuation">[</span> ix <span class="token punctuation">]</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">unsigned</span> evenCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oddCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> digit <span class="token operator">=</span> <span class="token function">get_num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>digit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token operator">:</span>            oddcnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">:</span>            evencnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">unsigned</span> ival<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> jval<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span> kval<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> bufsize<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> swt <span class="token operator">=</span> <span class="token function">get_bufCnt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>swt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> ival<span class="token operator">:</span>            bufsize <span class="token operator">=</span> ival <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> jval<span class="token operator">:</span>            bufsize <span class="token operator">=</span> jval <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> kval<span class="token operator">:</span>            bufsize <span class="token operator">=</span> kval <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>(a) å°‘äº†<code>break</code>è¯­å¥ã€‚åº”è¯¥ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> aCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> eCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> iouCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">next_text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span> aCnt<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token string">'e'</span><span class="token operator">:</span> eCnt<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span> iouCnt<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(b) åœ¨<code>default</code>åˆ†æ”¯å½“ä¸­ï¼Œ<code>ix</code>æœªå®šä¹‰ã€‚åº”è¯¥åœ¨å¤–éƒ¨å®šä¹‰<code>ix</code>ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> index <span class="token operator">=</span> <span class="token function">some_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ix<span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>            ix <span class="token operator">=</span> <span class="token function">get_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ivec<span class="token punctuation">[</span> ix <span class="token punctuation">]</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token operator">:</span>            ix <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>ivec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            ivec<span class="token punctuation">[</span> ix <span class="token punctuation">]</span> <span class="token operator">=</span> index<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(c) <code>case</code>åé¢åº”è¯¥ç”¨å†’å·è€Œä¸æ˜¯é€—å·ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">unsigned</span> evenCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> oddCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> digit <span class="token operator">=</span> <span class="token function">get_num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>digit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span>            oddcnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span> <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>            evencnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(d) <code>case</code>æ ‡ç­¾å¿…é¡»æ˜¯æ•´å‹å¸¸é‡è¡¨è¾¾å¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">unsigned</span> ival<span class="token operator">=</span><span class="token number">512</span><span class="token punctuation">,</span> jval<span class="token operator">=</span><span class="token number">1024</span><span class="token punctuation">,</span> kval<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> bufsize<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> swt <span class="token operator">=</span> <span class="token function">get_bufCnt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>swt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> ival<span class="token operator">:</span>            bufsize <span class="token operator">=</span> ival <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> jval<span class="token operator">:</span>            bufsize <span class="token operator">=</span> jval <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> kval<span class="token operator">:</span>            bufsize <span class="token operator">=</span> kval <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-14"><a href="#ç»ƒä¹ 5-14" class="headerlink" title="ç»ƒä¹ 5.14"></a>ç»ƒä¹ 5.14</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–è‹¥å¹²<code>string</code>å¯¹è±¡å¹¶æŸ¥æ‰¾è¿ç»­é‡å¤å‡ºç°çš„å•è¯ï¼Œæ‰€è°“è¿ç»­é‡å¤å‡ºç°çš„æ„æ€æ˜¯ï¼šä¸€ä¸ªå•è¯åé¢ç´§è·Ÿç€è¿™ä¸ªå•è¯æœ¬èº«ã€‚è¦æ±‚è®°å½•è¿ç»­é‡å¤å‡ºç°çš„æœ€å¤§æ¬¡æ•°ä»¥åŠå¯¹åº”çš„å•è¯ã€‚å¦‚æœè¿™æ ·çš„å•è¯å­˜åœ¨ï¼Œè¾“å‡ºé‡å¤å‡ºç°çš„æœ€å¤§æ¬¡æ•°ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œè¾“å‡ºä¸€æ¡ä¿¡æ¯è¯´æ˜ä»»ä½•å•è¯éƒ½æ²¡æœ‰è¿ç»­å‡ºç°è¿‡ã€‚<br>ä¾‹å¦‚ï¼šå¦‚æœè¾“å…¥æ˜¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">how now now now brown cow cow<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‚£ä¹ˆè¾“å‡ºåº”è¯¥è¡¨æ˜å•è¯nowè¿ç»­å‡ºç°äº†3æ¬¡ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>pair<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> max_duplicated<span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string str<span class="token punctuation">,</span> prestr<span class="token punctuation">;</span> cin <span class="token operator">>></span> str<span class="token punctuation">;</span> prestr <span class="token operator">=</span> str<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> prestr<span class="token punctuation">)</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>        <span class="token keyword">else</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> max_duplicated<span class="token punctuation">.</span>second<span class="token punctuation">)</span> max_duplicated <span class="token operator">=</span> <span class="token punctuation">&#123;</span> prestr<span class="token punctuation">,</span> count <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>max_duplicated<span class="token punctuation">.</span>first<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"There's no duplicated string."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"the word "</span> <span class="token operator">&lt;&lt;</span> max_duplicated<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" occurred "</span> <span class="token operator">&lt;&lt;</span> max_duplicated<span class="token punctuation">.</span>second <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" times. "</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-15"><a href="#ç»ƒä¹ 5-15" class="headerlink" title="ç»ƒä¹ 5.15"></a>ç»ƒä¹ 5.15</h2><p>è¯´æ˜ä¸‹åˆ—å¾ªç¯çš„å«ä¹‰å¹¶æ”¹æ­£å…¶ä¸­çš„é”™è¯¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ix <span class="token operator">!=</span> sz<span class="token punctuation">)</span>    <span class="token comment">// . . .</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> ix<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">,</span> <span class="token operator">++</span>sz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åº”è¯¥æ”¹ä¸ºä¸‹é¢è¿™æ ·ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> ix<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ix <span class="token operator">!=</span> sz<span class="token punctuation">)</span>    <span class="token comment">// . . .</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> ix<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ix <span class="token operator">!=</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>ix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-16"><a href="#ç»ƒä¹ 5-16" class="headerlink" title="ç»ƒä¹ 5.16"></a>ç»ƒä¹ 5.16</h2><p><code>while</code>å¾ªç¯ç‰¹åˆ«é€‚ç”¨äºé‚£ç§æ¡ä»¶ä¸å˜ã€åå¤æ‰§è¡Œæ“ä½œçš„æƒ…å†µï¼Œä¾‹å¦‚ï¼Œå½“æœªè¾¾åˆ°æ–‡ä»¶æœ«å°¾æ—¶ä¸æ–­è¯»å–ä¸‹ä¸€ä¸ªå€¼ã€‚<br><code>for</code>å¾ªç¯æ›´åƒæ˜¯åœ¨æŒ‰æ­¥éª¤è¿­ä»£ï¼Œå®ƒçš„ç´¢å¼•å€¼åœ¨æŸä¸ªèŒƒå›´å†…ä¸€æ¬¡å˜åŒ–ã€‚æ ¹æ®æ¯ç§å¾ªç¯çš„ä¹ æƒ¯å„è‡ªç¼–å†™ä¸€æ®µç¨‹åºï¼Œç„¶ååˆ†åˆ«ç”¨å¦ä¸€ç§å¾ªç¯æ”¹å†™ã€‚<br>å¦‚æœåªèƒ½ä½¿ç”¨ä¸€ç§å¾ªç¯ï¼Œä½ å€¾å‘äºå“ªç§ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span> cin <span class="token operator">>></span> i <span class="token punctuation">)</span>    <span class="token comment">// ...</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> cin <span class="token operator">>></span> i<span class="token punctuation">;</span><span class="token punctuation">)</span>    <span class="token comment">// ...</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>    <span class="token comment">// ...</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> size<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ...</span>    <span class="token operator">++</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœåªèƒ½ç”¨ä¸€ç§å¾ªç¯ï¼Œæˆ‘ä¼šæ›´å€¾å‘ä½¿ç”¨<code>while</code>ï¼Œå› ä¸º<code>while</code>æ˜¾å¾—ç®€æ´ï¼Œä»£ç å¯è¯»æ€§å¼ºã€‚</p><h2 id="ç»ƒä¹ 5-17"><a href="#ç»ƒä¹ 5-17" class="headerlink" title="ç»ƒä¹ 5.17"></a>ç»ƒä¹ 5.17</h2><p>å‡è®¾æœ‰ä¸¤ä¸ªåŒ…å«æ•´æ•°çš„<code>vector</code>å¯¹è±¡ï¼Œç¼–å†™ä¸€æ®µç¨‹åºï¼Œæ£€éªŒå…¶ä¸­ä¸€ä¸ª<code>vector</code>å¯¹è±¡æ˜¯å¦æ˜¯å¦ä¸€ä¸ªçš„å‰ç¼€ã€‚<br>ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå¯¹äºä¸¤ä¸ªä¸ç­‰é•¿çš„<code>vector</code>å¯¹è±¡ï¼Œåªéœ€æŒ‘å‡ºé•¿åº¦è¾ƒçŸ­çš„é‚£ä¸ªï¼ŒæŠŠå®ƒçš„æ‰€æœ‰å…ƒç´ å’Œå¦ä¸€ä¸ª<code>vector</code>å¯¹è±¡æ¯”è¾ƒå³å¯ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ª<code>vector</code>å¯¹è±¡çš„å…ƒç´ åˆ†åˆ«æ˜¯0ã€1ã€1ã€2 å’Œ 0ã€1ã€1ã€2ã€3ã€5ã€8ï¼Œåˆ™ç¨‹åºçš„è¿”å›ç»“æœä¸ºçœŸã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">is_prefix</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> rhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token function">is_prefix</span><span class="token punctuation">(</span>rhs<span class="token punctuation">,</span> lhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> lhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>lhs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> rhs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> l<span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> r<span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token function">is_prefix</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> l<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"yes\n"</span> <span class="token operator">:</span> <span class="token string">"no\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-18"><a href="#ç»ƒä¹ 5-18" class="headerlink" title="ç»ƒä¹ 5.18"></a>ç»ƒä¹ 5.18</h2><p>è¯´æ˜ä¸‹åˆ—å¾ªç¯çš„å«ä¹‰å¹¶æ”¹æ­£å…¶ä¸­çš„é”™è¯¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">&#123;</span> <span class="token comment">// åº”è¯¥æ·»åŠ èŠ±æ‹¬å·</span>        <span class="token keyword">int</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please enter two numbers to sum:"</span> <span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> v1 <span class="token operator">>></span> v2<span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Sum is: "</span> <span class="token operator">&lt;&lt;</span> v1 <span class="token operator">+</span> v2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> ival<span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// . . .</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ival <span class="token operator">=</span> <span class="token function">get_response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åº”è¯¥å°†ival å®šä¹‰åœ¨å¾ªç¯å¤–</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> ival <span class="token operator">=</span> <span class="token function">get_response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        ival <span class="token operator">=</span> <span class="token function">get_response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>ival<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åº”è¯¥å°†ival å®šä¹‰åœ¨å¾ªç¯å¤–</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-19"><a href="#ç»ƒä¹ 5-19" class="headerlink" title="ç»ƒä¹ 5.19"></a>ç»ƒä¹ 5.19</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä½¿ç”¨<code>do while</code>å¾ªç¯é‡å¤åœ°æ‰§è¡Œä¸‹è¿°ä»»åŠ¡ï¼š<br>é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ä¸¤ä¸ª<code>string</code>å¯¹è±¡ï¼Œç„¶åæŒ‘å‡ºè¾ƒçŸ­çš„é‚£ä¸ªå¹¶è¾“å‡ºå®ƒã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string rsp<span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input two strings: "</span><span class="token punctuation">;</span>        string str1<span class="token punctuation">,</span> str2<span class="token punctuation">;</span>        cin <span class="token operator">>></span> str1 <span class="token operator">>></span> str2<span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>str1 <span class="token operator">&lt;=</span> str2 <span class="token operator">?</span> str1 <span class="token operator">:</span> str2<span class="token punctuation">)</span>              <span class="token operator">&lt;&lt;</span> <span class="token string">" is less than the other. "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n\n"</span>             <span class="token operator">&lt;&lt;</span> <span class="token string">"More? Enter yes or no: "</span><span class="token punctuation">;</span>        cin <span class="token operator">>></span> rsp<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>rsp<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">tolower</span><span class="token punctuation">(</span>rsp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-20"><a href="#ç»ƒä¹ 5-20" class="headerlink" title="ç»ƒä¹ 5.20"></a>ç»ƒä¹ 5.20</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–<code>string</code>å¯¹è±¡çš„åºåˆ—ç›´åˆ°è¿ç»­å‡ºç°ä¸¤ä¸ªç›¸åŒçš„å•è¯æˆ–è€…æ‰€æœ‰çš„å•è¯éƒ½è¯»å®Œä¸ºæ­¢ã€‚<br>ä½¿ç”¨<code>while</code>å¾ªç¯ä¸€æ¬¡è¯»å–ä¸€ä¸ªå•è¯ï¼Œå½“ä¸€ä¸ªå•è¯è¿ç»­å‡ºç°ä¸¤æ¬¡æ—¶ä½¿ç”¨<code>break</code>è¯­å¥ç»ˆæ­¢å¾ªç¯ã€‚<br>è¾“å‡ºè¿ç»­é‡å¤å‡ºç°çš„å•è¯ï¼Œæˆ–è€…è¾“å‡ºä¸€ä¸ªæ¶ˆæ¯è¯´æ˜æ²¡æœ‰ä»»ä½•å•è¯æ˜¯è¿ç»­é‡å¤å‡ºç°çš„ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string read<span class="token punctuation">,</span> tmp<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> read<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>read <span class="token operator">==</span> tmp<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token keyword">else</span> tmp <span class="token operator">=</span> read<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cin<span class="token punctuation">.</span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  cout <span class="token operator">&lt;&lt;</span> <span class="token string">"no word was repeated."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//eof(end of file)åˆ¤æ–­è¾“å…¥æ˜¯å¦ç»“æŸ,æˆ–è€…æ–‡ä»¶ç»“æŸç¬¦,ç­‰åŒäº CTRL+Z</span>    <span class="token keyword">else</span>            cout <span class="token operator">&lt;&lt;</span> read <span class="token operator">&lt;&lt;</span> <span class="token string">" occurs twice in succession."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-21"><a href="#ç»ƒä¹ 5-21" class="headerlink" title="ç»ƒä¹ 5.21"></a>ç»ƒä¹ 5.21</h2><p>ä¿®æ”¹5.5.1èŠ‚ç»ƒä¹ é¢˜çš„ç¨‹åºï¼Œä½¿å…¶æ‰¾åˆ°çš„é‡å¤å•è¯å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string curr<span class="token punctuation">,</span> prev<span class="token punctuation">;</span>    <span class="token keyword">bool</span> no_twice <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> curr<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isupper</span><span class="token punctuation">(</span>curr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> prev <span class="token operator">==</span> curr<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            cout <span class="token operator">&lt;&lt;</span> curr <span class="token operator">&lt;&lt;</span> <span class="token string">": occurs twice in succession."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>            no_twice <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        prev <span class="token operator">=</span> curr<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>no_twice<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"no word was repeated."</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-22"><a href="#ç»ƒä¹ 5-22" class="headerlink" title="ç»ƒä¹ 5.22"></a>ç»ƒä¹ 5.22</h2><p>æœ¬èŠ‚çš„æœ€åä¸€ä¸ªä¾‹å­è·³å›åˆ°<code>begin</code>ï¼Œå…¶å®ä½¿ç”¨å¾ªç¯èƒ½æ›´å¥½çš„å®Œæˆè¯¥ä»»åŠ¡ï¼Œé‡å†™è¿™æ®µä»£ç ï¼Œæ³¨æ„ä¸å†ä½¿ç”¨<code>goto</code>è¯­å¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// å‘åè·³è¿‡ä¸€ä¸ªå¸¦åˆå§‹åŒ–çš„å˜é‡å®šä¹‰æ˜¯åˆæ³•çš„</span>begin<span class="token operator">:</span>    <span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token function">get_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>sz <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">goto</span> begin<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç”¨ for å¾ªç¯ä¿®æ”¹çš„è¯å°±æ˜¯è¿™æ ·</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token function">get_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> sz <span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">;</span> sz <span class="token operator">=</span> <span class="token function">get_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-23"><a href="#ç»ƒä¹ 5-23" class="headerlink" title="ç»ƒä¹ 5.23"></a>ç»ƒä¹ 5.23</h2><p>ç¼–å†™ä¸€æ®µç¨‹åºï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–ä¸¤ä¸ªæ•´æ•°ï¼Œè¾“å‡ºç¬¬ä¸€ä¸ªæ•°é™¤ä»¥ç¬¬äºŒä¸ªæ•°çš„ç»“æœã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>     cin <span class="token operator">>></span> i <span class="token operator">>></span> j<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">/</span> j <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-24"><a href="#ç»ƒä¹ 5-24" class="headerlink" title="ç»ƒä¹ 5.24"></a>ç»ƒä¹ 5.24</h2><p>ä¿®æ”¹ä½ çš„ç¨‹åºï¼Œä½¿å¾—å½“ç¬¬äºŒä¸ªæ•°æ˜¯0æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚å…ˆä¸è¦è®¾å®š<code>catch</code>å­å¥ï¼Œè¿è¡Œç¨‹åºå¹¶çœŸçš„ä¸ºé™¤æ•°è¾“å…¥0ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdexcept></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> i <span class="token operator">>></span> j<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"divisor is 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">/</span> j <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 5-25"><a href="#ç»ƒä¹ 5-25" class="headerlink" title="ç»ƒä¹ 5.25"></a>ç»ƒä¹ 5.25</h2><p>ä¿®æ”¹ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œä½¿ç”¨<code>try</code>è¯­å¥å—å»æ•è·å¼‚å¸¸ã€‚<code>catch</code>å­å¥åº”è¯¥ä¸ºç”¨æˆ·è¾“å‡ºä¸€æ¡æç¤ºä¿¡æ¯ï¼Œè¯¢é—®å…¶æ˜¯å¦è¾“å…¥æ–°æ•°å¹¶é‡æ–°æ‰§è¡Œ<code>try</code>è¯­å¥å—çš„å†…å®¹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdexcept></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>runtime_error<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input two integers:\n"</span><span class="token punctuation">,</span> cin <span class="token operator">>></span> i <span class="token operator">>></span> j<span class="token punctuation">;</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span>         <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                 <span class="token keyword">throw</span> <span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"divisor is 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">/</span> j <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span> <span class="token punctuation">(</span>runtime_error err<span class="token punctuation">)</span>         <span class="token punctuation">&#123;</span>            cout <span class="token operator">&lt;&lt;</span> err<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\nTry again? Enter y or n"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>            <span class="token keyword">char</span> c<span class="token punctuation">;</span>            cin <span class="token operator">>></span> c<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cin <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ9</title>
      <link href="2021/04/10/excersize/ch09/"/>
      <url>2021/04/10/excersize/ch09/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¹ç« -é¡ºåºå®¹å™¨"><a href="#ç¬¬ä¹ç« -é¡ºåºå®¹å™¨" class="headerlink" title="ç¬¬ä¹ç«  é¡ºåºå®¹å™¨"></a>ç¬¬ä¹ç«  é¡ºåºå®¹å™¨</h1><h2 id="ç»ƒä¹ 9-1"><a href="#ç»ƒä¹ 9-1" class="headerlink" title="ç»ƒä¹ 9.1"></a>ç»ƒä¹ 9.1</h2><blockquote><p>å¯¹äºä¸‹é¢çš„ç¨‹åºä»»åŠ¡ï¼Œ<code>vector</code>ã€<code>deque</code>å’Œ<code>list</code>å“ªç§å®¹å™¨æœ€ä¸ºé€‚åˆï¼Ÿè§£é‡Šä½ çš„é€‰æ‹©çš„ç†ç”±ã€‚å¦‚æœæ²¡æœ‰å“ªä¸€ç§å®¹å™¨ä¼˜äºå…¶ä»–å®¹å™¨ï¼Œä¹Ÿè¯·è§£é‡Šç†ç”±ã€‚</p></blockquote><ul><li>(a) è¯»å–å›ºå®šæ•°é‡çš„å•è¯ï¼Œå°†å®ƒä»¬æŒ‰å­—å…¸åºæ’å…¥åˆ°å®¹å™¨ä¸­ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« ä¸­çœ‹åˆ°ï¼Œå…³è”å®¹å™¨æ›´é€‚åˆè¿™ä¸ªé—®é¢˜ã€‚</li><li>(b) è¯»å–æœªçŸ¥æ•°é‡çš„å•è¯ï¼Œæ€»æ˜¯å°†å•è¯æ’å…¥åˆ°æœ«å°¾ã€‚åˆ é™¤æ“ä½œåœ¨å¤´éƒ¨è¿›è¡Œã€‚</li><li>(c) ä»ä¸€ä¸ªæ–‡ä»¶è¯»å–æœªçŸ¥æ•°é‡çš„æ•´æ•°ã€‚å°†è¿™äº›æ•°æ’åºï¼Œç„¶åå°†å®ƒä»¬æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚</li></ul><p>è§£ï¼š</p><ul><li>(a) <code>list</code> ï¼Œå› ä¸ºéœ€è¦é¢‘ç¹çš„æ’å…¥æ“ä½œã€‚</li><li>(b) <code>deque</code> ï¼Œæ€»æ˜¯åœ¨å¤´å°¾è¿›è¡Œæ’å…¥ã€åˆ é™¤æ“ä½œã€‚</li><li>(c) <code>vector</code> ï¼Œä¸éœ€è¦è¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œã€‚</li></ul><h2 id="ç»ƒä¹ 9-2"><a href="#ç»ƒä¹ 9-2" class="headerlink" title="ç»ƒä¹ 9.2"></a>ç»ƒä¹ 9.2</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>list</code>å¯¹è±¡ï¼Œå…¶å…ƒç´ ç±»å‹æ˜¯<code>int</code>çš„<code>deque</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>list<span class="token operator">&lt;</span>std<span class="token operator">::</span>deque<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> l<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-3"><a href="#ç»ƒä¹ 9-3" class="headerlink" title="ç»ƒä¹ 9.3"></a>ç»ƒä¹ 9.3</h2><blockquote><p>æ„æˆè¿­ä»£å™¨èŒƒå›´çš„è¿­ä»£å™¨æœ‰ä½•é™åˆ¶ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸¤ä¸ªè¿­ä»£å™¨ <code>begin</code> å’Œ <code>end</code>éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>å®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªå®¹å™¨ä¸­çš„å…ƒç´ ï¼Œæˆ–è€…æ˜¯å®¹å™¨æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„ä½ç½®ã€‚</li><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡åå¤é€’å¢<code>begin</code>æ¥åˆ°è¾¾<code>end</code>ã€‚æ¢å¥è¯è¯´ï¼Œ<code>end</code> ä¸åœ¨<code>begin</code>ä¹‹å‰ã€‚</li></ul><h2 id="ç»ƒä¹ 9-4"><a href="#ç»ƒä¹ 9-4" class="headerlink" title="ç»ƒä¹ 9.4"></a>ç»ƒä¹ 9.4</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œæ¥å—ä¸€å¯¹æŒ‡å‘<code>vector&lt;int&gt;</code>çš„è¿­ä»£å™¨å’Œä¸€ä¸ª<code>int</code>å€¼ã€‚åœ¨ä¸¤ä¸ªè¿­ä»£å™¨æŒ‡å®šçš„èŒƒå›´ä¸­æŸ¥æ‰¾ç»™å®šçš„å€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼æ¥æŒ‡å‡ºæ˜¯å¦æ‰¾åˆ°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">find</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator begin<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator end<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>begin<span class="token operator">++</span> <span class="token operator">!=</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>begin <span class="token operator">==</span> i<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-5"><a href="#ç»ƒä¹ 9-5" class="headerlink" title="ç»ƒä¹ 9.5"></a>ç»ƒä¹ 9.5</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨æŒ‡å‘æ‰¾åˆ°çš„å…ƒç´ ã€‚æ³¨æ„ï¼Œç¨‹åºå¿…é¡»å¤„ç†æœªæ‰¾åˆ°ç»™å®šå€¼çš„æƒ…å†µã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator <span class="token function">find</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator begin<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator end<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>begin <span class="token operator">!=</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>begin <span class="token operator">==</span> i<span class="token punctuation">)</span> <span class="token keyword">return</span> begin<span class="token punctuation">;</span><span class="token operator">++</span>begin<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> end<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-6"><a href="#ç»ƒä¹ 9-6" class="headerlink" title="ç»ƒä¹ 9.6"></a>ç»ƒä¹ 9.6</h2><blockquote><p>ä¸‹é¢çš„ç¨‹åºæœ‰ä½•é”™è¯¯ï¼Ÿä½ åº”è¯¥å¦‚ä½•ä¿®æ”¹å®ƒï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lst1<span class="token punctuation">;</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator iter1 <span class="token operator">=</span> lst1<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>iter2 <span class="token operator">=</span> lst1<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>iter1 <span class="token operator">&lt;</span> iter2<span class="token punctuation">)</span> <span class="token comment">/* ... */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£:</p><p>ä¿®æ”¹æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>iter1 <span class="token operator">!=</span> iter2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-7"><a href="#ç»ƒä¹ 9-7" class="headerlink" title="ç»ƒä¹ 9.7"></a>ç»ƒä¹ 9.7</h2><blockquote><p>ä¸ºäº†ç´¢å¼•<code>int</code>çš„<code>vector</code>ä¸­çš„å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨ä»€ä¹ˆç±»å‹ï¼Ÿ</p></blockquote><p>è§£:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>size_type<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-8"><a href="#ç»ƒä¹ 9-8" class="headerlink" title="ç»ƒä¹ 9.8"></a>ç»ƒä¹ 9.8</h2><blockquote><p>ä¸ºäº†è¯»å–<code>string</code>çš„<code>list</code>ä¸­çš„å…ƒç´ ï¼Œåº”è¯¥ä½¿ç”¨ä»€ä¹ˆç±»å‹ï¼Ÿå¦‚æœå†™å…¥<code>list</code>ï¼Œåˆåº”è¯¥ä½¿ç”¨ä»€ä¹ˆç±»å‹ï¼Ÿ</p></blockquote><p>è§£:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">list<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>const_iterator <span class="token comment">// è¯»</span>list<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>iterator <span class="token comment">// å†™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-9"><a href="#ç»ƒä¹ 9-9" class="headerlink" title="ç»ƒä¹ 9.9"></a>ç»ƒä¹ 9.9</h2><blockquote><p><code>begin</code>å’Œ<code>cbegin</code>ä¸¤ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p></blockquote><p>è§£:</p><p><code>begin</code> è¿”å›çš„æ˜¯æ™®é€šè¿­ä»£å™¨ï¼Œ<code>cbegin</code> è¿”å›çš„æ˜¯å¸¸é‡è¿­ä»£å™¨ã€‚</p><h2 id="ç»ƒä¹ 9-10"><a href="#ç»ƒä¹ 9-10" class="headerlink" title="ç»ƒä¹ 9.10"></a>ç»ƒä¹ 9.10</h2><blockquote><p>ä¸‹é¢4ä¸ªå¯¹è±¡åˆ†åˆ«æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v1<span class="token punctuation">;</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v2<span class="token punctuation">;</span><span class="token keyword">auto</span> it1 <span class="token operator">=</span> v1<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it2 <span class="token operator">=</span> v2<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> it3 <span class="token operator">=</span> v1<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it4 <span class="token operator">=</span> v2<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£:</p><p><code>it1</code> æ˜¯ <code>vector&lt;int&gt;::iterator</code></p><p><code>it2</code>ï¼Œ<code>it3</code> å’Œ <code>it4</code> æ˜¯ <code>vector&lt;int&gt;::const_iterator</code></p><h2 id="ç»ƒä¹ 9-11"><a href="#ç»ƒä¹ 9-11" class="headerlink" title="ç»ƒä¹ 9.11"></a>ç»ƒä¹ 9.11</h2><blockquote><p>å¯¹6ç§åˆ›å»ºå’Œåˆå§‹åŒ–<code>vector</code>å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯ä¸€ç§éƒ½ç»™å‡ºä¸€ä¸ªå®ä¾‹ã€‚è§£é‡Šæ¯ä¸ª<code>vector</code>åŒ…å«ä»€ä¹ˆå€¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">;</span>    <span class="token comment">// 0</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 10ä¸ª0</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 10ä¸ª1</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// 1, 2, 3, 4, 5</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span>other_vec<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‹·è´ other_vec çš„å…ƒç´ </span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span>other_vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> other_vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‹·è´ other_vec çš„å…ƒç´ </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-12"><a href="#ç»ƒä¹ 9-12" class="headerlink" title="ç»ƒä¹ 9.12"></a>ç»ƒä¹ 9.12</h2><blockquote><p>å¯¹äºæ¥å—ä¸€ä¸ªå®¹å™¨åˆ›å»ºå…¶æ‹·è´çš„æ„é€ å‡½æ•°ï¼Œå’Œæ¥å—ä¸¤ä¸ªè¿­ä»£å™¨åˆ›å»ºæ‹·è´çš„æ„é€ å‡½æ•°ï¼Œè§£é‡Šå®ƒä»¬çš„ä¸åŒã€‚</p></blockquote><p>è§£ï¼š</p><ul><li>æ¥å—ä¸€ä¸ªå®¹å™¨åˆ›å»ºå…¶æ‹·è´çš„æ„é€ å‡½æ•°ï¼Œå¿…é¡»å®¹å™¨ç±»å‹å’Œå…ƒç´ ç±»å‹éƒ½ç›¸åŒã€‚</li><li>æ¥å—ä¸¤ä¸ªè¿­ä»£å™¨åˆ›å»ºæ‹·è´çš„æ„é€ å‡½æ•°ï¼Œåªéœ€è¦å…ƒç´ çš„ç±»å‹èƒ½å¤Ÿç›¸äº’è½¬æ¢ï¼Œå®¹å™¨ç±»å‹å’Œå…ƒç´ ç±»å‹å¯ä»¥ä¸åŒã€‚</li></ul><h2 id="ç»ƒä¹ 9-13"><a href="#ç»ƒä¹ 9-13" class="headerlink" title="ç»ƒä¹ 9.13"></a>ç»ƒä¹ 9.13</h2><blockquote><p>å¦‚ä½•ä»ä¸€ä¸ª<code>list&lt;int&gt;</code>åˆå§‹åŒ–ä¸€ä¸ª<code>vector&lt;double&gt;</code>ï¼Ÿä»ä¸€ä¸ª<code>vector&lt;int&gt;</code>åˆè¯¥å¦‚ä½•åˆ›å»ºï¼Ÿç¼–å†™ä»£ç éªŒè¯ä½ çš„ç­”æ¡ˆã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">ilst</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">ivc</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token function">dvc</span><span class="token punctuation">(</span>ilst<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ilst<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token function">dvc2</span><span class="token punctuation">(</span>ivc<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ivc<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-14"><a href="#ç»ƒä¹ 9-14" class="headerlink" title="ç»ƒä¹ 9.14"></a>ç»ƒä¹ 9.14</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œå°†ä¸€ä¸ª<code>list</code>ä¸­çš„<code>char *</code>æŒ‡é’ˆå…ƒç´ èµ‹å€¼ç»™ä¸€ä¸ª<code>vector</code>ä¸­çš„<code>string</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>list<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span> l<span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v<span class="token punctuation">;</span>v<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-15"><a href="#ç»ƒä¹ 9-15" class="headerlink" title="ç»ƒä¹ 9.15"></a>ç»ƒä¹ 9.15</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œåˆ¤å®šä¸¤ä¸ª<code>vector&lt;int&gt;</code>æ˜¯å¦ç›¸ç­‰ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec1<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec2<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec3<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>vec1 <span class="token operator">==</span> vec2 <span class="token operator">?</span> <span class="token string">"true"</span> <span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>vec1 <span class="token operator">==</span> vec3 <span class="token operator">?</span> <span class="token string">"true"</span> <span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-16"><a href="#ç»ƒä¹ 9-16" class="headerlink" title="ç»ƒä¹ 9.16"></a>ç»ƒä¹ 9.16</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œæ¯”è¾ƒä¸€ä¸ªlist<int>ä¸­çš„å…ƒç´ å’Œä¸€ä¸ªvector<int>ä¸­çš„å…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>      li<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>    vec2<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>    vec3<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>li<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> li<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> vec2 <span class="token operator">?</span> <span class="token string">"true"</span> <span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>li<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> li<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> vec3 <span class="token operator">?</span> <span class="token string">"true"</span> <span class="token operator">:</span> <span class="token string">"false"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-17"><a href="#ç»ƒä¹ 9-17" class="headerlink" title="ç»ƒä¹ 9.17"></a>ç»ƒä¹ 9.17</h2><blockquote><p>å‡å®š<code>c1</code>å’Œ<code>c2</code>æ˜¯ä¸¤ä¸ªå®¹å™¨ï¼Œä¸‹é¢çš„æ¯”è¾ƒæ“ä½œæœ‰ä½•é™åˆ¶ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>c1 <span class="token operator">&lt;</span> c2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>c1</code>å’Œ<code>c2</code>å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„å®¹å™¨å¹¶ä¸”ä¿å­˜ç›¸åŒç±»å‹çš„å…ƒç´ </li><li>å…ƒç´ ç±»å‹è¦æ”¯æŒå…³ç³»è¿ç®—ç¬¦</li></ul><h2 id="ç»ƒä¹ 9-18"><a href="#ç»ƒä¹ 9-18" class="headerlink" title="ç»ƒä¹ 9.18"></a>ç»ƒä¹ 9.18</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–<code>string</code>åºåˆ—ï¼Œå­˜å…¥ä¸€ä¸ª<code>deque</code>ä¸­ã€‚ç¼–å†™ä¸€ä¸ªå¾ªç¯ï¼Œç”¨è¿­ä»£å™¨æ‰“å°<code>deque</code>ä¸­çš„å…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;deque></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>deque<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    deque<span class="token operator">&lt;</span>string<span class="token operator">></span> input<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string str<span class="token punctuation">;</span> cin <span class="token operator">>></span> str<span class="token punctuation">;</span> input<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> iter <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter <span class="token operator">!=</span> input<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>iter<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>iter <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-19"><a href="#ç»ƒä¹ 9-19" class="headerlink" title="ç»ƒä¹ 9.19"></a>ç»ƒä¹ 9.19</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œç”¨<code>list</code>æ›¿ä»£<code>deque</code>ã€‚åˆ—å‡ºç¨‹åºè¦åšå‡ºå“ªäº›æ”¹å˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>åªéœ€è¦åœ¨å£°æ˜ä¸Šåšå‡ºæ”¹å˜å³å¯ï¼Œå…¶ä»–éƒ½ä¸å˜ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">deque<span class="token operator">&lt;</span>string<span class="token operator">></span> input<span class="token punctuation">;</span> <span class="token comment">//æ”¹ä¸º</span>list<span class="token operator">&lt;</span>string<span class="token operator">></span> input<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-20"><a href="#ç»ƒä¹ 9-20" class="headerlink" title="ç»ƒä¹ 9.20"></a>ç»ƒä¹ 9.20</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä»ä¸€ä¸ª<code>list&lt;int&gt;</code>æ‹·è´å…ƒç´ åˆ°ä¸¤ä¸ª<code>deque</code>ä¸­ã€‚å€¼ä¸ºå¶æ•°çš„æ‰€æœ‰å…ƒç´ éƒ½æ‹·è´åˆ°ä¸€ä¸ª<code>deque</code>ä¸­ï¼Œè€Œå¥‡æ•°å€¼å…ƒç´ éƒ½æ‹·è´åˆ°å¦ä¸€ä¸ª<code>deque</code>ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;deque></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>deque<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>list<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> l<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    deque<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> odd<span class="token punctuation">,</span> even<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> l<span class="token punctuation">)</span>        <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0x1</span> <span class="token operator">?</span> odd <span class="token operator">:</span> even<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> odd<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> even<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-21"><a href="#ç»ƒä¹ 9-21" class="headerlink" title="ç»ƒä¹ 9.21"></a>ç»ƒä¹ 9.21</h2><blockquote><p>å¦‚æœæˆ‘ä»¬å°†ç¬¬308é¡µä¸­ä½¿ç”¨<code>insert</code>è¿”å›å€¼å°†å…ƒç´ æ·»åŠ åˆ°<code>list</code>ä¸­çš„å¾ªç¯ç¨‹åºæ”¹å†™ä¸ºå°†å…ƒç´ æ’å…¥åˆ°<code>vector</code>ä¸­ï¼Œåˆ†æå¾ªç¯å°†å¦‚ä½•å·¥ä½œã€‚</p></blockquote><p>è§£ï¼š</p><p>ä¸€æ ·çš„ã€‚å¦‚ä¹¦ä¸Šæ‰€è¯´ï¼š</p><blockquote><p>ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>insert</code> ä¼šå°†æˆ‘ä»¬åˆšåˆšè¯»å…¥çš„ <code>string</code> æ’å…¥åˆ° <code>iter</code> æ‰€æŒ‡å‘çš„å…ƒç´ ä¹‹å‰çš„ä½ç½®ã€‚<code>insert</code> è¿”å›çš„è¿­ä»£å™¨æ°å¥½æŒ‡å‘è¿™ä¸ªæ–°å…ƒç´ ã€‚æˆ‘ä»¬å°†æ­¤è¿­ä»£å™¨èµ‹äºˆ <code>iter</code> å¹¶é‡å¤å¾ªç¯ï¼Œè¯»å–ä¸‹ä¸€ä¸ªå•è¯ã€‚åªè¦ç»§ç»­æœ‰å•è¯è¯»å…¥ï¼Œæ¯æ­¥ while å¾ªç¯å°±ä¼šå°†ä¸€ä¸ªæ–°å…ƒç´ æ’å…¥åˆ° <code>iter</code> ä¹‹å‰ï¼Œå¹¶å°† <code>iter</code> æ”¹å˜ä¸ºæ–°åŠ å…¥å…ƒç´ çš„å°¾ç½®ã€‚æ­¤å…ƒç´ ä¸ºï¼ˆæ–°çš„ï¼‰é¦–å…ƒç´ ã€‚å› æ­¤ï¼Œæ¯æ­¥å¾ªç¯å°†ä¸€ä¸ªå…ƒç´ æ’å…¥åˆ° <code>list</code> é¦–å…ƒç´ ä¹‹å‰çš„ä½ç½®ã€‚</p></blockquote><h2 id="ç»ƒä¹ 9-22"><a href="#ç»ƒä¹ 9-22" class="headerlink" title="ç»ƒä¹ 9.22"></a>ç»ƒä¹ 9.22</h2><blockquote><p>å‡å®š<code>iv</code>æ˜¯ä¸€ä¸ª<code>int</code>çš„<code>vector</code>ï¼Œä¸‹é¢çš„ç¨‹åºå­˜åœ¨ä»€ä¹ˆé”™è¯¯ï¼Ÿä½ å°†å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator iter <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  mid <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> iv<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>iter <span class="token operator">!=</span> mid<span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>iter <span class="token operator">==</span> some_val<span class="token punctuation">)</span>iv<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>iter<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> some_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>å¾ªç¯ä¸ä¼šç»“æŸ</li><li>è¿­ä»£å™¨å¯èƒ½ä¼šå¤±æ•ˆ</li></ul><p>è¦æ”¹ä¸ºä¸‹é¢è¿™æ ·ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>iter <span class="token operator">!=</span> mid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>iter <span class="token operator">==</span> some_val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>iter <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>iter<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> some_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>iter<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token operator">++</span>iter<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-23"><a href="#ç»ƒä¹ 9-23" class="headerlink" title="ç»ƒä¹ 9.23"></a>ç»ƒä¹ 9.23</h2><blockquote><p>åœ¨æœ¬èŠ‚ç¬¬ä¸€ä¸ªç¨‹åºä¸­ï¼Œè‹¥<code>c.size()</code> ä¸º1ï¼Œåˆ™<code>val</code>ã€<code>val2</code>ã€<code>val3</code>å’Œ<code>val4</code>çš„å€¼ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>éƒ½ä¼šæ˜¯åŒä¸€ä¸ªå€¼ï¼ˆå®¹å™¨ä¸­ä»…æœ‰çš„é‚£ä¸ªï¼‰ã€‚</p><h2 id="ç»ƒä¹ 9-24"><a href="#ç»ƒä¹ 9-24" class="headerlink" title="ç»ƒä¹ 9.24"></a>ç»ƒä¹ 9.24</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œåˆ†åˆ«ä½¿ç”¨<code>at</code>ã€ä¸‹æ ‡è¿ç®—ç¬¦ã€<code>front</code> å’Œ <code>begin</code> æå–ä¸€ä¸ª<code>vector</code>ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ä¸€ä¸ªç©º<code>vector</code>ä¸Šæµ‹è¯•ä½ çš„ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// terminating with uncaught exception of type std::out_of_range</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          <span class="token comment">// Segmentation fault: 11</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Segmentation fault: 11</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Segmentation fault: 11</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-25"><a href="#ç»ƒä¹ 9-25" class="headerlink" title="ç»ƒä¹ 9.25"></a>ç»ƒä¹ 9.25</h2><blockquote><p>å¯¹äºç¬¬312é¡µä¸­åˆ é™¤ä¸€ä¸ªèŒƒå›´å†…çš„å…ƒç´ çš„ç¨‹åºï¼Œå¦‚æœ <code>elem1</code> ä¸ <code>elem2</code> ç›¸ç­‰ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœ <code>elem2</code> æ˜¯å°¾åè¿­ä»£å™¨ï¼Œæˆ–è€… <code>elem1</code> å’Œ <code>elem2</code> çš†ä¸ºå°¾åè¿­ä»£å™¨ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li>å¦‚æœ <code>elem1</code> å’Œ <code>elem2</code> ç›¸ç­‰ï¼Œé‚£ä¹ˆä¸ä¼šå‘ç”Ÿä»»ä½•æ“ä½œã€‚</li><li><code>å¦‚æœelem2</code> æ˜¯å°¾åè¿­ä»£å™¨ï¼Œé‚£ä¹ˆåˆ é™¤ä» <code>elem1</code> åˆ°æœ€åçš„å…ƒç´ ã€‚</li><li>å¦‚æœä¸¤è€…çš†ä¸ºå°¾åè¿­ä»£å™¨ï¼Œä¹Ÿä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚</li></ul><h2 id="ç»ƒä¹ 9-26"><a href="#ç»ƒä¹ 9-26" class="headerlink" title="ç»ƒä¹ 9.26"></a>ç»ƒä¹ 9.26</h2><blockquote><p>ä½¿ç”¨ä¸‹é¢ä»£ç å®šä¹‰çš„<code>ia</code>ï¼Œå°†<code>ia</code>æ‹·è´åˆ°ä¸€ä¸ª<code>vector</code>å’Œä¸€ä¸ª<code>list</code>ä¸­ã€‚æ˜¯ç”¨å•è¿­ä»£å™¨ç‰ˆæœ¬çš„<code>erase</code>ä»<code>list</code>ä¸­åˆ é™¤å¥‡æ•°å…ƒç´ ï¼Œä»<code>vector</code>ä¸­åˆ é™¤å¶æ•°å…ƒç´ ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">89</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span>ia<span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>ia<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">lst</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> lst<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> lst<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span>it <span class="token operator">=</span> lst<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token operator">++</span>it<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token operator">*</span>it <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>it <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token operator">++</span>it<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-27"><a href="#ç»ƒä¹ 9-27" class="headerlink" title="ç»ƒä¹ 9.27"></a>ç»ƒä¹ 9.27</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼ŒæŸ¥æ‰¾å¹¶åˆ é™¤<code>forward_list&lt;int&gt;</code>ä¸­çš„å¥‡æ•°å…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;forward_list></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>forward_list<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">remove_odds</span><span class="token punctuation">(</span>forward_list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> flist<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> is_odd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    flist<span class="token punctuation">.</span><span class="token function">remove_if</span><span class="token punctuation">(</span>is_odd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    forward_list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">remove_odds</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> data<span class="token punctuation">)</span>         cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-28"><a href="#ç»ƒä¹ 9-28" class="headerlink" title="ç»ƒä¹ 9.28"></a>ç»ƒä¹ 9.28</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª<code>forward_list&lt;string&gt;</code>å’Œä¸¤ä¸ª<code>string</code>å…±ä¸‰ä¸ªå‚æ•°ã€‚å‡½æ•°åº”åœ¨é“¾è¡¨ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ª<code>string</code>ï¼Œå¹¶å°†ç¬¬äºŒä¸ª<code>string</code>æ’å…¥åˆ°ç´§æ¥ç€ç¬¬ä¸€ä¸ª<code>string</code>ä¹‹åçš„ä½ç½®ã€‚è‹¥ç¬¬ä¸€ä¸ª<code>string</code>æœªåœ¨é“¾è¡¨ä¸­ï¼Œåˆ™å°†ç¬¬äºŒä¸ª<code>string</code>æ’å…¥åˆ°é“¾è¡¨æœ«å°¾ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">find_and_insert</span><span class="token punctuation">(</span>forward_list<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> flst<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s1<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> prev <span class="token operator">=</span> flst<span class="token punctuation">.</span><span class="token function">before_begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> curr <span class="token operator">=</span> flst<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>curr <span class="token operator">!=</span> flst<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>curr <span class="token operator">==</span> s1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>flst<span class="token punctuation">.</span><span class="token function">insert_after</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    prev <span class="token operator">=</span> curr<span class="token punctuation">;</span>    <span class="token operator">++</span>curr<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    flst<span class="token punctuation">.</span><span class="token function">insert_after</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-29"><a href="#ç»ƒä¹ 9-29" class="headerlink" title="ç»ƒä¹ 9.29"></a>ç»ƒä¹ 9.29</h2><blockquote><p>å‡å®š<code>vec</code>åŒ…å«25ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆ<code>vec.resize(100)</code>ä¼šåšä»€ä¹ˆï¼Ÿå¦‚æœæ¥ä¸‹æ¥è°ƒç”¨<code>vec.resize(10)</code>ä¼šåšä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li>å°†75ä¸ªå€¼ä¸º0çš„å…ƒç´ æ·»åŠ åˆ°<code>vec</code>çš„æœ«å°¾</li><li>ä»<code>vec</code>çš„æœ«å°¾åˆ é™¤90ä¸ªå…ƒç´ </li></ul><h2 id="ç»ƒä¹ 9-30"><a href="#ç»ƒä¹ 9-30" class="headerlink" title="ç»ƒä¹ 9.30"></a>ç»ƒä¹ 9.30</h2><blockquote><p>æ¥å—å•ä¸ªå‚æ•°çš„<code>resize</code>ç‰ˆæœ¬å¯¹å…ƒç´ ç±»å‹æœ‰ä»€ä¹ˆé™åˆ¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å…ƒç´ ç±»å‹å¿…é¡»æä¾›ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 9-31"><a href="#ç»ƒä¹ 9-31" class="headerlink" title="ç»ƒä¹ 9.31"></a>ç»ƒä¹ 9.31</h2><blockquote><p>ç¬¬316é¡µä¸­åˆ é™¤å¶æ•°å€¼å…ƒç´ å¹¶å¤åˆ¶å¥‡æ•°å€¼å…ƒç´ çš„ç¨‹åºä¸èƒ½ç”¨äº<code>list</code>æˆ–<code>forward_list</code>ã€‚ä¸ºä»€ä¹ˆï¼Ÿä¿®æ”¹ç¨‹åºï¼Œä½¿ä¹‹ä¹Ÿèƒ½ç”¨äºè¿™äº›ç±»å‹ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">iter <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºå¤åˆèµ‹å€¼è¯­å¥åªèƒ½ç”¨äº<code>string</code>ã€<code>vector</code>ã€<code>deque</code>ã€<code>array</code>ï¼Œæ‰€ä»¥è¦æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">++</span>iter<span class="token punctuation">;</span><span class="token operator">++</span>iter<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœæ˜¯<code>forward_list</code>çš„è¯ï¼Œè¦å¢åŠ ä¸€ä¸ªé¦–å…ˆè¿­ä»£å™¨<code>prev</code>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> prev <span class="token operator">=</span> flst<span class="token punctuation">.</span><span class="token function">before_begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//...</span>curr <span class="token operator">==</span> flst<span class="token punctuation">.</span><span class="token function">insert_after</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> <span class="token operator">*</span>curr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>curr<span class="token punctuation">;</span> <span class="token operator">++</span>curr<span class="token punctuation">;</span><span class="token operator">++</span>prev<span class="token punctuation">;</span> <span class="token operator">++</span>prev<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-32"><a href="#ç»ƒä¹ 9-32" class="headerlink" title="ç»ƒä¹ 9.32"></a>ç»ƒä¹ 9.32</h2><blockquote><p>åœ¨ç¬¬316é¡µçš„ç¨‹åºä¸­ï¼Œå‘ä¸‹é¢è¯­å¥è¿™æ ·è°ƒç”¨<code>insert</code>æ˜¯å¦åˆæ³•ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">iter <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>iter<span class="token punctuation">,</span> <span class="token operator">*</span>iter<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆæ³•ã€‚å› ä¸ºå‚æ•°çš„æ±‚å€¼é¡ºåºæ˜¯æœªæŒ‡å®šçš„ã€‚</p><h2 id="ç»ƒä¹ 9-33"><a href="#ç»ƒä¹ 9-33" class="headerlink" title="ç»ƒä¹ 9.33"></a>ç»ƒä¹ 9.33</h2><blockquote><p>åœ¨æœ¬èŠ‚æœ€åä¸€ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä¸å°†<code>insert</code>çš„ç»“æœèµ‹äºˆ<code>begin</code>ï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç¼–å†™ç¨‹åºï¼Œå»æ‰æ­¤èµ‹å€¼è¯­å¥ï¼ŒéªŒè¯ä½ çš„ç­”æ¡ˆã€‚</p></blockquote><p>è§£ï¼š</p><p><code>begin</code>å°†ä¼šå¤±æ•ˆã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> data <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> cur <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cur <span class="token operator">!=</span> data<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>cur<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span>cur <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span>            cur <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> <span class="token operator">*</span>cur<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">++</span>cur<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> data<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-34"><a href="#ç»ƒä¹ 9-34" class="headerlink" title="ç»ƒä¹ 9.34"></a>ç»ƒä¹ 9.34</h2><blockquote><p>å‡å®š<code>vi</code>æ˜¯ä¸€ä¸ªä¿å­˜<code>int</code>çš„å®¹å™¨ï¼Œå…¶ä¸­æœ‰å¶æ•°å€¼ä¹Ÿæœ‰å¥‡æ•°å€¼ï¼Œåˆ†æä¸‹é¢å¾ªç¯çš„è¡Œä¸ºï¼Œç„¶åç¼–å†™ç¨‹åºéªŒè¯ä½ çš„åˆ†ææ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">iter <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>iter <span class="token operator">!=</span> vi<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>iter <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>iter <span class="token operator">=</span> vi<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>iter<span class="token punctuation">,</span> <span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>iter<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å¾ªç¯æ°¸è¿œä¸ä¼šç»“æŸã€‚</p><h2 id="ç»ƒä¹ 9-35"><a href="#ç»ƒä¹ 9-35" class="headerlink" title="ç»ƒä¹ 9.35"></a>ç»ƒä¹ 9.35</h2><blockquote><p>è§£é‡Šä¸€ä¸ª<code>vector</code>çš„<code>capacity</code>å’Œ<code>size</code>æœ‰ä½•åŒºåˆ«ã€‚</p></blockquote><p>è§£ï¼š</p><ul><li><code>capacity</code>çš„å€¼è¡¨æ˜ï¼Œåœ¨ä¸é‡æ–°åˆ†é…å†…å­˜ç©ºé—´çš„æƒ…å†µä¸‹ï¼Œå®¹å™¨å¯ä»¥ä¿å­˜å¤šå°‘å…ƒç´ </li><li>è€Œ<code>size</code>çš„å€¼æ˜¯æŒ‡å®¹å™¨å·²ç»ä¿å­˜çš„å…ƒç´ çš„æ•°é‡</li></ul><h2 id="ç»ƒä¹ 9-36"><a href="#ç»ƒä¹ 9-36" class="headerlink" title="ç»ƒä¹ 9.36"></a>ç»ƒä¹ 9.36</h2><blockquote><p>ä¸€ä¸ªå®¹å™¨çš„<code>capacity</code>å¯èƒ½å°äºå®ƒçš„<code>size</code>å—ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸å¯èƒ½ã€‚</p><h2 id="ç»ƒä¹ 9-37"><a href="#ç»ƒä¹ 9-37" class="headerlink" title="ç»ƒä¹ 9.37"></a>ç»ƒä¹ 9.37</h2><blockquote><p>ä¸ºä»€ä¹ˆ<code>list</code>æˆ–<code>array</code>æ²¡æœ‰<code>capacity</code>æˆå‘˜å‡½æ•°ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸º<code>list</code>æ˜¯é“¾è¡¨ï¼Œè€Œ<code>array</code>ä¸å…è®¸æ”¹å˜å®¹å™¨å¤§å°ã€‚</p><h2 id="ç»ƒä¹ 9-38"><a href="#ç»ƒä¹ 9-38" class="headerlink" title="ç»ƒä¹ 9.38"></a>ç»ƒä¹ 9.38</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œæ¢ç©¶åœ¨ä½ çš„æ ‡å‡†å®ç°ä¸­ï¼Œ<code>vector</code>æ˜¯å¦‚ä½•å¢é•¿çš„ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"capacity: "</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"  size: "</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><br>è¾“å‡ºï¼š</p><pre class="line-numbers language-none"><code class="language-none">capacity: 0  size: 0capacity: 1  size: 1capacity: 2  size: 2capacity: 3  size: 3capacity: 4  size: 4capacity: 6  size: 5capacity: 6  size: 6capacity: 9  size: 7capacity: 9  size: 8capacity: 9  size: 9capacity: 13  size: 10capacity: 13  size: 11capacity: 13  size: 12capacity: 13  size: 13capacity: 19  size: 14capacity: 19  size: 15capacity: 19  size: 16capacity: 19  size: 17capacity: 19  size: 18capacity: 19  size: 19capacity: 28  size: 20capacity: 28  size: 21capacity: 28  size: 22capacity: 28  size: 23capacity: 28  size: 24capacity: 28  size: 25capacity: 28  size: 26capacity: 28  size: 27capacity: 28  size: 28capacity: 42  size: 29capacity: 42  size: 30capacity: 42  size: 31capacity: 42  size: 32capacity: 42  size: 33capacity: 42  size: 34capacity: 42  size: 35capacity: 42  size: 36capacity: 42  size: 37capacity: 42  size: 38capacity: 42  size: 39capacity: 42  size: 40capacity: 42  size: 41capacity: 42  size: 42capacity: 63  size: 43capacity: 63  size: 44capacity: 63  size: 45capacity: 63  size: 46capacity: 63  size: 47capacity: 63  size: 48capacity: 63  size: 49capacity: 63  size: 50capacity: 63  size: 51capacity: 63  size: 52capacity: 63  size: 53capacity: 63  size: 54capacity: 63  size: 55capacity: 63  size: 56capacity: 63  size: 57capacity: 63  size: 58capacity: 63  size: 59capacity: 63  size: 60capacity: 63  size: 61capacity: 63  size: 62capacity: 63  size: 63capacity: 94  size: 64capacity: 94  size: 65capacity: 94  size: 66capacity: 94  size: 67capacity: 94  size: 68capacity: 94  size: 69capacity: 94  size: 70capacity: 94  size: 71capacity: 94  size: 72capacity: 94  size: 73capacity: 94  size: 74capacity: 94  size: 75capacity: 94  size: 76capacity: 94  size: 77capacity: 94  size: 78capacity: 94  size: 79capacity: 94  size: 80capacity: 94  size: 81capacity: 94  size: 82capacity: 94  size: 83capacity: 94  size: 84capacity: 94  size: 85capacity: 94  size: 86capacity: 94  size: 87capacity: 94  size: 88capacity: 94  size: 89capacity: 94  size: 90capacity: 94  size: 91capacity: 94  size: 92capacity: 94  size: 93capacity: 94  size: 94capacity: 141  size: 95capacity: 141  size: 96capacity: 141  size: 97capacity: 141  size: 98capacity: 141  size: 99<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-39"><a href="#ç»ƒä¹ 9-39" class="headerlink" title="ç»ƒä¹ 9.39"></a>ç»ƒä¹ 9.39</h2><blockquote><p>è§£é‡Šä¸‹é¢ç¨‹åºç‰‡æ®µåšäº†ä»€ä¹ˆï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span>string<span class="token operator">></span> svec<span class="token punctuation">;</span>svec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>string word<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> word<span class="token punctuation">)</span>svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>svec<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>svec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> svec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å®šä¹‰ä¸€ä¸ª<code>vector</code>ï¼Œä¸ºå®ƒåˆ†é…1024ä¸ªå…ƒç´ çš„ç©ºé—´ã€‚ç„¶åé€šè¿‡ä¸€ä¸ªå¾ªç¯ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–å­—ç¬¦ä¸²å¹¶æ·»åŠ åˆ°<code>vector</code>å½“ä¸­ã€‚å¾ªç¯ç»“æŸåï¼Œæ”¹å˜<code>vector</code>çš„å®¹å™¨å¤§å°ï¼ˆå…ƒç´ æ•°é‡ï¼‰ä¸ºåŸæ¥çš„1.5å€ï¼Œä½¿ç”¨å…ƒç´ çš„é»˜è®¤åˆå§‹åŒ–å€¼å¡«å……ã€‚å¦‚æœå®¹å™¨çš„å¤§å°è¶…è¿‡1024ï¼Œ<code>vector</code>ä¹Ÿä¼šé‡æ–°åˆ†é…ç©ºé—´ä»¥å®¹çº³æ–°å¢çš„å…ƒç´ ã€‚</p><h2 id="ç»ƒä¹ 9-40"><a href="#ç»ƒä¹ 9-40" class="headerlink" title="ç»ƒä¹ 9.40"></a>ç»ƒä¹ 9.40</h2><blockquote><p>å¦‚æœä¸Šä¸€é¢˜çš„ç¨‹åºè¯»å…¥äº†256ä¸ªè¯ï¼Œåœ¨<code>resize</code>ä¹‹åå®¹å™¨çš„<code>capacity</code>å¯èƒ½æ˜¯å¤šå°‘ï¼Ÿå¦‚æœè¯»å…¥äº†512ä¸ªã€1000ä¸ªã€æˆ–1048ä¸ªå‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li>å¦‚æœè¯»å…¥äº†256ä¸ªè¯ï¼Œ<code>capacity</code> ä»ç„¶æ˜¯ 1024</li><li>å¦‚æœè¯»å…¥äº†512ä¸ªè¯ï¼Œ<code>capacity</code> ä»ç„¶æ˜¯ 1024</li><li>å¦‚æœè¯»å…¥äº†1000æˆ–1048ä¸ªè¯ï¼Œ<code>capacity</code> å–å†³äºå…·ä½“å®ç°ã€‚</li></ul><h2 id="ç»ƒä¹ 9-41"><a href="#ç»ƒä¹ 9-41" class="headerlink" title="ç»ƒä¹ 9.41"></a>ç»ƒä¹ 9.41</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä»ä¸€ä¸ª<code>vector&lt;char&gt;</code>åˆå§‹åŒ–ä¸€ä¸ª<code>string</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> v<span class="token punctuation">&#123;</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'o'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>string <span class="token function">str</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-42"><a href="#ç»ƒä¹ 9-42" class="headerlink" title="ç»ƒä¹ 9.42"></a>ç»ƒä¹ 9.42</h2><blockquote><p>å‡å®šä½ å¸Œæœ›æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦å­˜å…¥ä¸€ä¸ª<code>string</code>ä¸­ï¼Œè€Œä¸”çŸ¥é“æœ€å°‘éœ€è¦è¯»å–100ä¸ªå­—ç¬¦ï¼Œåº”è¯¥å¦‚ä½•æé«˜ç¨‹åºçš„æ€§èƒ½ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä½¿ç”¨ <code>reserve(100)</code> å‡½æ•°é¢„å…ˆåˆ†é…100ä¸ªå…ƒç´ çš„ç©ºé—´ã€‚</p><h2 id="ç»ƒä¹ 9-43"><a href="#ç»ƒä¹ 9-43" class="headerlink" title="ç»ƒä¹ 9.43"></a>ç»ƒä¹ 9.43</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸‰ä¸ª<code>string</code>å‚æ•°æ˜¯<code>s</code>ã€<code>oldVal</code> å’Œ<code>newVal</code>ã€‚ä½¿ç”¨è¿­ä»£å™¨åŠ<code>insert</code>å’Œ<code>erase</code>å‡½æ•°å°†<code>s</code>ä¸­æ‰€æœ‰<code>oldVal</code>æ›¿æ¢ä¸º<code>newVal</code>ã€‚æµ‹è¯•ä½ çš„ç¨‹åºï¼Œç”¨å®ƒæ›¿æ¢é€šç”¨çš„ç®€å†™å½¢å¼ï¼Œå¦‚ï¼Œå°†â€thoâ€æ›¿æ¢ä¸ºâ€thoughâ€,å°†â€thruâ€æ›¿æ¢ä¸ºâ€throughâ€ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstddef></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">replace_with</span><span class="token punctuation">(</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> oldVal<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> newVal<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> cur <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cur <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldVal <span class="token operator">==</span> string<span class="token punctuation">&#123;</span> cur<span class="token punctuation">,</span> cur <span class="token operator">+</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            cur <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> cur <span class="token operator">+</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            cur <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span> newVal<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> newVal<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            cur <span class="token operator">+=</span> newVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>              <span class="token operator">++</span>cur<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string s<span class="token punctuation">&#123;</span> <span class="token string">"To drive straight thru is a foolish, tho courageous act."</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">replace_with</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"tho"</span><span class="token punctuation">,</span> <span class="token string">"though"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">replace_with</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">"thru"</span><span class="token punctuation">,</span> <span class="token string">"through"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-44"><a href="#ç»ƒä¹ 9-44" class="headerlink" title="ç»ƒä¹ 9.44"></a>ç»ƒä¹ 9.44</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„å‡½æ•°ï¼Œè¿™æ¬¡ä½¿ç”¨ä¸€ä¸ªä¸‹æ ‡å’Œ<code>replace</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">replace_with</span><span class="token punctuation">(</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> oldVal<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> newVal<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> pos <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">==</span> oldVal<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> oldVal<span class="token punctuation">)</span>            s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> oldVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">,</span>            pos <span class="token operator">+=</span> newVal<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token operator">++</span>pos<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string str<span class="token punctuation">&#123;</span> <span class="token string">"To drive straight thru is a foolish, tho courageous act."</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">replace_with</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"tho"</span><span class="token punctuation">,</span> <span class="token string">"though"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">replace_with</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"thru"</span><span class="token punctuation">,</span> <span class="token string">"through"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-45"><a href="#ç»ƒä¹ 9-45" class="headerlink" title="ç»ƒä¹ 9.45"></a>ç»ƒä¹ 9.45</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè¡¨ç¤ºåå­—çš„<code>string</code>å‚æ•°å’Œä¸¤ä¸ªåˆ†åˆ«è¡¨ç¤ºå‰ç¼€ï¼ˆå¦‚â€Mr.â€æˆ–â€Mrs.â€ï¼‰å’Œåç¼€ï¼ˆå¦‚â€Jr.â€æˆ–â€IIIâ€ï¼‰çš„å­—ç¬¦ä¸²ã€‚ä½¿ç”¨è¿­ä»£å™¨åŠ<code>insert</code>å’Œ<code>append</code>å‡½æ•°å°†å‰ç¼€å’Œåç¼€æ·»åŠ åˆ°ç»™å®šçš„åå­—ä¸­ï¼Œå°†ç”Ÿæˆçš„æ–°<code>string</code>è¿”å›ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token comment">// Exercise 9.45</span><span class="token keyword">auto</span> <span class="token function">add_pre_and_suffix</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> pre<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> su<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    name<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pre<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pre<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>su<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string <span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"Wang"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token function">add_pre_and_suffix</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"Mr."</span><span class="token punctuation">,</span> <span class="token string">", Jr."</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-46"><a href="#ç»ƒä¹ 9-46" class="headerlink" title="ç»ƒä¹ 9.46"></a>ç»ƒä¹ 9.46</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„å‡½æ•°ï¼Œè¿™æ¬¡ä½¿ç”¨ä½ç½®å’Œé•¿åº¦æ¥ç®¡ç†<code>string</code>ï¼Œå¹¶åªä½¿ç”¨<code>insert</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">auto</span> <span class="token function">add_pre_and_suffix</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string name<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> pre<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> su<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    name<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pre<span class="token punctuation">)</span><span class="token punctuation">;</span>    name<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> su<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"alan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">add_pre_and_suffix</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"Mr."</span><span class="token punctuation">,</span> <span class="token string">",Jr."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-47"><a href="#ç»ƒä¹ 9-47" class="headerlink" title="ç»ƒä¹ 9.47"></a>ç»ƒä¹ 9.47</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œé¦–å…ˆæŸ¥æ‰¾<code>string</code>â€œab2c3d7R4E6â€ä¸­æ¯ä¸ªæ•°å­—å­—ç¬¦ï¼Œç„¶åæŸ¥æ‰¾å…¶ä¸­æ¯ä¸ªå­—æ¯å­—ç¬¦ã€‚ç¼–å†™ä¸¤ä¸ªç‰ˆæœ¬çš„ç¨‹åºï¼Œç¬¬ä¸€ä¸ªè¦ä½¿ç”¨<code>find_first_of</code>ï¼Œç¬¬äºŒä¸ªè¦ä½¿ç”¨<code>find_first_not_of</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string <span class="token function">numbers</span><span class="token punctuation">(</span><span class="token string">"0123456789"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>string <span class="token function">s</span><span class="token punctuation">(</span><span class="token string">"ab2c3d7R4E6"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"numeric characters: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>pos <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">;</span> <span class="token operator">++</span>pos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\nalphabetic characters: "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>pos <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">find_first_not_of</span><span class="token punctuation">(</span>numbers<span class="token punctuation">,</span> pos<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">;</span> <span class="token operator">++</span>pos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-48"><a href="#ç»ƒä¹ 9-48" class="headerlink" title="ç»ƒä¹ 9.48"></a>ç»ƒä¹ 9.48</h2><blockquote><p>å‡å®š<code>name</code>å’Œ<code>numbers</code>çš„å®šä¹‰å¦‚325é¡µæ‰€ç¤ºï¼Œ<code>numbers.find(name)</code>è¿”å›ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>è¿”å› <code>string::npos</code></p><h2 id="ç»ƒä¹ 9-49"><a href="#ç»ƒä¹ 9-49" class="headerlink" title="ç»ƒä¹ 9.49"></a>ç»ƒä¹ 9.49</h2><blockquote><p>å¦‚æœä¸€ä¸ªå­—æ¯å»¶ä¼¸åˆ°ä¸­çº¿ä¹‹ä¸Šï¼Œå¦‚dæˆ–fï¼Œåˆ™ç§°å…¶æœ‰ä¸Šå‡ºå¤´éƒ¨åˆ†ï¼ˆ<code>ascender</code>ï¼‰ã€‚å¦‚æœä¸€ä¸ªå­—æ¯å»¶ä¼¸åˆ°ä¸­çº¿ä¹‹ä¸‹ï¼Œå¦‚pæˆ–gï¼Œåˆ™ç§°å…¶æœ‰ä¸‹å‡ºå¤´éƒ¨åˆ†ï¼ˆ<code>descender</code>ï¼‰ã€‚ç¼–å†™ç¨‹åºï¼Œè¯»å…¥ä¸€ä¸ªå•è¯æ–‡ä»¶ï¼Œè¾“å‡ºæœ€é•¿çš„æ—¢ä¸åŒ…å«ä¸Šå‡ºå¤´éƒ¨åˆ†ï¼Œä¹Ÿä¸åŒ…å«ä¸‹å‡ºå¤´éƒ¨åˆ†çš„å•è¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"../data/letter.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ifs<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    string longest<span class="token punctuation">;</span>    <span class="token keyword">auto</span> update_with <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>longest<span class="token punctuation">]</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> curr<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>string<span class="token operator">::</span>npos <span class="token operator">==</span> curr<span class="token punctuation">.</span><span class="token function">find_first_not_of</span><span class="token punctuation">(</span><span class="token string">"aceimnorsuvwxz"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            longest <span class="token operator">=</span> longest<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> curr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> curr <span class="token operator">:</span> longest<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string curr<span class="token punctuation">;</span> ifs <span class="token operator">>></span> curr<span class="token punctuation">;</span> <span class="token function">update_with</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> longest <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-50"><a href="#ç»ƒä¹ 9-50" class="headerlink" title="ç»ƒä¹ 9.50"></a>ç»ƒä¹ 9.50</h2><blockquote><p>ç¼–å†™ç¨‹åºå¤„ç†ä¸€ä¸ª<code>vector&lt;string&gt;</code>ï¼Œå…¶å…ƒç´ éƒ½è¡¨ç¤ºæ•´å‹å€¼ã€‚è®¡ç®—<code>vector</code>ä¸­æ‰€æœ‰å…ƒç´ ä¹‹å’Œã€‚ä¿®æ”¹ç¨‹åºï¼Œä½¿ä¹‹è®¡ç®—è¡¨ç¤ºæµ®ç‚¹å€¼çš„<code>string</code>ä¹‹å’Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">auto</span> <span class="token function">sum_for_int</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> s <span class="token operator">:</span> v<span class="token punctuation">)</span>        sum <span class="token operator">+=</span> std<span class="token operator">::</span><span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">auto</span> <span class="token function">sum_for_float</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">float</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> s <span class="token operator">:</span> v<span class="token punctuation">)</span>        sum <span class="token operator">+=</span> std<span class="token operator">::</span><span class="token function">stof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"4.5"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">sum_for_int</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">sum_for_float</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-51"><a href="#ç»ƒä¹ 9-51" class="headerlink" title="ç»ƒä¹ 9.51"></a>ç»ƒä¹ 9.51</h2><blockquote><p>è®¾è®¡ä¸€ä¸ªç±»ï¼Œå®ƒæœ‰ä¸‰ä¸ª<code>unsigned</code>æˆå‘˜ï¼Œåˆ†åˆ«è¡¨ç¤ºå¹´ã€æœˆå’Œæ—¥ã€‚ä¸ºå…¶ç¼–å†™æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè¡¨ç¤ºæ—¥æœŸçš„<code>string</code>å‚æ•°ã€‚ä½ çš„æ„é€ å‡½æ•°åº”è¯¥èƒ½å¤„ç†ä¸åŒçš„æ•°æ®æ ¼å¼ï¼Œå¦‚January 1,1900ã€1/1/1990ã€Jan 1 1900 ç­‰ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">My_date</span><span class="token punctuation">&#123;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">unsigned</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">My_date</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">unsigned</span> tag<span class="token punctuation">;</span>        <span class="token keyword">unsigned</span> format<span class="token punctuation">;</span>        format <span class="token operator">=</span> tag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// 1/1/1900</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token operator">!=</span> string <span class="token operator">::</span> npos<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            format <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// January 1, 1900 or Jan 1, 1900</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token operator">!=</span> string <span class="token operator">::</span> npos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            format <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span> <span class="token comment">// Jan 1 1900</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">3</span>                <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token operator">!=</span> string <span class="token operator">::</span> npos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                format <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span>                tag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token number">0x01</span><span class="token operator">:</span>            day <span class="token operator">=</span> <span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            month <span class="token operator">=</span> <span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">find_last_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token operator">-</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            year <span class="token operator">=</span> <span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_last_of</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token number">0x10</span><span class="token operator">:</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Jan"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Feb"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Mar"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Apr"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"May"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Jun"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Jul"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Aug"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Sep"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Oct"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Nov"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span> s<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"Dec"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>  month <span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">;</span>            <span class="token keyword">char</span> chr <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>tag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                chr <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            day <span class="token operator">=</span> <span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"123456789"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span>chr<span class="token punctuation">)</span> <span class="token operator">-</span> s<span class="token punctuation">.</span><span class="token function">find_first_of</span><span class="token punctuation">(</span><span class="token string">"123456789"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            year <span class="token operator">=</span> <span class="token function">stoi</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">find_last_of</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"day:"</span> <span class="token operator">&lt;&lt;</span> day <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"month: "</span> <span class="token operator">&lt;&lt;</span> month <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"year: "</span> <span class="token operator">&lt;&lt;</span> year<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    My_date <span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Jan 1 1900"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 9-52"><a href="#ç»ƒä¹ 9-52" class="headerlink" title="ç»ƒä¹ 9.52"></a>ç»ƒä¹ 9.52</h2><blockquote><p>ä½¿ç”¨<code>stack</code>å¤„ç†æ‹¬å·åŒ–çš„è¡¨è¾¾å¼ã€‚å½“ä½ çœ‹åˆ°ä¸€ä¸ªå·¦æ‹¬å·ï¼Œå°†å…¶è®°å½•ä¸‹æ¥ã€‚å½“ä½ åœ¨ä¸€ä¸ªå·¦æ‹¬å·ä¹‹åçœ‹åˆ°ä¸€ä¸ªå³æ‹¬å·ï¼Œä»<code>stack</code>ä¸­<code>pop</code>å¯¹è±¡ï¼Œç›´è‡³é‡åˆ°å·¦æ‹¬å·ï¼Œå°†å·¦æ‹¬å·ä¹Ÿä¸€èµ·å¼¹å‡ºæ ˆã€‚ç„¶åå°†ä¸€ä¸ªå€¼ï¼ˆæ‹¬å·å†…çš„è¿ç®—ç»“æœï¼‰<code>push</code>åˆ°æ ˆä¸­ï¼Œè¡¨ç¤ºä¸€ä¸ªæ‹¬å·åŒ–çš„ï¼ˆå­ï¼‰è¡¨è¾¾å¼å·²ç»å¤„ç†å®Œæ¯•ï¼Œè¢«å…¶è¿ç®—ç»“æœæ‰€æ›¿ä»£ã€‚</p></blockquote><p>è§£ï¼š</p><p>è¿™é“é¢˜å¯ä»¥å»¶ä¼¸ä¸ºé€†æ³¢å…°æ±‚å€¼ï¼Œä»¥åŠä¸­ç¼€è½¬åç¼€è¡¨è¾¾å¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stack></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>stack<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string expression<span class="token punctuation">&#123;</span> <span class="token string">"This is (pezy)."</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> bSeen <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    stack<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> stk<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>s <span class="token operator">:</span> expression<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token string">'('</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> bSeen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span> bSeen <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>bSeen<span class="token punctuation">)</span> stk<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        string repstr<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>stk<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        repstr <span class="token operator">+=</span> stk<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        stk<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        expression<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>expression<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"("</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> repstr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> repstr<span class="token punctuation">)</span><span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> expression <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ6</title>
      <link href="2021/04/10/excersize/ch06/"/>
      <url>2021/04/10/excersize/ch06/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬å…­ç« -å‡½æ•°"><a href="#ç¬¬å…­ç« -å‡½æ•°" class="headerlink" title="ç¬¬å…­ç«  å‡½æ•°"></a>ç¬¬å…­ç«  å‡½æ•°</h1><h2 id="ç»ƒä¹ 6-1"><a href="#ç»ƒä¹ 6-1" class="headerlink" title="ç»ƒä¹ 6.1"></a>ç»ƒä¹ 6.1</h2><p>å®å‚å’Œå½¢å‚çš„åŒºåˆ«çš„ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>å®å‚æ˜¯å‡½æ•°è°ƒç”¨çš„å®é™…å€¼ï¼Œæ˜¯å½¢å‚çš„åˆå§‹å€¼ã€‚</p><h2 id="ç»ƒä¹ 6-2"><a href="#ç»ƒä¹ 6-2" class="headerlink" title="ç»ƒä¹ 6.2"></a>ç»ƒä¹ 6.2</h2><p>è¯·æŒ‡å‡ºä¸‹åˆ—å‡½æ•°å“ªä¸ªæœ‰é”™è¯¯ï¼Œä¸ºä»€ä¹ˆï¼Ÿåº”è¯¥å¦‚ä½•ä¿®æ”¹è¿™äº›é”™è¯¯å‘¢ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         string s<span class="token punctuation">;</span>         <span class="token comment">// ...</span>         <span class="token keyword">return</span> s<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">double</span> <span class="token function">square</span> <span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span>  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åº”è¯¥æ”¹ä¸ºä¸‹é¢è¿™æ ·ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> string <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         string s<span class="token punctuation">;</span>         <span class="token comment">// ...</span>         <span class="token keyword">return</span> s<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token keyword">return</span> <span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">double</span> <span class="token function">square</span> <span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-3"><a href="#ç»ƒä¹ 6-3" class="headerlink" title="ç»ƒä¹ 6.3"></a>ç»ƒä¹ 6.3</h2><p>ç¼–å†™ä½ è‡ªå·±çš„<code>fact</code>å‡½æ•°ï¼Œä¸Šæœºæ£€æŸ¥æ˜¯å¦æ­£ç¡®ã€‚æ³¨ï¼šé˜¶ä¹˜ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>runtime_error <span class="token function">err</span><span class="token punctuation">(</span><span class="token string">"Input cannot be a negative number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> err<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> i <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> i <span class="token operator">*</span> <span class="token function">fact</span><span class="token punctuation">(</span> i <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>boolalpha <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">120</span> <span class="token operator">==</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ç”¨<code>std::boolalpha</code>ï¼Œå¯ä»¥è¾“å‡º <code>&quot;true&quot;</code>æˆ–è€… <code>&quot;false&quot;</code>ã€‚</p><h2 id="ç»ƒä¹ 6-4"><a href="#ç»ƒä¹ 6-4" class="headerlink" title="ç»ƒä¹ 6.4"></a>ç»ƒä¹ 6.4</h2><p>ç¼–å†™ä¸€ä¸ªä¸ç”¨æˆ·äº¤äº’çš„å‡½æ•°ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œè®¡ç®—ç”Ÿæˆè¯¥æ•°å­—çš„é˜¶ä¹˜ã€‚åœ¨mainå‡½æ•°ä¸­è°ƒç”¨è¯¥å‡½æ•°ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">int</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> i <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> i <span class="token operator">*</span> <span class="token function">fact</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">interactive_fact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token keyword">const</span> prompt <span class="token operator">=</span> <span class="token string">"Enter a number within [1, 13) :\n"</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>string <span class="token keyword">const</span> out_of_range <span class="token operator">=</span> <span class="token string">"Out of range, please try again.\n"</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> prompt<span class="token punctuation">,</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> i<span class="token punctuation">;</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">></span> <span class="token number">12</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> out_of_range<span class="token punctuation">;</span>             <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">fact</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">interactive_fact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-5"><a href="#ç»ƒä¹ 6-5" class="headerlink" title="ç»ƒä¹ 6.5"></a>ç»ƒä¹ 6.5</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°è¾“å‡ºå…¶å®å‚çš„ç»å¯¹å€¼ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">return</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> i <span class="token operator">:</span> <span class="token operator">-</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-6"><a href="#ç»ƒä¹ 6-6" class="headerlink" title="ç»ƒä¹ 6.6"></a>ç»ƒä¹ 6.6</h2><p>è¯´æ˜å½¢å‚ã€å±€éƒ¨å˜é‡ä»¥åŠå±€éƒ¨é™æ€å˜é‡çš„åŒºåˆ«ã€‚ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶è¾¾åˆ°è¿™ä¸‰ç§å½¢å¼ã€‚</p><p>è§£ï¼š</p><p>å½¢å‚å®šä¹‰åœ¨å‡½æ•°å½¢å‚åˆ—è¡¨é‡Œé¢ï¼›å±€éƒ¨å˜é‡å®šä¹‰åœ¨ä»£ç å—é‡Œé¢ï¼›<br>å±€éƒ¨é™æ€å˜é‡åœ¨ç¨‹åºçš„æ‰§è¡Œè·¯å¾„ç¬¬ä¸€æ¬¡ç»è¿‡å¯¹è±¡å®šä¹‰è¯­å¥æ—¶åˆå§‹åŒ–ï¼Œå¹¶ä¸”ç›´åˆ°ç¨‹åºç»ˆæ­¢æ—¶æ‰è¢«é”€æ¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// ä¾‹å­</span><span class="token keyword">int</span> <span class="token function">count_add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>       <span class="token comment">// næ˜¯å½¢å‚</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> ctr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// ctr æ˜¯å±€éƒ¨é™æ€å˜é‡</span>    ctr <span class="token operator">+=</span> n<span class="token punctuation">;</span>    <span class="token keyword">return</span> ctr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>  <span class="token comment">// i æ˜¯å±€éƒ¨å˜é‡</span>      cout <span class="token operator">&lt;&lt;</span> <span class="token function">count_add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-7"><a href="#ç»ƒä¹ 6-7" class="headerlink" title="ç»ƒä¹ 6.7"></a>ç»ƒä¹ 6.7</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå½“å®ƒç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶è¿”å›0ï¼Œä»¥åæ¯æ¬¡è¢«è°ƒç”¨è¿”å›å€¼åŠ 1ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> ctr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ctr<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-8"><a href="#ç»ƒä¹ 6-8" class="headerlink" title="ç»ƒä¹ 6.8"></a>ç»ƒä¹ 6.8</h2><p>ç¼–å†™ä¸€ä¸ªåä¸ºChapter6.h çš„å¤´æ–‡ä»¶ï¼Œä»¤å…¶åŒ…å«6.1èŠ‚ç»ƒä¹ ä¸­çš„å‡½æ•°å£°æ˜ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token comment">//å‚è€ƒï¼šhttps://blog.csdn.net/fightingforcv/article/details/51472586</span>T <span class="token function">abs</span><span class="token punctuation">(</span>T i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> i <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">?</span> i <span class="token operator">:</span> <span class="token operator">-</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-9-fact-cc-factMain-cc"><a href="#ç»ƒä¹ 6-9-fact-cc-factMain-cc" class="headerlink" title="ç»ƒä¹ 6.9 : fact.cc | factMain.cc"></a>ç»ƒä¹ 6.9 : fact.cc | factMain.cc</h2><p>ç¼–å†™ä½ è‡ªå·±çš„fact.cc å’ŒfactMain.cc ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½åº”è¯¥åŒ…å«ä¸Šä¸€å°èŠ‚çš„ç»ƒä¹ ä¸­ç¼–å†™çš„ Chapter6.h å¤´æ–‡ä»¶ã€‚é€šè¿‡è¿™äº›æ–‡ä»¶ï¼Œç†è§£ä½ çš„ç¼–è¯‘å™¨æ˜¯å¦‚ä½•æ”¯æŒåˆ†ç¦»å¼ç¼–è¯‘çš„ã€‚</p><p>è§£ï¼š</p><p>fact.ccï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Chapter6.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> val <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">return</span> val <span class="token operator">*</span> <span class="token function">fact</span><span class="token punctuation">(</span>val<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n<span class="token punctuation">,</span> ret <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"input a number: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cin <span class="token operator">>></span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> ret <span class="token operator">*=</span> n<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>factMain.ccï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Chapter6.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"5! is "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>     std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>     std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">9.78</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–è¯‘ï¼š <code>g++ factMain.cpp fact.cpp -o main</code></p><h2 id="ç»ƒä¹ 6-10"><a href="#ç»ƒä¹ 6-10" class="headerlink" title="ç»ƒä¹ 6.10"></a>ç»ƒä¹ 6.10</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨æŒ‡é’ˆå½¢å‚äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼ã€‚<br>åœ¨ä»£ç ä¸­è°ƒç”¨è¯¥å‡½æ•°å¹¶è¾“å‡ºäº¤æ¢åçš„ç»“æœï¼Œä»¥æ­¤éªŒè¯å‡½æ•°çš„æ­£ç¡®æ€§ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> lhs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> tmp<span class="token punctuation">;</span>tmp <span class="token operator">=</span> <span class="token operator">*</span>lhs<span class="token punctuation">;</span><span class="token operator">*</span>lhs <span class="token operator">=</span> <span class="token operator">*</span>rhs<span class="token punctuation">;</span><span class="token operator">*</span>rhs <span class="token operator">=</span> tmp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> lft<span class="token punctuation">,</span> rht<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please Enter:\n"</span><span class="token punctuation">,</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> lft <span class="token operator">>></span> rht<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>lft<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rht<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> lft <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> rht <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-11"><a href="#ç»ƒä¹ 6-11" class="headerlink" title="ç»ƒä¹ 6.11"></a>ç»ƒä¹ 6.11</h2><p>ç¼–å†™å¹¶éªŒè¯ä½ è‡ªå·±çš„resetå‡½æ•°ï¼Œä½¿å…¶ä½œç”¨äºå¼•ç”¨ç±»å‹çš„å‚æ•°ã€‚æ³¨ï¼šresetå³ç½®0ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>    <span class="token function">reset</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i  <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-12"><a href="#ç»ƒä¹ 6-12" class="headerlink" title="ç»ƒä¹ 6.12"></a>ç»ƒä¹ 6.12</h2><p>æ”¹å†™6.2.1èŠ‚ç»ƒä¹ ä¸­çš„ç¨‹åºï¼Œä½¿å…¶å¼•ç”¨è€ŒéæŒ‡é’ˆäº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼ã€‚ä½ è§‰å¾—å“ªç§æ–¹æ³•æ›´æ˜“äºä½¿ç”¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    lhs <span class="token operator">=</span> rhs<span class="token punctuation">;</span>    rhs <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> right<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please Enter:\n"</span><span class="token punctuation">,</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> left <span class="token operator">>></span> right<span class="token punctuation">;</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">swap</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾å¼•ç”¨æ›´å¥½ç”¨ã€‚</p><h2 id="ç»ƒä¹ 6-13"><a href="#ç»ƒä¹ 6-13" class="headerlink" title="ç»ƒä¹ 6.13"></a>ç»ƒä¹ 6.13</h2><p>å‡è®¾<code>T</code>æ˜¯æŸç§ç±»å‹çš„åå­—ï¼Œè¯´æ˜ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°å£°æ˜çš„åŒºåˆ«ï¼š<br>ä¸€ä¸ªæ˜¯<code>void f(T)</code>, å¦ä¸€ä¸ªæ˜¯<code>void f(&amp;T)</code>ã€‚</p><p>è§£ï¼š</p><p><code>void f(T)</code>çš„å‚æ•°é€šè¿‡å€¼ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­<code>T</code>æ˜¯å®å‚çš„å‰¯æœ¬ï¼Œæ”¹å˜<code>T</code>ä¸ä¼šå½±å“åˆ°åŸæ¥çš„å®å‚ã€‚<br><code>void f(&amp;T)</code>çš„å‚æ•°é€šè¿‡å¼•ç”¨ä¼ é€’ï¼Œåœ¨å‡½æ•°ä¸­çš„<code>T</code>æ˜¯å®å‚çš„å¼•ç”¨ï¼Œ<code>T</code>çš„æ”¹å˜ä¹Ÿå°±æ˜¯å®å‚çš„æ”¹å˜ã€‚</p><h2 id="ç»ƒä¹ 6-14"><a href="#ç»ƒä¹ 6-14" class="headerlink" title="ç»ƒä¹ 6.14"></a>ç»ƒä¹ 6.14</h2><p>ä¸¾ä¸€ä¸ªå½¢å‚åº”è¯¥æ˜¯å¼•ç”¨ç±»å‹çš„ä¾‹å­ï¼Œå†ä¸¾ä¸€ä¸ªå½¢å‚ä¸èƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ä¾‹å­ã€‚</p><p>è§£ï¼š</p><p>ä¾‹å¦‚äº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å‡½æ•°ï¼Œå½¢å‚åº”è¯¥æ˜¯å¼•ç”¨</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> temp <span class="token operator">=</span> lhs<span class="token punctuation">;</span>lhs <span class="token operator">=</span> rhs<span class="token punctuation">;</span>rhs <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“å®å‚çš„å€¼æ˜¯å³å€¼æ—¶ï¼Œå½¢å‚ä¸èƒ½ä¸ºå¼•ç”¨ç±»å‹</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-15"><a href="#ç»ƒä¹ 6-15" class="headerlink" title="ç»ƒä¹ 6.15"></a>ç»ƒä¹ 6.15</h2><p>è¯´æ˜<code>find_char</code>å‡½æ•°ä¸­çš„ä¸‰ä¸ªå½¢å‚ä¸ºä»€ä¹ˆæ˜¯ç°åœ¨çš„ç±»å‹ï¼Œç‰¹åˆ«è¯´æ˜ä¸ºä»€ä¹ˆ<code>s</code>æ˜¯å¸¸é‡å¼•ç”¨è€Œ<code>occurs</code>æ˜¯æ™®é€šå¼•ç”¨ï¼Ÿ<br>ä¸ºä»€ä¹ˆ<code>s</code>å’Œ<code>occurs</code>æ˜¯å¼•ç”¨ç±»å‹è€Œ<code>c</code>ä¸æ˜¯ï¼Ÿ<br>å¦‚æœä»¤<code>s</code>æ˜¯æ™®é€šå¼•ç”¨ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ<br>å¦‚æœä»¤<code>occurs</code>æ˜¯å¸¸é‡å¼•ç”¨ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><p>è§£ï¼š</p><ul><li>å› ä¸ºå­—ç¬¦ä¸²å¯èƒ½å¾ˆé•¿ï¼Œå› æ­¤ä½¿ç”¨å¼•ç”¨é¿å…æ‹·è´ï¼›</li><li>è€Œåœ¨å‡½æ•°ä¸­æˆ‘ä»¬ä¸å¸Œæœ›æ”¹å˜<code>s</code>çš„å†…å®¹ï¼Œæ‰€ä»¥ä»¤<code>s</code>ä¸ºå¸¸é‡ã€‚</li><li><code>occurs</code>æ˜¯è¦ä¼ åˆ°å‡½æ•°å¤–éƒ¨çš„å˜é‡ï¼Œæ‰€ä»¥ä½¿ç”¨å¼•ç”¨ï¼Œ<code>occurs</code>çš„å€¼ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æ˜¯æ™®é€šå¼•ç”¨ã€‚</li><li>å› ä¸ºæˆ‘ä»¬åªéœ€è¦<code>c</code>çš„å€¼ï¼Œè¿™ä¸ªå®å‚å¯èƒ½æ˜¯å³å€¼(å³å€¼å®å‚æ— æ³•ç”¨äºå¼•ç”¨å½¢å‚)ï¼Œæ‰€ä»¥<code>c</code>ä¸èƒ½ç”¨å¼•ç”¨ç±»å‹ã€‚</li><li>å¦‚æœ<code>s</code>æ˜¯æ™®é€šå¼•ç”¨ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–æ”¹å˜åŸæ¥å­—ç¬¦ä¸²çš„å†…å®¹ã€‚</li><li><code>occurs</code>å¦‚æœæ˜¯å¸¸é‡å¼•ç”¨ï¼Œé‚£ä¹ˆæ„å‘³ç€ä¸èƒ½æ”¹å˜å®ƒçš„å€¼ï¼Œé‚£ä¹Ÿå°±å¤±å»æ„ä¹‰äº†ã€‚</li></ul><h2 id="ç»ƒä¹ 6-16"><a href="#ç»ƒä¹ 6-16" class="headerlink" title="ç»ƒä¹ 6.16"></a>ç»ƒä¹ 6.16</h2><p>ä¸‹é¢çš„è¿™ä¸ªå‡½æ•°è™½ç„¶åˆæ³•ï¼Œä½†æ˜¯ä¸ç®—ç‰¹åˆ«æœ‰ç”¨ã€‚æŒ‡å‡ºå®ƒçš„å±€é™æ€§å¹¶è®¾æ³•æ”¹å–„ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">is_empty</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å±€é™æ€§åœ¨äºå¸¸é‡å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²å­—é¢å€¼æ— æ³•ä½œä¸ºè¯¥å‡½æ•°çš„å®å‚ï¼Œå¦‚æœä¸‹é¢è¿™æ ·è°ƒç”¨æ˜¯éæ³•çš„ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">const</span> string str<span class="token punctuation">;</span><span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token function">is_empty</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//éæ³•</span><span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//éæ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥è¦å°†è¿™ä¸ªå‡½æ•°çš„å½¢å‚å®šä¹‰ä¸ºå¸¸é‡å¼•ç”¨ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">is_empty</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-17"><a href="#ç»ƒä¹ 6-17" class="headerlink" title="ç»ƒä¹ 6.17"></a>ç»ƒä¹ 6.17</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­<code>string</code>å¯¹è±¡ä¸­æ˜¯å¦å«æœ‰å¤§å†™å­—æ¯ã€‚<br>ç¼–å†™å¦ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠ<code>string</code>å¯¹è±¡å…¨éƒ¨æ”¹å†™æˆå°å†™å½¢å¼ã€‚<br>åœ¨è¿™ä¸¤ä¸ªå‡½æ•°ä¸­ä½ ä½¿ç”¨çš„å½¢å‚ç±»å‹ç›¸åŒå—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>ä¸¤ä¸ªå‡½æ•°çš„å½¢å‚ä¸ä¸€æ ·ã€‚ç¬¬ä¸€ä¸ªå‡½æ•°ä½¿ç”¨å¸¸é‡å¼•ç”¨ï¼Œç¬¬äºŒä¸ªå‡½æ•°ä½¿ç”¨æ™®é€šå¼•ç”¨ã€‚</p><h2 id="ç»ƒä¹ 6-18"><a href="#ç»ƒä¹ 6-18" class="headerlink" title="ç»ƒä¹ 6.18"></a>ç»ƒä¹ 6.18</h2><p>ä¸ºä¸‹é¢çš„å‡½æ•°ç¼–å†™å‡½æ•°å£°æ˜ï¼Œä»ç»™å®šçš„åå­—ä¸­æ¨æµ‹å‡½æ•°å…·å¤‡çš„åŠŸèƒ½ã€‚</p><ul><li>(a) åä¸º<code>compare</code>çš„å‡½æ•°ï¼Œè¿”å›å¸ƒå°”å€¼ï¼Œä¸¤ä¸ªå‚æ•°éƒ½æ˜¯<code>matrix</code>ç±»çš„å¼•ç”¨ã€‚</li><li>(b) åä¸º<code>change_val</code>çš„å‡½æ•°ï¼Œè¿”å›<code>vector</code>çš„è¿­ä»£å™¨ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯<code>int</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code>vector</code>çš„è¿­ä»£å™¨ã€‚</li></ul><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">bool</span> <span class="token function">compare</span><span class="token punctuation">(</span>matrix <span class="token operator">&amp;</span>m1<span class="token punctuation">,</span> matrix <span class="token operator">&amp;</span>m2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator <span class="token function">change_val</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-19"><a href="#ç»ƒä¹ 6-19" class="headerlink" title="ç»ƒä¹ 6.19"></a>ç»ƒä¹ 6.19</h2><p>å‡å®šæœ‰å¦‚ä¸‹å£°æ˜ï¼Œåˆ¤æ–­å“ªä¸ªè°ƒç”¨åˆæ³•ã€å“ªä¸ªè°ƒç”¨ä¸åˆæ³•ã€‚å¯¹äºä¸åˆæ³•çš„å‡½æ•°è°ƒç”¨ï¼Œè¯´æ˜åŸå› ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">double</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>iterator<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">23.4</span><span class="token punctuation">,</span> <span class="token number">55.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token string">"abcda"</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">sum</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3.8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ä¸åˆæ³•ã€‚<code>calc</code>åªæœ‰ä¸€ä¸ªå‚æ•°ã€‚</li><li>(b) åˆæ³•ã€‚</li><li>(c) åˆæ³•ã€‚</li><li>(d) åˆæ³•ã€‚</li></ul><h2 id="ç»ƒä¹ 6-20"><a href="#ç»ƒä¹ 6-20" class="headerlink" title="ç»ƒä¹ 6.20"></a>ç»ƒä¹ 6.20</h2><p>å¼•ç”¨å½¢å‚ä»€ä¹ˆæ—¶å€™åº”è¯¥æ˜¯å¸¸é‡å¼•ç”¨ï¼Ÿå¦‚æœå½¢å‚åº”è¯¥æ˜¯å¸¸é‡å¼•ç”¨ï¼Œè€Œæˆ‘ä»¬å°†å…¶è®¾ä¸ºäº†æ™®é€šå¼•ç”¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><p>è§£ï¼š</p><p>åº”è¯¥å°½é‡å°†å¼•ç”¨å½¢å‚è®¾ä¸ºå¸¸é‡å¼•ç”¨ï¼Œé™¤éæœ‰æ˜ç¡®çš„ç›®çš„æ˜¯ä¸ºäº†æ”¹å˜è¿™ä¸ªå¼•ç”¨å˜é‡ã€‚<br>å¦‚æœå½¢å‚åº”è¯¥æ˜¯å¸¸é‡å¼•ç”¨ï¼Œè€Œæˆ‘ä»¬å°†å…¶è®¾ä¸ºäº†æ™®é€šå¼•ç”¨ï¼Œé‚£ä¹ˆå¸¸é‡å®å‚å°†æ— æ³•ä½œç”¨äºæ™®é€šå¼•ç”¨å½¢å‚ã€‚</p><h2 id="ç»ƒä¹ 6-21"><a href="#ç»ƒä¹ 6-21" class="headerlink" title="ç»ƒä¹ 6.21"></a>ç»ƒä¹ 6.21</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä»¤å…¶æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯<code>int</code>å‹çš„æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯<code>int</code>æŒ‡é’ˆã€‚<br>å‡½æ•°æ¯”è¾ƒ<code>int</code>çš„å€¼å’ŒæŒ‡é’ˆæ‰€æŒ‡çš„å€¼ï¼Œè¿”å›è¾ƒå¤§çš„é‚£ä¸ªã€‚<br>åœ¨è¯¥å‡½æ•°ä¸­æŒ‡é’ˆçš„ç±»å‹åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">larger_one</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token keyword">const</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">?</span> i <span class="token operator">:</span> <span class="token operator">*</span>p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token function">larger_one</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åº”è¯¥æ˜¯<code>const int *</code>ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 6-22"><a href="#ç»ƒä¹ 6-22" class="headerlink" title="ç»ƒä¹ 6.22"></a>ç»ƒä¹ 6.22</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä»¤å…¶äº¤æ¢ä¸¤ä¸ª<code>int</code>æŒ‡é’ˆã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&amp;</span> lft<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&amp;</span> rht<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> tmp <span class="token operator">=</span> lft<span class="token punctuation">;</span>    lft <span class="token operator">=</span> rht<span class="token punctuation">;</span>    rht <span class="token operator">=</span> tmp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> lft <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span>    <span class="token keyword">auto</span> rht <span class="token operator">=</span> <span class="token operator">&amp;</span>j<span class="token punctuation">;</span>    <span class="token function">swap</span><span class="token punctuation">(</span>lft<span class="token punctuation">,</span> rht<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>lft <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>rht <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-23"><a href="#ç»ƒä¹ 6-23" class="headerlink" title="ç»ƒä¹ 6.23"></a>ç»ƒä¹ 6.23</h2><p>å‚è€ƒæœ¬èŠ‚ä»‹ç»çš„å‡ ä¸ª<code>print</code>å‡½æ•°ï¼Œæ ¹æ®ç†è§£ç¼–å†™ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚<br>ä¾æ¬¡è°ƒç”¨æ¯ä¸ªå‡½æ•°ä½¿å…¶è¾“å…¥ä¸‹é¢å®šä¹‰çš„<code>i</code>å’Œ<code>j</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>begin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>end<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>pi<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>pi <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p<span class="token operator">++</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>beg<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>beg <span class="token operator">!=</span> end<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>beg<span class="token operator">++</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> arr<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> ch<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"pezy"</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token function">end</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">begin</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-24"><a href="#ç»ƒä¹ 6-24" class="headerlink" title="ç»ƒä¹ 6.24"></a>ç»ƒä¹ 6.24</h2><p>æè¿°ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„è¡Œä¸ºã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨é—®é¢˜ï¼Œè¯·æŒ‡å‡ºå¹¶æ”¹æ­£ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å½“æ•°ç»„ä½œä¸ºå®å‚çš„æ—¶å€™ï¼Œä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºæŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚<br>å› æ­¤å‡½æ•°å½¢å‚æ¥å—çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚<br>å¦‚æœè¦è®©è¿™ä¸ªä»£ç æˆåŠŸè¿è¡Œ(ä¸æ›´æ”¹ä¹Ÿå¯ä»¥è¿è¡Œï¼‰ï¼Œå¯ä»¥å°†å½¢å‚æ”¹ä¸ºæ•°ç»„çš„å¼•ç”¨ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>ia<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-25"><a href="#ç»ƒä¹ 6-25" class="headerlink" title="ç»ƒä¹ 6.25"></a>ç»ƒä¹ 6.25</h2><p>ç¼–å†™ä¸€ä¸ª<code>main</code>å‡½æ•°ï¼Œä»¤å…¶æ¥å—ä¸¤ä¸ªå®å‚ã€‚æŠŠå®å‚çš„å†…å®¹è¿æ¥æˆä¸€ä¸ª<code>string</code>å¯¹è±¡å¹¶è¾“å‡ºå‡ºæ¥ã€‚</p><h2 id="ç»ƒä¹ 6-26"><a href="#ç»ƒä¹ 6-26" class="headerlink" title="ç»ƒä¹ 6.26"></a>ç»ƒä¹ 6.26</h2><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä½¿å…¶æ¥å—æœ¬èŠ‚æ‰€ç¤ºçš„é€‰é¡¹ï¼›è¾“å‡ºä¼ é€’ç»™<code>main</code>å‡½æ•°çš„å®å‚å†…å®¹ã€‚</p><p>è§£ï¼š</p><p>åŒ…æ‹¬6.25</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string str<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> argc<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        str <span class="token operator">+=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-27"><a href="#ç»ƒä¹ 6-27" class="headerlink" title="ç»ƒä¹ 6.27"></a>ç»ƒä¹ 6.27</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯<code>initializer_list</code>ç±»å‹çš„å¯¹è±¡ï¼Œå‡½æ•°çš„åŠŸèƒ½æ˜¯è®¡ç®—åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„å’Œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> il<span class="token punctuation">)</span> sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> il <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">sum</span><span class="token punctuation">(</span>il<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-28"><a href="#ç»ƒä¹ 6-28" class="headerlink" title="ç»ƒä¹ 6.28"></a>ç»ƒä¹ 6.28</h2><p>åœ¨<code>error_msg</code>å‡½æ•°çš„ç¬¬äºŒä¸ªç‰ˆæœ¬ä¸­åŒ…å«<code>ErrCode</code>ç±»å‹çš„å‚æ•°ï¼Œå…¶ä¸­å¾ªç¯å†…çš„<code>elem</code>æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ</p><p>è§£ï¼š</p><p><code>elem</code>æ˜¯<code>const string &amp;</code>ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 6-29"><a href="#ç»ƒä¹ 6-29" class="headerlink" title="ç»ƒä¹ 6.29"></a>ç»ƒä¹ 6.29</h2><p>åœ¨èŒƒå›´<code>for</code>å¾ªç¯ä¸­ä½¿ç”¨<code>initializer_list</code>å¯¹è±¡æ—¶ï¼Œåº”è¯¥å°†å¾ªç¯æ§åˆ¶å˜é‡å£°æ˜æˆå¼•ç”¨ç±»å‹å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>åº”è¯¥ä½¿ç”¨å¸¸é‡å¼•ç”¨ç±»å‹ã€‚<code>initializer_list</code>å¯¹è±¡ä¸­çš„å…ƒç´ éƒ½æ˜¯å¸¸é‡ï¼Œæˆ‘ä»¬æ— æ³•ä¿®æ”¹<code>initializer_list</code>å¯¹è±¡ä¸­çš„å…ƒç´ çš„å€¼ã€‚</p><h2 id="ç»ƒä¹ 6-30"><a href="#ç»ƒä¹ 6-30" class="headerlink" title="ç»ƒä¹ 6.30"></a>ç»ƒä¹ 6.30</h2><p>ç¼–è¯‘ç¬¬200é¡µçš„<code>str_subrange</code>å‡½æ•°ï¼Œçœ‹çœ‹ä½ çš„ç¼–è¯‘å™¨æ˜¯å¦‚ä½•å¤„ç†å‡½æ•°ä¸­çš„é”™è¯¯çš„ã€‚</p><p>è§£ï¼š</p><p>ç¼–è¯‘å™¨ä¿¡æ¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">g++ (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¯‘é”™è¯¯ä¿¡æ¯ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ch6.cpp:38:9: error: return-statement with no value, in function returning â€˜boolâ€™ [-fpermissive]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-31"><a href="#ç»ƒä¹ 6-31" class="headerlink" title="ç»ƒä¹ 6.31"></a>ç»ƒä¹ 6.31</h2><p>ä»€ä¹ˆæƒ…å†µä¸‹è¿”å›çš„å¼•ç”¨æ— æ•ˆï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹è¿”å›å¸¸é‡çš„å¼•ç”¨æ— æ•ˆï¼Ÿ</p><p>è§£ï¼š</p><p>å½“è¿”å›çš„å¼•ç”¨çš„å¯¹è±¡æ˜¯å±€éƒ¨å˜é‡æ—¶ï¼Œè¿”å›çš„å¼•ç”¨æ— æ•ˆï¼›å½“æˆ‘ä»¬å¸Œæœ›è¿”å›çš„å¯¹è±¡è¢«ä¿®æ”¹æ—¶ï¼Œè¿”å›å¸¸é‡çš„å¼•ç”¨æ— æ•ˆã€‚</p><h2 id="ç»ƒä¹ 6-32"><a href="#ç»ƒä¹ 6-32" class="headerlink" title="ç»ƒä¹ 6.32"></a>ç»ƒä¹ 6.32</h2><p>ä¸‹é¢çš„å‡½æ•°åˆæ³•å—ï¼Ÿå¦‚æœåˆæ³•ï¼Œè¯´æ˜å…¶åŠŸèƒ½ï¼›å¦‚æœä¸åˆæ³•ï¼Œä¿®æ”¹å…¶ä¸­çš„é”™è¯¯å¹¶è§£é‡ŠåŸå› ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">&amp;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> array<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ia<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token function">get</span><span class="token punctuation">(</span>ia<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åˆæ³•ã€‚<code>get</code>å‡½æ•°æ ¹æ®ç´¢å¼•å–å¾—æ•°ç»„ä¸­çš„å…ƒç´ çš„å¼•ç”¨ã€‚</p><h2 id="ç»ƒä¹ 6-33"><a href="#ç»ƒä¹ 6-33" class="headerlink" title="ç»ƒä¹ 6.33"></a>ç»ƒä¹ 6.33</h2><p>ç¼–å†™ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œè¾“å‡º<code>vector</code>å¯¹è±¡çš„å†…å®¹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> Iter <span class="token operator">=</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span>const_iterator<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>Iter first<span class="token punctuation">,</span> Iter last<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token function">print</span><span class="token punctuation">(</span><span class="token operator">++</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-34"><a href="#ç»ƒä¹ 6-34" class="headerlink" title="ç»ƒä¹ 6.34"></a>ç»ƒä¹ 6.34</h2><p>å¦‚æœ<code>factorial</code>å‡½æ•°çš„åœæ­¢æ¡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼Œå°†å‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š<br>å¦‚æœ<code>val</code>ä¸ºæ­£æ•°ï¼Œä»ç»“æœä¸Šæ¥è¯´æ²¡æœ‰åŒºåˆ«ï¼ˆå¤šä¹˜äº†ä¸ª1ï¼‰;<br>å¦‚æœ<code>val</code>ä¸ºè´Ÿæ•°ï¼Œé‚£ä¹ˆé€’å½’æ°¸è¿œä¸ä¼šç»“æŸã€‚</p><h2 id="ç»ƒä¹ 6-35"><a href="#ç»ƒä¹ 6-35" class="headerlink" title="ç»ƒä¹ 6.35"></a>ç»ƒä¹ 6.35</h2><p>åœ¨è°ƒç”¨<code>factorial</code>å‡½æ•°æ—¶ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼ å…¥çš„å€¼æ˜¯<code>val-1</code>è€Œé<code>val--</code>ï¼Ÿ</p><p>è§£ï¼š</p><p>å¦‚æœä¼ å…¥çš„å€¼æ˜¯<code>val--</code>ï¼Œé‚£ä¹ˆå°†ä¼šæ°¸è¿œä¼ å…¥ç›¸åŒçš„å€¼æ¥è°ƒç”¨è¯¥å‡½æ•°ï¼Œé€’å½’å°†æ°¸è¿œä¸ä¼šç»“æŸã€‚</p><h2 id="ç»ƒä¹ 6-36"><a href="#ç»ƒä¹ 6-36" class="headerlink" title="ç»ƒä¹ 6.36"></a>ç»ƒä¹ 6.36</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°å£°æ˜ï¼Œä½¿å…¶è¿”å›æ•°ç»„çš„å¼•ç”¨å¹¶ä¸”è¯¥æ•°ç»„åŒ…å«10ä¸ª<code>string</code>å¯¹è±¡ã€‚<br>ä¸ç”¨ä½¿ç”¨å°¾ç½®è¿”å›ç±»å‹ã€<code>decltype</code>æˆ–è€…ç±»å‹åˆ«åã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">string</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-37"><a href="#ç»ƒä¹ 6-37" class="headerlink" title="ç»ƒä¹ 6.37"></a>ç»ƒä¹ 6.37</h2><p>ä¸ºä¸Šä¸€é¢˜çš„å‡½æ•°å†å†™ä¸‰ä¸ªå£°æ˜ï¼Œä¸€ä¸ªä½¿ç”¨ç±»å‹åˆ«åï¼Œå¦ä¸€ä¸ªä½¿ç”¨å°¾ç½®è¿”å›ç±»å‹ï¼Œæœ€åä¸€ä¸ªä½¿ç”¨<code>decltype</code>å…³é”®å­—ã€‚<br>ä½ è§‰å¾—å“ªç§å½¢å¼æœ€å¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> string str_arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>str_arr<span class="token operator">&amp;</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>string s<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&amp;</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘è§‰å¾—å°¾ç½®è¿”å›ç±»å‹æœ€å¥½ï¼Œå°±ä¸€è¡Œä»£ç ã€‚</p><h2 id="ç»ƒä¹ 6-38"><a href="#ç»ƒä¹ 6-38" class="headerlink" title="ç»ƒä¹ 6.38"></a>ç»ƒä¹ 6.38</h2><p>ä¿®æ”¹<code>arrPtr</code>å‡½æ•°ï¼Œä½¿å…¶è¿”å›æ•°ç»„çš„å¼•ç”¨ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">decltype</span><span class="token punctuation">(</span>odd<span class="token punctuation">)</span><span class="token operator">&amp;</span> <span class="token function">arrPtr</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">?</span> odd <span class="token operator">:</span> even<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-39"><a href="#ç»ƒä¹ 6-39" class="headerlink" title="ç»ƒä¹ 6.39"></a>ç»ƒä¹ 6.39</h2><p>è¯´æ˜åœ¨ä¸‹é¢çš„æ¯ç»„å£°æ˜ä¸­ç¬¬äºŒæ¡è¯­å¥æ˜¯ä½•å«ä¹‰ã€‚<br>å¦‚æœæœ‰éæ³•çš„å£°æ˜ï¼Œè¯·æŒ‡å‡ºæ¥ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) éæ³•ã€‚å› ä¸ºé¡¶å±‚constä¸å½±å“ä¼ å…¥å‡½æ•°çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå£°æ˜æ— æ³•ä¸ç¬¬ä¸€ä¸ªå£°æ˜åŒºåˆ†å¼€æ¥ã€‚</li><li>(b) éæ³•ã€‚å¯¹äºé‡è½½çš„å‡½æ•°æ¥è¯´ï¼Œå®ƒä»¬åº”è¯¥åªæœ‰å½¢å‚çš„æ•°é‡å’Œå½¢å‚çš„ç±»å‹ä¸åŒã€‚è¿”å›å€¼ä¸é‡è½½æ— å…³ã€‚</li><li>(c) åˆæ³•ã€‚</li></ul><h2 id="ç»ƒä¹ 6-40"><a href="#ç»ƒä¹ 6-40" class="headerlink" title="ç»ƒä¹ 6.40"></a>ç»ƒä¹ 6.40</h2><p>ä¸‹é¢çš„å“ªä¸ªå£°æ˜æ˜¯é”™è¯¯çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">ff</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> ht <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token keyword">int</span> wd<span class="token punctuation">,</span> <span class="token keyword">char</span> bckgrnd<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>(a) æ­£ç¡®ã€‚<br>(b) é”™è¯¯ã€‚å› ä¸ºä¸€æ—¦æŸä¸ªå½¢å‚è¢«èµ‹äºˆäº†é»˜è®¤å€¼ï¼Œé‚£ä¹ˆå®ƒä¹‹åçš„å½¢å‚éƒ½å¿…é¡»è¦æœ‰é»˜è®¤å€¼ã€‚</p><h2 id="ç»ƒä¹ 6-41"><a href="#ç»ƒä¹ 6-41" class="headerlink" title="ç»ƒä¹ 6.41"></a>ç»ƒä¹ 6.41</h2><p>ä¸‹é¢çš„å“ªä¸ªè°ƒç”¨æ˜¯éæ³•çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿå“ªä¸ªè°ƒç”¨è™½ç„¶åˆæ³•ä½†æ˜¾ç„¶ä¸ç¨‹åºå‘˜çš„åˆè¡·ä¸ç¬¦ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> ht<span class="token punctuation">,</span> <span class="token keyword">int</span> wd <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token keyword">char</span> bckgrnd <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) éæ³•ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯é»˜è®¤å‚æ•°ï¼Œæœ€å°‘éœ€è¦ä¸€ä¸ªå®å‚ã€‚</li><li>(b) åˆæ³•ã€‚</li><li>(c) åˆæ³•ï¼Œä½†ä¸åˆè¡·ä¸ç¬¦ã€‚å­—ç¬¦<code>*</code>è¢«è§£é‡Šæˆ<code>int</code>ä¼ å…¥åˆ°äº†ç¬¬äºŒä¸ªå‚æ•°ã€‚è€Œåˆè¡·æ˜¯è¦ä¼ ç»™ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚</li></ul><h2 id="ç»ƒä¹ 6-42"><a href="#ç»ƒä¹ 6-42" class="headerlink" title="ç»ƒä¹ 6.42"></a>ç»ƒä¹ 6.42</h2><p>ç»™<code>make_plural</code>å‡½æ•°çš„ç¬¬äºŒä¸ªå½¢å‚èµ‹äºˆé»˜è®¤å®å‚â€™sâ€™, åˆ©ç”¨æ–°ç‰ˆæœ¬çš„å‡½æ•°è¾“å‡ºå•è¯successå’Œfailureçš„å•æ•°å’Œå¤æ•°å½¢å¼ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>string <span class="token function">make_plural</span><span class="token punctuation">(</span>size_t ctr<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> word<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> ending <span class="token operator">=</span> <span class="token string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>ctr <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> word <span class="token operator">+</span> ending <span class="token operator">:</span> word<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"single: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">make_plural</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">,</span> <span class="token string">"es"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token operator">&lt;&lt;</span> <span class="token function">make_plural</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"failure"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"plural : "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">make_plural</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"success"</span><span class="token punctuation">,</span> <span class="token string">"es"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token operator">&lt;&lt;</span> <span class="token function">make_plural</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"failure"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-43"><a href="#ç»ƒä¹ 6-43" class="headerlink" title="ç»ƒä¹ 6.43"></a>ç»ƒä¹ 6.43</h2><p>ä½ ä¼šæŠŠä¸‹é¢çš„å“ªä¸ªå£°æ˜å’Œå®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ï¼Ÿå“ªä¸ªæ”¾åœ¨æºæ–‡ä»¶ä¸­ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">eq</span><span class="token punctuation">(</span><span class="token keyword">const</span> BigInt<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> BigInt<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">void</span> <span class="token function">putValues</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å…¨éƒ¨éƒ½æ”¾è¿›å¤´æ–‡ä»¶ã€‚(a) æ˜¯å†…è”å‡½æ•°ï¼Œ(b) æ˜¯å£°æ˜ã€‚</p><h2 id="ç»ƒä¹ 6-44"><a href="#ç»ƒä¹ 6-44" class="headerlink" title="ç»ƒä¹ 6.44"></a>ç»ƒä¹ 6.44</h2><p>å°†6.2.2èŠ‚çš„<code>isShorter</code>å‡½æ•°æ”¹å†™æˆå†…è”å‡½æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">is_shorter</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>lft<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span>rht<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> lft<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> rht<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-45"><a href="#ç»ƒä¹ 6-45" class="headerlink" title="ç»ƒä¹ 6.45"></a>ç»ƒä¹ 6.45</h2><p>å›é¡¾åœ¨å‰é¢çš„ç»ƒä¹ ä¸­ä½ ç¼–å†™çš„é‚£äº›å‡½æ•°ï¼Œå®ƒä»¬åº”è¯¥æ˜¯å†…è”å‡½æ•°å—ï¼Ÿ<br>å¦‚æœæ˜¯ï¼Œå°†å®ƒä»¬æ”¹å†™æˆå†…è”å‡½æ•°ï¼›å¦‚æœä¸æ˜¯ï¼Œè¯´æ˜åŸå› ã€‚</p><p>è§£ï¼š</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå†…è”æœºåˆ¶ç”¨äºä¼˜åŒ–è§„æ¨¡å°ã€æµç¨‹ç›´æ¥ã€é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 6-46"><a href="#ç»ƒä¹ 6-46" class="headerlink" title="ç»ƒä¹ 6.46"></a>ç»ƒä¹ 6.46</h2><p>èƒ½æŠŠ<code>isShorter</code>å‡½æ•°å®šä¹‰æˆ<code>constexpr</code>å‡½æ•°å—ï¼Ÿ<br>å¦‚æœèƒ½ï¼Œå°†å®ƒæ”¹å†™æˆ<code>constxpre</code>å‡½æ•°ï¼›å¦‚æœä¸èƒ½ï¼Œè¯´æ˜åŸå› ã€‚</p><p>è§£ï¼š</p><p>ä¸èƒ½ã€‚<code>constexpr</code>å‡½æ•°çš„è¿”å›å€¼ç±»å‹åŠæ‰€æœ‰å½¢å‚éƒ½å¾—æ˜¯å­—é¢å€¼ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 6-47"><a href="#ç»ƒä¹ 6-47" class="headerlink" title="ç»ƒä¹ 6.47"></a>ç»ƒä¹ 6.47</h2><p>æ”¹å†™6.3.2èŠ‚ç»ƒä¹ ä¸­ä½¿ç”¨é€’å½’è¾“å‡º<code>vector</code>å†…å®¹çš„ç¨‹åºï¼Œä½¿å…¶æœ‰æ¡ä»¶åœ°è¾“å‡ºä¸æ‰§è¡Œè¿‡ç¨‹æœ‰å…³çš„ä¿¡æ¯ã€‚<br>ä¾‹å¦‚ï¼Œæ¯æ¬¡è°ƒç”¨æ—¶è¾“å‡º<code>vector</code>å¯¹è±¡çš„å¤§å°ã€‚<br>åˆ†åˆ«åœ¨æ‰“å¼€å’Œå…³é—­è°ƒè¯•å™¨çš„æƒ…å†µä¸‹ç¼–è¯‘å¹¶æ‰§è¡Œè¿™ä¸ªç¨‹åºã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">printVec</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">&amp;</span>vec<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">NDEBUG</span></span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"vector size: "</span> <span class="token operator">&lt;&lt;</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vec<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> tmp <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        vec<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printVec</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> tmp <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">printVec</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-48"><a href="#ç»ƒä¹ 6-48" class="headerlink" title="ç»ƒä¹ 6.48"></a>ç»ƒä¹ 6.48</h2><p>è¯´æ˜ä¸‹é¢è¿™ä¸ªå¾ªç¯çš„å«ä¹‰ï¼Œå®ƒå¯¹assertçš„ä½¿ç”¨åˆç†å—ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> sought<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">//ç©ºå‡½æ•°ä½“</span><span class="token function">assert</span><span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆç†ã€‚ä»è¿™ä¸ªç¨‹åºçš„æ„å›¾æ¥çœ‹ï¼Œåº”è¯¥ç”¨</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">assert</span><span class="token punctuation">(</span>s <span class="token operator">==</span> sought<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-49"><a href="#ç»ƒä¹ 6-49" class="headerlink" title="ç»ƒä¹ 6.49"></a>ç»ƒä¹ 6.49</h2><p>ä»€ä¹ˆæ˜¯å€™é€‰å‡½æ•°ï¼Ÿä»€ä¹ˆæ˜¯å¯è¡Œå‡½æ•°ï¼Ÿ</p><p>è§£ï¼š</p><p>å€™é€‰å‡½æ•°ï¼šä¸è¢«è°ƒç”¨å‡½æ•°åŒåï¼Œå¹¶ä¸”å…¶å£°æ˜åœ¨è°ƒç”¨ç‚¹å¯è§ã€‚<br>å¯è¡Œå‡½æ•°ï¼šå½¢å‚ä¸å®å‚çš„æ•°é‡ç›¸ç­‰ï¼Œå¹¶ä¸”æ¯ä¸ªå®å‚ç±»å‹ä¸å¯¹åº”çš„å½¢å‚ç±»å‹ç›¸åŒæˆ–è€…èƒ½è½¬æ¢æˆå½¢å‚çš„ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 6-50"><a href="#ç»ƒä¹ 6-50" class="headerlink" title="ç»ƒä¹ 6.50"></a>ç»ƒä¹ 6.50</h2><p>å·²çŸ¥æœ‰ç¬¬217é¡µå¯¹å‡½æ•°<code>f</code>çš„å£°æ˜ï¼Œå¯¹äºä¸‹é¢çš„æ¯ä¸€ä¸ªè°ƒç”¨åˆ—å‡ºå¯è¡Œå‡½æ•°ã€‚<br>å…¶ä¸­å“ªä¸ªå‡½æ•°æ˜¯æœ€ä½³åŒ¹é…ï¼Ÿ<br>å¦‚æœè°ƒç”¨ä¸åˆæ³•ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰å¯åŒ¹é…çš„å‡½æ•°è¿˜æ˜¯å› ä¸ºè°ƒç”¨å…·æœ‰äºŒä¹‰æ€§ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2.56</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2.56</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) <code>void f(int, int);</code>å’Œ<code>void f(double, double = 3.14);</code>æ˜¯å¯è¡Œå‡½æ•°ã€‚<br>è¯¥è°ƒç”¨å…·æœ‰äºŒä¹‰æ€§è€Œä¸åˆæ³•ã€‚</li><li>(b) <code>void f(int);</code> æ˜¯å¯è¡Œå‡½æ•°ã€‚è°ƒç”¨åˆæ³•ã€‚</li><li>(c) <code>void f(int, int);</code>å’Œ<code>void f(double, double = 3.14);</code>æ˜¯å¯è¡Œå‡½æ•°ã€‚<br><code>void f(int, int);</code>æ˜¯æœ€ä½³åŒ¹é…ã€‚</li><li>(d) <code>void f(int, int);</code>å’Œ<code>void f(double, double = 3.14);</code>æ˜¯å¯è¡Œå‡½æ•°ã€‚<br><code>void f(double, double = 3.14);</code>æ˜¯æœ€ä½³åŒ¹é…ã€‚</li></ul><h2 id="ç»ƒä¹ 6-51"><a href="#ç»ƒä¹ 6-51" class="headerlink" title="ç»ƒä¹ 6.51"></a>ç»ƒä¹ 6.51</h2><p>ç¼–å†™å‡½æ•°<code>f</code>çš„4ç‰ˆæœ¬ï¼Œä»¤å…¶å„è¾“å‡ºä¸€æ¡å¯ä»¥åŒºåˆ†çš„æ¶ˆæ¯ã€‚<br>éªŒè¯ä¸Šä¸€ä¸ªç»ƒä¹ çš„ç­”æ¡ˆï¼Œå¦‚æœä½ çš„å›ç­”é”™äº†ï¼Œåå¤ç ”ç©¶æœ¬èŠ‚å†…å®¹ç›´åˆ°ä½ å¼„æ¸…è‡ªå·±é”™åœ¨ä½•å¤„ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"f()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"f(int)"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"f(int, int)"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"f(double, double)"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//f(2.56, 42); // error: 'f' is ambiguous.</span>    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2.56</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-52"><a href="#ç»ƒä¹ 6-52" class="headerlink" title="ç»ƒä¹ 6.52"></a>ç»ƒä¹ 6.52</h2><p>å·²çŸ¥æœ‰å¦‚ä¸‹å£°æ˜ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">manip</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> dobj<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¯·æŒ‡å‡ºä¸‹åˆ—è°ƒç”¨ä¸­æ¯ä¸ªç±»å‹è½¬æ¢çš„ç­‰çº§ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">manip</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">manip</span><span class="token punctuation">(</span><span class="token number">55.4</span><span class="token punctuation">,</span> dobj<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ç¬¬3çº§ã€‚ç±»å‹æå‡å®ç°çš„åŒ¹é…ã€‚</li><li>(b) ç¬¬4çº§ã€‚ç®—æœ¯ç±»å‹è½¬æ¢å®ç°çš„åŒ¹é…ã€‚</li></ul><h2 id="ç»ƒä¹ 6-53"><a href="#ç»ƒä¹ 6-53" class="headerlink" title="ç»ƒä¹ 6.53"></a>ç»ƒä¹ 6.53</h2><p>è¯´æ˜ä¸‹åˆ—æ¯ç»„å£°æ˜ä¸­çš„ç¬¬äºŒæ¡è¯­å¥ä¼šäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Œå¹¶æŒ‡å‡ºå“ªäº›ä¸åˆæ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token keyword">const</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>(c) ä¸åˆæ³•ã€‚é¡¶å±‚constä¸å½±å“ä¼ å…¥å‡½æ•°çš„å¯¹è±¡ã€‚</p><h2 id="ç»ƒä¹ 6-54"><a href="#ç»ƒä¹ 6-54" class="headerlink" title="ç»ƒä¹ 6.54"></a>ç»ƒä¹ 6.54</h2><p>ç¼–å†™å‡½æ•°çš„å£°æ˜ï¼Œä»¤å…¶æ¥å—ä¸¤ä¸ª<code>int</code>å½¢å‚å¹¶è¿”å›ç±»å‹ä¹Ÿæ˜¯<code>int</code>ï¼›ç„¶åå£°æ˜ä¸€ä¸ª<code>vector</code>å¯¹è±¡ï¼Œä»¤å…¶å…ƒç´ æ˜¯æŒ‡å‘è¯¥å‡½æ•°çš„æŒ‡é’ˆã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">></span> v<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-55"><a href="#ç»ƒä¹ 6-55" class="headerlink" title="ç»ƒä¹ 6.55"></a>ç»ƒä¹ 6.55</h2><p>ç¼–å†™4ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«å¯¹ä¸¤ä¸ª<code>int</code>å€¼æ‰§è¡ŒåŠ ã€å‡ã€ä¹˜ã€é™¤è¿ç®—ï¼›åœ¨ä¸Šä¸€é¢˜åˆ›å»ºçš„<code>vector</code>å¯¹è±¡ä¸­ä¿å­˜æŒ‡å‘è¿™äº›å‡½æ•°çš„æŒ‡é’ˆã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> b <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> a <span class="token operator">/</span> b <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>subtract<span class="token punctuation">)</span><span class="token punctuation">;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>multiply<span class="token punctuation">)</span><span class="token punctuation">;</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>divide<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 6-56"><a href="#ç»ƒä¹ 6-56" class="headerlink" title="ç»ƒä¹ 6.56"></a>ç»ƒä¹ 6.56</h2><p>è°ƒç”¨ä¸Šè¿°<code>vector</code>å¯¹è±¡ä¸­çš„æ¯ä¸ªå…ƒç´ å¹¶è¾“å‡ºç»“æœã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> add<span class="token punctuation">,</span> subtract<span class="token punctuation">,</span> multiply<span class="token punctuation">,</span> divide <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> f <span class="token operator">:</span> vec<span class="token punctuation">)</span>          std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ10</title>
      <link href="2021/04/10/excersize/ch10/"/>
      <url>2021/04/10/excersize/ch10/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åç« -æ³›å‹ç®—æ³•"><a href="#ç¬¬åç« -æ³›å‹ç®—æ³•" class="headerlink" title="ç¬¬åç«  æ³›å‹ç®—æ³•"></a>ç¬¬åç«  æ³›å‹ç®—æ³•</h1><h2 id="ç»ƒä¹ 10-1"><a href="#ç»ƒä¹ 10-1" class="headerlink" title="ç»ƒä¹ 10.1"></a>ç»ƒä¹ 10.1</h2><blockquote><p>å¤´æ–‡ä»¶<code>algorithm</code>ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>count</code>çš„å‡½æ•°ï¼Œå®ƒç±»ä¼¼<code>find</code>ï¼Œ æ¥å—ä¸€å¯¹è¿­ä»£å™¨å’Œä¸€ä¸ªå€¼ä½œä¸ºå‚æ•°ã€‚<code>count</code>è¿”å›ç»™å®šå€¼åœ¨åºåˆ—ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚ç¼–å†™ç¨‹åºï¼Œè¯»å–<code>int</code>åºåˆ—å­˜å…¥<code>vector</code>ä¸­ï¼Œæ‰“å°æœ‰å¤šå°‘ä¸ªå…ƒç´ çš„å€¼ç­‰äºç»™å®šå€¼ã€‚</p></blockquote><p>è§£ï¼š</p><p>è§ä¸‹é¢˜</p><h2 id="ç»ƒä¹ 10-2"><a href="#ç»ƒä¹ 10-2" class="headerlink" title="ç»ƒä¹ 10.2"></a>ç»ƒä¹ 10.2</h2><blockquote><p>é‡åšä¸Šä¸€é¢˜ï¼Œä½†è¯»å– <code>string</code> åºåˆ—å­˜å…¥ <code>list</code> ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// 10.1</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex 10.01: "</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">count</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">// 10.2</span>    std<span class="token operator">::</span>list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> l <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"aaa"</span><span class="token punctuation">,</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"cc"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex 10.02: "</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">count</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"aa"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-3"><a href="#ç»ƒä¹ 10-3" class="headerlink" title="ç»ƒä¹ 10.3"></a>ç»ƒä¹ 10.3</h2><blockquote><p>ç”¨ <code>accumulate</code>æ±‚ä¸€ä¸ª <code>vector&lt;int&gt;</code> ä¸­å…ƒç´ ä¹‹å’Œã€‚</p></blockquote><p>è§£ï¼š</p><p>è§ä¸‹é¢˜ã€‚</p><h2 id="ç»ƒä¹ 10-4"><a href="#ç»ƒä¹ 10-4" class="headerlink" title="ç»ƒä¹ 10.4"></a>ç»ƒä¹ 10.4</h2><blockquote><p>å‡å®š <code>v</code> æ˜¯ä¸€ä¸ª<code>vector&lt;double&gt;</code>ï¼Œé‚£ä¹ˆè°ƒç”¨ <code>accumulate(v.cbegin(),v.cend(),0)</code> æœ‰ä½•é”™è¯¯ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;numeric></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// Exercise 10.3</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex 10.03: "</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">accumulate</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">// Exercise 10.4</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> vd <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">3.3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout   <span class="token operator">&lt;&lt;</span> <span class="token string">"ex 10.04: "</span>                <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">accumulate</span><span class="token punctuation">(</span>vd<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vd<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>                <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                        <span class="token comment">//   ^&lt;-- note here.</span>    <span class="token comment">// @attention</span>    <span class="token comment">//</span>    <span class="token comment">// The ouput is 4 rather than 4.9 as expected.</span>    <span class="token comment">// The reason is std::accumulate is a template function. The third parameter is _Tp __init</span>    <span class="token comment">// When "0" , an integer, had been specified here, the compiler deduced _Tp as</span>    <span class="token comment">// interger.As a result , when the following statments were being excuted :</span>    <span class="token comment">//  for (; __first != __last; ++__first)</span>    <span class="token comment">//__init = __init + *__first;</span>    <span class="token comment">//  return __init;</span>    <span class="token comment">// all calculation would be converted to integer.</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¼šæ˜¯ <code>int</code> ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 10-5"><a href="#ç»ƒä¹ 10-5" class="headerlink" title="ç»ƒä¹ 10.5"></a>ç»ƒä¹ 10.5</h2><blockquote><p>åœ¨æœ¬èŠ‚å¯¹åå†Œï¼ˆ<code>roster</code>ï¼‰è°ƒç”¨<code>equal</code>çš„ä¾‹å­ä¸­ï¼Œå¦‚æœä¸¤ä¸ªåå†Œä¸­ä¿å­˜çš„éƒ½æ˜¯Cé£æ ¼å­—ç¬¦ä¸²è€Œä¸æ˜¯<code>string</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>Cé£æ ¼å­—ç¬¦ä¸²æ˜¯ç”¨æŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆè¡¨ç¤ºçš„ï¼Œå› æ­¤ä¼šæ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆçš„å€¼ï¼ˆåœ°å€ï¼‰ï¼Œè€Œä¸ä¼šæ¯”è¾ƒè¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å†…å®¹ã€‚</p><h2 id="ç»ƒä¹ 10-6"><a href="#ç»ƒä¹ 10-6" class="headerlink" title="ç»ƒä¹ 10.6"></a>ç»ƒä¹ 10.6</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä½¿ç”¨ <code>fill_n</code> å°†ä¸€ä¸ªåºåˆ—ä¸­çš„ <code>int</code> å€¼éƒ½è®¾ç½®ä¸º0ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>fill_n<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">fill_n</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> vec<span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-7"><a href="#ç»ƒä¹ 10-7" class="headerlink" title="ç»ƒä¹ 10.7"></a>ç»ƒä¹ 10.7</h2><blockquote><p>ä¸‹é¢ç¨‹åºæ˜¯å¦æœ‰é”™è¯¯ï¼Ÿå¦‚æœæœ‰ï¼Œè¯·æ”¹æ­£ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">;</span> list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lst<span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span>lst<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>lst<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lst<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fill_n</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) åº”è¯¥åŠ ä¸€æ¡è¯­å¥ <code>vec.resize(lst.size())</code> ã€‚<code>copy</code>æ—¶å¿…é¡»ä¿è¯ç›®æ ‡ç›®çš„åºåˆ—è‡³å°‘è¦åŒ…å«ä¸è¾“å…¥åºåˆ—ä¸€æ ·å¤šçš„å…ƒç´ ã€‚</li><li>(b) reserveåˆ†é…äº†è¶³å¤Ÿçš„ç©ºé—´ï¼Œä½†æ˜¯ä¸ä¼šåˆ›å»ºæ–°å…ƒç´ ã€‚ç®—æ³•å¯èƒ½æ”¹å˜å®¹å™¨ä¸­ä¿å­˜çš„å…ƒç´ çš„å€¼ï¼Œä¹Ÿå¯èƒ½åœ¨å®¹å™¨å†…ç§»åŠ¨å…ƒç´ ï¼Œæ°¸è¿œä¸ä¼šç›´æ¥æ·»åŠ å’Œåˆ é™¤å…ƒç´ (c++ priemrä¸­æ–‡ç‰ˆç¬¬äº”ç‰ˆ P338)ï¼Œæ‰€ä»¥æ­¤å¤„åº”è¯¥æ”¹ä¸ºresize(10)ã€‚</li></ul><h2 id="ç»ƒä¹ 10-8"><a href="#ç»ƒä¹ 10-8" class="headerlink" title="ç»ƒä¹ 10.8"></a>ç»ƒä¹ 10.8</h2><blockquote><p>æœ¬èŠ‚æåˆ°è¿‡ï¼Œæ ‡å‡†åº“ç®—æ³•ä¸ä¼šæ”¹å˜å®ƒä»¬æ‰€æ“ä½œçš„å®¹å™¨çš„å¤§å°ã€‚ä¸ºä»€ä¹ˆä½¿ç”¨ <code>back_inserter</code>ä¸ä¼šä½¿è¿™ä¸€æ–­è¨€å¤±æ•ˆï¼Ÿ</p></blockquote><p><code>back_inserter</code> æ˜¯æ’å…¥è¿­ä»£å™¨ï¼Œåœ¨ <code>iterator.h</code> å¤´æ–‡ä»¶ä¸­ï¼Œä¸æ˜¯æ ‡å‡†åº“çš„ç®—æ³•ã€‚</p><h2 id="ç»ƒä¹ 10-9"><a href="#ç»ƒä¹ 10-9" class="headerlink" title="ç»ƒä¹ 10.9"></a>ç»ƒä¹ 10.9</h2><blockquote><p>å®ç°ä½ è‡ªå·±çš„<code>elimDups</code>ã€‚åˆ†åˆ«åœ¨è¯»å–è¾“å…¥åã€è°ƒç”¨<code>unique</code>åä»¥åŠè°ƒç”¨<code>erase</code>åæ‰“å°<code>vector</code>çš„å†…å®¹ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token comment">// print containers like vector, deque, list, etc.</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Sequence</span><span class="token operator">></span><span class="token keyword">auto</span> <span class="token function">println</span><span class="token punctuation">(</span>Sequence <span class="token keyword">const</span><span class="token operator">&amp;</span> seq<span class="token punctuation">)</span> <span class="token operator">-></span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> elem <span class="token operator">:</span> seq<span class="token punctuation">)</span>         std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> elem <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">auto</span> <span class="token function">eliminate_duplicates</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">)</span> <span class="token operator">-></span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token operator">&amp;</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">println</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> new_end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">unique</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">println</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>    vs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>new_end<span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> vs<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> vs<span class="token punctuation">&#123;</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"a"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">println</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">println</span><span class="token punctuation">(</span><span class="token function">eliminate_duplicates</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-10"><a href="#ç»ƒä¹ 10-10" class="headerlink" title="ç»ƒä¹ 10.10"></a>ç»ƒä¹ 10.10</h2><blockquote><p>ä½ è®¤ä¸ºç®—æ³•ä¸æ”¹å˜å®¹å™¨å¤§å°çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li>å°†ç®—æ³•å’Œå®¹å™¨çš„æˆå‘˜å‡½æ•°åŒºåˆ†å¼€ã€‚</li><li>ç®—æ³•çš„å‚æ•°æ˜¯è¿­ä»£å™¨ï¼Œä¸æ˜¯å®¹å™¨æœ¬èº«ã€‚</li></ul><h2 id="ç»ƒä¹ 10-11"><a href="#ç»ƒä¹ 10-11" class="headerlink" title="ç»ƒä¹ 10.11"></a>ç»ƒä¹ 10.11</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä½¿ç”¨ <code>stable_sort</code> å’Œ <code>isShorter</code> å°†ä¼ é€’ç»™ä½ çš„ <code>elimDups</code> ç‰ˆæœ¬çš„ <code>vector</code> æ’åºã€‚æ‰“å° <code>vector</code>çš„å†…å®¹ï¼ŒéªŒè¯ä½ çš„ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;numeric></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token comment">// print a container like vector, deque, list, etc.</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Sequence</span><span class="token operator">></span><span class="token keyword">inline</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">println</span><span class="token punctuation">(</span>Sequence <span class="token keyword">const</span><span class="token operator">&amp;</span> seq<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> elem <span class="token operator">:</span> seq<span class="token punctuation">)</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> elem <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> <span class="token keyword">bool</span><span class="token function">is_shorter</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span>  lhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">elimdups</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> new_end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">unique</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>new_end<span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v<span class="token punctuation">&#123;</span>        <span class="token string">"1234"</span><span class="token punctuation">,</span> <span class="token string">"1234"</span><span class="token punctuation">,</span> <span class="token string">"1234"</span><span class="token punctuation">,</span> <span class="token string">"Hi"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"wang"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">elimdups</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span><span class="token function">stable_sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> is_shorter<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.11 :\n"</span><span class="token punctuation">;</span>    <span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-12"><a href="#ç»ƒä¹ 10-12" class="headerlink" title="ç»ƒä¹ 10.12"></a>ç»ƒä¹ 10.12</h2><blockquote><p>ç¼–å†™åä¸º <code>compareIsbn</code> çš„å‡½æ•°ï¼Œæ¯”è¾ƒä¸¤ä¸ª <code>Sales_data</code> å¯¹è±¡çš„<code>isbn()</code> æˆå‘˜ã€‚ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ’åºä¸€ä¸ªä¿å­˜ <code>Sales_data</code> å¯¹è±¡çš„ <code>vector</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../ch07/ex7_26.h"</span>     <span class="token comment">// Sales_data class.</span></span><span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">compareIsbn</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>sd1<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>sd2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> sd1<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> sd2<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data <span class="token function">d1</span><span class="token punctuation">(</span><span class="token string">"aa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d2</span><span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d3</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d4</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d5</span><span class="token punctuation">(</span><span class="token string">"aaaaz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> v<span class="token punctuation">&#123;</span> d1<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> d3<span class="token punctuation">,</span> d4<span class="token punctuation">,</span> d5 <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">// @note   the elements the iterators pointing to</span>    <span class="token comment">//         must match the parameters of the predicate.</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>element <span class="token operator">:</span> v<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> element<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-13"><a href="#ç»ƒä¹ 10-13" class="headerlink" title="ç»ƒä¹ 10.13"></a>ç»ƒä¹ 10.13</h2><blockquote><p>æ ‡å‡†åº“å®šä¹‰äº†åä¸º <code>partition</code> çš„ç®—æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªè°“è¯ï¼Œå¯¹å®¹å™¨å†…å®¹è¿›è¡Œåˆ’åˆ†ï¼Œä½¿å¾—è°“è¯ä¸º<code>true</code> çš„å€¼ä¼šæ’åœ¨å®¹å™¨çš„å‰åŠéƒ¨åˆ†ï¼Œè€Œä½¿å¾—è°“è¯ä¸º <code>false</code> çš„å€¼ä¼šæ’åœ¨ååŠéƒ¨åˆ†ã€‚ç®—æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘æœ€åä¸€ä¸ªä½¿è°“è¯ä¸º <code>true</code> çš„å…ƒç´ ä¹‹åçš„ä½ç½®ã€‚ç¼–å†™å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª <code>string</code>ï¼Œè¿”å›ä¸€ä¸ª <code>bool</code> å€¼ï¼ŒæŒ‡å‡º <code>string</code> æ˜¯å¦æœ‰5ä¸ªæˆ–æ›´å¤šå­—ç¬¦ã€‚ä½¿ç”¨æ­¤å‡½æ•°åˆ’åˆ† <code>words</code>ã€‚æ‰“å°å‡ºé•¿åº¦å¤§äºç­‰äº5çš„å…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">bool</span> <span class="token function">predicate</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> v <span class="token operator">=</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">&#123;</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"as"</span><span class="token punctuation">,</span> <span class="token string">"aasss"</span><span class="token punctuation">,</span> <span class="token string">"aaaaassaa"</span><span class="token punctuation">,</span> <span class="token string">"aaaaaabba"</span><span class="token punctuation">,</span> <span class="token string">"aaa"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> pivot <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">partition</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> predicate<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> pivot<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-14"><a href="#ç»ƒä¹ 10-14" class="headerlink" title="ç»ƒä¹ 10.14"></a>ç»ƒä¹ 10.14</h2><blockquote><p>ç¼–å†™ä¸€ä¸ª<code>lambda</code>ï¼Œæ¥å—ä¸¤ä¸ª<code>int</code>ï¼Œè¿”å›å®ƒä»¬çš„å’Œã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-15"><a href="#ç»ƒä¹ 10-15" class="headerlink" title="ç»ƒä¹ 10.15"></a>ç»ƒä¹ 10.15</h2><blockquote><p>ç¼–å†™ä¸€ä¸ª <code>lambda</code> ï¼Œæ•è·å®ƒæ‰€åœ¨å‡½æ•°çš„ <code>int</code>ï¼Œå¹¶æ¥å—ä¸€ä¸ª <code>int</code>å‚æ•°ã€‚<code>lambda</code> åº”è¯¥è¿”å›æ•è·çš„ <code>int</code> å’Œ <code>int</code> å‚æ•°çš„å’Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> i <span class="token operator">+</span> x<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-16"><a href="#ç»ƒä¹ 10-16" class="headerlink" title="ç»ƒä¹ 10.16"></a>ç»ƒä¹ 10.16</h2><blockquote><p>ä½¿ç”¨ <code>lambda</code> ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>biggies</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token comment">// from ex 10.9</span><span class="token keyword">void</span> <span class="token function">elimdups</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> new_end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">unique</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>new_end<span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">biggies</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span>    <span class="token function">elimdups</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// sort by size, but maintain alphabetical order for same size.</span>    std<span class="token operator">::</span><span class="token function">stable_sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> lhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// get an iterator to the first one whose size() is >= sz</span>    <span class="token keyword">auto</span> wc <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">find_if</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>sz<span class="token punctuation">]</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> sz<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// print the biggies</span>    std<span class="token operator">::</span><span class="token function">for_each</span><span class="token punctuation">(</span>wc<span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ex10.16</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v    <span class="token punctuation">&#123;</span>        <span class="token string">"1234"</span><span class="token punctuation">,</span><span class="token string">"1234"</span><span class="token punctuation">,</span><span class="token string">"1234"</span><span class="token punctuation">,</span><span class="token string">"hi~"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"cp"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.16: "</span><span class="token punctuation">;</span>    <span class="token function">biggies</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-17"><a href="#ç»ƒä¹ 10-17" class="headerlink" title="ç»ƒä¹ 10.17"></a>ç»ƒä¹ 10.17</h2><blockquote><p>é‡å†™10.3.1èŠ‚ç»ƒä¹ 10.12çš„ç¨‹åºï¼Œåœ¨å¯¹<code>sort</code>çš„è°ƒç”¨ä¸­ä½¿ç”¨ <code>lambda</code> æ¥ä»£æ›¿å‡½æ•° <code>compareIsbn</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../ch07/ex7_26.h"</span>     <span class="token comment">// Sales_data class.</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data <span class="token function">d1</span><span class="token punctuation">(</span><span class="token string">"aa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d2</span><span class="token punctuation">(</span><span class="token string">"aaaa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d3</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d4</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d5</span><span class="token punctuation">(</span><span class="token string">"aaaaz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> v<span class="token punctuation">&#123;</span> d1<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> d3<span class="token punctuation">,</span> d4<span class="token punctuation">,</span> d5 <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>sd1<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>sd2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> sd1<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> sd2<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>element <span class="token operator">:</span> v<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> element<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-18"><a href="#ç»ƒä¹ 10-18" class="headerlink" title="ç»ƒä¹ 10.18"></a>ç»ƒä¹ 10.18</h2><blockquote><p>é‡å†™ <code>biggies</code>ï¼Œç”¨ <code>partition</code> ä»£æ›¿ <code>find_if</code>ã€‚æˆ‘ä»¬åœ¨10.3.1èŠ‚ç»ƒä¹ 10.13ä¸­ä»‹ç»äº† <code>partition</code> ç®—æ³•ã€‚</p></blockquote><p>è§£ï¼š</p><p>è§ä¸‹é¢˜</p><h2 id="ç»ƒä¹ 10-19"><a href="#ç»ƒä¹ 10-19" class="headerlink" title="ç»ƒä¹ 10.19"></a>ç»ƒä¹ 10.19</h2><blockquote><p>ç”¨ <code>stable_partition</code> é‡å†™å‰ä¸€é¢˜çš„ç¨‹åºï¼Œä¸ <code>stable_sort</code> ç±»ä¼¼ï¼Œåœ¨åˆ’åˆ†åçš„åºåˆ—ä¸­ç»´æŒåŸæœ‰å…ƒç´ çš„é¡ºåºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token comment">// from ex 10.9</span><span class="token keyword">void</span> <span class="token function">elimdups</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> new_end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">unique</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>new_end<span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ex10.18</span><span class="token keyword">void</span> <span class="token function">biggies_partition</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">elimdups</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> pivot <span class="token operator">=</span> <span class="token function">partition</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>sz<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> sz<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> vs<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> pivot<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ex10.19</span><span class="token keyword">void</span> <span class="token function">biggies_stable_partition</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">elimdups</span><span class="token punctuation">(</span>vs<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> pivot <span class="token operator">=</span> <span class="token function">stable_partition</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>sz<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> sz<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> vs<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> pivot<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ex10.18</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v<span class="token punctuation">&#123;</span>        <span class="token string">"the"</span><span class="token punctuation">,</span> <span class="token string">"quick"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"fox"</span><span class="token punctuation">,</span> <span class="token string">"jumps"</span><span class="token punctuation">,</span> <span class="token string">"over"</span><span class="token punctuation">,</span> <span class="token string">"the"</span><span class="token punctuation">,</span> <span class="token string">"slow"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"turtle"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.18: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token function">v1</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">biggies_partition</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">// ex10.19</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.19: "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> <span class="token function">v2</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">biggies_stable_partition</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-20"><a href="#ç»ƒä¹ 10-20" class="headerlink" title="ç»ƒä¹ 10.20"></a>ç»ƒä¹ 10.20</h2><blockquote><p>æ ‡å‡†åº“å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>count_if</code> çš„ç®—æ³•ã€‚ç±»ä¼¼ <code>find_if</code>ï¼Œæ­¤å‡½æ•°æ¥å—ä¸€å¯¹è¿­ä»£å™¨ï¼Œè¡¨ç¤ºä¸€ä¸ªè¾“å…¥èŒƒå›´ï¼Œè¿˜æ¥å—ä¸€ä¸ªè°“è¯ï¼Œä¼šå¯¹è¾“å…¥èŒƒå›´ä¸­æ¯ä¸ªå…ƒç´ æ‰§è¡Œã€‚<code>count_if</code>è¿”å›ä¸€ä¸ªè®¡æ•°å€¼ï¼Œè¡¨ç¤ºè°“è¯æœ‰å¤šå°‘æ¬¡ä¸ºçœŸã€‚ä½¿ç”¨<code>count_if</code>é‡å†™æˆ‘ä»¬ç¨‹åºä¸­ç»Ÿè®¡æœ‰å¤šå°‘å•è¯é•¿åº¦è¶…è¿‡6çš„éƒ¨åˆ†ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>count_if<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token comment">// Exercise 10.20</span>std<span class="token operator">::</span>size_t <span class="token function">bigerThan6</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">count_if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">6</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ex10.20</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> v<span class="token punctuation">&#123;</span>        <span class="token string">"alan"</span><span class="token punctuation">,</span><span class="token string">"moophy"</span><span class="token punctuation">,</span><span class="token string">"1234567"</span><span class="token punctuation">,</span><span class="token string">"1234567"</span><span class="token punctuation">,</span><span class="token string">"1234567"</span><span class="token punctuation">,</span><span class="token string">"1234567"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.20: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">bigerThan6</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">// ex10.21</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> check_and_decrement <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">!</span><span class="token operator">--</span>i <span class="token operator">:</span> <span class="token operator">!</span>i<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"ex10.21: "</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check_and_decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-21"><a href="#ç»ƒä¹ 10-21" class="headerlink" title="ç»ƒä¹ 10.21"></a>ç»ƒä¹ 10.21</h2><blockquote><p>ç¼–å†™ä¸€ä¸ª <code>lambda</code>ï¼Œæ•è·ä¸€ä¸ªå±€éƒ¨ <code>int</code> å˜é‡ï¼Œå¹¶é€’å‡å˜é‡å€¼ï¼Œç›´è‡³å®ƒå˜ä¸º0ã€‚ä¸€æ—¦å˜é‡å˜ä¸º0ï¼Œå†è°ƒç”¨<code>lambda</code>åº”è¯¥ä¸å†é€’å‡å˜é‡ã€‚<code>lambda</code>åº”è¯¥è¿”å›ä¸€ä¸ª<code>bool</code>å€¼ï¼ŒæŒ‡å‡ºæ•è·çš„å˜é‡æ˜¯å¦ä¸º0ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">bool</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token operator">!</span><span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-22"><a href="#ç»ƒä¹ 10-22" class="headerlink" title="ç»ƒä¹ 10.22"></a>ç»ƒä¹ 10.22</h2><blockquote><p>é‡å†™ç»Ÿè®¡é•¿åº¦å°äºç­‰äº6çš„å•è¯æ•°é‡çš„ç¨‹åºï¼Œä½¿ç”¨å‡½æ•°ä»£æ›¿<code>lambda</code>ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token operator">::</span>placeholders<span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">isLesserThanOrEqualTo6</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> string<span class="token operator">::</span>size_type sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> sz<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> authors<span class="token punctuation">&#123;</span> <span class="token string">"Mooophy"</span><span class="token punctuation">,</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"Queequeg90"</span><span class="token punctuation">,</span> <span class="token string">"shbling"</span><span class="token punctuation">,</span> <span class="token string">"evan617"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">count_if</span><span class="token punctuation">(</span>authors<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> authors<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">bind</span><span class="token punctuation">(</span>isLesserThanOrEqualTo6<span class="token punctuation">,</span> _1<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-23"><a href="#ç»ƒä¹ 10-23" class="headerlink" title="ç»ƒä¹ 10.23"></a>ç»ƒä¹ 10.23</h2><blockquote><p><code>bind</code> æ¥å—å‡ ä¸ªå‚æ•°ï¼Ÿ</p></blockquote><p>å‡è®¾è¢«ç»‘å®šçš„å‡½æ•°æ¥å— <code>n</code> ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆ<code>bind</code> æ¥å—<code>n + 1</code>ä¸ªå‚æ•°ã€‚</p><h2 id="ç»ƒä¹ 10-24"><a href="#ç»ƒä¹ 10-24" class="headerlink" title="ç»ƒä¹ 10.24"></a>ç»ƒä¹ 10.24</h2><blockquote><p>ç»™å®šä¸€ä¸ª<code>string</code>ï¼Œä½¿ç”¨ <code>bind</code> å’Œ <code>check_size</code> åœ¨ä¸€ä¸ª <code>int</code> çš„<code>vector</code> ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äº<code>string</code>é•¿åº¦çš„å€¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>find_if<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>bind<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>size_t<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">check_size</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> str<span class="token punctuation">,</span> size_t sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> sz<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    string <span class="token function">str</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> result <span class="token operator">=</span> <span class="token function">find_if</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">bind</span><span class="token punctuation">(</span>check_size<span class="token punctuation">,</span> str<span class="token punctuation">,</span> std<span class="token operator">::</span>placeholders<span class="token operator">::</span>_1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>result <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">else</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Not found"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-25"><a href="#ç»ƒä¹ 10-25" class="headerlink" title="ç»ƒä¹ 10.25"></a>ç»ƒä¹ 10.25</h2><blockquote><p>åœ¨10.3.2èŠ‚çš„ç»ƒä¹ ä¸­ï¼Œç¼–å†™äº†ä¸€ä¸ªä½¿ç”¨<code>partition</code> çš„<code>biggies</code>ç‰ˆæœ¬ã€‚ä½¿ç”¨ <code>check_size</code> å’Œ <code>bind</code> é‡å†™æ­¤å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token operator">::</span>placeholders<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">elimdups</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>vs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">unique</span><span class="token punctuation">(</span>vs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">check_size</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> string<span class="token operator">::</span>size_type sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> sz<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">biggies</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>words<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>size_type sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">elimdups</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> iter <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">stable_partition</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">bind</span><span class="token punctuation">(</span>check_size<span class="token punctuation">,</span> _1<span class="token punctuation">,</span> sz<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">for_each</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> iter<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> v<span class="token punctuation">&#123;</span>        <span class="token string">"the"</span><span class="token punctuation">,</span> <span class="token string">"quick"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"fox"</span><span class="token punctuation">,</span> <span class="token string">"jumps"</span><span class="token punctuation">,</span> <span class="token string">"over"</span><span class="token punctuation">,</span> <span class="token string">"the"</span><span class="token punctuation">,</span> <span class="token string">"slow"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"turtle"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token function">biggies</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-26"><a href="#ç»ƒä¹ 10-26" class="headerlink" title="ç»ƒä¹ 10.26"></a>ç»ƒä¹ 10.26</h2><blockquote><p>è§£é‡Šä¸‰ç§æ’å…¥è¿­ä»£å™¨çš„ä¸åŒä¹‹å¤„ã€‚</p></blockquote><p>è§£ï¼š</p><ul><li><code>back_inserter</code> ä½¿ç”¨ <code>push_back</code> ã€‚</li><li><code>front_inserter</code> ä½¿ç”¨ <code>push_front</code> ã€‚</li><li><code>inserter</code> ä½¿ç”¨ <code>insert</code>ï¼Œæ­¤å‡½æ•°æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæŒ‡å‘ç»™å®šå®¹å™¨çš„è¿­ä»£å™¨ã€‚å…ƒç´ å°†è¢«æ’å…¥åˆ°ç»™å®šè¿­ä»£å™¨æ‰€è¡¨ç¤ºçš„å…ƒç´ ä¹‹å‰ã€‚</li></ul><h2 id="ç»ƒä¹ 10-27"><a href="#ç»ƒä¹ 10-27" class="headerlink" title="ç»ƒä¹ 10.27"></a>ç»ƒä¹ 10.27</h2><blockquote><p>é™¤äº† <code>unique</code> ä¹‹å¤–ï¼Œæ ‡å‡†åº“è¿˜å®šä¹‰äº†åä¸º <code>unique_copy</code> çš„å‡½æ•°ï¼Œå®ƒæ¥å—ç¬¬ä¸‰ä¸ªè¿­ä»£å™¨ï¼Œè¡¨ç¤ºæ‹·è´ä¸é‡å¤å…ƒç´ çš„ç›®çš„ä½ç½®ã€‚ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä½¿ç”¨ <code>unique_copy</code>å°†ä¸€ä¸ª<code>vector</code>ä¸­ä¸é‡å¤çš„å…ƒç´ æ‹·è´åˆ°ä¸€ä¸ªåˆå§‹åŒ–ä¸ºç©ºçš„<code>list</code>ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lst<span class="token punctuation">;</span>        std<span class="token operator">::</span><span class="token function">unique_copy</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> lst<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-28"><a href="#ç»ƒä¹ 10-28" class="headerlink" title="ç»ƒä¹ 10.28"></a>ç»ƒä¹ 10.28</h2><blockquote><p>ä¸€ä¸ª<code>vector</code> ä¸­ä¿å­˜ 1 åˆ° 9ï¼Œå°†å…¶æ‹·è´åˆ°ä¸‰ä¸ªå…¶ä»–å®¹å™¨ä¸­ã€‚åˆ†åˆ«ä½¿ç”¨<code>inserter</code>ã€<code>back_inserter</code> å’Œ <code>front_inserter</code> å°†å…ƒç´ æ·»åŠ åˆ°ä¸‰ä¸ªå®¹å™¨ä¸­ã€‚å¯¹æ¯ç§ <code>inserter</code>ï¼Œä¼°è®¡è¾“å‡ºåºåˆ—æ˜¯æ€æ ·çš„ï¼Œè¿è¡Œç¨‹åºéªŒè¯ä½ çš„ä¼°è®¡æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>list<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>copy<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Sequence</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>Sequence <span class="token keyword">const</span><span class="token operator">&amp;</span> seq<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> seq<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token comment">// uses inserter</span>    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lst1<span class="token punctuation">;</span>    <span class="token function">copy</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">inserter</span><span class="token punctuation">(</span>lst1<span class="token punctuation">,</span> lst1<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>lst1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// uses back_inserter</span>    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lit2<span class="token punctuation">;</span>    <span class="token function">copy</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>lit2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>lit2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// uses front_inserter</span>    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lst3<span class="token punctuation">;</span>    <span class="token function">copy</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">front_inserter</span><span class="token punctuation">(</span>lst3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>lst3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‰ä¸¤ç§ä¸ºæ­£åºï¼Œç¬¬ä¸‰ç§ä¸ºé€†åºï¼Œè¾“å‡ºå’Œé¢„è®¡ä¸€æ ·ã€‚</p><h2 id="ç»ƒä¹ 10-29"><a href="#ç»ƒä¹ 10-29" class="headerlink" title="ç»ƒä¹ 10.29"></a>ç»ƒä¹ 10.29</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä½¿ç”¨æµè¿­ä»£å™¨è¯»å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå­˜å…¥ä¸€ä¸ª<code>vector</code>ä¸­çš„<code>string</code>é‡Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"../data/book.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>istream_iterator<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">in</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">,</span> eof<span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> vec<span class="token punctuation">;</span>    std<span class="token operator">::</span><span class="token function">copy</span><span class="token punctuation">(</span>in<span class="token punctuation">,</span> eof<span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// output</span>    std<span class="token operator">::</span><span class="token function">copy</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ostream_iterator<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-30"><a href="#ç»ƒä¹ 10-30" class="headerlink" title="ç»ƒä¹ 10.30"></a>ç»ƒä¹ 10.30</h2><blockquote><p>ä½¿ç”¨æµè¿­ä»£å™¨ã€<code>sort</code> å’Œ <code>copy</code> ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€ä¸ªæ•´æ•°åºåˆ—ï¼Œå°†å…¶æ’åºï¼Œå¹¶å°†ç»“æœå†™åˆ°æ ‡å‡†è¾“å‡ºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span>istream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">int_it</span><span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">,</span> int_eof<span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>int_it<span class="token punctuation">,</span> int_eof<span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ostream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>cout<span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-31"><a href="#ç»ƒä¹ 10-31" class="headerlink" title="ç»ƒä¹ 10.31"></a>ç»ƒä¹ 10.31</h2><blockquote><p>ä¿®æ”¹å‰ä¸€é¢˜çš„ç¨‹åºï¼Œä½¿å…¶åªæ‰“å°ä¸é‡å¤çš„å…ƒç´ ã€‚ä½ çš„ç¨‹åºåº”è¯¥ä½¿ç”¨ <code>unique_copy</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span>istream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">int_it</span><span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">,</span> int_eof<span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>int_it<span class="token punctuation">,</span> int_eof<span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">unique</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ostream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>cout<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-32"><a href="#ç»ƒä¹ 10-32" class="headerlink" title="ç»ƒä¹ 10.32"></a>ç»ƒä¹ 10.32</h2><blockquote><p>é‡å†™1.6èŠ‚ä¸­çš„ä¹¦åº—ç¨‹åºï¼Œä½¿ç”¨ä¸€ä¸ª<code>vector</code>ä¿å­˜äº¤æ˜“è®°å½•ï¼Œä½¿ç”¨ä¸åŒç®—æ³•å®Œæˆå¤„ç†ã€‚ä½¿ç”¨ <code>sort</code> å’Œ10.3.1èŠ‚ä¸­çš„ <code>compareIsbn</code> å‡½æ•°æ¥æ’åºäº¤æ˜“è®°å½•ï¼Œç„¶åä½¿ç”¨ <code>find</code> å’Œ <code>accumulate</code> æ±‚å’Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;numeric></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../include/Sales_item.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>istream_iterator<span class="token operator">&lt;</span>Sales_item<span class="token operator">></span> <span class="token function">in_iter</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">)</span><span class="token punctuation">,</span> in_eof<span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_item<span class="token operator">></span> vec<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>in_iter <span class="token operator">!=</span> in_eof<span class="token punctuation">)</span>        vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>in_iter<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sort</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> beg <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end <span class="token operator">=</span> beg<span class="token punctuation">;</span> beg <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> beg <span class="token operator">=</span> end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        end <span class="token operator">=</span> <span class="token function">find_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>beg<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_item <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> beg<span class="token operator">-></span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span><span class="token function">accumulate</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> <span class="token function">Sales_item</span><span class="token punctuation">(</span>beg<span class="token operator">-></span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-33"><a href="#ç»ƒä¹ 10-33" class="headerlink" title="ç»ƒä¹ 10.33"></a>ç»ƒä¹ 10.33</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œæ¥å—ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ªè¾“å…¥æ–‡ä»¶å’Œä¸¤ä¸ªè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶åã€‚è¾“å…¥æ–‡ä»¶ä¿å­˜çš„åº”è¯¥æ˜¯æ•´æ•°ã€‚ä½¿ç”¨ <code>istream_iterator</code> è¯»å–è¾“å…¥æ–‡ä»¶ã€‚ä½¿ç”¨ <code>ostream_iterator</code> å°†å¥‡æ•°å†™å…¥ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œæ¯ä¸ªå€¼åé¢éƒ½è·Ÿä¸€ä¸ªç©ºæ ¼ã€‚å°†å¶æ•°å†™å…¥ç¬¬äºŒä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæ¯ä¸ªå€¼éƒ½ç‹¬å ä¸€è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ifstream <span class="token function">ifs</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ofstream <span class="token function">ofs_odd</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ofs_even</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">in</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">,</span> in_eof<span class="token punctuation">;</span>std<span class="token operator">::</span>ostream_iterator<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">out_odd</span><span class="token punctuation">(</span>ofs_odd<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">out_even</span><span class="token punctuation">(</span>ofs_even<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">for_each</span><span class="token punctuation">(</span>in<span class="token punctuation">,</span> in_eof<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>out_odd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>out_even<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0x1</span> <span class="token operator">?</span> out_odd <span class="token operator">:</span> out_even<span class="token punctuation">)</span><span class="token operator">++</span> <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-34"><a href="#ç»ƒä¹ 10-34" class="headerlink" title="ç»ƒä¹ 10.34"></a>ç»ƒä¹ 10.34</h2><blockquote><p>ä½¿ç”¨ <code>reverse_iterator</code> é€†åºæ‰“å°ä¸€ä¸ª<code>vector</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> v<span class="token punctuation">.</span><span class="token function">crend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-35"><a href="#ç»ƒä¹ 10-35" class="headerlink" title="ç»ƒä¹ 10.35"></a>ç»ƒä¹ 10.35</h2><blockquote><p>ä½¿ç”¨æ™®é€šè¿­ä»£å™¨é€†åºæ‰“å°ä¸€ä¸ª<code>vector</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">prev</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token operator">--</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">==</span> v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-36"><a href="#ç»ƒä¹ 10-36" class="headerlink" title="ç»ƒä¹ 10.36"></a>ç»ƒä¹ 10.36</h2><blockquote><p>ä½¿ç”¨ <code>find</code> åœ¨ä¸€ä¸ª <code>int</code> çš„<code>list</code> ä¸­æŸ¥æ‰¾æœ€åä¸€ä¸ªå€¼ä¸º0çš„å…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> l <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">auto</span> it <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span><span class="token function">crend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">distance</span><span class="token punctuation">(</span>it<span class="token punctuation">,</span> l<span class="token punctuation">.</span><span class="token function">crend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-37"><a href="#ç»ƒä¹ 10-37" class="headerlink" title="ç»ƒä¹ 10.37"></a>ç»ƒä¹ 10.37</h2><blockquote><p>ç»™å®šä¸€ä¸ªåŒ…å«10 ä¸ªå…ƒç´ çš„<code>vector</code>ï¼Œå°†ä½ç½®3åˆ°7ä¹‹é—´çš„å…ƒç´ æŒ‰é€†åºæ‹·è´åˆ°ä¸€ä¸ª<code>list</code>ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iterator></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> l<span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> l<span class="token punctuation">)</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 10-38"><a href="#ç»ƒä¹ 10-38" class="headerlink" title="ç»ƒä¹ 10.38"></a>ç»ƒä¹ 10.38</h2><blockquote><p>åˆ—å‡º5ä¸ªè¿­ä»£å™¨ç±»åˆ«ï¼Œä»¥åŠæ¯ç±»è¿­ä»£å™¨æ‰€æ”¯æŒçš„æ“ä½œã€‚</p></blockquote><ul><li>è¾“å…¥è¿­ä»£å™¨ : <code>==</code>,<code>!=</code>,<code>++</code>,<code>*</code>,<code>-&gt;</code></li><li>è¾“å‡ºè¿­ä»£å™¨ : <code>++</code>,<code>*</code></li><li>å‰å‘è¿­ä»£å™¨ : <code>==</code>,<code>!=</code>,<code>++</code>,<code>*</code>,<code>-&gt;</code></li><li>åŒå‘è¿­ä»£å™¨ : <code>==</code>,<code>!=</code>,<code>++</code>,<code>--</code>,<code>*</code>,<code>-&gt;</code></li><li>éšæœºè®¿é—®è¿­ä»£å™¨ : <code>==</code>,<code>!=</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;</code>,<code>&gt;=</code>,<code>++</code>,<code>--</code>,<code>+</code>,<code>+=</code>,<code>-</code>,<code>-=</code>,<code>*</code>,<code>-&gt;</code>,<code>iter[n]</code>==<code>*(iter[n])</code></li></ul><h2 id="ç»ƒä¹ 10-39"><a href="#ç»ƒä¹ 10-39" class="headerlink" title="ç»ƒä¹ 10.39"></a>ç»ƒä¹ 10.39</h2><blockquote><p><code>list</code> ä¸Šçš„è¿­ä»£å™¨å±äºå“ªç±»ï¼Ÿ<code>vector</code>å‘¢ï¼Ÿ</p></blockquote><ul><li><code>list</code> ä¸Šçš„è¿­ä»£å™¨æ˜¯ <strong>åŒå‘è¿­ä»£å™¨</strong></li><li><code>vector</code> ä¸Šçš„è¿­ä»£å™¨æ˜¯ <strong>éšæœºè®¿é—®è¿­ä»£å™¨</strong></li></ul><h2 id="ç»ƒä¹ 10-40"><a href="#ç»ƒä¹ 10-40" class="headerlink" title="ç»ƒä¹ 10.40"></a>ç»ƒä¹ 10.40</h2><blockquote><p>ä½ è®¤ä¸º <code>copy</code> è¦æ±‚å“ªç±»è¿­ä»£å™¨ï¼Ÿ<code>reverse</code> å’Œ <code>unique</code> å‘¢ï¼Ÿ</p></blockquote><ul><li><code>copy</code> éœ€è¦ä¸¤ä¸ª<strong>è¾“å…¥è¿­ä»£å™¨</strong>ï¼Œä¸€ä¸ª<strong>è¾“å‡ºè¿­ä»£å™¨</strong></li><li><code>reverse</code> éœ€è¦<strong>åŒå‘è¿­ä»£å™¨</strong></li><li><code>unique</code>éœ€è¦<strong>éšæœºè®¿é—®è¿­ä»£å™¨</strong></li></ul><h2 id="ç»ƒä¹ 10-41"><a href="#ç»ƒä¹ 10-41" class="headerlink" title="ç»ƒä¹ 10.41"></a>ç»ƒä¹ 10.41</h2><blockquote><p>ä»…æ ¹æ®ç®—æ³•å’Œå‚æ•°çš„åå­—ï¼Œæè¿°ä¸‹é¢æ¯ä¸ªæ ‡å‡†åº“ç®—æ³•æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">replace</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> old_val<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">replace_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> pred<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">replace_copy</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> old_val<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">replace_copy_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> pred<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li><code>replace</code> åœ¨è¿­ä»£å™¨èŒƒå›´å†…ç”¨æ–°å€¼æ›¿æ¢æ‰€æœ‰åŸæ¥çš„æ—§å€¼ã€‚</li><li><code>replace_if</code> åœ¨è¿­ä»£å™¨èŒƒå›´å†…ï¼Œæ»¡è¶³è°“è¯æ¡ä»¶çš„å…ƒç´ ç”¨æ–°å€¼æ›¿æ¢ã€‚</li><li><code>replace_copy</code> å¤åˆ¶è¿­ä»£å™¨èŒƒå›´å†…çš„å…ƒç´ åˆ°ç›®æ ‡è¿­ä»£å™¨ä½ç½®ï¼Œå¦‚æœå…ƒç´ ç­‰äºæŸä¸ªæ—§å€¼ï¼Œåˆ™ç”¨æ–°å€¼æ›¿æ¢</li><li><code>replace_copy_if</code> å¤åˆ¶è¿­ä»£å™¨èŒƒå›´å†…çš„å…ƒç´ åˆ°ç›®æ ‡è¿­ä»£å™¨ä½ç½®ï¼Œæ»¡è¶³è°“è¯æ¡ä»¶çš„å…ƒç´ ç”¨æ–°å€¼æ›¿æ¢</li></ul><h2 id="ç»ƒä¹ 10-42"><a href="#ç»ƒä¹ 10-42" class="headerlink" title="ç»ƒä¹ 10.42"></a>ç»ƒä¹ 10.42</h2><blockquote><p>ä½¿ç”¨ <code>list</code> ä»£æ›¿ <code>vector</code> é‡æ–°å®ç°10.2.3èŠ‚ä¸­çš„å»é™¤é‡å¤å•è¯çš„ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>list<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">elimDups</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>words<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>words<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>words<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>list<span class="token operator">&lt;</span>string<span class="token operator">></span> l <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"aasss"</span><span class="token punctuation">,</span> <span class="token string">"aa"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">elimDups</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> l<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> e <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ11</title>
      <link href="2021/04/10/excersize/ch11/"/>
      <url>2021/04/10/excersize/ch11/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸€ç« -å…³è”å®¹å™¨"><a href="#ç¬¬åä¸€ç« -å…³è”å®¹å™¨" class="headerlink" title="ç¬¬åä¸€ç«  å…³è”å®¹å™¨"></a>ç¬¬åä¸€ç«  å…³è”å®¹å™¨</h1><h2 id="ç»ƒä¹ 11-1"><a href="#ç»ƒä¹ 11-1" class="headerlink" title="ç»ƒä¹ 11.1"></a>ç»ƒä¹ 11.1</h2><blockquote><p>æè¿°<code>map</code>å’Œ<code>vector</code>çš„ä¸åŒã€‚</p></blockquote><p>è§£ï¼š</p><p><code>map</code> æ˜¯å…³è”å®¹å™¨ï¼Œ <code>vector</code> æ˜¯é¡ºåºå®¹å™¨ã€‚</p><h2 id="ç»ƒä¹ 11-2"><a href="#ç»ƒä¹ 11-2" class="headerlink" title="ç»ƒä¹ 11.2"></a>ç»ƒä¹ 11.2</h2><blockquote><p>åˆ†åˆ«ç»™å‡ºæœ€é€‚åˆä½¿ç”¨<code>list</code>ã€<code>vector</code>ã€<code>deque</code>ã€<code>map</code>ä»¥åŠ<code>set</code>çš„ä¾‹å­ã€‚</p></blockquote><p>è§£ï¼š</p><ul><li><code>list</code>ï¼šåŒå‘é“¾è¡¨ï¼Œé€‚åˆé¢‘ç¹æ’å…¥åˆ é™¤å…ƒç´ çš„åœºæ™¯ã€‚</li><li><code>vector</code>ï¼šé€‚åˆé¢‘ç¹è®¿é—®å…ƒç´ çš„åœºæ™¯ã€‚</li><li><code>deque</code>ï¼šåŒç«¯é˜Ÿåˆ—ï¼Œé€‚åˆé¢‘ç¹åœ¨å¤´å°¾æ’å…¥åˆ é™¤å…ƒç´ çš„åœºæ™¯ã€‚</li><li><code>map</code>ï¼šå­—å…¸ã€‚</li><li><code>set</code>ï¼šé€‚åˆæœ‰åºä¸é‡å¤çš„å…ƒç´ çš„åœºæ™¯ã€‚</li></ul><h2 id="ç»ƒä¹ 11-3"><a href="#ç»ƒä¹ 11-3" class="headerlink" title="ç»ƒä¹ 11.3"></a>ç»ƒä¹ 11.3</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±çš„å•è¯è®¡æ•°ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> word_count<span class="token punctuation">;</span>    string tmp<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> tmp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        word_count<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> elem <span class="token operator">:</span> word_count<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> elem<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" : "</span> <span class="token operator">&lt;&lt;</span> elem<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-4"><a href="#ç»ƒä¹ 11-4" class="headerlink" title="ç»ƒä¹ 11.4"></a>ç»ƒä¹ 11.4</h2><blockquote><p>æ‰©å±•ä½ çš„ç¨‹åºï¼Œå¿½ç•¥å¤§å°å†™å’Œæ ‡ç‚¹ã€‚ä¾‹å¦‚ï¼Œâ€example.â€ã€â€example,â€å’Œâ€Exampleâ€åº”è¯¥é€’å¢ç›¸åŒçš„è®¡æ•°å™¨ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cctype></span></span><span class="token keyword">void</span> <span class="token function">word_count_pro</span><span class="token punctuation">(</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string word<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> word<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> ch <span class="token operator">:</span> word<span class="token punctuation">)</span> ch <span class="token operator">=</span> <span class="token function">tolower</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>word<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">remove_if</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> word<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ispunct<span class="token punctuation">)</span><span class="token punctuation">,</span>word<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>m<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> m<span class="token punctuation">)</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" : "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> m<span class="token punctuation">;</span><span class="token function">word_count_pro</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-5"><a href="#ç»ƒä¹ 11-5" class="headerlink" title="ç»ƒä¹ 11.5"></a>ç»ƒä¹ 11.5</h2><blockquote><p>è§£é‡Š<code>map</code>å’Œ<code>set</code>çš„åŒºåˆ«ã€‚ä½ å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªä¸ªï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p><code>map</code> æ˜¯é”®å€¼å¯¹ï¼Œè€Œ <code>set</code> åªæœ‰é”®æ²¡æœ‰å€¼ã€‚å½“æˆ‘éœ€è¦å­˜å‚¨é”®å€¼å¯¹çš„æ—¶å€™ä½¿ç”¨ <code>map</code>ï¼Œè€Œåªéœ€è¦é”®çš„æ—¶å€™ä½¿ç”¨ <code>set</code>ã€‚</p><h2 id="ç»ƒä¹ 11-6"><a href="#ç»ƒä¹ 11-6" class="headerlink" title="ç»ƒä¹ 11.6"></a>ç»ƒä¹ 11.6</h2><blockquote><p>è§£é‡Š<code>set</code>å’Œ<code>list</code>çš„åŒºåˆ«ã€‚ä½ å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªä¸ªï¼Ÿ</p></blockquote><p><code>set</code> æ˜¯æœ‰åºä¸é‡å¤é›†åˆï¼Œåº•å±‚å®ç°æ˜¯çº¢é»‘æ ‘ï¼Œè€Œ <code>list</code> æ˜¯æ— åºå¯é‡å¤é›†åˆï¼Œåº•å±‚å®ç°æ˜¯é“¾è¡¨ã€‚</p><h2 id="ç»ƒä¹ 11-7"><a href="#ç»ƒä¹ 11-7" class="headerlink" title="ç»ƒä¹ 11.7"></a>ç»ƒä¹ 11.7</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>map</code>ï¼Œå…³é”®å­—æ˜¯å®¶åº­çš„å§“ï¼Œå€¼æ˜¯ä¸€ä¸ª<code>vector</code>ï¼Œä¿å­˜å®¶ä¸­å­©å­ï¼ˆä»¬ï¼‰çš„åã€‚ç¼–å†™ä»£ç ï¼Œå®ç°æ·»åŠ æ–°çš„å®¶åº­ä»¥åŠå‘å·²æœ‰å®¶åº­ä¸­æ·»åŠ æ–°çš„å­©å­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> m<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string ln<span class="token punctuation">;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Last name:\n"</span><span class="token punctuation">,</span> cin <span class="token operator">>></span> ln <span class="token operator">&amp;&amp;</span> ln <span class="token operator">!=</span> <span class="token string">"@q"</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string cn<span class="token punctuation">;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"|-Children's names:\n"</span><span class="token punctuation">,</span> cin <span class="token operator">>></span> cn <span class="token operator">&amp;&amp;</span> cn <span class="token operator">!=</span> <span class="token string">"@q"</span><span class="token punctuation">;</span><span class="token punctuation">)</span>m<span class="token punctuation">[</span>ln<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cn<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-8"><a href="#ç»ƒä¹ 11-8" class="headerlink" title="ç»ƒä¹ 11.8"></a>ç»ƒä¹ 11.8</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œåœ¨ä¸€ä¸ª<code>vector</code>è€Œä¸æ˜¯ä¸€ä¸ª<code>set</code>ä¸­ä¿å­˜ä¸é‡å¤çš„å•è¯ã€‚ä½¿ç”¨<code>set</code>çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> exclude <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"aa"</span><span class="token punctuation">,</span> <span class="token string">"bb"</span><span class="token punctuation">,</span> <span class="token string">"cc"</span><span class="token punctuation">,</span> <span class="token string">"dd"</span><span class="token punctuation">,</span> <span class="token string">"ee"</span><span class="token punctuation">,</span> <span class="token string">"ff"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>string word<span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Enter plz:\n"</span><span class="token punctuation">,</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> word<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> is_excluded <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">binary_search</span><span class="token punctuation">(</span>exclude<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> exclude<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> reply <span class="token operator">=</span> is_excluded <span class="token operator">?</span> <span class="token string">"excluded"</span> <span class="token operator">:</span> <span class="token string">"not excluded"</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> reply <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>set</code>çš„ä¼˜ç‚¹æ˜¯é›†åˆæœ¬èº«çš„å…ƒç´ å°±æ˜¯ä¸é‡å¤ã€‚</p><h2 id="ç»ƒä¹ 11-9"><a href="#ç»ƒä¹ 11-9" class="headerlink" title="ç»ƒä¹ 11.9"></a>ç»ƒä¹ 11.9</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>map</code>ï¼Œå°†å•è¯ä¸ä¸€ä¸ªè¡Œå·çš„<code>list</code>å…³è”ï¼Œ<code>list</code>ä¸­ä¿å­˜çš„æ˜¯å•è¯æ‰€å‡ºç°çš„è¡Œå·ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>list<span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t<span class="token operator">>></span> m<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-10"><a href="#ç»ƒä¹ 11-10" class="headerlink" title="ç»ƒä¹ 11.10"></a>ç»ƒä¹ 11.10</h2><blockquote><p>å¯ä»¥å®šä¹‰ä¸€ä¸ª<code>vector&lt;int&gt;::iterator</code> åˆ° <code>int</code> çš„<code>map</code>å—ï¼Ÿ<code>list&lt;int&gt;::iterator</code> åˆ° <code>int</code> çš„<code>map</code>å‘¢ï¼Ÿå¯¹äºä¸¤ç§æƒ…å†µï¼Œå¦‚æœä¸èƒ½ï¼Œè§£é‡Šä¸ºä»€ä¹ˆã€‚</p></blockquote><p>è§£ï¼š</p><p>å¯ä»¥å®šä¹‰ <code>vector&lt;int&gt;::iterator</code> åˆ° <code>int</code> çš„<code>map</code>ï¼Œä½†æ˜¯ä¸èƒ½å®šä¹‰ <code>list&lt;int&gt;::iterator</code> åˆ° <code>int</code> çš„<code>map</code>ã€‚å› ä¸º<code>map</code>çš„é”®å¿…é¡»å®ç° <code>&lt;</code> æ“ä½œï¼Œ<code>list</code> çš„è¿­ä»£å™¨ä¸æ”¯æŒæ¯”è¾ƒè¿ç®—ã€‚</p><h2 id="ç»ƒä¹ 11-11"><a href="#ç»ƒä¹ 11-11" class="headerlink" title="ç»ƒä¹ 11.11"></a>ç»ƒä¹ 11.11</h2><blockquote><p>ä¸ä½¿ç”¨<code>decltype</code> é‡æ–°å®šä¹‰ <code>bookstore</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> Less <span class="token operator">=</span> <span class="token keyword">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Sales_data <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>multiset<span class="token operator">&lt;</span>Sales_data<span class="token punctuation">,</span> Less<span class="token operator">></span> <span class="token function">bookstore</span><span class="token punctuation">(</span>less<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-12"><a href="#ç»ƒä¹ 11-12" class="headerlink" title="ç»ƒä¹ 11.12"></a>ç»ƒä¹ 11.12</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œè¯»å…¥<code>string</code>å’Œ<code>int</code>çš„åºåˆ—ï¼Œå°†æ¯ä¸ª<code>string</code>å’Œ<code>int</code>å­˜å…¥ä¸€ä¸ª<code>pair</code> ä¸­ï¼Œ<code>pair</code>ä¿å­˜åœ¨ä¸€ä¸ª<code>vector</code>ä¸­ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">>></span> vec<span class="token punctuation">;</span>std<span class="token operator">::</span>string str<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> str <span class="token operator">>></span> i<span class="token punctuation">)</span>vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>p <span class="token operator">:</span> vec<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-13"><a href="#ç»ƒä¹ 11-13" class="headerlink" title="ç»ƒä¹ 11.13"></a>ç»ƒä¹ 11.13</h2><blockquote><p>åœ¨ä¸Šä¸€é¢˜çš„ç¨‹åºä¸­ï¼Œè‡³å°‘æœ‰ä¸‰ç§åˆ›å»º<code>pair</code>çš„æ–¹æ³•ã€‚ç¼–å†™æ­¤ç¨‹åºçš„ä¸‰ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«é‡‡ç”¨ä¸åŒçš„æ–¹æ³•åˆ›å»º<code>pair</code>ã€‚è§£é‡Šä½ è®¤ä¸ºå“ªç§å½¢å¼æœ€æ˜“äºç¼–å†™å’Œç†è§£ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> str<span class="token punctuation">,</span> i <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨èŠ±æ‹¬å·çš„åˆå§‹åŒ–å™¨æœ€æ˜“äºç†è§£å’Œç¼–å†™ã€‚</p><h2 id="ç»ƒä¹ 11-14"><a href="#ç»ƒä¹ 11-14" class="headerlink" title="ç»ƒä¹ 11.14"></a>ç»ƒä¹ 11.14</h2><blockquote><p>æ‰©å±•ä½ åœ¨11.2.1èŠ‚ç»ƒä¹ ä¸­ç¼–å†™çš„å­©å­å§“è¾¾åˆ°åçš„<code>map</code>ï¼Œæ·»åŠ ä¸€ä¸ª<code>pair</code>çš„<code>vector</code>ï¼Œä¿å­˜å­©å­çš„åå’Œç”Ÿæ—¥ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ostream<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>make_pair<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>pair<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>map<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Families</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> Child <span class="token operator">=</span> pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">using</span> Children <span class="token operator">=</span> vector<span class="token operator">&lt;</span>Child<span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">using</span> Data <span class="token operator">=</span> map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Children<span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> last_name<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> first_name<span class="token punctuation">,</span> string birthday<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> child <span class="token operator">=</span> <span class="token function">make_pair</span><span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> birthday<span class="token punctuation">)</span><span class="token punctuation">;</span>_data<span class="token punctuation">[</span>last_name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> pair <span class="token operator">:</span> _data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> pair<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">":\n"</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> child <span class="token operator">:</span> pair<span class="token punctuation">.</span>second<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> child<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> child<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>Data _data<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Families families<span class="token punctuation">;</span><span class="token keyword">auto</span> msg <span class="token operator">=</span> <span class="token string">"Please enter last name, first name and birthday:\n"</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string l<span class="token punctuation">,</span> f<span class="token punctuation">,</span> b<span class="token punctuation">;</span> cout <span class="token operator">&lt;&lt;</span> msg<span class="token punctuation">,</span> cin <span class="token operator">>></span> l <span class="token operator">>></span> f <span class="token operator">>></span> b<span class="token punctuation">;</span> families<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> f<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>families<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-15"><a href="#ç»ƒä¹ 11-15" class="headerlink" title="ç»ƒä¹ 11.15"></a>ç»ƒä¹ 11.15</h2><blockquote><p>å¯¹ä¸€ä¸ª<code>int</code>åˆ°<code>vector&lt;int&gt;çš„map</code>ï¼Œå…¶<code>mapped_type</code>ã€<code>key_type</code>å’Œ <code>value_type</code>åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li><code>mapped_type</code> : <code>vector&lt;int&gt;</code></li><li><code>key_type</code> : <code>int</code></li><li><code>value_type</code> : <code>std::pair&lt;const int,vector &gt;</code></li></ul><h2 id="ç»ƒä¹ 11-16"><a href="#ç»ƒä¹ 11-16" class="headerlink" title="ç»ƒä¹ 11.16"></a>ç»ƒä¹ 11.16</h2><blockquote><p>ä½¿ç”¨ä¸€ä¸ª<code>map</code>è¿­ä»£å™¨ç¼–å†™ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå°†ä¸€ä¸ªå€¼èµ‹äºˆä¸€ä¸ªå…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> string<span class="token operator">></span><span class="token operator">::</span>iterator it <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>it<span class="token operator">-></span>second <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-17"><a href="#ç»ƒä¹ 11-17" class="headerlink" title="ç»ƒä¹ 11.17"></a>ç»ƒä¹ 11.17</h2><blockquote><p>å‡å®š<code>c</code>æ˜¯ä¸€ä¸ª<code>string</code>çš„<code>multiset</code>ï¼Œ<code>v</code> æ˜¯ä¸€ä¸ª<code>string</code> çš„<code>vector</code>ï¼Œè§£é‡Šä¸‹é¢çš„è°ƒç”¨ã€‚æŒ‡å‡ºæ¯ä¸ªè°ƒç”¨æ˜¯å¦åˆæ³•ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">inserter</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">inserter</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">copy</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">back_inserter</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç¬¬äºŒä¸ªè°ƒç”¨ä¸åˆæ³•ï¼Œå› ä¸º <code>multiset</code> æ²¡æœ‰ <code>push_back</code> æ–¹æ³•ã€‚å…¶ä»–è°ƒç”¨éƒ½åˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 11-18"><a href="#ç»ƒä¹ 11-18" class="headerlink" title="ç»ƒä¹ 11.18"></a>ç»ƒä¹ 11.18</h2><blockquote><p>å†™å‡ºç¬¬382é¡µå¾ªç¯ä¸­<code>map_it</code> çš„ç±»å‹ï¼Œä¸è¦ä½¿ç”¨<code>auto</code> æˆ– <code>decltype</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> size_t<span class="token operator">></span><span class="token operator">::</span>const_iterator map_it <span class="token operator">=</span> word_count<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-19"><a href="#ç»ƒä¹ 11-19" class="headerlink" title="ç»ƒä¹ 11.19"></a>ç»ƒä¹ 11.19</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œé€šè¿‡å¯¹11.2.2èŠ‚ä¸­çš„åä¸º <code>bookstore</code> çš„<code>multiset</code> è°ƒç”¨<code>begin()</code>æ¥åˆå§‹åŒ–è¿™ä¸ªå˜é‡ã€‚å†™å‡ºå˜é‡çš„ç±»å‹ï¼Œä¸è¦ä½¿ç”¨<code>auto</code> æˆ– <code>decltype</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">using</span> compareType <span class="token operator">=</span> <span class="token keyword">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>multiset<span class="token operator">&lt;</span>Sales_data<span class="token punctuation">,</span> compareType<span class="token operator">></span> <span class="token function">bookstore</span><span class="token punctuation">(</span>compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>multiset<span class="token operator">&lt;</span>Sales_data<span class="token punctuation">,</span> compareType<span class="token operator">></span><span class="token operator">::</span>iterator c_it <span class="token operator">=</span> bookstore<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-20"><a href="#ç»ƒä¹ 11-20" class="headerlink" title="ç»ƒä¹ 11.20"></a>ç»ƒä¹ 11.20</h2><blockquote><p>é‡å†™11.1èŠ‚ç»ƒä¹ çš„å•è¯è®¡æ•°ç¨‹åºï¼Œä½¿ç”¨<code>insert</code>ä»£æ›¿ä¸‹æ ‡æ“ä½œã€‚ä½ è®¤ä¸ºå“ªä¸ªç¨‹åºæ›´å®¹æ˜“ç¼–å†™å’Œé˜…è¯»ï¼Ÿè§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>map<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> size_t<span class="token operator">></span> counts<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string word<span class="token punctuation">;</span> cin <span class="token operator">>></span> word<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> result <span class="token operator">=</span> counts<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> word<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token operator">++</span>result<span class="token punctuation">.</span>first<span class="token operator">-></span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> count <span class="token operator">:</span> counts<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> count<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> count<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>count<span class="token punctuation">.</span>second <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">" times\n"</span> <span class="token operator">:</span> <span class="token string">" time\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨<code>insert</code>æ›´å®¹æ˜“é˜…è¯»å’Œç¼–å†™ã€‚<code>insert</code>æœ‰è¿”å›å€¼ï¼Œå¯ä»¥æ˜ç¡®çš„ä½“ç°å‡ºæ’å…¥æ“ä½œçš„ç»“æœã€‚</p><h2 id="ç»ƒä¹ 11-21"><a href="#ç»ƒä¹ 11-21" class="headerlink" title="ç»ƒä¹ 11.21"></a>ç»ƒä¹ 11.21</h2><blockquote><p>å‡å®š<code>word_count</code>æ˜¯ä¸€ä¸ª<code>string</code>åˆ°<code>size_t</code>çš„<code>map</code>ï¼Œ<code>word</code>æ˜¯ä¸€ä¸ª<code>string</code>ï¼Œè§£é‡Šä¸‹é¢å¾ªç¯çš„ä½œç”¨ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> word<span class="token punctuation">)</span><span class="token operator">++</span>word_count<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>word<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token operator">-></span>second<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¿™æ¡è¯­å¥ç­‰ä»·äºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> word<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> result <span class="token operator">=</span> word_count<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>word<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>first<span class="token operator">-></span>second<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‹¥<code>insert</code>æˆåŠŸï¼šå…ˆæ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè¿”å›ä¸€ä¸ª <code>pair</code>ï¼Œ<code>pair</code> çš„ <code>first</code>å…ƒç´ æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿™ä¸ªè¿­ä»£å™¨æŒ‡å‘åˆšåˆšæ·»åŠ çš„å…ƒç´ ï¼Œè¿™ä¸ªå…ƒç´ æ˜¯<code>pair</code>ï¼Œç„¶åé€’å¢<code>pair</code>çš„<code>second</code>æˆå‘˜ã€‚<br>è‹¥<code>insert</code>å¤±è´¥ï¼šé€’å¢å·²æœ‰æŒ‡å®šå…³é”®å­—çš„å…ƒç´ çš„ <code>second</code>æˆå‘˜ã€‚</p><h2 id="ç»ƒä¹ 11-22"><a href="#ç»ƒä¹ 11-22" class="headerlink" title="ç»ƒä¹ 11.22"></a>ç»ƒä¹ 11.22</h2><blockquote><p>ç»™å®šä¸€ä¸ª<code>map&lt;string, vector&lt;int&gt;&gt;</code>ï¼Œå¯¹æ­¤å®¹å™¨çš„æ’å…¥ä¸€ä¸ªå…ƒç´ çš„<code>insert</code>ç‰ˆæœ¬ï¼Œå†™å‡ºå…¶å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span>    <span class="token comment">// å‚æ•°ç±»å‹</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">::</span>iterator<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">></span> <span class="token comment">// è¿”å›ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-23"><a href="#ç»ƒä¹ 11-23" class="headerlink" title="ç»ƒä¹ 11.23"></a>ç»ƒä¹ 11.23</h2><blockquote><p>11.2.1èŠ‚ç»ƒä¹ ä¸­çš„<code>map</code> ä»¥å­©å­çš„å§“ä¸ºå…³é”®å­—ï¼Œä¿å­˜ä»–ä»¬çš„åçš„<code>vector</code>ï¼Œç”¨<code>multimap</code> é‡å†™æ­¤<code>map</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>multimap<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    multimap<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> families<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string lname<span class="token punctuation">,</span> cname<span class="token punctuation">;</span> cin <span class="token operator">>></span> cname <span class="token operator">>></span> lname<span class="token punctuation">;</span> families<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>lname<span class="token punctuation">,</span> cname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> family <span class="token operator">:</span> families<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> family<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> family<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-24"><a href="#ç»ƒä¹ 11-24" class="headerlink" title="ç»ƒä¹ 11.24"></a>ç»ƒä¹ 11.24</h2><blockquote><p>ä¸‹é¢çš„ç¨‹åºå®Œæˆä»€ä¹ˆåŠŸèƒ½ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> m<span class="token punctuation">;</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°<code>map</code>ä¸­ï¼Œå¦‚æœè¯¥é”®å­˜åœ¨ï¼Œåˆ™é‡æ–°èµ‹å€¼ã€‚</p><h2 id="ç»ƒä¹ 11-25"><a href="#ç»ƒä¹ 11-25" class="headerlink" title="ç»ƒä¹ 11.25"></a>ç»ƒä¹ 11.25</h2><blockquote><p>å¯¹æ¯”ä¸‹é¢çš„ç¨‹åºä¸ä¸Šä¸€é¢˜ç¨‹åº</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">;</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æœªå®šä¹‰è¡Œä¸ºï¼Œ<code>vector</code> çš„ä¸‹æ ‡è¶Šç•Œè®¿é—®ã€‚</p><h2 id="ç»ƒä¹ 11-26"><a href="#ç»ƒä¹ 11-26" class="headerlink" title="ç»ƒä¹ 11.26"></a>ç»ƒä¹ 11.26</h2><blockquote><p>å¯ä»¥ç”¨ä»€ä¹ˆç±»å‹æ¥å¯¹ä¸€ä¸ª<code>map</code>è¿›è¡Œä¸‹æ ‡æ“ä½œï¼Ÿä¸‹æ ‡è¿ç®—ç¬¦è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿè¯·ç»™å‡ºä¸€ä¸ªå…·ä½“ä¾‹å­â€”â€”å³ï¼Œå®šä¹‰ä¸€ä¸ª<code>map</code>ï¼Œç„¶åå†™å‡ºä¸€ä¸ªå¯ä»¥ç”¨æ¥å¯¹<code>map</code>è¿›è¡Œä¸‹æ ‡æ“ä½œçš„ç±»å‹ä»¥åŠä¸‹æ ‡è¿ç®—ç¬¦å°†ä¼šè¿”ä¼šçš„ç±»å‹ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">></span> m <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"ss"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"sz"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">using</span> KeyType <span class="token operator">=</span> std<span class="token operator">::</span>map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">></span><span class="token operator">::</span>key_type<span class="token punctuation">;</span><span class="token keyword">using</span> ReturnType <span class="token operator">=</span> std<span class="token operator">::</span>map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">></span><span class="token operator">::</span>mapped_type<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-27"><a href="#ç»ƒä¹ 11-27" class="headerlink" title="ç»ƒä¹ 11.27"></a>ç»ƒä¹ 11.27</h2><blockquote><p>å¯¹äºä»€ä¹ˆé—®é¢˜ä½ ä¼šä½¿ç”¨<code>count</code>æ¥è§£å†³ï¼Ÿä»€ä¹ˆæ—¶å€™ä½ åˆä¼šé€‰æ‹©<code>find</code>å‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¯¹äºå…è®¸é‡å¤å…³é”®å­—çš„å®¹å™¨ï¼Œåº”è¯¥ç”¨ <code>count</code> ; å¯¹äºä¸å…è®¸é‡å¤å…³é”®å­—çš„å®¹å™¨ï¼Œåº”è¯¥ç”¨ <code>find</code> ã€‚</p><h2 id="ç»ƒä¹ 11-28"><a href="#ç»ƒä¹ 11-28" class="headerlink" title="ç»ƒä¹ 11.28"></a>ç»ƒä¹ 11.28</h2><blockquote><p>å¯¹ä¸€ä¸ª<code>string</code>åˆ°<code>int</code>çš„<code>vector</code>çš„<code>map</code>ï¼Œå®šä¹‰å¹¶åˆå§‹åŒ–ä¸€ä¸ªå˜é‡æ¥ä¿å­˜åœ¨å…¶ä¸Šè°ƒç”¨<code>find</code>æ‰€è¿”å›çš„ç»“æœã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> m<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">::</span>iterator it <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-29"><a href="#ç»ƒä¹ 11-29" class="headerlink" title="ç»ƒä¹ 11.29"></a>ç»ƒä¹ 11.29</h2><blockquote><p>å¦‚æœç»™å®šçš„å…³é”®å­—ä¸åœ¨å®¹å™¨ä¸­ï¼Œ<code>upper_bound</code>ã€<code>lower_bound</code> å’Œ <code>equal_range</code> åˆ†åˆ«ä¼šè¿”å›ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœç»™å®šçš„å…³é”®å­—ä¸åœ¨å®¹å™¨ä¸­ï¼Œåˆ™ <code>lower_bound</code>å’Œ <code>upper_bound</code> ä¼šè¿”å›ç›¸ç­‰çš„è¿­ä»£å™¨ï¼ŒæŒ‡å‘ä¸€ä¸ªä¸å½±å“æ’åºçš„å…³é”®å­—æ’å…¥ä½ç½®ã€‚è€Œ<code>equal_range</code> ä¼šè¿”å›ä¸€ä¸ª <code>pair</code>ï¼Œ<code>pair</code> ä¸­çš„ä¸¤ä¸ªè¿­ä»£å™¨éƒ½æŒ‡å‘å…³é”®å­—å¯ä»¥æ’å…¥çš„ä½ç½®ã€‚</p><h2 id="ç»ƒä¹ 11-30"><a href="#ç»ƒä¹ 11-30" class="headerlink" title="ç»ƒä¹ 11.30"></a>ç»ƒä¹ 11.30</h2><blockquote><p>å¯¹äºæœ¬èŠ‚æœ€åä¸€ä¸ªç¨‹åºä¸­çš„è¾“å‡ºè¡¨è¾¾å¼ï¼Œè§£é‡Šè¿ç®—å¯¹è±¡<code>pos.first-&gt;second</code>çš„å«ä¹‰ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>pos</code> æ˜¯ä¸€ä¸ª<code>pair</code>ï¼Œ<code>pos.first</code> æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘åŒ¹é…å…³é”®å­—çš„å…ƒç´ ï¼Œè¯¥å…ƒç´ æ˜¯ä¸€ä¸ª <code>pair</code>ï¼Œè®¿é—®è¯¥å…ƒç´ çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚</p><h2 id="ç»ƒä¹ 11-31"><a href="#ç»ƒä¹ 11-31" class="headerlink" title="ç»ƒä¹ 11.31"></a>ç»ƒä¹ 11.31</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œå®šä¹‰ä¸€ä¸ªä½œè€…åŠå…¶ä½œå“çš„<code>multimap</code>ã€‚ä½¿ç”¨<code>find</code>åœ¨<code>multimap</code>ä¸­æŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ å¹¶ç”¨<code>erase</code>åˆ é™¤å®ƒã€‚ç¡®ä¿ä½ çš„ç¨‹åºåœ¨å…ƒç´ ä¸åœ¨<code>map</code> ä¸­æ—¶ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>multimap<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> authors<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"DMA"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"LeetCode"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"CLRS"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"wang"</span><span class="token punctuation">,</span> <span class="token string">"FTP"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"wang"</span><span class="token punctuation">,</span> <span class="token string">"CPP-Concurrency"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>string author <span class="token operator">=</span> <span class="token string">"pezy"</span><span class="token punctuation">;</span>string work <span class="token operator">=</span> <span class="token string">"CP5"</span><span class="token punctuation">;</span><span class="token keyword">auto</span> found <span class="token operator">=</span> authors<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> count <span class="token operator">=</span> authors<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token operator">-></span>second <span class="token operator">==</span> work<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>authors<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>found<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token operator">++</span>found<span class="token punctuation">;</span><span class="token operator">--</span>count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>author <span class="token operator">:</span> authors<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> author<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> author<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-32"><a href="#ç»ƒä¹ 11-32" class="headerlink" title="ç»ƒä¹ 11.32"></a>ç»ƒä¹ 11.32</h2><blockquote><p>ä½¿ç”¨ä¸Šä¸€é¢˜å®šä¹‰çš„<code>multimap</code>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼ŒæŒ‰å­—å…¸åºæ‰“å°ä½œè€…åˆ—è¡¨å’Œä»–ä»¬çš„ä½œå“ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>multimap<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> authors<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"DMA"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"LeetCode"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"CLRS"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"wang"</span><span class="token punctuation">,</span> <span class="token string">"FTP"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"wang"</span><span class="token punctuation">,</span> <span class="token string">"CPP-Concurrency"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>multiset<span class="token operator">&lt;</span>string<span class="token operator">>></span> order_authors<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>author <span class="token operator">:</span> authors<span class="token punctuation">)</span>order_authors<span class="token punctuation">[</span>author<span class="token punctuation">.</span>first<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>author<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>author <span class="token operator">:</span> order_authors<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> author<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>work <span class="token operator">:</span> author<span class="token punctuation">.</span>second<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> work <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-33"><a href="#ç»ƒä¹ 11-33" class="headerlink" title="ç»ƒä¹ 11.33"></a>ç»ƒä¹ 11.33</h2><blockquote><p>å®ç°ä½ è‡ªå·±ç‰ˆæœ¬çš„å•è¯è½¬æ¢ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> <span class="token function">buildMap</span><span class="token punctuation">(</span>ifstream <span class="token operator">&amp;</span>map_file<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> trans_map<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string key<span class="token punctuation">,</span> value<span class="token punctuation">;</span> map_file <span class="token operator">>></span> key <span class="token operator">&amp;&amp;</span> <span class="token function">getline</span><span class="token punctuation">(</span>map_file<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> trans_map<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> value<span class="token punctuation">.</span><span class="token function">find_last_not_of</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> trans_map<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> map_it <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> map_it <span class="token operator">==</span> m<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> s <span class="token operator">:</span> map_it<span class="token operator">-></span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">word_transform</span><span class="token punctuation">(</span>ifstream <span class="token operator">&amp;</span>map<span class="token punctuation">,</span> ifstream <span class="token operator">&amp;</span>input<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> trans_map <span class="token operator">=</span> <span class="token function">buildMap</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string text<span class="token punctuation">;</span> <span class="token function">getline</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>istringstream <span class="token function">iss</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>string word<span class="token punctuation">;</span> iss <span class="token operator">>></span> word<span class="token punctuation">;</span> <span class="token punctuation">)</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">transform</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> trans_map<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    ifstream <span class="token function">ifs_map</span><span class="token punctuation">(</span><span class="token string">"../data/word_transformation_bad.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ifs_content</span><span class="token punctuation">(</span><span class="token string">"../data/given_to_transform.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ifs_map <span class="token operator">&amp;&amp;</span> ifs_content<span class="token punctuation">)</span> <span class="token function">word_transform</span><span class="token punctuation">(</span>ifs_map<span class="token punctuation">,</span> ifs_content<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"can't find the documents."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 11-34"><a href="#ç»ƒä¹ 11-34" class="headerlink" title="ç»ƒä¹ 11.34"></a>ç»ƒä¹ 11.34</h2><blockquote><p>å¦‚æœä½ å°†<code>transform</code> å‡½æ•°ä¸­çš„<code>find</code>æ›¿æ¢ä¸ºä¸‹æ ‡è¿ç®—ç¬¦ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦ï¼Œå½“å…³é”®å­—æœªåœ¨å®¹å™¨ä¸­æ—¶ï¼Œä¼šå¾€å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ã€‚</p><h2 id="ç»ƒä¹ 11-35"><a href="#ç»ƒä¹ 11-35" class="headerlink" title="ç»ƒä¹ 11.35"></a>ç»ƒä¹ 11.35</h2><blockquote><p>åœ¨<code>buildMap</code>ä¸­ï¼Œå¦‚æœè¿›è¡Œå¦‚ä¸‹æ”¹å†™ï¼Œä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">trans_map<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”¹ä¸º</span>trans_map<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>key<span class="token punctuation">,</span> value<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å½“ä¸€ä¸ªè½¬æ¢è§„åˆ™çš„å…³é”®å­—å¤šæ¬¡å‡ºç°çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦ä¼šä¿ç•™æœ€åä¸€æ¬¡æ·»åŠ çš„è§„åˆ™ï¼Œè€Œç”¨insertåˆ™ä¿ç•™ç¬¬ä¸€æ¬¡æ·»åŠ çš„è§„åˆ™ã€‚</p><h2 id="ç»ƒä¹ 11-36"><a href="#ç»ƒä¹ 11-36" class="headerlink" title="ç»ƒä¹ 11.36"></a>ç»ƒä¹ 11.36</h2><blockquote><p>æˆ‘ä»¬çš„ç¨‹åºå¹¶æ²¡æ£€æŸ¥è¾“å…¥æ–‡ä»¶çš„åˆæ³•æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå‡å®šè½¬æ¢è§„åˆ™æ–‡ä»¶ä¸­çš„è§„åˆ™éƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚å¦‚æœæ–‡ä»¶ä¸­çš„æŸä¸€è¡ŒåŒ…å«ä¸€ä¸ªå…³é”®å­—ã€ä¸€ä¸ªç©ºæ ¼ï¼Œç„¶åå°±ç»“æŸäº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿé¢„æµ‹ç¨‹åºçš„è¡Œä¸ºå¹¶è¿›è¡ŒéªŒè¯ï¼Œå†ä¸ä½ çš„ç¨‹åºè¿›è¡Œæ¯”è¾ƒã€‚</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœå…³é”®å­—æ²¡æœ‰å¯¹åº”çš„è§„åˆ™ï¼Œé‚£ä¹ˆç¨‹åºä¼šæŠ›å‡ºä¸€ä¸ª <code>runtime_error</code>ã€‚</p><h2 id="ç»ƒä¹ 11-37"><a href="#ç»ƒä¹ 11-37" class="headerlink" title="ç»ƒä¹ 11.37"></a>ç»ƒä¹ 11.37</h2><blockquote><p>ä¸€ä¸ªæ— åºå®¹å™¨ä¸å…¶æœ‰åºç‰ˆæœ¬ç›¸æ¯”æœ‰ä½•ä¼˜åŠ¿ï¼Ÿæœ‰åºç‰ˆæœ¬æœ‰ä½•ä¼˜åŠ¿ï¼Ÿ</p></blockquote><p>æ— åºå®¹å™¨æ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œæœ‰åºå®¹å™¨ä½¿å¾—å…ƒç´ å§‹ç»ˆæœ‰åºã€‚</p><h2 id="ç»ƒä¹ 11-38"><a href="#ç»ƒä¹ 11-38" class="headerlink" title="ç»ƒä¹ 11.38"></a>ç»ƒä¹ 11.38</h2><blockquote><p>ç”¨ <code>unordered_map</code> é‡å†™å•è¯è®¡æ•°ç¨‹åºå’Œå•è¯è½¬æ¢ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unordered_map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">wordCounting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> size_t<span class="token operator">></span> word_count<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string word<span class="token punctuation">;</span> std<span class="token operator">::</span>cin <span class="token operator">>></span> word<span class="token punctuation">;</span> <span class="token operator">++</span>word_count<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>w <span class="token operator">:</span> word_count<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> w<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">" occurs "</span> <span class="token operator">&lt;&lt;</span> w<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>w<span class="token punctuation">.</span>second <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">"times"</span> <span class="token operator">:</span> <span class="token string">"time"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">wordTransformation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>ifstream <span class="token function">ifs_map</span><span class="token punctuation">(</span><span class="token string">"../data/word_transformation.txt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ifs_content</span><span class="token punctuation">(</span><span class="token string">"../data/given_to_transform.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ifs_map <span class="token operator">||</span> <span class="token operator">!</span>ifs_content<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"can't find the documents."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> trans_map<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>string key<span class="token punctuation">,</span> value<span class="token punctuation">;</span> ifs_map <span class="token operator">>></span> key <span class="token operator">&amp;&amp;</span> <span class="token function">getline</span><span class="token punctuation">(</span>ifs_map<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> trans_map<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> value<span class="token punctuation">.</span><span class="token function">find_last_not_of</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>string text<span class="token punctuation">,</span> word<span class="token punctuation">;</span> <span class="token function">getline</span><span class="token punctuation">(</span>ifs_content<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>istringstream <span class="token function">iss</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span> iss <span class="token operator">>></span> word<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">auto</span> map_it <span class="token operator">=</span> trans_map<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>            std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>map_it <span class="token operator">==</span> trans_map<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> word <span class="token operator">:</span> map_it<span class="token operator">-></span>second<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//wordCounting();</span>    <span class="token function">wordTransformation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ12</title>
      <link href="2021/04/10/excersize/ch12/"/>
      <url>2021/04/10/excersize/ch12/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åäºŒç« -åŠ¨æ€å†…å­˜"><a href="#ç¬¬åäºŒç« -åŠ¨æ€å†…å­˜" class="headerlink" title="ç¬¬åäºŒç«  åŠ¨æ€å†…å­˜"></a>ç¬¬åäºŒç«  åŠ¨æ€å†…å­˜</h1><h2 id="ç»ƒä¹ 12-1"><a href="#ç»ƒä¹ 12-1" class="headerlink" title="ç»ƒä¹ 12.1"></a>ç»ƒä¹ 12.1</h2><blockquote><p>åœ¨æ­¤ä»£ç çš„ç»“å°¾ï¼Œ<code>b1</code> å’Œ <code>b2</code> å„åŒ…å«å¤šå°‘ä¸ªå…ƒç´ ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">StrBlob b1<span class="token punctuation">;</span><span class="token punctuation">&#123;</span>StrBlob b2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"an"</span><span class="token punctuation">,</span> <span class="token string">"the"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>b1 <span class="token operator">=</span> b2<span class="token punctuation">;</span>b2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"about"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å®ƒä»¬å®é™…æ“ä½œçš„æ˜¯åŒä¸€ä¸ª<code>vector</code>ï¼Œéƒ½åŒ…å«4ä¸ªå…ƒç´ ã€‚åœ¨ä»£ç çš„ç»“å°¾ï¼Œ<code>b2</code> è¢«ææ„äº†ï¼Œä¸å½±å“ <code>b1</code> çš„å…ƒç´ ã€‚</p><h2 id="ç»ƒä¹ 12-2"><a href="#ç»ƒä¹ 12-2" class="headerlink" title="ç»ƒä¹ 12.2"></a>ç»ƒä¹ 12.2</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±çš„<code>StrBlob</code> ç±»ï¼ŒåŒ…å«<code>const</code> ç‰ˆæœ¬çš„ <code>front</code> å’Œ <code>back</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;exception></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlob</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">using</span> size_type <span class="token operator">=</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">;</span>    <span class="token function">StrBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">StrBlob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    size_type <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"pop_back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        data<span class="token operator">-></span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> data<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex12_02.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">const</span> StrBlob csb<span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"pezy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    StrBlob sb<span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"Mooophy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> csb<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> csb<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    sb<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"pezy"</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> sb<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> sb<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-3"><a href="#ç»ƒä¹ 12-3" class="headerlink" title="ç»ƒä¹ 12.3"></a>ç»ƒä¹ 12.3</h2><blockquote><p><code>StrBlob</code> éœ€è¦<code>const</code> ç‰ˆæœ¬çš„<code>push_back</code> å’Œ <code>pop_back</code>å—ï¼Ÿå¦‚éœ€è¦ï¼Œæ·»åŠ è¿›å»ã€‚å¦åˆ™ï¼Œè§£é‡Šä¸ºä»€ä¹ˆä¸éœ€è¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ä¸éœ€è¦ã€‚<code>push_back</code> å’Œ <code>pop_back</code> ä¼šæ”¹å˜å¯¹è±¡çš„å†…å®¹ã€‚è€Œ <code>const</code> å¯¹è±¡æ˜¯åªè¯»çš„ï¼Œå› æ­¤ä¸éœ€è¦ã€‚</p><h2 id="ç»ƒä¹ 12-4"><a href="#ç»ƒä¹ 12-4" class="headerlink" title="ç»ƒä¹ 12.4"></a>ç»ƒä¹ 12.4</h2><blockquote><p>åœ¨æˆ‘ä»¬çš„ <code>check</code> å‡½æ•°ä¸­ï¼Œæ²¡æœ‰æ£€æŸ¥ <code>i</code> æ˜¯å¦å¤§äº0ã€‚ä¸ºä»€ä¹ˆå¯ä»¥å¿½ç•¥è¿™ä¸ªæ£€æŸ¥ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸º <code>size_type</code> æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´å‹ï¼Œå½“ä¼ é€’ç»™ <code>check</code> çš„å‚æ•°å°äº 0 çš„æ—¶å€™ï¼Œå‚æ•°å€¼ä¼šè½¬æ¢æˆä¸€ä¸ªæ­£æ•´æ•°ã€‚</p><h2 id="ç»ƒä¹ 12-5"><a href="#ç»ƒä¹ 12-5" class="headerlink" title="ç»ƒä¹ 12.5"></a>ç»ƒä¹ 12.5</h2><blockquote><p>æˆ‘ä»¬æœªç¼–å†™æ¥å—ä¸€ä¸ª <code>initializer_list explicit</code> å‚æ•°çš„æ„é€ å‡½æ•°ã€‚è®¨è®ºè¿™ä¸ªè®¾è®¡ç­–ç•¥çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ„é€ å‡½æ•°ä¸æ˜¯ <code>explicit</code> çš„ï¼Œæ„å‘³ç€å¯ä»¥ä» <code>initializer_list</code> éšå¼è½¬æ¢ä¸º <code>StrBlob</code>ã€‚åœ¨ <code>StrBlob</code> å¯¹è±¡ä¸­ï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®æˆå‘˜ <code>data</code>ï¼Œè€Œ <code>StrBlob</code> å¯¹è±¡æœ¬èº«çš„å«ä¹‰ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª<strong>ç®¡ç†å­—ç¬¦ä¸²çš„åºåˆ—</strong>ã€‚å› æ­¤ï¼Œä» <code>initializer_list</code> åˆ° <code>StrBlob</code> çš„è½¬æ¢ï¼Œåœ¨é€»è¾‘ä¸Šæ˜¯å¯è¡Œçš„ã€‚è€Œè¿™ä¸ªè®¾è®¡ç­–ç•¥çš„ç¼ºç‚¹ï¼Œå¯èƒ½åœ¨æŸäº›åœ°æ–¹æˆ‘ä»¬ç¡®å®éœ€è¦ <code>initializer_list</code>ï¼Œè€Œç¼–è¯‘å™¨ä»ä¼šå°†ä¹‹è½¬æ¢ä¸º <code>StrBlob</code>ã€‚</p><h2 id="ç»ƒä¹ 12-6"><a href="#ç»ƒä¹ 12-6" class="headerlink" title="ç»ƒä¹ 12.6"></a>ç»ƒä¹ 12.6</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„ <code>int</code> çš„<code>vector</code>ã€‚å°†æ­¤<code>vector</code> ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¯»å–æ ‡å‡†è¾“å…¥ï¼Œå°†è¯»å…¥çš„å€¼ä¿å­˜åœ¨ <code>vector</code> å…ƒç´ ä¸­ã€‚å†å°†<code>vector</code>ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œæ‰“å°è¯»å…¥çš„å€¼ã€‚è®°å¾—åœ¨æ°å½“çš„æ—¶åˆ»<code>delete vector</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">*</span> <span class="token function">alloc_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">new</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">assign_vector</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>p<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print_vector</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">alloc_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">assign_vector</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_vector</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">delete</span> p<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-7"><a href="#ç»ƒä¹ 12-7" class="headerlink" title="ç»ƒä¹ 12.7"></a>ç»ƒä¹ 12.7</h2><blockquote><p>é‡åšä¸Šä¸€é¢˜ï¼Œè¿™æ¬¡ä½¿ç”¨ <code>shared_ptr</code> è€Œä¸æ˜¯å†…ç½®æŒ‡é’ˆã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">alloc_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">assign_vector</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>p<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">print_vector</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">alloc_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">assign_vector</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_vector</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-8"><a href="#ç»ƒä¹ 12-8" class="headerlink" title="ç»ƒä¹ 12.8"></a>ç»ƒä¹ 12.8</h2><blockquote><p>ä¸‹é¢çš„å‡½æ•°æ˜¯å¦æœ‰é”™è¯¯ï¼Ÿå¦‚æœæœ‰ï¼Œè§£é‡Šé”™è¯¯åŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span><span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span><span class="token comment">// ...</span><span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æœ‰é”™è¯¯ã€‚<code>p</code>ä¼šè¢«å¼ºåˆ¶è½¬æ¢æˆ<code>bool</code>ï¼Œç»§è€Œæ²¡æœ‰é‡Šæ”¾æŒ‡é’ˆ <code>p</code> æŒ‡å‘çš„å¯¹è±¡ã€‚</p><h2 id="ç»ƒä¹ 12-9"><a href="#ç»ƒä¹ 12-9" class="headerlink" title="ç»ƒä¹ 12.9"></a>ç»ƒä¹ 12.9</h2><blockquote><p>è§£é‡Šä¸‹é¢ä»£ç æ‰§è¡Œçš„ç»“æœã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>q <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">*</span>r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>r <span class="token operator">=</span> q<span class="token punctuation">;</span><span class="token keyword">auto</span> q2 <span class="token operator">=</span> make_shared<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r2 <span class="token operator">=</span> make_shared<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>r2 <span class="token operator">=</span> q2<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>r</code> å’Œ <code>q</code> æŒ‡å‘ 42ï¼Œè€Œä¹‹å‰ <code>r</code> æŒ‡å‘çš„ 100 çš„å†…å­˜ç©ºé—´å¹¶æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œå› æ­¤ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚<code>r2</code> å’Œ <code>q2</code> éƒ½æ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Œå½“å¯¹è±¡ç©ºé—´ä¸è¢«å¼•ç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚</p><h2 id="ç»ƒä¹ 12-10"><a href="#ç»ƒä¹ 12-10" class="headerlink" title="ç»ƒä¹ 12.10"></a>ç»ƒä¹ 12.10</h2><blockquote><p>ä¸‹é¢çš„ä»£ç è°ƒç”¨äº†ç¬¬413é¡µä¸­å®šä¹‰çš„<code>process</code> å‡½æ•°ï¼Œè§£é‡Šæ­¤è°ƒç”¨æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœä¸æ­£ç¡®ï¼Œåº”å¦‚ä½•ä¿®æ”¹ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">process</span><span class="token punctuation">(</span>shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ­£ç¡®ã€‚<code>shared_ptr&lt;int&gt;(p)</code> ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æ™ºèƒ½æŒ‡é’ˆï¼Œè¿™ä¸ªæ™ºèƒ½æŒ‡é’ˆä¸ <code>p</code> å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°ä¸º 2ã€‚å½“è¡¨è¾¾å¼ç»“æŸæ—¶ï¼Œä¸´æ—¶çš„æ™ºèƒ½æŒ‡é’ˆè¢«é”€æ¯ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°ä¸º 1ã€‚</p><h2 id="ç»ƒä¹ 12-11"><a href="#ç»ƒä¹ 12-11" class="headerlink" title="ç»ƒä¹ 12.11"></a>ç»ƒä¹ 12.11</h2><blockquote><p>å¦‚æœæˆ‘ä»¬åƒä¸‹é¢è¿™æ ·è°ƒç”¨ <code>process</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">process</span><span class="token punctuation">(</span>shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>è¿™æ ·ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°ä¸º 1ï¼Œè¿™ä¸ªæ™ºèƒ½æŒ‡é’ˆæ‰€æŒ‡å‘çš„ç©ºé—´ä¸ <code>p</code> ç›¸åŒã€‚åœ¨è¡¨è¾¾å¼ç»“æŸåï¼Œè¿™ä¸ªä¸´æ—¶æ™ºèƒ½æŒ‡é’ˆä¼šè¢«é”€æ¯ï¼Œå¼•ç”¨è®¡æ•°ä¸º 0ï¼Œæ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ä¹Ÿä¼šè¢«é‡Šæ”¾ã€‚è€Œå¯¼è‡´ <code>p</code> æ‰€æŒ‡å‘çš„ç©ºé—´è¢«é‡Šæ”¾ï¼Œä½¿å¾— p` æˆä¸ºä¸€ä¸ªç©ºæ‚¬æŒ‡é’ˆã€‚</p><h2 id="ç»ƒä¹ 12-12"><a href="#ç»ƒä¹ 12-12" class="headerlink" title="ç»ƒä¹ 12.12"></a>ç»ƒä¹ 12.12</h2><blockquote><p><code>p</code> å’Œ <code>sp</code> çš„å®šä¹‰å¦‚ä¸‹ï¼Œå¯¹äºæ¥ä¸‹æ¥çš„å¯¹ <code>process</code> çš„æ¯ä¸ªè°ƒç”¨ï¼Œå¦‚æœåˆæ³•ï¼Œè§£é‡Šå®ƒåšäº†ä»€ä¹ˆï¼Œå¦‚æœä¸åˆæ³•ï¼Œè§£é‡Šé”™è¯¯åŸå› ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> sp <span class="token operator">=</span> make_shared<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">process</span><span class="token punctuation">(</span>sp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">process</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">process</span><span class="token punctuation">(</span>shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) åˆæ³•ã€‚å°†<code>sp</code> æ‹·è´ç»™ <code>process</code>å‡½æ•°çš„å½¢å‚ï¼Œåœ¨å‡½æ•°é‡Œé¢å¼•ç”¨è®¡æ•°ä¸º 2ï¼Œå‡½æ•°ç»“æŸåå¼•ç”¨è®¡æ•°ä¸º 1ã€‚</li><li>(b) ä¸åˆæ³•ã€‚ä¸èƒ½ä»å†…ç½®æŒ‡é’ˆéšå¼è½¬æ¢ä¸ºæ™ºèƒ½æŒ‡é’ˆã€‚</li><li>(c) ä¸åˆæ³•ã€‚ä¸èƒ½ä»å†…ç½®æŒ‡é’ˆéšå¼è½¬æ¢ä¸ºæ™ºèƒ½æŒ‡é’ˆã€‚</li><li>(d) åˆæ³•ã€‚ä½†æ˜¯æ™ºèƒ½æŒ‡é’ˆå’Œå†…ç½®æŒ‡é’ˆä¸€èµ·ä½¿ç”¨å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œåœ¨è¡¨è¾¾å¼ç»“æŸåæ™ºèƒ½æŒ‡é’ˆä¼šè¢«é”€æ¯ï¼Œå®ƒæ‰€æŒ‡å‘çš„å¯¹è±¡ä¹Ÿè¢«é‡Šæ”¾ã€‚è€Œæ­¤æ—¶å†…ç½®æŒ‡é’ˆ <code>p</code> ä¾æ—§æŒ‡å‘è¯¥å†…å­˜ç©ºé—´ã€‚ä¹‹åå¯¹å†…ç½®æŒ‡é’ˆ <code>p</code> çš„æ“ä½œå¯èƒ½ä¼šå¼•å‘é”™è¯¯ã€‚</li></ul><h2 id="ç»ƒä¹ 12-13"><a href="#ç»ƒä¹ 12-13" class="headerlink" title="ç»ƒä¹ 12.13"></a>ç»ƒä¹ 12.13</h2><blockquote><p>å¦‚æœæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> sp <span class="token operator">=</span> make_shared<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> sp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">delete</span> p<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ™ºèƒ½æŒ‡é’ˆ <code>sp</code> æ‰€æŒ‡å‘ç©ºé—´å·²ç»è¢«é‡Šæ”¾ï¼Œå†å¯¹ <code>sp</code> è¿›è¡Œæ“ä½œä¼šå‡ºç°é”™è¯¯ã€‚</p><h2 id="ç»ƒä¹ 12-14"><a href="#ç»ƒä¹ 12-14" class="headerlink" title="ç»ƒä¹ 12.14"></a>ç»ƒä¹ 12.14</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ç”¨ <code>shared_ptr</code> ç®¡ç† <code>connection</code> çš„å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">connection</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string ip<span class="token punctuation">;</span><span class="token keyword">int</span> port<span class="token punctuation">;</span><span class="token function">connection</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string i<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ip</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">port</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">destination</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string ip<span class="token punctuation">;</span><span class="token keyword">int</span> port<span class="token punctuation">;</span><span class="token function">destination</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string i<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ip</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">port</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>connection <span class="token function">connect</span><span class="token punctuation">(</span>destination<span class="token operator">*</span> pDest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>connection<span class="token operator">></span> <span class="token function">pConn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">connection</span><span class="token punctuation">(</span>pDest<span class="token operator">-></span>ip<span class="token punctuation">,</span> pDest<span class="token operator">-></span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"creating connection("</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span>pConn<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">disconnect</span><span class="token punctuation">(</span>connection pConn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"connection close("</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span>ip <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span>port <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">end_connection</span><span class="token punctuation">(</span>connection<span class="token operator">*</span> pConn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token operator">*</span>pConn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>destination <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>connection conn <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>connection<span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>conn<span class="token punctuation">,</span> end_connection<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"connecting now("</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>destination <span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">"220.181.111.111"</span><span class="token punctuation">,</span> <span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-15"><a href="#ç»ƒä¹ 12-15" class="headerlink" title="ç»ƒä¹ 12.15"></a>ç»ƒä¹ 12.15</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„ç¨‹åºï¼Œç”¨ <code>lambda</code> ä»£æ›¿<code>end_connection</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">connection</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string ip<span class="token punctuation">;</span><span class="token keyword">int</span> port<span class="token punctuation">;</span><span class="token function">connection</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string i<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ip</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">port</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">destination</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string ip<span class="token punctuation">;</span><span class="token keyword">int</span> port<span class="token punctuation">;</span><span class="token function">destination</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string i<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ip</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">port</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>connection <span class="token function">connect</span><span class="token punctuation">(</span>destination<span class="token operator">*</span> pDest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>connection<span class="token operator">></span> <span class="token function">pConn</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">connection</span><span class="token punctuation">(</span>pDest<span class="token operator">-></span>ip<span class="token punctuation">,</span> pDest<span class="token operator">-></span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"creating connection("</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span>pConn<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">disconnect</span><span class="token punctuation">(</span>connection pConn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"connection close("</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span>ip <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> pConn<span class="token punctuation">.</span>port <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>destination <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>connection conn <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>connection<span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>conn<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>connection<span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"connecting now("</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>destination <span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">"220.181.111.111"</span><span class="token punctuation">,</span> <span class="token number">10086</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-16"><a href="#ç»ƒä¹ 12-16" class="headerlink" title="ç»ƒä¹ 12.16"></a>ç»ƒä¹ 12.16</h2><blockquote><p>å¦‚æœä½ è¯•å›¾æ‹·è´æˆ–èµ‹å€¼ <code>unique_ptr</code>ï¼Œç¼–è¯‘å™¨å¹¶ä¸æ€»æ˜¯èƒ½ç»™å‡ºæ˜“äºç†è§£çš„é”™è¯¯ä¿¡æ¯ã€‚ç¼–å†™åŒ…å«è¿™ç§é”™è¯¯çš„ç¨‹åºï¼Œè§‚å¯Ÿç¼–è¯‘å™¨å¦‚ä½•è¯Šæ–­è¿™ç§é”™è¯¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>unique_ptr<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    unique_ptr<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">p1</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string">"pezy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// unique_ptr&lt;string> p2(p1); // copy</span>    <span class="token comment">//                      ^</span>    <span class="token comment">// Error: Call to implicitly-deleted copy constructor of 'unique_ptr&lt;string>'</span>    <span class="token comment">//</span>    <span class="token comment">// unique_ptr&lt;string> p3 = p1; // assign</span>    <span class="token comment">//                      ^</span>    <span class="token comment">// Error: Call to implicitly-deleted copy constructor of 'unique_ptr&lt;string>'</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p1 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    p1<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-17"><a href="#ç»ƒä¹ 12-17" class="headerlink" title="ç»ƒä¹ 12.17"></a>ç»ƒä¹ 12.17</h2><blockquote><p>ä¸‹é¢çš„ <code>unique_ptr</code> å£°æ˜ä¸­ï¼Œå“ªäº›æ˜¯åˆæ³•çš„ï¼Œå“ªäº›å¯èƒ½å¯¼è‡´åç»­çš„ç¨‹åºé”™è¯¯ï¼Ÿè§£é‡Šæ¯ä¸ªé”™è¯¯çš„é—®é¢˜åœ¨å“ªé‡Œã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> ix <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token operator">*</span>pi <span class="token operator">=</span> <span class="token operator">&amp;</span>ix<span class="token punctuation">,</span> <span class="token operator">*</span>pi2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">typedef</span> unique_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> IntP<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> IntP <span class="token function">p0</span><span class="token punctuation">(</span>ix<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> IntP <span class="token function">p1</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> IntP <span class="token function">p2</span><span class="token punctuation">(</span>pi2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> IntP <span class="token function">p3</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ix<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> IntP <span class="token function">p4</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> IntP <span class="token function">p5</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ä¸åˆæ³•ã€‚åœ¨å®šä¹‰ä¸€ä¸ª <code>unique_ptr</code> æ—¶ï¼Œéœ€è¦å°†å…¶ç»‘å®šåˆ°ä¸€ä¸ª<code>new</code> è¿”å›çš„æŒ‡é’ˆä¸Šã€‚</li><li>(b) ä¸åˆæ³•ã€‚ç†ç”±åŒä¸Šã€‚</li><li>(c) åˆæ³•ã€‚ä½†æ˜¯ä¹Ÿå¯èƒ½ä¼šä½¿å¾— <code>pi2</code> æˆä¸ºç©ºæ‚¬æŒ‡é’ˆã€‚</li><li>(d) ä¸åˆæ³•ã€‚å½“ <code>p3</code> è¢«é”€æ¯æ—¶ï¼Œå®ƒè¯•å›¾é‡Šæ”¾ä¸€ä¸ªæ ˆç©ºé—´çš„å¯¹è±¡ã€‚</li><li>(e) åˆæ³•ã€‚</li><li>(f) ä¸åˆæ³•ã€‚<code>p5</code> å’Œ <code>p2</code> æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå½“ <code>p5</code> å’Œ <code>p2</code> è¢«é”€æ¯æ—¶ï¼Œä¼šä½¿å¾—åŒä¸€ä¸ªæŒ‡é’ˆè¢«é‡Šæ”¾ä¸¤æ¬¡ã€‚</li></ul><h2 id="ç»ƒä¹ 12-18"><a href="#ç»ƒä¹ 12-18" class="headerlink" title="ç»ƒä¹ 12.18"></a>ç»ƒä¹ 12.18</h2><blockquote><p><code>shared_ptr</code> ä¸ºä»€ä¹ˆæ²¡æœ‰ <code>release</code> æˆå‘˜ï¼Ÿ</p></blockquote><p><code>release</code> æˆå‘˜çš„ä½œç”¨æ˜¯æ”¾å¼ƒæ§åˆ¶æƒå¹¶è¿”å›æŒ‡é’ˆï¼Œå› ä¸ºåœ¨æŸä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª <code>unique_ptr</code> æŒ‡å‘æŸä¸ªå¯¹è±¡ï¼Œ<code>unique_ptr</code> ä¸èƒ½è¢«èµ‹å€¼ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ <code>release</code> æˆå‘˜å°†ä¸€ä¸ª <code>unique_ptr</code> çš„æŒ‡é’ˆçš„æ‰€æœ‰æƒä¼ é€’ç»™å¦ä¸€ä¸ª <code>unique_ptr</code>ã€‚è€Œ <code>shared_ptr</code> å…è®¸æœ‰å¤šä¸ª <code>shared_ptr</code> æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤ä¸éœ€è¦ <code>release</code> æˆå‘˜ã€‚</p><h2 id="ç»ƒä¹ 12-19"><a href="#ç»ƒä¹ 12-19" class="headerlink" title="ç»ƒä¹ 12.19"></a>ç»ƒä¹ 12.19</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>StrBlobPtr</code>ï¼Œæ›´æ–° <code>StrBlob</code> ç±»ï¼ŒåŠ å…¥æ°å½“çš„ <code>friend</code> å£°æ˜ä»¥åŠ <code>begin</code> å’Œ <code>end</code> æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdexcept></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlobPtr</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlob</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> size_type <span class="token operator">=</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">StrBlobPtr</span><span class="token punctuation">;</span>StrBlobPtr <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>StrBlobPtr <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">StrBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">StrBlob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>string<span class="token operator">></span> il<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>size_type <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"pop_back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>data<span class="token operator">-></span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> msg<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> data<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlobPtr</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">StrBlobPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">curr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">StrBlobPtr</span><span class="token punctuation">(</span>StrBlob <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> size_t sz <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">wptr</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">curr</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrBlobPtr<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> p<span class="token punctuation">.</span>curr <span class="token operator">!=</span> curr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>string<span class="token operator">&amp;</span> <span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"dereference past end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrBlobPtr<span class="token operator">&amp;</span> <span class="token function">incr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>curr<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> <span class="token function">check</span><span class="token punctuation">(</span>size_t i<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> ret <span class="token operator">=</span> wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"unbound StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> ret<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>weak_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> wptr<span class="token punctuation">;</span>size_t curr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>StrBlobPtr <span class="token class-name">StrBlob</span><span class="token operator">::</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">StrBlobPtr</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrBlobPtr <span class="token class-name">StrBlob</span><span class="token operator">::</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">StrBlobPtr</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-20"><a href="#ç»ƒä¹ 12-20" class="headerlink" title="ç»ƒä¹ 12.20"></a>ç»ƒä¹ 12.20</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œé€è¡Œè¯»å…¥ä¸€ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œå°†å†…å®¹å­˜å…¥ä¸€ä¸ª <code>StrBlob</code> ä¸­ï¼Œç”¨ä¸€ä¸ª <code>StrBlobPtr</code> æ‰“å°å‡º <code>StrBlob</code> ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"exercise12_19.h"</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"books.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>StrBlob sb<span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>sb<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>StrBlobPtr sbp <span class="token operator">=</span> sb<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> sbp <span class="token operator">!=</span> sb<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> sbp<span class="token punctuation">.</span><span class="token function">incr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> sbp<span class="token punctuation">.</span><span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-21"><a href="#ç»ƒä¹ 12-21" class="headerlink" title="ç»ƒä¹ 12.21"></a>ç»ƒä¹ 12.21</h2><blockquote><p>ä¹Ÿå¯ä»¥è¿™æ ·ç¼–å†™ <code>StrBlobPtr</code> çš„ <code>deref</code> æˆå‘˜ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"dereference past end"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½ è®¤ä¸ºå“ªä¸ªç‰ˆæœ¬æ›´å¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>åŸæ¥çš„ç‰ˆæœ¬æ›´å¥½ï¼Œå¯è¯»æ€§æ›´é«˜ã€‚</p><h2 id="ç»ƒä¹ 12-22"><a href="#ç»ƒä¹ 12-22" class="headerlink" title="ç»ƒä¹ 12.22"></a>ç»ƒä¹ 12.22</h2><blockquote><p>ä¸ºäº†èƒ½è®© <code>StrBlobPtr</code> ä½¿ç”¨ <code>const StrBlob</code>ï¼Œä½ è§‰å¾—åº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿå®šä¹‰ä¸€ä¸ªåä¸º<code>ConstStrBlobPtr</code> çš„ç±»ï¼Œä½¿å…¶èƒ½å¤ŸæŒ‡å‘ <code>const StrBlob</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ„é€ å‡½æ•°æ”¹ä¸ºæ¥å— <code>const Strblob &amp;</code> , ç„¶åç»™ <code>Strblob</code> ç±»æ·»åŠ ä¸¤ä¸ª <code>const</code> æˆå‘˜å‡½æ•° <code>cbegin</code> å’Œ <code>cend</code>ï¼Œè¿”å› <code>ConstStrBlobPtr</code>ã€‚</p><h2 id="ç»ƒä¹ 12-23"><a href="#ç»ƒä¹ 12-23" class="headerlink" title="ç»ƒä¹ 12.23"></a>ç»ƒä¹ 12.23</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²å­—é¢å¸¸é‡ï¼Œå°†ç»“æœä¿å­˜åœ¨ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„<code>char</code>æ•°ç»„ä¸­ã€‚é‡å†™è¿™ä¸ªç¨‹åºï¼Œè¿æ¥ä¸¤ä¸ªæ ‡å‡†åº“<code>string</code>å¯¹è±¡ã€‚</p></blockquote><p>è§£:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>c1 <span class="token operator">=</span> <span class="token string">"Hello "</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>c2 <span class="token operator">=</span> <span class="token string">"World"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcat_s</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> len<span class="token punctuation">,</span> c1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcat_s</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> len<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> r <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>string s1 <span class="token operator">=</span> <span class="token string">"Hello "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>string s2 <span class="token operator">=</span> <span class="token string">"World"</span><span class="token punctuation">;</span><span class="token function">strcpy_s</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token punctuation">(</span>s1 <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> r <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> r<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-24"><a href="#ç»ƒä¹ 12-24" class="headerlink" title="ç»ƒä¹ 12.24"></a>ç»ƒä¹ 12.24</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­˜å…¥ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„å­—ç¬¦æ•°ç»„ä¸­ã€‚æè¿°ä½ çš„ç¨‹åºå¦‚ä½•å¤„ç†å˜é•¿è¾“å…¥ã€‚æµ‹è¯•ä½ çš„ç¨‹åºï¼Œè¾“å…¥ä¸€ä¸ªè¶…å‡ºä½ åˆ†é…çš„æ•°ç»„é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"How long do you want the string? "</span><span class="token punctuation">;</span><span class="token keyword">int</span> size<span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> size<span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"input the string: "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> input<span class="token punctuation">;</span><span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-25"><a href="#ç»ƒä¹ 12-25" class="headerlink" title="ç»ƒä¹ 12.25"></a>ç»ƒä¹ 12.25</h2><blockquote><p>ç»™å®šä¸‹é¢çš„<code>new</code>è¡¨è¾¾å¼ï¼Œä½ åº”è¯¥å¦‚ä½•é‡Šæ”¾<code>pa</code>ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token operator">*</span>pa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> pa<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-26"><a href="#ç»ƒä¹ 12-26" class="headerlink" title="ç»ƒä¹ 12.26"></a>ç»ƒä¹ 12.26</h2><blockquote><p>ç”¨ <code>allocator</code> é‡å†™ç¬¬427é¡µä¸­çš„ç¨‹åºã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>allocator<span class="token operator">&lt;</span>string<span class="token operator">></span> alloc<span class="token punctuation">;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">auto</span> q <span class="token operator">=</span> p<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> q <span class="token operator">!=</span> p <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>q<span class="token operator">++</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>q <span class="token operator">!=</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span><span class="token operator">--</span>q <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-27"><a href="#ç»ƒä¹ 12-27" class="headerlink" title="ç»ƒä¹ 12.27"></a>ç»ƒä¹ 12.27</h2><blockquote><p><code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»åªä½¿ç”¨äº†æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡çš„è¯­è¨€å’Œæ ‡å‡†åº“ç‰¹æ€§ã€‚ä¸è¦æå‰çœ‹åç»­ç« èŠ‚å†…å®¹ï¼Œåªç”¨å·²ç»å­¦åˆ°çš„çŸ¥è¯†å¯¹è¿™ä¸¤ä¸ªç±»ç¼–å†™ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">EX12_27_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EX12_27_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token keyword">class</span> <span class="token class-name">QueryResult</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">TextQuery</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> line_no <span class="token operator">=</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">;</span><span class="token function">TextQuery</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ifstream<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>QueryResult <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span> file<span class="token punctuation">;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>set<span class="token operator">&lt;</span>line_no<span class="token operator">>></span><span class="token operator">></span> wm<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">QueryResult</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> QueryResult<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">QueryResult</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string s<span class="token punctuation">,</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>set<span class="token operator">&lt;</span>TextQuery<span class="token operator">::</span>line_no<span class="token operator">>></span> p<span class="token punctuation">,</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span> f<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">sought</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">lines</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">file</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>string sought<span class="token punctuation">;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>set<span class="token operator">&lt;</span>TextQuery<span class="token operator">::</span>line_no<span class="token operator">>></span> lines<span class="token punctuation">;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span> file<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> QueryResult<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_12_27.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token class-name">TextQuery</span><span class="token operator">::</span><span class="token function">TextQuery</span><span class="token punctuation">(</span>ifstream<span class="token operator">&amp;</span> ifs<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">file</span><span class="token punctuation">(</span><span class="token keyword">new</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string text<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>ifs<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>file<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> n <span class="token operator">=</span> file<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>istringstream <span class="token function">line</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>string word<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>line <span class="token operator">>></span> word<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span>lines <span class="token operator">=</span> wm<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lines<span class="token punctuation">)</span>lines<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token keyword">new</span> set<span class="token operator">&lt;</span>line_no<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>lines<span class="token operator">-></span><span class="token function">insert</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>QueryResult <span class="token class-name">TextQuery</span><span class="token operator">::</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">static</span> shared_ptr<span class="token operator">&lt;</span>set<span class="token operator">&lt;</span>line_no<span class="token operator">>></span> <span class="token function">nodata</span><span class="token punctuation">(</span><span class="token keyword">new</span> set<span class="token operator">&lt;</span>line_no<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> loc <span class="token operator">=</span> wm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>loc <span class="token operator">==</span> wm<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token function">QueryResult</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> nodata<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token function">QueryResult</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> loc<span class="token operator">-></span>second<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> QueryResult<span class="token operator">&amp;</span> qr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> qr<span class="token punctuation">.</span>sought <span class="token operator">&lt;&lt;</span> <span class="token string">" occurs "</span> <span class="token operator">&lt;&lt;</span> qr<span class="token punctuation">.</span>lines<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token operator">&lt;&lt;</span> <span class="token string">"time"</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>qr<span class="token punctuation">.</span>lines<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">"s"</span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> num <span class="token operator">:</span> <span class="token operator">*</span>qr<span class="token punctuation">.</span>lines<span class="token punctuation">)</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"\t(line "</span> <span class="token operator">&lt;&lt;</span> num <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token string">") "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span><span class="token punctuation">(</span>qr<span class="token punctuation">.</span>file<span class="token operator">-></span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> num<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_12_27.h"</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">runQueries</span><span class="token punctuation">(</span>ifstream<span class="token operator">&amp;</span> infile<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>TextQuery <span class="token function">tq</span><span class="token punctuation">(</span>infile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter word to look for, or q to quit: "</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span> <span class="token operator">||</span> s <span class="token operator">==</span> <span class="token string">"q"</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token function">print</span><span class="token punctuation">(</span>cout<span class="token punctuation">,</span> tq<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>ifstream <span class="token function">ifs</span><span class="token punctuation">(</span><span class="token string">"storyDataFile.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">runQueries</span><span class="token punctuation">(</span>ifs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-28"><a href="#ç»ƒä¹ 12-28" class="headerlink" title="ç»ƒä¹ 12.28"></a>ç»ƒä¹ 12.28</h2><blockquote><p>ç¼–å†™ç¨‹åºå®ç°æ–‡æœ¬æŸ¥è¯¢ï¼Œä¸è¦å®šä¹‰ç±»æ¥ç®¡ç†æ•°æ®ã€‚ä½ çš„ç¨‹åºåº”è¯¥æ¥å—ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸ç”¨æˆ·äº¤äº’æ¥æŸ¥è¯¢å•è¯ã€‚ä½¿ç”¨<code>vector</code>ã€<code>map</code> å’Œ <code>set</code> å®¹å™¨æ¥ä¿å­˜æ¥è‡ªæ–‡ä»¶çš„æ•°æ®å¹¶ç”ŸæˆæŸ¥è¯¢ç»“æœã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>shared_ptr<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>ifstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"H:/code/C++/Cpp_Primer_Answers/data/storyDataFile.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> input<span class="token punctuation">;</span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>set<span class="token operator">&lt;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span> dictionary<span class="token punctuation">;</span><span class="token keyword">decltype</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> lineNo<span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string line<span class="token punctuation">;</span> std<span class="token operator">::</span><span class="token function">getline</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>lineNo<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>input<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istringstream <span class="token function">line_stream</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>string text<span class="token punctuation">,</span> word<span class="token punctuation">;</span> line_stream <span class="token operator">>></span> text<span class="token punctuation">;</span> word<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span><span class="token function">remove_copy_if</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">back_inserter</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">,</span> ispunct<span class="token punctuation">)</span><span class="token punctuation">;</span>dictionary<span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>lineNo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter word to look for, or q to quit: "</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span> <span class="token operator">||</span> s <span class="token operator">==</span> <span class="token string">"q"</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">auto</span> found <span class="token operator">=</span> dictionary<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>found <span class="token operator">!=</span> dictionary<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" occurs "</span> <span class="token operator">&lt;&lt;</span> found<span class="token operator">-></span>second<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>found<span class="token operator">-></span>second<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string">" times"</span> <span class="token operator">:</span> <span class="token string">" time"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> found<span class="token operator">-></span>second<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\t(line "</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token string">") "</span> <span class="token operator">&lt;&lt;</span> input<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" occurs 0 time"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 12-29"><a href="#ç»ƒä¹ 12-29" class="headerlink" title="ç»ƒä¹ 12.29"></a>ç»ƒä¹ 12.29</h2><blockquote><p>æˆ‘ä»¬æ›¾ç»ç”¨<code>do while</code> å¾ªç¯æ¥ç¼–å†™ç®¡ç†ç”¨æˆ·äº¤äº’çš„å¾ªç¯ã€‚ç”¨<code>do while</code> é‡å†™æœ¬èŠ‚ç¨‹åºï¼Œè§£é‡Šä½ å€¾å‘äºå“ªä¸ªç‰ˆæœ¬ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"enter word to look for, or q to quit: "</span><span class="token punctuation">;</span>    string s<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> s<span class="token punctuation">)</span> <span class="token operator">||</span> s <span class="token operator">==</span> <span class="token string">"q"</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> tq<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token boolean">true</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘æ›´å–œæ¬¢ <code>while</code>ï¼Œè¿™å¯èƒ½æ˜¯ä¹ æƒ¯çš„é—®é¢˜ã€‚</p><h2 id="ç»ƒä¹ 12-30"><a href="#ç»ƒä¹ 12-30" class="headerlink" title="ç»ƒä¹ 12.30"></a>ç»ƒä¹ 12.30</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»ï¼Œå¹¶æ‰§è¡Œ12.3.1èŠ‚ä¸­çš„<code>runQueries</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><p>åŒ12.27ã€‚</p><h2 id="ç»ƒä¹ 12-31"><a href="#ç»ƒä¹ 12-31" class="headerlink" title="ç»ƒä¹ 12.31"></a>ç»ƒä¹ 12.31</h2><blockquote><p>å¦‚æœç”¨<code>vector</code> ä»£æ›¿ <code>set</code> ä¿å­˜è¡Œå·ï¼Œä¼šæœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿå“ªä¸ªæ–¹æ³•æ›´å¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>å¦‚æœç”¨ <code>vector</code> åˆ™ä¼šæœ‰å•è¯é‡å¤çš„æƒ…å†µå‡ºç°ã€‚è€Œè¿™é‡Œä¿å­˜çš„æ˜¯è¡Œå·ï¼Œä¸éœ€è¦é‡å¤å…ƒç´ ï¼Œæ‰€ä»¥ <code>set</code> æ›´å¥½ã€‚</p><h2 id="ç»ƒä¹ 12-32"><a href="#ç»ƒä¹ 12-32" class="headerlink" title="ç»ƒä¹ 12.32"></a>ç»ƒä¹ 12.32</h2><blockquote><p>é‡å†™ <code>TextQuery</code> å’Œ <code>QueryResult</code>ç±»ï¼Œç”¨<code>StrBlob</code> ä»£æ›¿ <code>vector&lt;string&gt;</code> ä¿å­˜è¾“å…¥æ–‡ä»¶ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»ä¸­çš„ <code>file</code> æˆå‘˜ï¼Œæ”¹ä¸º æŒ‡å‘ <code>StrBlob</code> çš„æ™ºèƒ½æŒ‡é’ˆã€‚åœ¨è®¿é—® <code>StrBlob</code> æ—¶ï¼Œè¦ä½¿ç”¨ <code>StrBlobPtr</code>ã€‚</p><h2 id="ç»ƒä¹ 12-33"><a href="#ç»ƒä¹ 12-33" class="headerlink" title="ç»ƒä¹ 12.33"></a>ç»ƒä¹ 12.33</h2><blockquote><p>åœ¨ç¬¬15ç« ä¸­æˆ‘ä»¬å°†æ‰©å±•æŸ¥è¯¢ç³»ç»Ÿï¼Œåœ¨ <code>QueryResult</code> ç±»ä¸­å°†ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„æˆå‘˜ã€‚æ·»åŠ åä¸º <code>begin</code> å’Œ <code>end</code> çš„æˆå‘˜ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘ä¸€ä¸ªç»™å®šæŸ¥è¯¢è¿”å›çš„è¡Œå·çš„ <code>set</code> ä¸­çš„ä½ç½®ã€‚å†æ·»åŠ ä¸€ä¸ªåä¸º <code>get_file</code> çš„æˆå‘˜ï¼Œè¿”å›ä¸€ä¸ª <code>shared_ptr</code>ï¼ŒæŒ‡å‘ <code>QueryResult</code> å¯¹è±¡ä¸­çš„æ–‡ä»¶ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">QueryResult</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> Iter <span class="token operator">=</span> std<span class="token operator">::</span>set<span class="token operator">&lt;</span>line_no<span class="token operator">></span><span class="token operator">::</span>iterator<span class="token punctuation">;</span><span class="token comment">// ...</span>Iter <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> lines<span class="token operator">-></span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>Iter <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> lines<span class="token operator">-></span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span> <span class="token function">get_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">>></span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// ...</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ17</title>
      <link href="2021/04/10/excersize/ch17/"/>
      <url>2021/04/10/excersize/ch17/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸ƒç« -æ ‡æ³¨åº“ç‰¹æ®Šè®¾æ–½"><a href="#ç¬¬åä¸ƒç« -æ ‡æ³¨åº“ç‰¹æ®Šè®¾æ–½" class="headerlink" title="ç¬¬åä¸ƒç«  æ ‡æ³¨åº“ç‰¹æ®Šè®¾æ–½"></a>ç¬¬åä¸ƒç«  æ ‡æ³¨åº“ç‰¹æ®Šè®¾æ–½</h1><h2 id="ç»ƒä¹ 17-1"><a href="#ç»ƒä¹ 17-1" class="headerlink" title="ç»ƒä¹ 17.1"></a>ç»ƒä¹ 17.1</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªä¿å­˜ä¸‰ä¸ª<code>int</code>å€¼çš„ <code>tuple</code>ï¼Œå¹¶å°†å…¶æˆå‘˜åˆ†åˆ«åˆå§‹åŒ–ä¸º10ã€20å’Œ30ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> t <span class="token operator">=</span> tuple<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-2"><a href="#ç»ƒä¹ 17-2" class="headerlink" title="ç»ƒä¹ 17.2"></a>ç»ƒä¹ 17.2</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª <code>tuple</code>ï¼Œä¿å­˜ä¸€ä¸ª <code>string</code>ã€ä¸€ä¸ª<code>vector&lt;string&gt;</code> å’Œä¸€ä¸ª <code>pair&lt;string, int&gt;</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> t <span class="token operator">=</span> tuple<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">,</span> pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-3"><a href="#ç»ƒä¹ 17-3" class="headerlink" title="ç»ƒä¹ 17.3"></a>ç»ƒä¹ 17.3</h2><blockquote><p>é‡å†™12.3èŠ‚ä¸­çš„ <code>TextQuery</code> ç¨‹åºï¼Œä½¿ç”¨ <code>tuple</code> ä»£æ›¿ <code>QueryResult</code> ç±»ã€‚ä½ è®¤ä¸ºå“ªç§è®¾è®¡æ›´å¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç¨‹åºç•¥ã€‚</p><p>æˆ‘è®¤ä¸º<code>tuple</code>æ›´æ–¹ä¾¿ã€‚</p><h2 id="ç»ƒä¹ 17-4"><a href="#ç»ƒä¹ 17-4" class="headerlink" title="ç»ƒä¹ 17.4"></a>ç»ƒä¹ 17.4</h2><blockquote><p>ç¼–å†™å¹¶æµ‹è¯•ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>findBook</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;tuple></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;numeric></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_17_4_SalesData.h"</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token comment">// matchesæœ‰ä¸‰ä¸ªæˆå‘˜ï¼š1.ä¸€ä¸ªä¹¦åº—çš„ç´¢å¼•ã€‚2.æŒ‡å‘ä¹¦åº—ä¸­å…ƒç´ çš„è¿­ä»£å™¨ã€‚3.æŒ‡å‘ä¹¦åº—ä¸­å…ƒç´ çš„è¿­ä»£å™¨ã€‚</span><span class="token keyword">typedef</span> tuple<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">,</span>              vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator<span class="token punctuation">,</span>              vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator<span class="token operator">></span>    matches<span class="token punctuation">;</span><span class="token comment">// filesä¿å­˜æ¯å®¶ä¹¦åº—çš„é”€å”®è®°å½•</span><span class="token comment">// findBookè¿”å›ä¸€ä¸ªvectorï¼Œæ¯å®¶é”€å”®äº†ç»™å®šä¹¦ç±çš„ä¹¦åº—åœ¨å…¶ä¸­éƒ½æœ‰ä¸€é¡¹</span>vector<span class="token operator">&lt;</span>matches<span class="token operator">></span> <span class="token function">findBook</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">>></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span>                         <span class="token keyword">const</span> string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span>matches<span class="token operator">></span> ret<span class="token punctuation">;</span> <span class="token comment">//åˆå§‹åŒ–ä¸ºç©ºvector</span>    <span class="token comment">// å¯¹æ¯å®¶ä¹¦åº—ï¼ŒæŸ¥æ‰¾ç»™å®šä¹¦ç±åŒ¹é…çš„è®°å½•èŒƒå›´</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span>cbegin<span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// æŸ¥æ‰¾å…·æœ‰ç›¸åŒISBNçš„Sales_dataèŒƒå›´ï¼Œfoundæ˜¯ä¸€ä¸ªè¿­ä»£å™¨pair</span>        <span class="token keyword">auto</span> found <span class="token operator">=</span> <span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span>  <span class="token comment">// æ­¤ä¹¦åº—é”€å”®äº†ç»™å®šä¹¦ç±</span>            <span class="token comment">// è®°ä½æ­¤ä¹¦åº—çš„ç´¢å¼•åŠåŒ¹é…çš„èŒƒå›´</span>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">make_tuple</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span> <span class="token comment">//å¦‚æœæœªæ‰¾åˆ°åŒ¹é…è®°å½•ï¼Œretä¸ºç©º</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">reportResults</span><span class="token punctuation">(</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">,</span> ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span>                       <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string s<span class="token punctuation">;</span>  <span class="token comment">//è¦æŸ¥æ‰¾çš„ä¹¦</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>in <span class="token operator">>></span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> trans <span class="token operator">=</span> <span class="token function">findBook</span><span class="token punctuation">(</span>files<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>trans<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" not found in any stores"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// è·å¾—ä¸‹ä¸€æœ¬è¦æŸ¥æ‰¾çš„ä¹¦</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>store <span class="token operator">:</span> trans<span class="token punctuation">)</span>  <span class="token comment">// å¯¹æ¯å®¶é”€å”®äº†ç»™å®šä¹¦ç±çš„ä¹¦åº—</span>            <span class="token comment">// get&lt;n>è¿”å›storeä¸­tupleçš„æŒ‡å®šçš„æˆå‘˜</span>            os <span class="token operator">&lt;&lt;</span> <span class="token string">"store "</span> <span class="token operator">&lt;&lt;</span> get<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" sales: "</span>               <span class="token operator">&lt;&lt;</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>get<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">,</span> get<span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">></span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-5"><a href="#ç»ƒä¹ 17-5" class="headerlink" title="ç»ƒä¹ 17.5"></a>ç»ƒä¹ 17.5</h2><blockquote><p>é‡å†™ <code>findBook</code>ï¼Œä»¤å…¶è¿”å›ä¸€ä¸ª <code>pair</code>ï¼ŒåŒ…å«ä¸€ä¸ªç´¢å¼•å’Œä¸€ä¸ªè¿­ä»£å™¨pairã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">,</span>                  std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator<span class="token punctuation">,</span>                            std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator<span class="token operator">>></span>                                                                      matches_pair<span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>matches_pair<span class="token operator">></span><span class="token function">findBook_pair</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span>              <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>matches_pair<span class="token operator">></span> ret<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> found <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                         std<span class="token operator">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-6"><a href="#ç»ƒä¹ 17-6" class="headerlink" title="ç»ƒä¹ 17.6"></a>ç»ƒä¹ 17.6</h2><blockquote><p>é‡å†™ <code>findBook</code>ï¼Œä¸ä½¿ç”¨<code>tuple</code>å’Œ<code>pair</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">matches_struct</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>size_type st<span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator first<span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator last<span class="token punctuation">;</span>    <span class="token function">matches_struct</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>size_type s<span class="token punctuation">,</span>                   std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator f<span class="token punctuation">,</span>                   std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token operator">::</span>const_iterator l<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">st</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">last</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>matches_struct<span class="token operator">></span><span class="token function">findBook_struct</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Sales_data<span class="token operator">></span> <span class="token operator">></span> <span class="token operator">&amp;</span>files<span class="token punctuation">,</span>                <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>matches_struct<span class="token operator">></span> ret<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> files<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> found <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">equal_range</span><span class="token punctuation">(</span>it<span class="token operator">-></span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token operator">-></span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">,</span> compareIsbn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>found<span class="token punctuation">.</span>first <span class="token operator">!=</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span>            ret<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">matches_struct</span><span class="token punctuation">(</span>it <span class="token operator">-</span> files<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> found<span class="token punctuation">.</span>first<span class="token punctuation">,</span> found<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-7"><a href="#ç»ƒä¹ 17-7" class="headerlink" title="ç»ƒä¹ 17.7"></a>ç»ƒä¹ 17.7</h2><blockquote><p>è§£é‡Šä½ æ›´å€¾å‘äºå“ªä¸ªç‰ˆæœ¬çš„<code>findBook</code>ï¼Œä¸ºä»€ä¹ˆã€‚</p></blockquote><p>è§£ï¼š</p><p>ä½¿ç”¨<code>tuple</code>çš„ç‰ˆæœ¬ã€‚å¾ˆæ˜æ˜¾æ›´åŠ çµæ´»æ–¹ä¾¿ã€‚</p><h2 id="ç»ƒä¹ 17-8"><a href="#ç»ƒä¹ 17-8" class="headerlink" title="ç»ƒä¹ 17.8"></a>ç»ƒä¹ 17.8</h2><blockquote><p>åœ¨æœ¬èŠ‚æœ€åä¸€æ®µä»£ç ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å°†<code>Sales_data()</code>ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™<code>accumulate</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç»“æœæ˜¯0ï¼Œä»¥ä¸º<code>Sales_data</code>æ˜¯é»˜è®¤åˆå§‹åŒ–çš„ã€‚</p><h2 id="ç»ƒä¹ 17-9"><a href="#ç»ƒä¹ 17-9" class="headerlink" title="ç»ƒä¹ 17.9"></a>ç»ƒä¹ 17.9</h2><blockquote><p>è§£é‡Šä¸‹åˆ—æ¯ä¸ª<code>bitset</code> å¯¹è±¡æ‰€åŒ…å«çš„ä½æ¨¡å¼ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> bitset<span class="token operator">&lt;</span><span class="token number">64</span><span class="token operator">></span> <span class="token function">bitvec</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 0000000000000000000000000000000000000000000000000000000000100000</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> <span class="token function">bv</span><span class="token punctuation">(</span><span class="token number">1010101</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 00000000000011110110100110110101</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> string bstr<span class="token punctuation">;</span> cin <span class="token operator">>></span> bstr<span class="token punctuation">;</span> bitset<span class="token operator">&lt;</span><span class="token number">8</span><span class="token operator">></span> <span class="token function">bv</span><span class="token punctuation">(</span>bstr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ ¹æ®è¾“å…¥çš„strè½¬æ¢æˆbitset</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-10"><a href="#ç»ƒä¹ 17-10" class="headerlink" title="ç»ƒä¹ 17.10"></a>ç»ƒä¹ 17.10</h2><blockquote><p>ä½¿ç”¨åºåˆ—1ã€2ã€3ã€5ã€8ã€13ã€21åˆå§‹åŒ–ä¸€ä¸ª<code>bitset</code>ï¼Œå°†è¿™äº›ä½ç½®ç½®ä½ã€‚å¯¹å¦ä¸€ä¸ª<code>bitset</code>è¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œå¹¶ç¼–å†™ä¸€å°æ®µç¨‹åºå°†å…¶æ°å½“çš„ä½ç½®ä½ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bitset></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">21</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> bset<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">:</span> v<span class="token punctuation">)</span>    bset<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>bitset<span class="token operator">&lt;</span><span class="token number">32</span><span class="token operator">></span> bset2<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        bset2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bset<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span>bset <span class="token operator">&lt;&lt;</span>std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span>bset2<span class="token operator">&lt;&lt;</span>std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-11"><a href="#ç»ƒä¹ 17-11" class="headerlink" title="ç»ƒä¹ 17.11"></a>ç»ƒä¹ 17.11</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ŒåŒ…å«ä¸€ä¸ªæ•´å‹å¯¹è±¡ï¼Œè®°å½•ä¸€ä¸ªåŒ…å«10ä¸ªé—®é¢˜çš„çœŸ/å‡æµ‹éªŒçš„è§£ç­”ã€‚å¦‚æœæµ‹éªŒåŒ…å«100é“é¢˜ï¼Œä½ éœ€è¦å¯¹æ•°æ®ç»“æ„åšå‡ºä»€ä¹ˆæ”¹å˜ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bitset></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token comment">//class Quiz</span><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t N<span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">Quiz</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token comment">//constructors</span>    <span class="token function">Quiz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Quiz</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bitquiz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token comment">//generate grade</span>    <span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t M<span class="token operator">></span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>size_t <span class="token function">grade</span><span class="token punctuation">(</span>Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//print</span>    <span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t M<span class="token operator">></span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//update bitset</span>    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>bitset<span class="token operator">&lt;</span>N<span class="token operator">></span> bitquiz<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t N<span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Quiz</span><span class="token operator">&lt;</span>N<span class="token operator">></span><span class="token operator">::</span><span class="token function">update</span><span class="token punctuation">(</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">></span> pair<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    bitquiz<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>pair<span class="token punctuation">.</span>first<span class="token punctuation">,</span> pair<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t M<span class="token operator">></span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> quiz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> quiz<span class="token punctuation">.</span>bitquiz<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t M<span class="token operator">></span>std<span class="token operator">::</span>size_t <span class="token function">grade</span><span class="token punctuation">(</span>Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> corAns<span class="token punctuation">,</span> Quiz<span class="token operator">&lt;</span>M<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> stuAns<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> result <span class="token operator">=</span> stuAns<span class="token punctuation">.</span>bitquiz <span class="token operator">^</span> corAns<span class="token punctuation">.</span>bitquiz<span class="token punctuation">;</span>    result<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//Ex17_11</span>    std<span class="token operator">::</span>string s <span class="token operator">=</span> <span class="token string">"1010101"</span><span class="token punctuation">;</span>    Quiz<span class="token operator">&lt;</span><span class="token number">10</span><span class="token operator">></span> <span class="token function">quiz</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> quiz <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">//EX17_12</span>    quiz<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">make_pair</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> quiz <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token comment">//Ex17_13</span>    std<span class="token operator">::</span>string answer <span class="token operator">=</span> <span class="token string">"10011"</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>string stu_answer <span class="token operator">=</span> <span class="token string">"11001"</span><span class="token punctuation">;</span>    Quiz<span class="token operator">&lt;</span><span class="token number">5</span><span class="token operator">></span> <span class="token function">ans</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">stu_ans</span><span class="token punctuation">(</span>stu_answer<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">grade</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> stu_ans<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-12"><a href="#ç»ƒä¹ 17-12" class="headerlink" title="ç»ƒä¹ 17.12"></a>ç»ƒä¹ 17.12</h2><blockquote><p>ä½¿ç”¨å‰ä¸€é¢˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªé—®é¢˜ç¼–å·å’Œä¸€ä¸ªè¡¨ç¤ºçœŸ/å‡è§£ç­”çš„å€¼ï¼Œå‡½æ•°æ ¹æ®è¿™ä¸¤ä¸ªå‚æ•°æ›´æ–°æµ‹éªŒçš„è§£ç­”ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.11ã€‚</p><h2 id="ç»ƒä¹ 17-13"><a href="#ç»ƒä¹ 17-13" class="headerlink" title="ç»ƒä¹ 17.13"></a>ç»ƒä¹ 17.13</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªæ•´å‹å¯¹è±¡ï¼ŒåŒ…å«çœŸ/å‡æµ‹éªŒçš„æ­£ç¡®ç­”æ¡ˆã€‚ä½¿ç”¨å®ƒæ¥ä¸ºå‰ä¸¤é¢˜ä¸­çš„æ•°æ®ç»“æ„ç”Ÿæˆæµ‹éªŒæˆç»©ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.11ã€‚</p><h2 id="ç»ƒä¹ 17-14"><a href="#ç»ƒä¹ 17-14" class="headerlink" title="ç»ƒä¹ 17.14"></a>ç»ƒä¹ 17.14</h2><blockquote><p>ç¼–å†™å‡ ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ†åˆ«è§¦å‘ä¸åŒé”™è¯¯ã€‚è¿è¡Œä½ çš„ç¨‹åºï¼Œè§‚å¯Ÿç¼–è¯‘å™¨å¯¹æ¯ä¸ªé”™è¯¯çš„è¾“å‡ºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>regex<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>regex_error<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// for ex17.14</span>    <span class="token comment">// error_brack</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        regex <span class="token function">r</span><span class="token punctuation">(</span><span class="token string">"[[:alnum:]+\\.(cpp|cxx|cc)$"</span><span class="token punctuation">,</span> regex<span class="token operator">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span><span class="token punctuation">(</span>regex_error e<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" code: "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// for ex17.15</span>    regex <span class="token function">r</span><span class="token punctuation">(</span><span class="token string">"[[:alpha:]]*[^c]ei[[:alpha:]]*"</span><span class="token punctuation">,</span> regex<span class="token operator">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span>    string s<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">regex_match</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is okay!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">else</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is not okay!"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token comment">// for ex17.16</span>    r<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token string">"[^c]ei"</span><span class="token punctuation">,</span> regex<span class="token operator">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>cin <span class="token operator">>></span> s <span class="token operator">&amp;&amp;</span> s <span class="token operator">!=</span> <span class="token string">"q"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">regex_match</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is okay!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token keyword">else</span>            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Input word "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" is not okay!"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a word! Input 'q' to quit!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-15"><a href="#ç»ƒä¹ 17-15" class="headerlink" title="ç»ƒä¹ 17.15"></a>ç»ƒä¹ 17.15</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œä½¿ç”¨æ¨¡å¼æŸ¥æ‰¾è¿åâ€œiåœ¨eä¹‹å‰ï¼Œé™¤éåœ¨cä¹‹åâ€è§„åˆ™çš„å•è¯ã€‚ä½ çš„ç¨‹åºåº”è¯¥æç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªå•è¯ï¼Œç„¶åæŒ‡å‡ºæ­¤å•è¯æ˜¯å¦ç¬¦å·è¦æ±‚ã€‚ç”¨ä¸€äº›è¿åå’Œæœªè¿åè§„åˆ™çš„å•è¯æµ‹è¯•ä½ çš„ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.14ã€‚</p><h2 id="ç»ƒä¹ 17-16"><a href="#ç»ƒä¹ 17-16" class="headerlink" title="ç»ƒä¹ 17.16"></a>ç»ƒä¹ 17.16</h2><blockquote><p>å¦‚æœå‰ä¸€é¢˜ç¨‹åºä¸­çš„<code>regex</code>å¯¹è±¡ç”¨<code>&quot;[^c]ei&quot;</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç”¨æ­¤æ¨¡å¼æµ‹è¯•ä½ çš„ç¨‹åºï¼Œæ£€æŸ¥ä½ çš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.14ã€‚</p><h2 id="ç»ƒä¹ 17-17"><a href="#ç»ƒä¹ 17-17" class="headerlink" title="ç»ƒä¹ 17.17"></a>ç»ƒä¹ 17.17</h2><blockquote><p>æ›´æ–°ä½ çš„ç¨‹åºï¼Œä»¤å®ƒæŸ¥æ‰¾è¾“å…¥åºåˆ—ä¸­æ‰€æœ‰è¿åâ€eiâ€è¯­æ³•è§„åˆ™çš„å•è¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>regex<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>sregex_iterator<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string s<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a sequence of words:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Word(s) that violiate the \"ei\" grammar rule:"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>string <span class="token function">pattern</span><span class="token punctuation">(</span><span class="token string">"[^c]ei"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>pattern <span class="token operator">=</span> <span class="token string">"[[:alpha:]]*"</span> <span class="token operator">+</span> pattern <span class="token operator">+</span> <span class="token string">"[[:alpha:]]*"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> regex<span class="token operator">::</span>icase<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-18"><a href="#ç»ƒä¹ 17-18" class="headerlink" title="ç»ƒä¹ 17.18"></a>ç»ƒä¹ 17.18</h2><blockquote><p>ä¿®æ”¹ä½ çš„ç¨‹åºï¼Œå¿½ç•¥åŒ…å«â€œei`ä½†å¹¶éæ‹¼å†™é”™è¯¯çš„å•è¯ï¼Œå¦‚â€œalbeitâ€å’Œâ€œneighborâ€ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.17ã€‚</p><h2 id="ç»ƒä¹ 17-19"><a href="#ç»ƒä¹ 17-19" class="headerlink" title="ç»ƒä¹ 17.19"></a>ç»ƒä¹ 17.19</h2><blockquote><p>ä¸ºä»€ä¹ˆå¯ä»¥ä¸å…ˆæ£€æŸ¥<code>m[4]</code>æ˜¯å¦åŒ¹é…äº†å°±ç›´æ¥è°ƒç”¨<code>m[4].str()</code>ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœä¸åŒ¹é…ï¼Œåˆ™<code>m[4].str()</code>è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p><h2 id="ç»ƒä¹ 17-20"><a href="#ç»ƒä¹ 17-20" class="headerlink" title="ç»ƒä¹ 17.20"></a>ç»ƒä¹ 17.20</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„éªŒè¯ç”µè¯å·ç çš„ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>regex<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>sregex_iterator<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>smatch<span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123; 3 &#125;)(\\))?([-. ])?(\\d&#123; 3 &#125;)([-. ]?)(\\d&#123; 4 &#125;)"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>smatch m<span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">bool</span> valid_record<span class="token punctuation">;</span><span class="token comment">// read each record from the input file</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>valid_record <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// for each matching phone number</span><span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>valid_record <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// check whether the number's formatting is valid</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"valid phone number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">else</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid phone number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>valid_record<span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid record!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// if there is an open parenthesis before the area code</span><span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span><span class="token comment">// the area code must be followed by a close parenthesis</span><span class="token comment">// and followed immediately by the rest of the number or a space</span><span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token comment">// then there can't be a close after the area code</span><span class="token comment">// the delimiters between the other two components must match</span><span class="token keyword">return</span> <span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-21"><a href="#ç»ƒä¹ 17-21" class="headerlink" title="ç»ƒä¹ 17.21"></a>ç»ƒä¹ 17.21</h2><blockquote><p>ä½¿ç”¨æœ¬èŠ‚å®šä¹‰çš„<code>valid</code> å‡½æ•°é‡å†™8.3.2èŠ‚ä¸­çš„ç”µè¯å·ç ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cerr<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>istream<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>ostream<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>ofstream<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>istringstream<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>ostringstream<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>regex<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>sregex_iterator<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>smatch<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">PersonInfo</span><span class="token punctuation">&#123;</span>    string name<span class="token punctuation">;</span>    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> phones<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">read_record</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">format_record</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// fake function that makes the program compile</span>string <span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> num<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span> people<span class="token punctuation">;</span>    string filename<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Please input a record file name: "</span><span class="token punctuation">;</span>    cin <span class="token operator">>></span> filename<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    ifstream <span class="token function">fin</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read_record</span><span class="token punctuation">(</span>fin<span class="token punctuation">,</span> people<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        ofstream <span class="token function">fout</span><span class="token punctuation">(</span><span class="token string">"data\\result.txt"</span><span class="token punctuation">,</span> ofstream<span class="token operator">::</span>trunc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">format_record</span><span class="token punctuation">(</span>fout<span class="token punctuation">,</span> people<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Fail to open file "</span> <span class="token operator">&lt;&lt;</span> filename <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// if there is an open parenthesis before the area code</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span>        <span class="token comment">// the area code must be followed by a close parenthesis</span>        <span class="token comment">// and followed immediately by the rest of the number or a space</span>        <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        <span class="token comment">// then there can't be a close after the area code</span>        <span class="token comment">// the delimiters between the other two components must match</span>        <span class="token keyword">return</span> <span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> m<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">read_record</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string line<span class="token punctuation">,</span> word<span class="token punctuation">;</span> <span class="token comment">// will hold a line and word from input, respectively</span>                           <span class="token comment">// read the input a line at a time until cin hits end-of-file (or another error)</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            PersonInfo info<span class="token punctuation">;</span> <span class="token comment">// create an object to hold this record's data</span>            istringstream <span class="token function">record</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bind record to the line we just read</span>            record <span class="token operator">>></span> info<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// read the name</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>record <span class="token operator">>></span> word<span class="token punctuation">)</span> <span class="token comment">// read the phone numbers</span>                info<span class="token punctuation">.</span>phones<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// and store them</span>            people<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// append this record to people</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">format_record</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> vector<span class="token operator">&lt;</span>PersonInfo<span class="token operator">></span><span class="token operator">&amp;</span> people<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123; 3 &#125;)(\\))?([-. ])?(\\d&#123; 3 &#125;)([-. ]?)(\\d&#123; 4 &#125;)"</span><span class="token punctuation">;</span>    regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>    smatch m<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>entry <span class="token operator">:</span> people<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// for each entry in people</span>        ostringstream formatted<span class="token punctuation">,</span> badNums<span class="token punctuation">;</span> <span class="token comment">// objects created on each loop</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>nums <span class="token operator">:</span> entry<span class="token punctuation">.</span>phones<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token comment">// for each number</span>                <span class="token comment">// check whether the number's formatting is valid</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token comment">// string in badNums</span>                    badNums <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> nums<span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token comment">// "writes" to formatted's string</span>                    formatted <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">format</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// there were no bad numbers</span>            os <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token comment">// print the name</span>            <span class="token operator">&lt;&lt;</span> formatted<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">// and reformatted numbers</span>        <span class="token keyword">else</span> <span class="token comment">// otherwise, print the name and bad numbers</span>            cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"input error: "</span> <span class="token operator">&lt;&lt;</span> entry<span class="token punctuation">.</span>name            <span class="token operator">&lt;&lt;</span> <span class="token string">" invalid number(s) "</span> <span class="token operator">&lt;&lt;</span> badNums<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-22"><a href="#ç»ƒä¹ 17-22" class="headerlink" title="ç»ƒä¹ 17.22"></a>ç»ƒä¹ 17.22</h2><blockquote><p>é‡å†™ä½ çš„ç”µè¯å·ç ç¨‹åºï¼Œä½¿ä¹‹å…è®¸åœ¨å·ç çš„ä¸‰ä¸ªéƒ¨åˆ†ä¹‹é—´æ”¾ç½®ä»»æ„å¤šä¸ªç©ºç™½ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.21ã€‚</p><h2 id="ç»ƒä¹ 17-23"><a href="#ç»ƒä¹ 17-23" class="headerlink" title="ç»ƒä¹ 17.23"></a>ç»ƒä¹ 17.23</h2><blockquote><p>ç¼–å†™æŸ¥æ‰¾é‚®æ”¿ç¼–ç çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¸€ä¸ªç¾å›½é‚®æ”¿ç¼–ç å¯ä»¥ç”±äº”ä½æˆ–ä¹ä½æ•°å­—ç»„æˆã€‚å‰äº”ä½æ•°å­—å’Œåå››ä½æ•°å­—ä¹‹é—´å¯ä»¥ç”¨ä¸€ä¸ªçŸ­æ¨ªçº¿åˆ†éš”ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>regex<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>sregex_iterator<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>smatch<span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>string zipcode <span class="token operator">=</span><span class="token string">"(\\d&#123;5&#125;)([-])?(\\d&#123;4&#125;)?\\b"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>zipcode<span class="token punctuation">)</span><span class="token punctuation">;</span>smatch m<span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//! for each matching zipcode number</span><span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span>it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//! check whether the number's formatting is valid</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">)</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"valid zipcode number: "</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token keyword">else</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"invalid zipcode number: "</span> <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token keyword">const</span> smatch<span class="token operator">&amp;</span> m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>m<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>matched<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-24"><a href="#ç»ƒä¹ 17-24" class="headerlink" title="ç»ƒä¹ 17.24"></a>ç»ƒä¹ 17.24</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„é‡æ‹ç”µè¯å·ç æ ¼å¼çš„ç¨‹åºã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>string pattern <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span>string format <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        cout<span class="token operator">&lt;&lt;</span><span class="token function">regex_replace</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>r<span class="token punctuation">,</span>format<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-25"><a href="#ç»ƒä¹ 17-25" class="headerlink" title="ç»ƒä¹ 17.25"></a>ç»ƒä¹ 17.25</h2><blockquote><p>é‡å†™ä½ çš„ç”µè¯å·ç ç¨‹åºï¼Œä½¿ä¹‹åªè¾“å‡ºæ¯ä¸ªäººçš„ç¬¬ä¸€ä¸ªç”µè¯å·ç ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>string pattern <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span>string fmt <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        smatch result<span class="token punctuation">;</span>        <span class="token function">regex_search</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>result<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>        cout<span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">prefix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"Sorry, No match."</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-26"><a href="#ç»ƒä¹ 17-26" class="headerlink" title="ç»ƒä¹ 17.26"></a>ç»ƒä¹ 17.26</h2><blockquote><p>é‡å†™ä½ çš„ç”µè¯å·ç ç¨‹åºï¼Œä½¿ä¹‹å¯¹å¤šäºä¸€ä¸ªç”µè¯å·ç çš„äººåªè¾“å‡ºç¬¬äºŒä¸ªå’Œåç»­å·ç ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 17-27"><a href="#ç»ƒä¹ 17-27" class="headerlink" title="ç»ƒä¹ 17.27"></a>ç»ƒä¹ 17.27</h2><blockquote><p>ç¼–å†™ç¨‹åºï¼Œå°†ä¹ä½æ•°å­—é‚®æ”¿ç¼–ç çš„æ ¼å¼è½¬æ¢ä¸º <code>ddddd-dddd</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;regex></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>string pattern <span class="token operator">=</span> <span class="token string">"(\\d&#123;5&#125;)([.- ])?(\\d&#123;4&#125;)"</span><span class="token punctuation">;</span>string fmt <span class="token operator">=</span> <span class="token string">"$1-$3"</span><span class="token punctuation">;</span>regex <span class="token function">r</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>string s<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        smatch result<span class="token punctuation">;</span>        <span class="token function">regex_search</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>result<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            cout<span class="token operator">&lt;&lt;</span>result<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>fmt<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"Sorry, No match."</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-28"><a href="#ç»ƒä¹ 17-28" class="headerlink" title="ç»ƒä¹ 17.28"></a>ç»ƒä¹ 17.28</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ç”Ÿæˆå¹¶è¿”å›ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœº<code>unsigned int</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;random></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span><span class="token comment">// default version</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// with seed spicified</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// with seed and range spicified</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> min<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string temp<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> temp<span class="token punctuation">)</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>hex <span class="token operator">&lt;&lt;</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>default_random_engine e<span class="token punctuation">;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> ud<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>default_random_engine <span class="token function">e</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> ud<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token function">random_gen</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> seed<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> min<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> max<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>default_random_engine <span class="token function">e</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> std<span class="token operator">::</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">ud</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">ud</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-29"><a href="#ç»ƒä¹ 17-29" class="headerlink" title="ç»ƒä¹ 17.29"></a>ç»ƒä¹ 17.29</h2><blockquote><p>ä¿®æ”¹ä¸Šä¸€é¢˜ä¸­ç¼–å†™çš„å‡½æ•°ï¼Œå…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªç§å­ä½œä¸ºå¯é€‰å‚æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.28ã€‚</p><h2 id="ç»ƒä¹ 17-30"><a href="#ç»ƒä¹ 17-30" class="headerlink" title="ç»ƒä¹ 17.30"></a>ç»ƒä¹ 17.30</h2><blockquote><p>å†æ¬¡ä¿®æ”¹ä½ çš„ç¨‹åºï¼Œæ­¤æ¬¡å¢åŠ ä¸¤ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå‡½æ•°å…è®¸è¿”å›çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.28ã€‚</p><h2 id="ç»ƒä¹ 17-31"><a href="#ç»ƒä¹ 17-31" class="headerlink" title="ç»ƒä¹ 17.31"></a>ç»ƒä¹ 17.31</h2><blockquote><p>å¯¹äºæœ¬èŠ‚ä¸­çš„æ¸¸æˆç¨‹åºï¼Œå¦‚æœåœ¨<code>do</code>å¾ªç¯å†…å®šä¹‰<code>b</code>å’Œ<code>e</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç”±äºå¼•æ“è¿”å›ç›¸åŒçš„éšæœºæ•°åºåˆ—ï¼Œå› æ­¤çœ‰ä¸å¾ªç¯éƒ½ä¼šåˆ›å»ºæ–°çš„å¼•æ“ï¼Œçœ‰ä¸å¾ªç¯éƒ½ä¼šç”Ÿæˆç›¸åŒçš„å€¼ã€‚</p><h2 id="ç»ƒä¹ 17-32"><a href="#ç»ƒä¹ 17-32" class="headerlink" title="ç»ƒä¹ 17.32"></a>ç»ƒä¹ 17.32</h2><blockquote><p>å¦‚æœæˆ‘ä»¬åœ¨å¾ªç¯å†…å®šä¹‰<code>resp</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šæŠ¥é”™ï¼Œ<code>while</code>æ¡ä»¶ä¸­ç”¨åˆ°äº†<code>resp</code>ã€‚</p><h2 id="ç»ƒä¹ 17-33"><a href="#ç»ƒä¹ 17-33" class="headerlink" title="ç»ƒä¹ 17.33"></a>ç»ƒä¹ 17.33</h2><blockquote><p>ä¿®æ”¹11.3.6èŠ‚ä¸­çš„å•è¯è½¬æ¢ç¨‹åºï¼Œå…è®¸å¯¹ä¸€ä¸ªç»™å®šå•è¯æœ‰å¤šç§è½¬æ¢æ–¹å¼ï¼Œæ¯æ¬¡éšæœºé€‰æ‹©ä¸€ç§è¿›è¡Œå®é™…è½¬æ¢ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>ifstream<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;random></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>default_random_engine<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>uniform_int_distribution<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctime></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>time<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>sort<span class="token punctuation">;</span><span class="token keyword">using</span> std<span class="token operator">::</span>find_if<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;utility></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>pair<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">typedef</span> pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> ps<span class="token punctuation">;</span>ifstream <span class="token function">i</span><span class="token punctuation">(</span><span class="token string">"d.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span>ps<span class="token operator">></span> dict<span class="token punctuation">;</span>string str1<span class="token punctuation">,</span> str2<span class="token punctuation">;</span><span class="token comment">// read wirds from dictionary</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">>></span> str1 <span class="token operator">>></span> str2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>dict<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>i<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// sort words in vector</span><span class="token function">sort</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps1<span class="token punctuation">,</span> <span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps1<span class="token punctuation">.</span>first <span class="token operator">&lt;</span> _ps2<span class="token punctuation">.</span>first<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"i.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>default_random_engine <span class="token function">e</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// read words from text</span><span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">>></span> str1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// find word in dictionary</span>vector<span class="token operator">&lt;</span>ps<span class="token operator">></span><span class="token operator">::</span>const_iterator it <span class="token operator">=</span> <span class="token function">find_if</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span><span class="token operator">&amp;</span>str1<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps<span class="token punctuation">.</span>first <span class="token operator">==</span> str1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// if word doesn't exist in dictionary</span><span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">==</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// write it itself</span>cout <span class="token operator">&lt;&lt;</span> str1 <span class="token operator">&lt;&lt;</span> <span class="token string">' '</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// get random meaning of word </span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">u</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">find_if</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dict<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>str1<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> ps <span class="token operator">&amp;</span>_ps<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> _ps<span class="token punctuation">.</span>first <span class="token operator">></span> str1<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">-</span> it <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// write random meaning</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>it <span class="token operator">+</span> <span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span>second <span class="token operator">&lt;&lt;</span> <span class="token string">' '</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-34"><a href="#ç»ƒä¹ 17-34" class="headerlink" title="ç»ƒä¹ 17.34"></a>ç»ƒä¹ 17.34</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨è¡¨17.17å’Œè¡¨17.18ä¸­çš„æ¯ä¸ªæ“ä½œç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 17-35"><a href="#ç»ƒä¹ 17-35" class="headerlink" title="ç»ƒä¹ 17.35"></a>ç»ƒä¹ 17.35</h2><blockquote><p>ä¿®æ”¹ç¬¬670é¡µä¸­çš„ç¨‹åºï¼Œæ‰“å°2çš„å¹³æ–¹æ ¹ï¼Œä½†è¿™æ¬¡æ‰“å°åå…­è¿›åˆ¶æ•°å­—çš„å¤§å†™å½¢å¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iomanip></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span><span class="token string">"default format: "</span> <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"scientific: "</span> <span class="token operator">&lt;&lt;</span> scientific <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"fixed decimal: "</span> <span class="token operator">&lt;&lt;</span> fixed <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"hexidecimal: "</span> <span class="token operator">&lt;&lt;</span> uppercase <span class="token operator">&lt;&lt;</span> hexfloat <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> <span class="token string">"use defaults: "</span> <span class="token operator">&lt;&lt;</span> defaultfloat <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//17.36</span><span class="token comment">//Modify the program from the previous exercise to print the various floating-point values so that they line up in a column.</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iomanip></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span>left<span class="token operator">&lt;&lt;</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"default format:"</span> <span class="token operator">&lt;&lt;</span><span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> right<span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"scientific:"</span> <span class="token operator">&lt;&lt;</span> scientific <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"fixed decimal:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> fixed <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"hexidecimal:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> uppercase <span class="token operator">&lt;&lt;</span> hexfloat <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'\n'</span><span class="token operator">&lt;&lt;</span> left <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"use defaults:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">setw</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> defaultfloat <span class="token operator">&lt;&lt;</span> right <span class="token operator">&lt;&lt;</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-36"><a href="#ç»ƒä¹ 17-36" class="headerlink" title="ç»ƒä¹ 17.36"></a>ç»ƒä¹ 17.36</h2><blockquote><p>ä¿®æ”¹ä¸Šä¸€é¢˜ä¸­çš„ç¨‹åºï¼Œæ‰“å°ä¸åŒçš„æµ®ç‚¹æ•°ï¼Œä½¿å®ƒä»¬æ’æˆä¸€åˆ—ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.36ã€‚</p><h2 id="ç»ƒä¹ 17-37"><a href="#ç»ƒä¹ 17-37" class="headerlink" title="ç»ƒä¹ 17.37"></a>ç»ƒä¹ 17.37</h2><blockquote><p>ç”¨æœªæ ¼å¼åŒ–ç‰ˆæœ¬çš„<code>getline</code> é€è¡Œè¯»å–ä¸€ä¸ªæ–‡ä»¶ã€‚æµ‹è¯•ä½ çš„ç¨‹åºï¼Œç»™å®šä¸€ä¸ªæ–‡ä»¶ï¼Œæ—¢åŒ…å«ç©ºè¡ŒåˆåŒ…å«é•¿åº¦è¶…è¿‡ä½ ä¼ é€’ç»™<code>geiline</code>çš„å­—ç¬¦æ•°ç»„å¤§å°çš„è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//17.37</span><span class="token comment">//Use the unformatted version of getline to read a file a line at a time.</span><span class="token comment">//Test your program by giving it a file that contains empty lines as well as lines that are</span><span class="token comment">//longer than the character array that you pass to getline.</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iomanip></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token comment">//int main () &#123;</span><span class="token comment">//  ifstream myfile("F:\\Git\\Cpp-Primer\\ch17\\17_37_38\\test.txt");</span><span class="token comment">//  if (myfile) cout &lt;&lt; 1 &lt;&lt; endl;</span><span class="token comment">//  char sink [250];</span><span class="token comment">//</span><span class="token comment">//  while(myfile.getline(sink,250))</span><span class="token comment">//  &#123;</span><span class="token comment">//    cout &lt;&lt; sink &lt;&lt; endl;</span><span class="token comment">//  &#125;</span><span class="token comment">//  return 0;</span><span class="token comment">//&#125;</span><span class="token comment">//17.38</span><span class="token comment">//Extend your program from the previous exercise to print each word you read onto its own line.</span><span class="token comment">//#include &lt;iostream></span><span class="token comment">//#include &lt;fstream></span><span class="token comment">//#include &lt;iomanip></span><span class="token comment">//</span><span class="token comment">//using namespace std;</span><span class="token comment">//</span><span class="token comment">//int main () &#123;</span><span class="token comment">//  ifstream myfile ("F:\\Git\\Cpp-Primer\\ch17\\17_37_38\\test.txt");</span><span class="token comment">//  char sink [250];</span><span class="token comment">//</span><span class="token comment">//  while(myfile.getline(sink,250,' '))</span><span class="token comment">//  &#123;</span><span class="token comment">//    cout &lt;&lt; sink &lt;&lt; endl;</span><span class="token comment">//  &#125;</span><span class="token comment">//  return 0;</span><span class="token comment">//&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Output!\n"</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Error!\n"</span><span class="token punctuation">;</span>std<span class="token operator">::</span>clog <span class="token operator">&lt;&lt;</span> <span class="token string">"Standard Log??\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 17-38"><a href="#ç»ƒä¹ 17-38" class="headerlink" title="ç»ƒä¹ 17.38"></a>ç»ƒä¹ 17.38</h2><blockquote><p>æ‰©å±•ä¸Šä¸€é¢˜ä¸­ä½ çš„ç¨‹åºï¼Œå°†è¯»å…¥çš„æ¯ä¸ªå•è¯æ‰“å°åˆ°å®ƒæ‰€åœ¨çš„è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ17.37ã€‚</p><h2 id="ç»ƒä¹ 17-39"><a href="#ç»ƒä¹ 17-39" class="headerlink" title="ç»ƒä¹ 17.39"></a>ç»ƒä¹ 17.39</h2><blockquote><p>å¯¹æœ¬èŠ‚ç»™å‡ºçš„ <code>seek</code>ç¨‹åºï¼Œç¼–å†™ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ15</title>
      <link href="2021/04/10/excersize/ch15/"/>
      <url>2021/04/10/excersize/ch15/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åäº”ç« -é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡"><a href="#ç¬¬åäº”ç« -é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡" class="headerlink" title="ç¬¬åäº”ç«  é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡"></a>ç¬¬åäº”ç«  é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡</h1><h2 id="ç»ƒä¹ 15-1"><a href="#ç»ƒä¹ 15-1" class="headerlink" title="ç»ƒä¹ 15.1"></a>ç»ƒä¹ 15.1</h2><blockquote><p>ä»€ä¹ˆæ˜¯è™šæˆå‘˜ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¯¹äºæŸäº›å‡½æ•°ï¼ŒåŸºç±»å¸Œæœ›å®ƒçš„æ´¾ç”Ÿç±»å„è‡ªå®šä¹‰é€‚åˆè‡ªèº«çš„ç‰ˆæœ¬ï¼Œæ­¤æ—¶åŸºç±»å°±å°†è¿™äº›å‡½æ•°å£°æ˜æˆè™šå‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 15-2"><a href="#ç»ƒä¹ 15-2" class="headerlink" title="ç»ƒä¹ 15.2"></a>ç»ƒä¹ 15.2</h2><blockquote><p><code>protected</code> è®¿é—®è¯´æ˜ç¬¦ä¸ <code>private</code> æœ‰ä½•åŒºåˆ«ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li><code>protected</code> ï¼š åŸºç±»å’Œå’Œå…¶æ´¾ç”Ÿç±»è¿˜æœ‰å‹å…ƒå¯ä»¥è®¿é—®ã€‚</li><li><code>private</code> ï¼š åªæœ‰åŸºç±»æœ¬èº«å’Œå‹å…ƒå¯ä»¥è®¿é—®ã€‚</li></ul><h2 id="ç»ƒä¹ 15-3"><a href="#ç»ƒä¹ 15-3" class="headerlink" title="ç»ƒä¹ 15.3"></a>ç»ƒä¹ 15.3</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±çš„ <code>Quote</code> ç±»å’Œ <code>print_total</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Quote</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Quote</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">price</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> n <span class="token operator">*</span> price<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">double</span>  price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_15_3.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token keyword">double</span> <span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> item<span class="token punctuation">,</span> size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote <span class="token operator">&amp;</span>item<span class="token punctuation">,</span> size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">double</span> ret <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">net_price</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"ISBN:"</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> <span class="token string">"# sold: "</span> <span class="token operator">&lt;&lt;</span> n <span class="token operator">&lt;&lt;</span> <span class="token string">" total due: "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-4"><a href="#ç»ƒä¹ 15-4" class="headerlink" title="ç»ƒä¹ 15.4"></a>ç»ƒä¹ 15.4</h2><blockquote><p>ä¸‹é¢å“ªæ¡å£°æ˜è¯­å¥æ˜¯ä¸æ­£ç¡®çš„ï¼Ÿè¯·è§£é‡ŠåŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Derived</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">private</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ä¸æ­£ç¡®ã€‚ç±»ä¸èƒ½æ´¾ç”Ÿè‡ªèº«ã€‚</li><li>(b) ä¸æ­£ç¡®ã€‚è¿™æ˜¯å®šä¹‰è€Œéå£°æ˜ã€‚</li><li>(c) ä¸æ­£ç¡®ã€‚æ´¾ç”Ÿåˆ—è¡¨ä¸èƒ½å‡ºç°åœ¨è¿™ã€‚</li></ul><h2 id="ç»ƒä¹ 15-5"><a href="#ç»ƒä¹ 15-5" class="headerlink" title="ç»ƒä¹ 15.5"></a>ç»ƒä¹ 15.5</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±çš„ <code>Bulk_quote</code> ç±»ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_15_3.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Bulk_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t q<span class="token punctuation">,</span> <span class="token keyword">double</span> disc<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">Quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">min_qty</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">discount</span><span class="token punctuation">(</span>disc<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>size_t min_qty <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">double</span>      discount <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-6"><a href="#ç»ƒä¹ 15-6" class="headerlink" title="ç»ƒä¹ 15.6"></a>ç»ƒä¹ 15.6</h2><blockquote><p>å°† <code>Quote</code> å’Œ <code>Bulk_quote</code> çš„å¯¹è±¡ä¼ ç»™15.2.1èŠ‚ç»ƒä¹ ä¸­çš„ <code>print_total</code> å‡½æ•°ï¼Œæ£€æŸ¥è¯¥å‡½æ•°æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_15_3.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_15_5.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">double</span> <span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> item<span class="token punctuation">,</span> size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// ex15.6</span>Quote <span class="token function">q</span><span class="token punctuation">(</span><span class="token string">"textbook"</span><span class="token punctuation">,</span> <span class="token number">10.60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Bulk_quote <span class="token function">bq</span><span class="token punctuation">(</span><span class="token string">"textbook"</span><span class="token punctuation">,</span> <span class="token number">10.60</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> bq<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">print_total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote <span class="token operator">&amp;</span>item<span class="token punctuation">,</span> size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">double</span> ret <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">net_price</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"ISBN:"</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span> <span class="token string">"# sold: "</span> <span class="token operator">&lt;&lt;</span> n <span class="token operator">&lt;&lt;</span> <span class="token string">" total due: "</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-7"><a href="#ç»ƒä¹ 15-7" class="headerlink" title="ç»ƒä¹ 15.7"></a>ç»ƒä¹ 15.7</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªç±»ä½¿å…¶å®ç°ä¸€ç§æ•°é‡å—é™çš„æŠ˜æ‰£ç­–ç•¥ï¼Œå…·ä½“ç­–ç•¥æ˜¯ï¼šå½“è´­ä¹°ä¹¦ç±çš„æ•°é‡ä¸è¶…è¿‡ä¸€ä¸ªç»™å®šçš„é™é‡æ—¶äº«å—æŠ˜æ‰£ï¼Œå¦‚æœè´­ä¹°é‡ä¸€æ—¦è¶…è¿‡äº†é™é‡ï¼Œåˆ™è¶…å‡ºçš„éƒ¨åˆ†å°†ä»¥åŸä»·é”€å”®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_15_5.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Limit_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Limit_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Limit_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t max<span class="token punctuation">,</span> <span class="token keyword">double</span> disc<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">Quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">max_qty</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">discount</span><span class="token punctuation">(</span>disc<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>size_t max_qty <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">double</span>      discount <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">double</span> <span class="token class-name">Limit_quote</span><span class="token operator">::</span><span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> max_qty<span class="token punctuation">)</span><span class="token keyword">return</span> max_qty <span class="token operator">*</span> price <span class="token operator">*</span> discount <span class="token operator">+</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> max_qty<span class="token punctuation">)</span> <span class="token operator">*</span> price<span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> n <span class="token operator">*</span> discount <span class="token operator">*</span>price<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-8"><a href="#ç»ƒä¹ 15-8" class="headerlink" title="ç»ƒä¹ 15.8"></a>ç»ƒä¹ 15.8</h2><blockquote><p>ç»™å‡ºé™æ€ç±»å‹å’ŒåŠ¨æ€ç±»å‹çš„å®šä¹‰ã€‚</p></blockquote><p>è§£ï¼š</p><p>è¡¨è¾¾å¼çš„é™æ€ç±»å‹åœ¨ç¼–è¯‘æ—¶æ€»æ˜¯å·²çŸ¥çš„ï¼Œå®ƒæ˜¯å˜é‡å£°æ˜æ—¶çš„ç±»å‹æˆ–è¡¨è¾¾å¼ç”Ÿæˆçš„ç±»å‹ã€‚åŠ¨æ€ç±»å‹åˆ™æ˜¯å˜é‡æˆ–è¡¨è¾¾å¼è¡¨ç¤ºçš„å†…å­˜ä¸­çš„å¯¹è±¡çš„ç±»å‹ã€‚åŠ¨æ€ç±»å‹ç›´åˆ°è¿è¡Œæ—¶æ‰å¯çŸ¥ã€‚</p><h2 id="ç»ƒä¹ 15-9"><a href="#ç»ƒä¹ 15-9" class="headerlink" title="ç»ƒä¹ 15.9"></a>ç»ƒä¹ 15.9</h2><blockquote><p>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹è¡¨è¾¾å¼çš„é™æ€ç±»å‹å¯èƒ½ä¸åŠ¨æ€ç±»å‹ä¸åŒï¼Ÿè¯·ç»™å‡ºä¸‰ä¸ªé™æ€ç±»å‹ä¸åŠ¨æ€ç±»å‹ä¸åŒçš„ä¾‹å­ã€‚</p></blockquote><p>è§£ï¼š</p><p>åŸºç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨çš„é™æ€ç±»å‹å¯èƒ½ä¸å…¶åŠ¨æ€ç±»å‹ä¸ä¸€è‡´ã€‚</p><h2 id="ç»ƒä¹ 15-10"><a href="#ç»ƒä¹ 15-10" class="headerlink" title="ç»ƒä¹ 15.10"></a>ç»ƒä¹ 15.10</h2><blockquote><p>å›å¿†æˆ‘ä»¬åœ¨8.1èŠ‚è¿›è¡Œçš„è®¨è®ºï¼Œè§£é‡Šç¬¬284é¡µä¸­å°† <code>ifstream</code> ä¼ é€’ç»™ <code>Sales_data</code> çš„<code>read</code> å‡½æ•°çš„ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>std::ifstream</code> æ˜¯ <code>std::istream</code> çš„æ´¾ç”ŸåŸºç±»ï¼Œå› æ­¤ <code>read</code> å‡½æ•°èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</p><h2 id="ç»ƒä¹ 15-11"><a href="#ç»ƒä¹ 15-11" class="headerlink" title="ç»ƒä¹ 15.11"></a>ç»ƒä¹ 15.11</h2><blockquote><p>ä¸ºä½ çš„ <code>Quote</code> ç±»ä½“ç³»æ·»åŠ ä¸€ä¸ªåä¸º <code>debug</code> çš„è™šå‡½æ•°ï¼Œä»¤å…¶åˆ†åˆ«æ˜¾ç¤ºæ¯ä¸ªç±»çš„æ•°æ®æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">Quote</span><span class="token operator">::</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"data members of this class:\n"</span>              <span class="token operator">&lt;&lt;</span> <span class="token string">"bookNo= "</span> <span class="token operator">&lt;&lt;</span><span class="token keyword">this</span><span class="token operator">-></span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span>              <span class="token operator">&lt;&lt;</span> <span class="token string">"price= "</span> <span class="token operator">&lt;&lt;</span><span class="token keyword">this</span><span class="token operator">-></span>price<span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-12"><a href="#ç»ƒä¹ 15-12" class="headerlink" title="ç»ƒä¹ 15.12"></a>ç»ƒä¹ 15.12</h2><blockquote><p>æœ‰å¿…è¦å°†ä¸€ä¸ªæˆå‘˜å‡½æ•°åŒæ—¶å£°æ˜æˆ <code>override</code> å’Œ <code>final</code> å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æœ‰å¿…è¦ã€‚<code>override</code> çš„å«ä¹‰æ˜¯é‡å†™åŸºç±»ä¸­ç›¸åŒåç§°çš„è™šå‡½æ•°ï¼Œ<code>final</code> æ˜¯é˜»æ­¢å®ƒçš„æ´¾ç”Ÿç±»é‡å†™å½“å‰è™šå‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 15-13"><a href="#ç»ƒä¹ 15-13" class="headerlink" title="ç»ƒä¹ 15.13"></a>ç»ƒä¹ 15.13</h2><blockquote><p>ç»™å®šä¸‹é¢çš„ç±»ï¼Œè§£é‡Šæ¯ä¸ª <code>print</code> å‡½æ•°çš„æœºç†ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">base</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>string <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> basename<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> os <span class="token operator">&lt;&lt;</span> basename<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>string basename<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">base</span></span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> os <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­å­˜åœ¨é—®é¢˜å—ï¼Ÿå¦‚æœæœ‰ï¼Œä½ è¯¥å¦‚ä½•ä¿®æ”¹å®ƒï¼Ÿ</p><p>è§£ï¼š</p><p>æœ‰é—®é¢˜ã€‚åº”è¯¥æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> override <span class="token punctuation">&#123;</span> base<span class="token operator">::</span><span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> os <span class="token operator">&lt;&lt;</span> <span class="token string">" derived\n "</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-14"><a href="#ç»ƒä¹ 15-14" class="headerlink" title="ç»ƒä¹ 15.14"></a>ç»ƒä¹ 15.14</h2><blockquote><p>ç»™å®šä¸Šä¸€é¢˜ä¸­çš„ç±»ä»¥åŠä¸‹é¢è¿™äº›å¯¹è±¡ï¼Œè¯´æ˜åœ¨è¿è¡Œæ—¶è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">base bobj<span class="token punctuation">;</span> base <span class="token operator">*</span>bp1 <span class="token operator">=</span> <span class="token operator">&amp;</span>bobj<span class="token punctuation">;</span> base <span class="token operator">&amp;</span>br1 <span class="token operator">=</span> bobj<span class="token punctuation">;</span>derived dobj<span class="token punctuation">;</span> base <span class="token operator">*</span>bp2 <span class="token operator">=</span> <span class="token operator">&amp;</span>dobj<span class="token punctuation">;</span> base <span class="token operator">&amp;</span>br2 <span class="token operator">=</span> dobj<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> bobj<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>dobj<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>bp1<span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>bp2<span class="token operator">-></span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>br1<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span>br2<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ç¼–è¯‘æ—¶ã€‚</li><li>(b) ç¼–è¯‘æ—¶ã€‚</li><li>(c) ç¼–è¯‘æ—¶ã€‚</li><li>(d) ç¼–è¯‘æ—¶ã€‚</li><li>(e) è¿è¡Œæ—¶ã€‚<code>base::print()</code></li><li>(f) è¿è¡Œæ—¶ã€‚<code>derived::print()</code></li></ul><h2 id="ç»ƒä¹ 15-15"><a href="#ç»ƒä¹ 15-15" class="headerlink" title="ç»ƒä¹ 15.15"></a>ç»ƒä¹ 15.15</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±çš„ <code>Disc_quote</code> å’Œ <code>Bulk_quote</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Disc_quote</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"quote.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Disc_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Disc_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Disc_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t q<span class="token punctuation">,</span> <span class="token keyword">double</span> d<span class="token punctuation">)</span> <span class="token operator">:</span>        <span class="token function">Quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">quantity</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">discount</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>   <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span>    std<span class="token operator">::</span>size_t quantity<span class="token punctuation">;</span>    <span class="token keyword">double</span>      discount<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Bulk_quote</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Bulk_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Disc_quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t q<span class="token punctuation">,</span> <span class="token keyword">double</span> disc<span class="token punctuation">)</span> <span class="token operator">:</span>        <span class="token function">Disc_quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> disc<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span>    <span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span>    <span class="token keyword">void</span>  <span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-16"><a href="#ç»ƒä¹ 15-16" class="headerlink" title="ç»ƒä¹ 15.16"></a>ç»ƒä¹ 15.16</h2><blockquote><p>æ”¹å†™ä½ åœ¨15.2.2èŠ‚ç»ƒä¹ ä¸­ç¼–å†™çš„æ•°é‡å—é™çš„æŠ˜æ‰£ç­–ç•¥ï¼Œä»¤å…¶ç»§æ‰¿ <code>Disc_quote</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Limit_quote</code>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Limit_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Disc_quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Limit_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Limit_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t max<span class="token punctuation">,</span> <span class="token keyword">double</span> disc<span class="token punctuation">)</span><span class="token operator">:</span>        <span class="token function">Disc_quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> max<span class="token punctuation">,</span> disc<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span>    <span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override    <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> n <span class="token operator">*</span> price <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> quantity <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">-</span> discount <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-17"><a href="#ç»ƒä¹ 15-17" class="headerlink" title="ç»ƒä¹ 15.17"></a>ç»ƒä¹ 15.17</h2><blockquote><p>å°è¯•å®šä¹‰ä¸€ä¸ª <code>Disc_quote</code> çš„å¯¹è±¡ï¼Œçœ‹çœ‹ç¼–è¯‘å™¨ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p><code>error: cannot declare variable &#39;d&#39; to be of abstract type &#39;Disc_quote&#39;: Disc_quote d;</code></p><h2 id="ç»ƒä¹ 15-18"><a href="#ç»ƒä¹ 15-18" class="headerlink" title="ç»ƒä¹ 15.18"></a>ç»ƒä¹ 15.18</h2><blockquote><p>å‡è®¾ç»™å®šäº†ç¬¬543é¡µå’Œç¬¬544é¡µçš„ç±»ï¼ŒåŒæ—¶å·²çŸ¥æ¯ä¸ªå¯¹è±¡çš„ç±»å‹å¦‚æ³¨é‡Šæ‰€ç¤ºï¼Œåˆ¤æ–­ä¸‹é¢çš„å“ªäº›èµ‹å€¼è¯­å¥æ˜¯åˆæ³•çš„ã€‚è§£é‡Šé‚£äº›ä¸åˆæ³•çš„è¯­å¥ä¸ºä»€ä¹ˆä¸è¢«å…è®¸ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Base <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>d1<span class="token punctuation">;</span>  <span class="token comment">//d1 çš„ç±»å‹æ˜¯ Pub_Derv</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>d2<span class="token punctuation">;</span><span class="token comment">//d2 çš„ç±»å‹æ˜¯ Priv_Derv</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>d3<span class="token punctuation">;</span><span class="token comment">//d3 çš„ç±»å‹æ˜¯ Prot_Derv</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd1<span class="token punctuation">;</span><span class="token comment">//dd1 çš„ç±»å‹æ˜¯ Derived_from_Public</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd2<span class="token punctuation">;</span><span class="token comment">//dd2 çš„ç±»å‹æ˜¯ Derived_from_Private</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd3<span class="token punctuation">;</span><span class="token comment">//dd3 çš„ç±»å‹æ˜¯ Derived_from_Protected</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Base <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>d1<span class="token punctuation">;</span> åˆæ³•p <span class="token operator">=</span> <span class="token operator">&amp;</span>d2<span class="token punctuation">;</span> ä¸åˆæ³•p <span class="token operator">=</span> <span class="token operator">&amp;</span>d3<span class="token punctuation">;</span> ä¸åˆæ³•p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd1<span class="token punctuation">;</span> åˆæ³•p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd2<span class="token punctuation">;</span> ä¸åˆæ³•p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd3<span class="token punctuation">;</span> ä¸åˆæ³•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªæœ‰åœ¨æ´¾ç”Ÿç±»æ˜¯ä½¿ç”¨<code>public</code>çš„æ–¹å¼ç»§æ‰¿åŸºç±»æ—¶ï¼Œç”¨æˆ·ä»£ç æ‰å¯ä»¥ä½¿ç”¨æ´¾ç”Ÿç±»åˆ°åŸºç±»ï¼ˆ<code>derived-to-base</code>ï¼‰çš„è½¬æ¢ã€‚</p><h2 id="ç»ƒä¹ 15-19"><a href="#ç»ƒä¹ 15-19" class="headerlink" title="ç»ƒä¹ 15.19"></a>ç»ƒä¹ 15.19</h2><blockquote><p>å‡è®¾543é¡µå’Œ544é¡µçš„æ¯ä¸ªç±»éƒ½æœ‰å¦‚ä¸‹å½¢å¼çš„æˆå‘˜å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äºæ¯ä¸ªç±»ï¼Œåˆ†åˆ«åˆ¤æ–­ä¸Šé¢çš„å‡½æ•°æ˜¯å¦åˆæ³•ã€‚</p><p>è§£ï¼š</p><p>åˆæ³•ï¼š</p><ul><li>Pub_Derv</li><li>Priv_Derv</li><li>Prot_Derv</li><li>Derived_from_Public</li><li>Derived_from_Protected<br>ä¸åˆæ³•ï¼š</li><li>Derived_from_Private</li></ul><p>è¿™æ®µä»£ç æ˜¯åœ¨æˆå‘˜å‡½æ•°ä¸­ä½¿ç”¨<code>Base</code>ã€‚<code>Priv_Drev</code>ä¸­çš„<code>Base</code>éƒ¨åˆ†è™½ç„¶æ˜¯<code>private</code>çš„ï¼Œä½†å…¶æˆå‘˜å‡½æ•°ä¾ç„¶å¯ä»¥è®¿é—®ï¼›<code>Derived_from_Private</code>ç»§æ‰¿è‡ª<code>Priv_Drev</code>ï¼Œä¸èƒ½è®¿é—®<code>Priv_Drev</code>ä¸­çš„<code>private</code>æˆå‘˜ï¼Œå› æ­¤ä¸åˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 15-20"><a href="#ç»ƒä¹ 15-20" class="headerlink" title="ç»ƒä¹ 15.20"></a>ç»ƒä¹ 15.20</h2><blockquote><p>ç¼–å†™ä»£ç æ£€éªŒä½ å¯¹å‰é¢ä¸¤é¢˜çš„å›ç­”æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"exercise15_5.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"bulk_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"limit_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token function">pub_mem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// public member</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">int</span> prot_mem<span class="token punctuation">;</span>     <span class="token comment">// protected member</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">char</span> priv_mem<span class="token punctuation">;</span>    <span class="token comment">// private member</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Pub_Derv</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span>    <span class="token class-name">Base</span></span><span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Priv_Derv</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">private</span>   <span class="token class-name">Base</span></span><span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Prot_Derv</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">protected</span> <span class="token class-name">Base</span></span><span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived_from_Public</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Pub_Derv</span></span><span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived_from_Private</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Priv_Derv</span></span><span class="token punctuation">&#123;</span><span class="token comment">//void memfcn(Base &amp;b) &#123; b = *this; &#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Derived_from_Protected</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Prot_Derv</span></span><span class="token punctuation">&#123;</span><span class="token keyword">void</span> <span class="token function">memfcn</span><span class="token punctuation">(</span>Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Pub_Derv d1<span class="token punctuation">;</span>Base <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>d1<span class="token punctuation">;</span>Priv_Derv d2<span class="token punctuation">;</span><span class="token comment">//p = &amp;d2;</span>Prot_Derv d3<span class="token punctuation">;</span><span class="token comment">//p = &amp;d3;</span>Derived_from_Public dd1<span class="token punctuation">;</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>dd1<span class="token punctuation">;</span>Derived_from_Private dd2<span class="token punctuation">;</span><span class="token comment">//p =&amp; dd2;</span>Derived_from_Protected dd3<span class="token punctuation">;</span><span class="token comment">//p = &amp;dd3;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-21"><a href="#ç»ƒä¹ 15-21" class="headerlink" title="ç»ƒä¹ 15.21"></a>ç»ƒä¹ 15.21</h2><blockquote><p>ä»ä¸‹é¢è¿™äº›ä¸€èˆ¬æ€§æŠ½è±¡æ¦‚å¿µä¸­ä»»é€‰ä¸€ä¸ªï¼ˆæˆ–è€…é€‰ä¸€ä¸ªä½ è‡ªå·±çš„ï¼‰ï¼Œå°†å…¶å¯¹åº”çš„ä¸€ç»„ç±»å‹ç»„ç»‡æˆä¸€ä¸ªç»§æ‰¿ä½“ç³»ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> å›¾å½¢æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚gifã€tiffã€jpegã€bmpï¼‰<span class="token punctuation">(</span>b<span class="token punctuation">)</span> å›¾å½¢åŸºå…ƒï¼ˆå¦‚æ–¹æ ¼ã€åœ†ã€çƒã€åœ†é”¥ï¼‰<span class="token punctuation">(</span>c<span class="token punctuation">)</span> C<span class="token operator">++</span>è¯­è¨€ä¸­çš„ç±»å‹ï¼ˆå¦‚ç±»ã€å‡½æ•°ã€æˆå‘˜å‡½æ•°ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"bulk_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"limit_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token comment">// just for 2D shape</span><span class="token keyword">class</span> <span class="token class-name">Shape</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">typedef</span> std<span class="token operator">::</span>pair<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token operator">></span>    Coordinate<span class="token punctuation">;</span>    <span class="token function">Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Shape</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> n<span class="token punctuation">)</span> <span class="token operator">:</span>        <span class="token function">name</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">perimeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Shape</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> n<span class="token punctuation">,</span>              <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> a<span class="token punctuation">,</span>              <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> b<span class="token punctuation">,</span>              <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> c<span class="token punctuation">,</span>              <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token operator">:</span>        <span class="token function">Shape</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">b</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">c</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">d</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span>    Coordinate  a<span class="token punctuation">;</span>    Coordinate  b<span class="token punctuation">;</span>    Coordinate  c<span class="token punctuation">;</span>    Coordinate  d<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Square</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Rectangle</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Square</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Square</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> n<span class="token punctuation">,</span>           <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> a<span class="token punctuation">,</span>           <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> b<span class="token punctuation">,</span>           <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> c<span class="token punctuation">,</span>           <span class="token keyword">const</span> Coordinate<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token operator">:</span>        <span class="token function">Rectangle</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">Square</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-22"><a href="#ç»ƒä¹ 15-22" class="headerlink" title="ç»ƒä¹ 15.22"></a>ç»ƒä¹ 15.22</h2><blockquote><p>å¯¹äºä½ åœ¨ä¸Šä¸€é¢˜ä¸­é€‰æ‹©çš„ç±»ï¼Œä¸ºå…¶æ·»åŠ å‡½æ•°çš„è™šå‡½æ•°åŠå…¬æœ‰æˆå‘˜å’Œå—ä¿æŠ¤çš„æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ15.21ã€‚</p><h2 id="ç»ƒä¹ 15-23"><a href="#ç»ƒä¹ 15-23" class="headerlink" title="ç»ƒä¹ 15.23"></a>ç»ƒä¹ 15.23</h2><blockquote><p>å‡è®¾ç¬¬550é¡µçš„ <code>D1</code> ç±»éœ€è¦è¦†ç›–å®ƒç»§æ‰¿è€Œæ¥çš„ <code>fcn</code> å‡½æ•°ï¼Œä½ åº”è¯¥å¦‚ä½•å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Ÿå¦‚æœä½ ä¿®æ”¹ä¹‹å <code>fcn</code> åŒ¹é…äº† <code>Base</code> ä¸­çš„å®šä¹‰ï¼Œåˆ™è¯¥èŠ‚çš„é‚£äº›è°ƒç”¨è¯­å¥å°†å¦‚ä½•è§£æï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç§»é™¤ <code>int</code> å‚æ•°ã€‚</p><h2 id="ç»ƒä¹ 15-24"><a href="#ç»ƒä¹ 15-24" class="headerlink" title="ç»ƒä¹ 15.24"></a>ç»ƒä¹ 15.24</h2><blockquote><p>å“ªç§ç±»éœ€è¦è™šææ„å‡½æ•°ï¼Ÿè™šææ„å‡½æ•°å¿…é¡»æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>åŸºç±»é€šå¸¸åº”è¯¥å®šä¹‰ä¸€ä¸ªè™šææ„å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 15-25"><a href="#ç»ƒä¹ 15-25" class="headerlink" title="ç»ƒä¹ 15.25"></a>ç»ƒä¹ 15.25</h2><blockquote><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸º <code>Disc_quote</code> å®šä¹‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼Ÿå¦‚æœå»æ‰è¯¥æ„é€ å‡½æ•°çš„è¯ä¼šå¯¹ <code>Bulk_quote</code> çš„è¡Œä¸ºäº§ç”Ÿä»€ä¹ˆå½±å“ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸º<code>Disc_quote</code>çš„é»˜è®¤æ„é€ å‡½æ•°ä¼šè¿è¡Œ<code>Quote</code>çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè€Œ<code>Quote</code>é»˜è®¤æ„é€ å‡½æ•°ä¼šå®Œæˆæˆå‘˜çš„åˆå§‹åŒ–å·¥ä½œã€‚<br>å¦‚æœå»é™¤æ‰è¯¥æ„é€ å‡½æ•°çš„è¯ï¼Œ<code>Bulk_quote</code>çš„é»˜è®¤æ„é€ å‡½æ•°è€Œæ— æ³•å®Œæˆ<code>Disc_quote</code>çš„åˆå§‹åŒ–å·¥ä½œã€‚</p><h2 id="ç»ƒä¹ 15-26"><a href="#ç»ƒä¹ 15-26" class="headerlink" title="ç»ƒä¹ 15.26"></a>ç»ƒä¹ 15.26</h2><blockquote><p>å®šä¹‰ <code>Quote</code> å’Œ <code>Bulk_quote</code> çš„æ‹·è´æ§åˆ¶æˆå‘˜ï¼Œä»¤å…¶ä¸åˆæˆçš„ç‰ˆæœ¬è¡Œä¸ºä¸€è‡´ã€‚ä¸ºè¿™äº›æˆå‘˜ä»¥åŠå…¶ä»–æ„é€ å‡½æ•°æ·»åŠ æ‰“å°çŠ¶æ€çš„è¯­å¥ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤ŸçŸ¥é“æ­£åœ¨è¿è¡Œå“ªä¸ªç¨‹åºã€‚ä½¿ç”¨è¿™äº›ç±»ç¼–å†™ç¨‹åºï¼Œé¢„æµ‹ç¨‹åºå°†åˆ›å»ºå’Œé”€æ¯å“ªäº›å¯¹è±¡ã€‚é‡å¤å®éªŒï¼Œä¸æ–­æ¯”è¾ƒä½ çš„é¢„æµ‹å’Œå®é™…è¾“å‡ºç»“æœæ˜¯å¦ç›¸åŒï¼Œç›´åˆ°é¢„æµ‹å®Œå…¨å‡†ç¡®å†ç»“æŸã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Quote</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Quote</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"default constructing Quote\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">price</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Quote : constructor taking 2 parameters\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// copy constructor</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> q<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">bookNo</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">price</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Quote: copy constructing\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move constructor</span><span class="token function">Quote</span><span class="token punctuation">(</span>Quote<span class="token operator">&amp;&amp;</span> q<span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token operator">:</span> <span class="token function">bookNo</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">price</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Quote: move constructing\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// copy =</span>Quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">!=</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>bookNo <span class="token operator">=</span> rhs<span class="token punctuation">.</span>bookNo<span class="token punctuation">;</span>price <span class="token operator">=</span> rhs<span class="token punctuation">.</span>price<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Quote: copy =() \n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move =</span>Quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>Quote<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span>  <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">!=</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>bookNo <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span><span class="token punctuation">;</span>price <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Quote: move =!!!!!!!!! \n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string     <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">virtual</span> <span class="token keyword">double</span>  <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> n <span class="token operator">*</span> price<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">virtual</span> <span class="token keyword">void</span>    <span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destructing Quote\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">double</span>  price <span class="token operator">=</span> <span class="token number">10.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">inline</span><span class="token keyword">operator</span> <span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>bookNo <span class="token operator">!=</span> rhs<span class="token punctuation">.</span>bookNo<span class="token operator">&amp;&amp;</span>lhs<span class="token punctuation">.</span>price <span class="token operator">!=</span> rhs<span class="token punctuation">.</span>price<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Bulk_quote</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Disc_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Bulk_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Disc_quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"default constructing Bulk_quote\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t q<span class="token punctuation">,</span> <span class="token keyword">double</span> disc<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">Disc_quote</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> disc<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : constructor taking 4 parameters\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// copy constructor</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> Bulk_quote<span class="token operator">&amp;</span> bq<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Disc_quote</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : copy constructor\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move constructor</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span>Bulk_quote<span class="token operator">&amp;&amp;</span> bq<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Disc_quote</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : move constructor\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// copy =()</span>Bulk_quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Bulk_quote<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Disc_quote<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : copy =()\n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move =()</span>Bulk_quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>Bulk_quote<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span>Disc_quote<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : move =()\n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token keyword">void</span>  <span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override<span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destructing Bulk_quote\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¨‹åºè¾“å‡ºç»“æœï¼š</p><pre class="line-numbers language-none"><code class="language-none">default constructing Quotedefault constructing Disc_quotedefault constructing Bulk_quoteQuote : constructor taking 2 parametersDisc_quote : constructor taking 4 parameters.Bulk_quote : constructor taking 4 parametersQuote: copy constructingQuote: copy constructingdestructing Quotedestructing QuoteDisc_quote : move &#x3D;()Bulk_quote : move &#x3D;()destructing Bulk_quotedestructing Dis_quotedestructing Quotedestructing Bulk_quotedestructing Dis_quotedestructing Quote<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-27"><a href="#ç»ƒä¹ 15-27" class="headerlink" title="ç»ƒä¹ 15.27"></a>ç»ƒä¹ 15.27</h2><blockquote><p>é‡æ–°å®šä¹‰ä½ çš„ <code>Bulk_quote</code> ç±»ï¼Œä»¤å…¶ç»§æ‰¿æ„é€ å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Bulk_quote</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Disc_quote</span></span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"default constructing Bulk_quote\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// changed the below to the inherited constructor for ex15.27.</span><span class="token comment">// rules:  1. only inherit from the direct base class.</span><span class="token comment">//         2. default, copy and move constructors can not inherit.</span><span class="token comment">//         3. any data members of its own are default initialized.</span><span class="token comment">//         4. the rest details are in the section section 15.7.4.</span><span class="token comment">/*Bulk_quote(const std::string&amp; b, double p, std::size_t q, double disc) :Disc_quote(b, p, q, disc) &#123; std::cout &lt;&lt; "Bulk_quote : constructor taking 4 parameters\n"; &#125;*/</span><span class="token keyword">using</span> Disc_quote<span class="token operator">::</span>Disc_quote<span class="token punctuation">;</span><span class="token comment">// copy constructor</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token keyword">const</span> Bulk_quote<span class="token operator">&amp;</span> bq<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Disc_quote</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : copy constructor\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move constructor</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span>Bulk_quote<span class="token operator">&amp;&amp;</span> bq<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Disc_quote</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>bq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : move constructor\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// copy =()</span>Bulk_quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Bulk_quote<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Disc_quote<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : copy =()\n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move =()</span>Bulk_quote<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>Bulk_quote<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Disc_quote<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Bulk_quote : move =()\n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token keyword">void</span>  <span class="token function">debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> override<span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override<span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destructing Bulk_quote\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-28"><a href="#ç»ƒä¹ 15-28" class="headerlink" title="ç»ƒä¹ 15.28"></a>ç»ƒä¹ 15.28</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªå­˜æ”¾ <code>Quote</code> å¯¹è±¡çš„ <code>vector</code>ï¼Œå°† <code>Bulk_quote</code> å¯¹è±¡ä¼ å…¥å…¶ä¸­ã€‚è®¡ç®— <code>vector</code> ä¸­æ‰€æœ‰å…ƒç´ æ€»çš„ <code>net_price</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"bulk_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"limit_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">/*** @brief ex15.28   outcome == 9090*/</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Quote<span class="token operator">></span> v<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token string">"sss"</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">10.1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> b <span class="token operator">:</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>total <span class="token operator">+=</span> b<span class="token punctuation">.</span><span class="token function">net_price</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"======================\n\n"</span><span class="token punctuation">;</span><span class="token comment">/*** @brief ex15.29   outccome == 6363*/</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">>></span> pv<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>pv<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>Bulk_quote<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token string">"sss"</span><span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">10.1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> total_p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">:</span> pv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>total_p <span class="token operator">+=</span> p<span class="token operator">-></span><span class="token function">net_price</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> total_p <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-29"><a href="#ç»ƒä¹ 15-29" class="headerlink" title="ç»ƒä¹ 15.29"></a>ç»ƒä¹ 15.29</h2><blockquote><p>å†è¿è¡Œä¸€æ¬¡ä½ çš„ç¨‹åºï¼Œè¿™æ¬¡ä¼ å…¥ <code>Quote</code> å¯¹è±¡çš„ <code>shared_ptr</code> ã€‚å¦‚æœè¿™æ¬¡è®¡ç®—å‡ºçš„æ€»é¢ä¸ä¹‹å‰çš„ä¸ä¸€è‡´ï¼Œè§£é‡Šä¸ºä»€ä¹ˆ;å¦‚æœä¸€ç›´ï¼Œä¹Ÿè¯·è¯´æ˜åŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºæ™ºèƒ½æŒ‡é’ˆå¯¼è‡´äº†å¤šæ€æ€§çš„äº§ç”Ÿï¼Œæ‰€ä»¥è¿™æ¬¡è®¡ç®—çš„æ€»é¢ä¸ä¸€è‡´ã€‚</p><h2 id="ç»ƒä¹ 15-30"><a href="#ç»ƒä¹ 15-30" class="headerlink" title="ç»ƒä¹ 15.30"></a>ç»ƒä¹ 15.30</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±çš„ <code>Basket</code> ç±»ï¼Œç”¨å®ƒè®¡ç®—ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­äº¤æ˜“è®°å½•çš„æ€»ä»·æ ¼ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Basket h</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token comment">// è´­ç‰©ç¯®</span><span class="token comment">// a basket of objects from Quote hierachy, using smart pointers.</span><span class="token keyword">class</span> <span class="token class-name">Basket</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token comment">// Basketä½¿ç”¨åˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°å’Œæ‹·è´æ§åˆ¶æˆå‘˜</span><span class="token comment">// copy verison</span><span class="token keyword">void</span> <span class="token function">add_item</span><span class="token punctuation">(</span><span class="token keyword">const</span> Quote<span class="token operator">&amp;</span> sale<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>items<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">></span><span class="token punctuation">(</span>sale<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move version</span><span class="token keyword">void</span> <span class="token function">add_item</span><span class="token punctuation">(</span>Quote<span class="token operator">&amp;&amp;</span> sale<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>items<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">></span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>sale<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// æ‰“å°æ¯æœ¬ä¹¦çš„æ€»ä»·å’Œè´­ç‰©ç¯®ä¸­æ‰€æœ‰ä¹¦çš„æ€»ä»·</span><span class="token keyword">double</span> <span class="token function">total_receipt</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// function to compare needed by the multiset member</span><span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span><span class="token keyword">const</span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token operator">-></span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> rhs<span class="token operator">-></span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// hold multiple quotes, ordered by the compare member</span>std<span class="token operator">::</span>multiset<span class="token operator">&lt;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Quote<span class="token operator">></span><span class="token punctuation">,</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>compare<span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">></span>items<span class="token punctuation">&#123;</span> compare <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Basket cpp</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"basket.h"</span></span><span class="token keyword">double</span> <span class="token class-name">Basket</span><span class="token operator">::</span><span class="token function">total_receipt</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>  <span class="token comment">// ä¿å­˜å®æ—¶è®¡ç®—å‡ºçš„æ€»ä»·æ ¼</span><span class="token comment">// iteræŒ‡å‘ISBNç›¸åŒçš„ä¸€æ‰¹å…ƒç´ ä¸­çš„ç¬¬ä¸€ä¸ª</span><span class="token comment">// upper_boundè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨æŒ‡å‘è¿™æ‰¹å…ƒç´ çš„å°¾åä½ç½®</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> iter <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter <span class="token operator">!=</span> items<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>iter <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">upper_bound</span><span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//  ^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="token comment">// @note   this increment moves iter to the first element with key</span><span class="token comment">//         greater than  *iter.</span><span class="token punctuation">&#123;</span>sum <span class="token operator">+=</span> <span class="token function">print_total</span><span class="token punctuation">(</span>os<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>iter<span class="token punctuation">,</span> items<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>                                   <span class="token comment">// ^^^^^^^^^^^^^ using count to fetch</span><span class="token comment">// the number of the same book.</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"Total Sale: "</span> <span class="token operator">&lt;&lt;</span> sum <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>main</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"bulk_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"limit_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"disc_quote.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"basket.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Basket basket<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>basket<span class="token punctuation">.</span><span class="token function">add_item</span><span class="token punctuation">(</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token string">"Bible"</span><span class="token punctuation">,</span> <span class="token number">20.6</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>basket<span class="token punctuation">.</span><span class="token function">add_item</span><span class="token punctuation">(</span><span class="token function">Bulk_quote</span><span class="token punctuation">(</span><span class="token string">"C++Primer"</span><span class="token punctuation">,</span> <span class="token number">30.9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>basket<span class="token punctuation">.</span><span class="token function">add_item</span><span class="token punctuation">(</span><span class="token function">Quote</span><span class="token punctuation">(</span><span class="token string">"CLRS"</span><span class="token punctuation">,</span> <span class="token number">40.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ofstream <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"log.txt"</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>app <span class="token operator">|</span> std<span class="token operator">::</span>ios_base<span class="token operator">::</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>basket<span class="token punctuation">.</span><span class="token function">total_receipt</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-31"><a href="#ç»ƒä¹ 15-31" class="headerlink" title="ç»ƒä¹ 15.31"></a>ç»ƒä¹ 15.31</h2><blockquote><p>å·²çŸ¥ <code>s1</code>ã€<code>s2</code>ã€<code>s3</code> å’Œ <code>s4</code> éƒ½æ˜¯ <code>string</code>ï¼Œåˆ¤æ–­ä¸‹é¢çš„è¡¨è¾¾å¼åˆ†åˆ«åˆ›å»ºäº†ä»€ä¹ˆæ ·çš„å¯¹è±¡ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">Query</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">Query</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token function">Query</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">Query</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token function">Query</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token function">Query</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">Query</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token function">Query</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token function">Query</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">Query</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> OrQuery<span class="token punctuation">,</span> AndQuery<span class="token punctuation">,</span> NotQuery<span class="token punctuation">,</span> <span class="token function">WordQuery</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> OrQuery<span class="token punctuation">,</span> AndQuery<span class="token punctuation">,</span> NotQuery<span class="token punctuation">,</span> <span class="token function">WordQuery</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> OrQuery<span class="token punctuation">,</span> AndQuery<span class="token punctuation">,</span> WordQuery<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-32"><a href="#ç»ƒä¹ 15-32" class="headerlink" title="ç»ƒä¹ 15.32"></a>ç»ƒä¹ 15.32</h2><blockquote><p>å½“ä¸€ä¸ª <code>Query</code> ç±»å‹çš„å¯¹è±¡è¢«æ‹·è´ã€ç§»åŠ¨ã€èµ‹å€¼æˆ–é”€æ¯æ—¶ï¼Œå°†åˆ†åˆ«å‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><ul><li><strong>æ‹·è´</strong>ï¼šå½“è¢«æ‹·è´æ—¶ï¼Œåˆæˆçš„æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨ã€‚å®ƒå°†æ‹·è´ä¸¤ä¸ªæ•°æ®æˆå‘˜è‡³æ–°çš„å¯¹è±¡ã€‚è€Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®æˆå‘˜æ˜¯ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆï¼Œå½“æ‹·è´æ—¶ï¼Œç›¸åº”çš„æ™ºèƒ½æŒ‡é’ˆæŒ‡å‘ç›¸åŒçš„åœ°å€ï¼Œè®¡æ•°å™¨å¢åŠ 1.</li><li><strong>ç§»åŠ¨</strong>ï¼šå½“ç§»åŠ¨æ—¶ï¼Œåˆæˆçš„ç§»åŠ¨æ„é€ å‡½æ•°è¢«è°ƒç”¨ã€‚å®ƒå°†ç§»åŠ¨æ•°æ®æˆå‘˜è‡³æ–°çš„å¯¹è±¡ã€‚è¿™æ—¶æ–°å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆå°†ä¼šæŒ‡å‘åŸå¯¹è±¡çš„åœ°å€ï¼Œè€ŒåŸå¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆä¸º <code>nullptr</code>ï¼Œæ–°å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°ä¸º 1ã€‚</li><li><strong>èµ‹å€¼</strong>ï¼šåˆæˆçš„èµ‹å€¼è¿ç®—ç¬¦è¢«è°ƒç”¨ï¼Œç»“æœå’Œæ‹·è´çš„ç›¸åŒçš„ã€‚</li><li><strong>é”€æ¯</strong>ï¼šåˆæˆçš„ææ„å‡½æ•°è¢«è°ƒç”¨ã€‚å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°é€’å‡ï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º 0 æ—¶ï¼Œå¯¹è±¡è¢«é”€æ¯ã€‚</li></ul><h2 id="ç»ƒä¹ 15-33"><a href="#ç»ƒä¹ 15-33" class="headerlink" title="ç»ƒä¹ 15.33"></a>ç»ƒä¹ 15.33</h2><blockquote><p>å½“ä¸€ä¸ª <code>Query_base</code> ç±»å‹çš„å¯¹è±¡è¢«æ‹·è´ã€ç§»åŠ¨èµ‹å€¼æˆ–é”€æ¯æ—¶ï¼Œå°†åˆ†åˆ«å‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ç”±åˆæˆçš„ç‰ˆæœ¬æ¥æ§åˆ¶ã€‚ç„¶è€Œ <code>Query_base</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„å¯¹è±¡å®é™…ä¸Šæ˜¯å®ƒçš„æ´¾ç”Ÿç±»å¯¹è±¡ã€‚</p><h2 id="ç»ƒä¹ 15-34"><a href="#ç»ƒä¹ 15-34" class="headerlink" title="ç»ƒä¹ 15.34"></a>ç»ƒä¹ 15.34</h2><blockquote><p>é’ˆå¯¹å›¾15.3æ„å»ºçš„è¡¨è¾¾å¼ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> ä¾‹ä¸¾å‡ºåœ¨å¤„ç†è¡¨è¾¾å¼çš„è¿‡ç¨‹ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ„é€ å‡½æ•°ã€‚<span class="token punctuation">(</span>b<span class="token punctuation">)</span> ä¾‹ä¸¾å‡º cout <span class="token operator">&lt;&lt;</span> q æ‰€è°ƒç”¨çš„ repã€‚<span class="token punctuation">(</span>c<span class="token punctuation">)</span> ä¾‹ä¸¾å‡º q<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ‰€è°ƒç”¨çš„ evalã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li><strong>a</strong>ï¼š <code>Query q = Query(&quot;fiery&quot;) &amp; Query(&quot;bird&quot;) | Query(&quot;wind&quot;);</code></li></ul><ol><li><code>Query::Query(const std::string&amp; s)</code> where s == â€œfieryâ€,â€birdâ€ and â€œwindâ€</li><li><code>WordQuery::WordQuery(const std::string&amp; s)</code> where s == â€œfieryâ€,â€birdâ€ and â€œwindâ€</li><li><code>AndQuery::AndQuery(const Query&amp; left, const Query&amp; right);</code></li><li><code>BinaryQuery(const Query&amp;l, const Query&amp; r, std::string s);</code></li><li><code>Query::Query(std::shared_ptr&lt;Query_base&gt; query)</code> 2times</li><li><code>OrQuery::OrQuery(const Query&amp; left, const Query&amp; right);</code></li><li><code>BinaryQuery(const Query&amp;l, const Query&amp; r, std::string s);</code></li><li><code>Query::Query(std::shared_ptr&lt;Query_base&gt; query)</code> 2times</li></ol><ul><li><strong>b</strong>ï¼š</li></ul><ol><li><code>query.rep()</code> inside the operator &lt;&lt;().</li><li><code>q-&gt;rep()</code> inside the member function rep().</li><li><code>OrQuery::rep()</code> which is inherited from <code>BinaryQuery</code>.</li><li><code>Query::rep()</code> for <code>lhs</code> and <code>rhs</code>:<br>for <code>rhs</code> which is a <code>WordQuery</code> : <code>WordQuery::rep()</code> where <code>query_word(&quot;wind&quot;)</code> is returned.For <code>lhs</code> which is an <code>AndQuery</code>.</li><li><code>AndQuery::rep()</code> which is inherited from <code>BinaryQuery</code>.</li><li><code>BinaryQuer::rep()</code>: for <code>rhs: WordQuery::rep()</code>   where query_word(â€œfieryâ€) is returned. For <code>lhs: WordQuery::rep()</code> where query_word(â€œbirdâ€ ) is returned.</li></ol><ul><li><strong>c</strong>ï¼š</li></ul><ol><li><code>q.eval()</code></li><li><code>q-&gt;rep()</code>: where q is a pointer to <code>OrQuary</code>.</li><li><code>QueryResult eval(const TextQuery&amp; )const override</code>: is called but this one has not been defined yet.</li></ol><h2 id="ç»ƒä¹ 15-35"><a href="#ç»ƒä¹ 15-35" class="headerlink" title="ç»ƒä¹ 15.35"></a>ç»ƒä¹ 15.35</h2><blockquote><p>å®ç° <code>Query</code> ç±»å’Œ <code>Query_base</code> ç±»ï¼Œå…¶ä¸­éœ€è¦å®šä¹‰<code>rep</code> è€Œæ— é¡»å®šä¹‰ <code>eval</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Query</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">QUERY_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">QUERY_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"query_base.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"queryresult.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"textquery.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"wordquery.h"</span></span><span class="token comment">/*** @brief interface class to manage the Query_base inheritance hierachy*/</span><span class="token keyword">class</span> <span class="token class-name">Query</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> Query <span class="token keyword">operator</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token keyword">const</span> Query<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> Query <span class="token keyword">operator</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token keyword">const</span> Query<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Query<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> Query <span class="token keyword">operator</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Query<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Query<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token comment">// build a new WordQuery</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">q</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">WordQuery</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Query::Query(const std::string&amp; s) where s="</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// interface functions: call the corresponding Query_base operatopns</span>QueryResult <span class="token function">eval</span><span class="token punctuation">(</span><span class="token keyword">const</span> TextQuery<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> q<span class="token operator">-></span><span class="token function">eval</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Query::rep() \n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> q<span class="token operator">-></span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// constructor only for friends</span><span class="token function">Query</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Query_base<span class="token operator">></span> query<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">q</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Query::Query(std::shared_ptr&lt;Query_base> query)\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Query_base<span class="token operator">></span> q<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">inline</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Query<span class="token operator">&amp;</span> query<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// make a virtual call through its Query_base pointer to rep();</span><span class="token keyword">return</span> os <span class="token operator">&lt;&lt;</span> query<span class="token punctuation">.</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// QUERY_H</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Query_base</code>:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">QUERY_BASE_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">QUERY_BASE_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"textquery.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"queryresult.h"</span></span><span class="token comment">/*** @brief abstract class acts as a base class for all concrete query types*        all members are private.*/</span><span class="token keyword">class</span> <span class="token class-name">Query_base</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Query</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token keyword">using</span> line_no <span class="token operator">=</span> TextQuery<span class="token operator">::</span>line_no<span class="token punctuation">;</span> <span class="token comment">//  used in the eval function</span><span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Query_base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// returns QueryResult that matches this query</span><span class="token keyword">virtual</span> QueryResult <span class="token function">eval</span><span class="token punctuation">(</span><span class="token keyword">const</span> TextQuery<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// a string representation of this query</span><span class="token keyword">virtual</span> std<span class="token operator">::</span>string <span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// QUERY_BASE_H</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-36"><a href="#ç»ƒä¹ 15-36" class="headerlink" title="ç»ƒä¹ 15.36"></a>ç»ƒä¹ 15.36</h2><blockquote><p>åœ¨æ„é€ å‡½æ•°å’Œ <code>rep</code> æˆå‘˜ä¸­æ·»åŠ æ‰“å°è¯­å¥ï¼Œè¿è¡Œä½ çš„ä»£ç ä»¥æ£€éªŒä½ å¯¹æœ¬èŠ‚ç¬¬ä¸€ä¸ªç»ƒä¹ ä¸­(a)ã€(b)ä¸¤å°é¢˜çš„å›ç­”æ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Query q <span class="token operator">=</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"fiery"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"bird"</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"wind"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">WordQuery</span><span class="token operator">::</span><span class="token function">WordQuery</span><span class="token punctuation">(</span>wind<span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> where s<span class="token operator">=</span>wind<span class="token class-name">WordQuery</span><span class="token operator">::</span><span class="token function">WordQuery</span><span class="token punctuation">(</span>bird<span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> where s<span class="token operator">=</span>bird<span class="token class-name">WordQuery</span><span class="token operator">::</span><span class="token function">WordQuery</span><span class="token punctuation">(</span>fiery<span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> where s<span class="token operator">=</span>fiery<span class="token class-name">BinaryQuery</span><span class="token operator">::</span><span class="token function">BinaryQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  where s<span class="token operator">=</span><span class="token operator">&amp;</span><span class="token class-name">AndQuery</span><span class="token operator">::</span><span class="token function">AndQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">Query</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Query_base<span class="token operator">></span> query<span class="token punctuation">)</span><span class="token class-name">BinaryQuery</span><span class="token operator">::</span><span class="token function">BinaryQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  where s<span class="token operator">=</span><span class="token operator">|</span>OrQuery<span class="token operator">::</span>OrQuery<span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">Query</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Query_base<span class="token operator">></span> query<span class="token punctuation">)</span>Press <span class="token operator">&lt;</span>RETURN<span class="token operator">></span> to close <span class="token keyword">this</span> window<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> q <span class="token operator">&lt;&lt;</span>std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">BinaryQuery</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">WodQuery</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">BinaryQuery</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">WodQuery</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Query</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">WodQuery</span><span class="token operator">::</span><span class="token function">rep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fiery <span class="token operator">&amp;</span> bird<span class="token punctuation">)</span> <span class="token operator">|</span> wind<span class="token punctuation">)</span>Press <span class="token operator">&lt;</span>RETURN<span class="token operator">></span> to close <span class="token keyword">this</span> window<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 15-37"><a href="#ç»ƒä¹ 15-37" class="headerlink" title="ç»ƒä¹ 15.37"></a>ç»ƒä¹ 15.37</h2><blockquote><p>å¦‚æœåœ¨æ´¾ç”Ÿç±»ä¸­å«æœ‰ <code>shared_ptr&lt;Query_base&gt;</code> ç±»å‹çš„æˆå‘˜è€Œé <code>Query</code> ç±»å‹çš„æˆå‘˜ï¼Œåˆ™ä½ çš„ç±»éœ€è¦åšå‡ºæ€æ ·çš„æ”¹å˜ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ15.35ã€‚</p><h2 id="ç»ƒä¹ 15-38"><a href="#ç»ƒä¹ 15-38" class="headerlink" title="ç»ƒä¹ 15.38"></a>ç»ƒä¹ 15.38</h2><blockquote><p>ä¸‹é¢çš„å£°æ˜åˆæ³•å—ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œè¯·è§£é‡ŠåŸå› ;å¦‚æœåˆæ³•ï¼Œè¯·æŒ‡å‡ºè¯¥å£°æ˜çš„å«ä¹‰ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">BinaryQuery a <span class="token operator">=</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"fiery"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"bird"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>AndQuery b <span class="token operator">=</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"fiery"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"bird"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>OrQuery c <span class="token operator">=</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"fiery"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">"bird"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ol><li>ä¸åˆæ³•ã€‚å› ä¸º <code>BinaryQuery</code> æ˜¯æŠ½è±¡ç±»ã€‚</li><li>ä¸åˆæ³•ã€‚<code>&amp;</code> æ“ä½œè¿”å›çš„æ˜¯ä¸€ä¸ª <code>Query</code> å¯¹è±¡ã€‚</li><li>ä¸åˆæ³•ã€‚<code>&amp;</code> æ“ä½œè¿”å›çš„æ˜¯ä¸€ä¸ª <code>Query</code> å¯¹è±¡ã€‚</li></ol><h2 id="ç»ƒä¹ 15-39"><a href="#ç»ƒä¹ 15-39" class="headerlink" title="ç»ƒä¹ 15.39"></a>ç»ƒä¹ 15.39</h2><blockquote><p>å®ç° <code>Query</code> ç±»å’Œã€€<code>Query_base</code> ç±»ï¼Œæ±‚å›¾15.3ä¸­è¡¨è¾¾å¼çš„å€¼å¹¶æ‰“å°ç›¸å…³ä¿¡æ¯ï¼ŒéªŒè¯ä½ çš„ç¨‹åºæ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><h2 id="ç»ƒä¹ 15-40"><a href="#ç»ƒä¹ 15-40" class="headerlink" title="ç»ƒä¹ 15.40"></a>ç»ƒä¹ 15.40</h2><blockquote><p>åœ¨ <code>OrQuery</code> çš„ <code>eval</code> å‡½æ•°ä¸­ï¼Œå¦‚æœ <code>rhs</code> æˆå‘˜è¿”å›çš„æ˜¯ç©ºé›†å°†å‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>set<span class="token operator">&lt;</span>line_no<span class="token operator">>></span> ret_lines <span class="token operator">=</span>       std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>set<span class="token operator">&lt;</span>line_no<span class="token operator">>></span><span class="token punctuation">(</span>left<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> left<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœ <code>rhs</code> æˆå‘˜è¿”å›çš„æ˜¯ç©ºé›†ï¼Œåœ¨ <code>set</code> å½“ä¸­ä¸ä¼šæ·»åŠ ä»€ä¹ˆã€‚</p><h2 id="ç»ƒä¹ 15-41"><a href="#ç»ƒä¹ 15-41" class="headerlink" title="ç»ƒä¹ 15.41"></a>ç»ƒä¹ 15.41</h2><blockquote><p>é‡æ–°å®ç°ä½ çš„ç±»ï¼Œè¿™æ¬¡ä½¿ç”¨æŒ‡å‘ <code>Query_base</code> çš„å†…ç½®æŒ‡é’ˆè€Œé <code>shared_ptr</code>ã€‚è¯·æ³¨æ„ï¼Œåšå‡ºä¸Šè¿°æ”¹åŠ¨åä½ çš„ç±»å°†ä¸èƒ½å†ä½¿ç”¨åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 15-42"><a href="#ç»ƒä¹ 15-42" class="headerlink" title="ç»ƒä¹ 15.42"></a>ç»ƒä¹ 15.42</h2><blockquote><p>ä»ä¸‹é¢çš„å‡ ç§æ”¹è¿›ä¸­é€‰æ‹©ä¸€ç§ï¼Œè®¾è®¡å¹¶å®ç°å®ƒ:</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> æŒ‰å¥å­æŸ¥è¯¢å¹¶æ‰“å°å•è¯ï¼Œè€Œä¸å†æ˜¯æŒ‰è¡Œæ‰“å°ã€‚<span class="token punctuation">(</span>b<span class="token punctuation">)</span> å¼•å…¥ä¸€ä¸ªå†å²ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥æŒ‰ç¼–å·æŸ¥é˜…ä¹‹å‰çš„æŸä¸ªæŸ¥è¯¢ï¼Œå¹¶å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ å†…å®¹æˆ–è€…å°†å…¶ä½™å…¶ä»–æŸ¥è¯¢ç»„åˆã€‚<span class="token punctuation">(</span>c<span class="token punctuation">)</span> å…è®¸ç”¨æˆ·å¯¹ç»“æœåšå‡ºé™åˆ¶ï¼Œæ¯”å¦‚ä»ç»™å®šèŒƒå›´çš„è¡Œä¸­è·³å‡ºåŒ¹é…çš„è¿›è¡Œæ˜¾ç¤ºã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç•¥</p><h2 id="TextQueryæœ€ç»ˆé¡¹ç›®"><a href="#TextQueryæœ€ç»ˆé¡¹ç›®" class="headerlink" title="TextQueryæœ€ç»ˆé¡¹ç›®"></a>TextQueryæœ€ç»ˆé¡¹ç›®</h2><p>è§ cpp_source/cha5/text_query</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°9</title>
      <link href="2021/04/10/notes/ch09/"/>
      <url>2021/04/10/notes/ch09/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¹ç« -é¡ºåºå®¹å™¨"><a href="#ç¬¬ä¹ç« -é¡ºåºå®¹å™¨" class="headerlink" title="ç¬¬ä¹ç«  é¡ºåºå®¹å™¨"></a>ç¬¬ä¹ç«  é¡ºåºå®¹å™¨</h1><h2 id="é¡ºåºå®¹å™¨æ¦‚è¿°"><a href="#é¡ºåºå®¹å™¨æ¦‚è¿°" class="headerlink" title="é¡ºåºå®¹å™¨æ¦‚è¿°"></a>é¡ºåºå®¹å™¨æ¦‚è¿°</h2><ul><li><strong>é¡ºåºå®¹å™¨</strong>ï¼ˆsequential containerï¼‰ï¼šä¸ºç¨‹åºå‘˜æä¾›äº†æ§åˆ¶å…ƒç´ å­˜å‚¨å’Œè®¿é—®é¡ºåºçš„èƒ½åŠ›ã€‚è¿™ç§é¡ºåºä¸ä¾èµ–äºå…ƒç´ çš„å€¼ï¼Œè€Œæ˜¯ä¸å…ƒç´ åŠ å…¥å®¹å™¨æ—¶çš„ä½ç½®ç›¸å¯¹åº”ã€‚</li></ul><h3 id="é¡ºåºå®¹å™¨ç±»å‹"><a href="#é¡ºåºå®¹å™¨ç±»å‹" class="headerlink" title="é¡ºåºå®¹å™¨ç±»å‹"></a>é¡ºåºå®¹å™¨ç±»å‹</h3><table><thead><tr><th>å®¹å™¨ç±»å‹</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td><code>vector</code></td><td>å¯å˜å¤§å°æ•°ç»„ã€‚æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚åœ¨å°¾éƒ¨ä¹‹å¤–çš„ä½ç½®æ’å…¥æˆ–åˆ é™¤å…ƒç´ å¯èƒ½å¾ˆæ…¢ã€‚</td></tr><tr><td><code>deque</code></td><td>åŒç«¯é˜Ÿåˆ—ã€‚æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚åœ¨å¤´å°¾ä½ç½®æ’å…¥/åˆ é™¤é€Ÿåº¦å¾ˆå¿«ã€‚</td></tr><tr><td><code>list</code></td><td>åŒå‘é“¾è¡¨ã€‚åªæ”¯æŒåŒå‘é¡ºåºè®¿é—®ã€‚åœ¨<code>list</code>ä¸­ä»»ä½•ä½ç½®è¿›è¡Œæ’å…¥/åˆ é™¤æ“ä½œé€Ÿåº¦éƒ½å¾ˆå¿«ã€‚</td></tr><tr><td><code>forward_list</code></td><td>å•å‘é“¾è¡¨ã€‚åªæ”¯æŒå•å‘é¡ºåºè®¿é—®ã€‚åœ¨é“¾è¡¨ä»»ä½•ä½ç½®è¿›è¡Œæ’å…¥/åˆ é™¤æ“ä½œé€Ÿåº¦éƒ½å¾ˆå¿«ã€‚</td></tr><tr><td><code>array</code></td><td>å›ºå®šå¤§å°æ•°ç»„ã€‚æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ã€‚ä¸èƒ½æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ ã€‚</td></tr><tr><td><code>string</code></td><td>ä¸<code>vector</code>ç›¸ä¼¼çš„å®¹å™¨ï¼Œä½†ä¸“é—¨ç”¨äºä¿å­˜å­—ç¬¦ã€‚éšæœºè®¿é—®å—ã€‚åœ¨å°¾éƒ¨æ’å…¥/åˆ é™¤é€Ÿåº¦å¿«ã€‚</td></tr></tbody></table><ul><li>é™¤äº†å›ºå®šå¤§å°çš„<code>array</code>å¤–ï¼Œå…¶ä»–å®¹å™¨éƒ½æä¾›é«˜æ•ˆã€çµæ´»çš„å†…å­˜ç®¡ç†ã€‚</li><li><code>forward_list</code>å’Œ<code>array</code>æ˜¯æ–°C++æ ‡å‡†å¢åŠ çš„ç±»å‹ã€‚</li><li>é€šå¸¸ä½¿ç”¨<code>vector</code>æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œé™¤éä½ æœ‰å¾ˆå¥½çš„ç†ç”±é€‰æ‹©å…¶ä»–å®¹å™¨ã€‚</li><li>æ–°æ ‡å‡†åº“çš„å®¹å™¨æ¯”æ—§ç‰ˆçš„å¿«å¾—å¤šã€‚</li></ul><h2 id="å®¹å™¨æ“ä½œ"><a href="#å®¹å™¨æ“ä½œ" class="headerlink" title="å®¹å™¨æ“ä½œ"></a>å®¹å™¨æ“ä½œ</h2><h3 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>iterator</code></td><td>æ­¤å®¹å™¨ç±»å‹çš„è¿­ä»£å™¨ç±»å‹</td></tr><tr><td><code>const_iterator</code></td><td>å¯ä»¥è¯»å–å…ƒç´ ä½†ä¸èƒ½ä¿®æ”¹å…ƒç´ çš„è¿­ä»£å™¨ç±»å‹</td></tr><tr><td><code>size_type</code></td><td>æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œè¶³å¤Ÿä¿å­˜æ­¤ç§å®¹å™¨ç±»å‹æœ€å¤§å¯èƒ½çš„å¤§å°</td></tr><tr><td><code>difference_type</code></td><td>å¸¦ç¬¦å·æ•´æ•°ç±»å‹ï¼Œè¶³å¤Ÿä¿å­˜ä¸¤ä¸ªè¿­ä»£å™¨ä¹‹é—´çš„è·ç¦»</td></tr><tr><td><code>value_type</code></td><td>å…ƒç´ ç±»å‹</td></tr><tr><td><code>reference</code></td><td>å…ƒç´ çš„å·¦å€¼ç±»å‹ï¼›å’Œ<code>value_type &amp;</code>å«ä¹‰ç›¸åŒ</td></tr><tr><td><code>const_reference</code></td><td>å…ƒç´ çš„<code>const</code>å·¦å€¼ç±»å‹ï¼Œå³<code>const value_type &amp;</code></td></tr></tbody></table><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>C c;</code></td><td>é»˜è®¤æ„é€ å‡½æ•°ï¼Œæ„é€ ç©ºå®¹å™¨</td></tr><tr><td><code>C c1(c2);</code>æˆ–<code>C c1 = c2;</code></td><td>æ„é€ <code>c2</code>çš„æ‹·è´<code>c1</code></td></tr><tr><td><code>C c(b, e)</code></td><td>æ„é€ <code>c</code>ï¼Œå°†è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ æ‹·è´åˆ°<code>c</code></td></tr><tr><td><code>C c(a, b, c...)</code></td><td>åˆ—è¡¨åˆå§‹åŒ–<code>c</code></td></tr><tr><td><code>C c(n)</code></td><td>åªæ”¯æŒé¡ºåºå®¹å™¨ï¼Œä¸”ä¸åŒ…æ‹¬<code>array</code>ï¼ŒåŒ…å«<code>n</code>ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ è¿›è¡Œäº†å€¼åˆå§‹åŒ–</td></tr><tr><td><code>C c(n, t)</code></td><td>åŒ…å«<code>n</code>ä¸ªåˆå§‹å€¼ä¸º<code>t</code>çš„å…ƒç´ </td></tr></tbody></table><ul><li>åªæœ‰é¡ºåºå®¹å™¨çš„æ„é€ å‡½æ•°æ‰æ¥å—å¤§å°å‚æ•°ï¼Œå…³è”å®¹å™¨å¹¶ä¸æ”¯æŒã€‚</li><li><code>array</code>å…·æœ‰å›ºå®šå¤§å°ã€‚</li><li>å’Œå…¶ä»–å®¹å™¨ä¸åŒï¼Œé»˜è®¤æ„é€ çš„<code>array</code>æ˜¯éç©ºçš„ã€‚</li><li>ç›´æ¥å¤åˆ¶ï¼šå°†ä¸€ä¸ªå®¹å™¨å¤åˆ¶ç»™å¦ä¸€ä¸ªå®¹å™¨æ—¶ï¼Œç±»å‹å¿…é¡»åŒ¹é…ï¼šå®¹å™¨ç±»å‹å’Œå…ƒç´ ç±»å‹éƒ½å¿…é¡»ç›¸åŒã€‚</li><li>ä½¿ç”¨è¿­ä»£å™¨å¤åˆ¶ï¼šä¸è¦æ±‚å®¹å™¨ç±»å‹ç›¸åŒï¼Œå®¹å™¨å†…çš„å…ƒç´ ç±»å‹ä¹Ÿå¯ä»¥ä¸åŒã€‚</li></ul><h3 id="èµ‹å€¼å’Œswap"><a href="#èµ‹å€¼å’Œswap" class="headerlink" title="èµ‹å€¼å’Œswap"></a>èµ‹å€¼å’Œ<code>swap</code></h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c1 = c2;</code></td><td>å°†<code>c1</code>ä¸­çš„å…ƒç´ æ›¿æ¢æˆ<code>c2</code>ä¸­çš„å…ƒç´ </td></tr><tr><td><code>c1 = &#123;a, b, c...&#125;</code></td><td>å°†<code>c1</code>ä¸­çš„å…ƒç´ æ›¿æ¢æˆåˆ—è¡¨ä¸­çš„å…ƒç´ ï¼ˆä¸é€‚ç”¨äº<code>array</code>ï¼‰</td></tr><tr><td><code>c1.swap(c2)</code></td><td>äº¤æ¢<code>c1</code>å’Œ<code>c2</code>çš„å…ƒç´ </td></tr><tr><td><code>swap(c1, c2)</code></td><td>ç­‰ä»·äº<code>c1.swap(c2)</code></td></tr><tr><td><code>c.assign(b, e)</code></td><td>å°†<code>c</code>ä¸­çš„å…ƒç´ æ›¿æ¢æˆè¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>è¡¨ç¤ºèŒƒå›´ä¸­çš„å…ƒç´ ï¼Œ<code>b</code>å’Œ<code>e</code>ä¸èƒ½æŒ‡å‘<code>c</code>ä¸­çš„å…ƒç´ </td></tr><tr><td><code>c.assign(il)</code></td><td>å°†<code>c</code>ä¸­çš„å…ƒç´ æ›¿æ¢æˆåˆå§‹åŒ–åˆ—è¡¨<code>il</code>ä¸­çš„å…ƒç´ </td></tr><tr><td><code>c.assign(n, r)</code></td><td>å°†<code>c</code>ä¸­çš„å…ƒç´ æ›¿æ¢ä¸º<code>n</code>ä¸ªå€¼æ˜¯<code>t</code>çš„å…ƒç´ </td></tr></tbody></table><ul><li>ä½¿ç”¨éæˆå‘˜ç‰ˆæœ¬çš„<code>swap</code>æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚</li><li><code>assign</code>æ“ä½œä¸é€‚ç”¨äºå…³è”å®¹å™¨å’Œ<code>array</code></li></ul><h3 id="å¤§å°"><a href="#å¤§å°" class="headerlink" title="å¤§å°"></a>å¤§å°</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.size()</code></td><td><code>c</code>ä¸­å…ƒç´ çš„æ•°ç›®ï¼ˆä¸æ”¯æŒ<code>forward_list</code>ï¼‰</td></tr><tr><td><code>c.max_size()</code></td><td><code>c</code>ä¸­å¯ä¿å­˜çš„æœ€å¤§å…ƒç´ æ•°ç›®</td></tr><tr><td><code>c.empty()</code></td><td>è‹¥<code>c</code>ä¸­å­˜å‚¨äº†å…ƒç´ ï¼Œè¿”å›<code>false</code>ï¼Œå¦åˆ™è¿”å›<code>true</code></td></tr></tbody></table><h3 id="æ·»åŠ å…ƒç´ "><a href="#æ·»åŠ å…ƒç´ " class="headerlink" title="æ·»åŠ å…ƒç´ "></a>æ·»åŠ å…ƒç´ </h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.push_back(t)</code></td><td>åœ¨<code>c</code>å°¾éƒ¨åˆ›å»ºä¸€ä¸ªå€¼ä¸º<code>t</code>çš„å…ƒç´ ï¼Œè¿”å›<code>void</code></td></tr><tr><td><code>c.emplace_back(args)</code></td><td>åŒä¸Š</td></tr><tr><td><code>c.push_front(t)</code></td><td>åœ¨<code>c</code>å¤´éƒ¨åˆ›å»ºä¸€ä¸ªå€¼ä¸º<code>t</code>çš„å…ƒç´ ï¼Œè¿”å›<code>void</code></td></tr><tr><td><code>c.emplace_front(args)</code></td><td>åŒä¸Š</td></tr><tr><td><code>c.insert(p, t)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>æŒ‡å‘çš„å…ƒç´ ä¹‹å‰åˆ›å»ºä¸€ä¸ªå€¼æ˜¯<code>t</code>çš„å…ƒç´ ï¼Œè¿”å›æŒ‡å‘æ–°å…ƒç´ çš„è¿­ä»£å™¨</td></tr><tr><td><code>c.emplace(p, args)</code></td><td>åŒä¸Š</td></tr><tr><td><code>c.inset(p, n, t)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>æŒ‡å‘çš„å…ƒç´ ä¹‹å‰æ’å…¥<code>n</code>ä¸ªå€¼ä¸º<code>t</code>çš„å…ƒç´ ï¼Œè¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªæ–°å…ƒç´ çš„è¿­ä»£å™¨ï¼›å¦‚æœ<code>n</code>æ˜¯0ï¼Œåˆ™è¿”å›<code>p</code></td></tr><tr><td><code>c.insert(p, b, e)</code></td><td>å°†è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>èŒƒå›´å†…çš„å…ƒç´ ï¼Œæ’å…¥åˆ°<code>p</code>æŒ‡å‘çš„å…ƒç´ ä¹‹å‰ï¼›å¦‚æœèŒƒå›´ä¸ºç©ºï¼Œåˆ™è¿”å›<code>p</code></td></tr><tr><td><code>c.insert(p, il)</code></td><td><code>il</code>æ˜¯ä¸€ä¸ªèŠ±æ‹¬å·åŒ…å›´ä¸­çš„å…ƒç´ å€¼åˆ—è¡¨ï¼Œå°†å…¶æ’å…¥åˆ°<code>p</code>æŒ‡å‘çš„å…ƒç´ ä¹‹å‰ï¼›å¦‚æœ<code>il</code>æ˜¯ç©ºï¼Œåˆ™è¿”å›<code>p</code></td></tr></tbody></table><ul><li>å› ä¸ºè¿™äº›æ“ä½œä¼šæ”¹å˜å¤§å°ï¼Œå› æ­¤ä¸é€‚ç”¨äº<code>array</code>ã€‚</li><li><code>forward_list</code>æœ‰è‡ªå·±ä¸“æœ‰ç‰ˆæœ¬çš„<code>insert</code>å’Œ<code>emplace</code>ã€‚</li><li><code>forward_list</code>ä¸æ”¯æŒ<code>push_back</code>å’Œ<code>emplace_back</code>ã€‚</li><li>å½“æˆ‘ä»¬ç”¨ä¸€ä¸ªå¯¹è±¡å»åˆå§‹åŒ–å®¹å™¨æˆ–è€…å°†å¯¹è±¡æ’å…¥åˆ°å®¹å™¨æ—¶ï¼Œå®é™…ä¸Šæ”¾å…¥çš„æ˜¯å¯¹è±¡çš„æ‹·è´ã€‚</li><li><code>emplace</code>å¼€å¤´çš„å‡½æ•°æ˜¯æ–°æ ‡å‡†å¼•å…¥çš„ï¼Œè¿™äº›æ“ä½œæ˜¯æ„é€ è€Œä¸æ˜¯æ‹·è´å…ƒç´ ã€‚</li><li>ä¼ é€’ç»™<code>emplace</code>çš„å‚æ•°å¿…é¡»å’Œå…ƒç´ ç±»å‹çš„æ„é€ å‡½æ•°ç›¸åŒ¹é…ã€‚</li></ul><h3 id="è®¿é—®å…ƒç´ "><a href="#è®¿é—®å…ƒç´ " class="headerlink" title="è®¿é—®å…ƒç´ "></a>è®¿é—®å…ƒç´ </h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.back()</code></td><td>è¿”å›<code>c</code>ä¸­å°¾å…ƒç´ çš„å¼•ç”¨ã€‚è‹¥<code>c</code>ä¸ºç©ºï¼Œå‡½æ•°è¡Œä¸ºæœªå®šä¹‰</td></tr><tr><td><code>c.front()</code></td><td>è¿”å›<code>c</code>ä¸­å¤´å…ƒç´ çš„å¼•ç”¨ã€‚è‹¥<code>c</code>ä¸ºç©ºï¼Œå‡½æ•°è¡Œä¸ºæœªå®šä¹‰</td></tr><tr><td><code>c[n]</code></td><td>è¿”å›<code>c</code>ä¸­ä¸‹æ ‡æ˜¯<code>n</code>çš„å…ƒç´ çš„å¼•ç”¨ï¼Œ<code>n</code>æ—¶å€™ä¸€ä¸ªæ— ç¬¦å·è¯ä¹¦ã€‚è‹¥<code>n&gt;=c.size()</code>ï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰</td></tr><tr><td><code>c.at(n)</code></td><td>è¿”å›ä¸‹æ ‡ä¸º<code>n</code>çš„å…ƒç´ å¼•ç”¨ã€‚å¦‚æœä¸‹æ ‡è¶Šç•Œï¼Œåˆ™æŠ›å‡º<code>out_of_range</code>å¼‚å¸¸</td></tr></tbody></table><ul><li>è®¿é—®æˆå‘˜å‡½æ•°è¿”å›çš„æ˜¯å¼•ç”¨ã€‚</li><li><code>at</code>å’Œä¸‹æ ‡æ“ä½œåªé€‚ç”¨äº<code>string</code>ã€<code>vector</code>ã€<code>deque</code>ã€<code>array</code>ã€‚</li><li><code>back</code>ä¸é€‚ç”¨äº<code>forward_list</code>ã€‚</li><li>å¦‚æœå¸Œæœ›ä¸‹æ ‡æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥ä½¿ç”¨<code>at</code>å‡½æ•°ã€‚</li></ul><h3 id="åˆ é™¤å…ƒç´ "><a href="#åˆ é™¤å…ƒç´ " class="headerlink" title="åˆ é™¤å…ƒç´ "></a>åˆ é™¤å…ƒç´ </h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.pop_back()</code></td><td>åˆ é™¤<code>c</code>ä¸­å°¾å…ƒç´ ï¼Œè‹¥<code>c</code>ä¸ºç©ºï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰ã€‚å‡½æ•°è¿”å›<code>void</code></td></tr><tr><td><code>c.pop_front()</code></td><td>åˆ é™¤<code>c</code>ä¸­é¦–å…ƒç´ ï¼Œè‹¥<code>c</code>ä¸ºç©ºï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰ã€‚å‡½æ•°è¿”å›<code>void</code></td></tr><tr><td><code>c.erase(p)</code></td><td>åˆ é™¤è¿­ä»£å™¨<code>p</code>æŒ‡å‘çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¢«åˆ é™¤å…ƒç´ ä¹‹åçš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥<code>p</code>æœ¬èº«æ˜¯å°¾åè¿­ä»£å™¨ï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰</td></tr><tr><td><code>c.erase(b, e)</code></td><td>åˆ é™¤è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>èŒƒå›´å†…çš„å…ƒç´ ï¼Œè¿”å›æŒ‡å‘æœ€åä¸€ä¸ªè¢«åˆ å…ƒç´ ä¹‹åå…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥<code>e</code>æœ¬èº«å°±æ˜¯å°¾åè¿­ä»£å™¨ï¼Œåˆ™è¿”å›å°¾åè¿­ä»£å™¨</td></tr><tr><td><code>c.clear()</code></td><td>åˆ é™¤<code>c</code>ä¸­æ‰€æœ‰å…ƒç´ ï¼Œè¿”å›<code>void</code></td></tr></tbody></table><ul><li>ä¼šæ”¹å˜å®¹å™¨å¤§å°ï¼Œä¸é€‚ç”¨äº<code>array</code>ã€‚</li><li><code>forward_list</code>æœ‰ç‰¹æ®Šç‰ˆæœ¬çš„<code>erase</code></li><li><code>forward_list</code>ä¸æ”¯æŒ<code>pop_back</code></li><li><code>vector</code>å’Œ<code>string</code>ä¸æ”¯æŒ<code>pop_front</code></li></ul><h3 id="ç‰¹æ®Šçš„forwad-listæ“ä½œ"><a href="#ç‰¹æ®Šçš„forwad-listæ“ä½œ" class="headerlink" title="ç‰¹æ®Šçš„forwad_listæ“ä½œ"></a>ç‰¹æ®Šçš„forwad_listæ“ä½œ</h3><ul><li>é“¾è¡¨åœ¨åˆ é™¤å…ƒç´ æ—¶éœ€è¦ä¿®æ”¹å‰ç½®èŠ‚ç‚¹çš„å†…å®¹ï¼ŒåŒå‘é“¾è¡¨ä¼šå‰é©±çš„æŒ‡é’ˆï¼Œä½†æ˜¯å•å‘é“¾è¡¨æ²¡æœ‰ä¿å­˜ï¼Œå› æ­¤éœ€è¦å¢åŠ è·å–å‰ç½®èŠ‚ç‚¹çš„æ–¹æ³•ã€‚</li><li><code>forward_list</code>å®šä¹‰äº†<code>before_begin</code>ï¼Œå³é¦–å‰ï¼ˆoff-the-beginingï¼‰è¿­ä»£å™¨ï¼Œå…è®¸æˆ‘ä»¬å†åœ¨é¦–å…ƒç´ ä¹‹å‰æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚</li></ul><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>lst.before_begin()</code></td><td>è¿”å›æŒ‡å‘é“¾è¡¨é¦–å…ƒç´ ä¹‹å‰ä¸å­˜åœ¨çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œæ­¤è¿­ä»£å™¨ä¸èƒ½è§£å¼•ç”¨ã€‚</td></tr><tr><td><code>lst.cbefore_begin()</code></td><td>åŒä¸Šï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å¸¸é‡è¿­ä»£å™¨ã€‚</td></tr><tr><td><code>lst.insert_after(p, t)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>ä¹‹åæ’å…¥å…ƒç´ ã€‚<code>t</code>æ˜¯ä¸€ä¸ªå¯¹è±¡</td></tr><tr><td><code>lst.insert_after(p, n, t)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>ä¹‹åæ’å…¥å…ƒç´ ã€‚<code>t</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>n</code>æ˜¯æ•°é‡ã€‚è‹¥<code>n</code>æ˜¯0åˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰</td></tr><tr><td><code>lst.insert_after(p, b, e)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>ä¹‹åæ’å…¥å…ƒç´ ã€‚ç”±è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>æŒ‡å®šèŒƒå›´ã€‚</td></tr><tr><td><code>lst.insert_after(p, il)</code></td><td>åœ¨è¿­ä»£å™¨<code>p</code>ä¹‹åæ’å…¥å…ƒç´ ã€‚ç”±<code>il</code>æŒ‡å®šåˆå§‹åŒ–åˆ—è¡¨ã€‚</td></tr><tr><td><code>emplace_after(p, args)</code></td><td>ä½¿ç”¨<code>args</code>åœ¨<code>p</code>ä¹‹åçš„ä½ç½®ï¼Œåˆ›å»ºä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªæ–°å…ƒç´ çš„è¿­ä»£å™¨ã€‚è‹¥<code>p</code>ä¸ºå°¾åè¿­ä»£å™¨ï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰ã€‚</td></tr><tr><td><code>lst.erase_after(p)</code></td><td>åˆ é™¤<code>p</code>æŒ‡å‘ä½ç½®ä¹‹åçš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¢«åˆ å…ƒç´ ä¹‹åçš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥<code>p</code>æŒ‡å‘<code>lst</code>çš„å°¾å…ƒç´ æˆ–è€…æ˜¯ä¸€ä¸ªå°¾åè¿­ä»£å™¨ï¼Œåˆ™å‡½æ•°è¡Œä¸ºæœªå®šä¹‰ã€‚</td></tr><tr><td><code>lst.erase_after(b, e)</code></td><td>ç±»ä¼¼ä¸Šé¢ï¼Œåˆ é™¤å¯¹è±¡æ¢æˆä»<code>b</code>åˆ°<code>e</code>æŒ‡å®šçš„èŒƒå›´ã€‚</td></tr></tbody></table><h3 id="æ”¹å˜å®¹å™¨å¤§å°"><a href="#æ”¹å˜å®¹å™¨å¤§å°" class="headerlink" title="æ”¹å˜å®¹å™¨å¤§å°"></a>æ”¹å˜å®¹å™¨å¤§å°</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.resize(n)</code></td><td>è°ƒæ•´<code>c</code>çš„å¤§å°ä¸º<code>n</code>ä¸ªå…ƒç´ ï¼Œè‹¥<code>n&lt;c.size()</code>ï¼Œåˆ™å¤šå‡ºçš„å…ƒç´ è¢«ä¸¢å¼ƒã€‚è‹¥å¿…é¡»æ·»åŠ æ–°å…ƒç´ ï¼Œå¯¹æ–°å…ƒç´ è¿›è¡Œå€¼åˆå§‹åŒ–</td></tr><tr><td><code>c.resize(n, t)</code></td><td>è°ƒæ•´<code>c</code>çš„å¤§å°ä¸º<code>n</code>ä¸ªå…ƒç´ ï¼Œä»»ä½•æ–°æ·»åŠ çš„å…ƒç´ éƒ½åˆå§‹åŒ–ä¸ºå€¼<code>t</code></td></tr></tbody></table><h3 id="è·å–è¿­ä»£å™¨"><a href="#è·å–è¿­ä»£å™¨" class="headerlink" title="è·å–è¿­ä»£å™¨"></a>è·å–è¿­ä»£å™¨</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.begin()</code>, <code>c.end()</code></td><td>è¿”å›æŒ‡å‘<code>c</code>çš„é¦–å…ƒç´ å’Œå°¾å…ƒç´ ä¹‹åä½ç½®çš„è¿­ä»£å™¨</td></tr><tr><td><code>c.cbegin()</code>, <code>c.cend()</code></td><td>è¿”å›<code>const_iterator</code></td></tr></tbody></table><ul><li>ä»¥<code>c</code>å¼€å¤´çš„ç‰ˆæœ¬æ˜¯C++11æ–°æ ‡å‡†å¼•å…¥çš„</li><li>å½“ä¸éœ€è¦å†™è®¿é—®æ—¶ï¼Œåº”è¯¥ä½¿ç”¨<code>cbegin</code>å’Œ<code>cend</code>ã€‚</li></ul><h3 id="åå‘å®¹å™¨çš„é¢å¤–æˆå‘˜"><a href="#åå‘å®¹å™¨çš„é¢å¤–æˆå‘˜" class="headerlink" title="åå‘å®¹å™¨çš„é¢å¤–æˆå‘˜"></a>åå‘å®¹å™¨çš„é¢å¤–æˆå‘˜</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>reverse_iterator</code></td><td>æŒ‰é€†åºå¯»å€å…ƒç´ çš„è¿­ä»£å™¨</td></tr><tr><td><code>const_reverse_iterator</code></td><td>ä¸èƒ½ä¿®æ”¹å…ƒç´ çš„é€†åºè¿­ä»£å™¨</td></tr><tr><td><code>c.rbegin()</code>, <code>c.rend()</code></td><td>è¿”å›æŒ‡å‘<code>c</code>çš„å°¾å…ƒç´ å’Œé¦–å…ƒç´ ä¹‹å‰ä½ç½®çš„è¿­ä»£å™¨</td></tr><tr><td><code>c.crbegin()</code>, <code>c.crend()</code></td><td>è¿”å›<code>const_reverse_iterator</code></td></tr></tbody></table><ul><li>ä¸æ”¯æŒ<code>forward_list</code></li></ul><h3 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h3><ul><li>è¿­ä»£å™¨èŒƒå›´ï¼š<code>begin</code>åˆ°<code>end</code>ï¼Œå³ç¬¬ä¸€ä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ çš„åé¢ä¸€ä¸ªä½ç½®ã€‚</li><li>å·¦é—­åˆåŒºé—´ï¼š<code>[begin, end)</code></li><li>å·¦é—­åˆèŒƒå›´è•´å«çš„ç¼–ç¨‹è®¾å®šï¼š<ul><li>å¦‚æœ<code>begin</code>å’Œ<code>end</code>ç›¸ç­‰ï¼Œåˆ™èŒƒå›´ä¸ºç©ºã€‚</li><li>å¦‚æœäºŒè€…ä¸ç­‰ï¼Œåˆ™èŒƒå›´è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œä¸”<code>begin</code>æŒ‡å‘è¯¥èŒƒå›´ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li><li>å¯ä»¥å¯¹<code>begin</code>é€’å¢è‹¥å¹²æ¬¡ï¼Œä½¿å¾—<code>begin == end</code>ã€‚</li></ul></li></ul><h3 id="å®¹å™¨æ“ä½œå¯èƒ½ä½¿è¿­ä»£å™¨å¤±æ•ˆ"><a href="#å®¹å™¨æ“ä½œå¯èƒ½ä½¿è¿­ä»£å™¨å¤±æ•ˆ" class="headerlink" title="å®¹å™¨æ“ä½œå¯èƒ½ä½¿è¿­ä»£å™¨å¤±æ•ˆ"></a>å®¹å™¨æ“ä½œå¯èƒ½ä½¿è¿­ä»£å™¨å¤±æ•ˆ</h3><ul><li>åœ¨å‘å®¹å™¨æ·»åŠ å…ƒç´ åï¼š<ul><li>å¦‚æœå®¹å™¨æ˜¯<code>vector</code>æˆ–<code>string</code>ï¼Œä¸”å­˜å‚¨ç©ºé—´è¢«é‡æ–°åˆ†é…ï¼Œåˆ™æŒ‡å‘å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆã€å¼•ç”¨éƒ½ä¼šå¤±æ•ˆã€‚</li><li>å¯¹äº<code>deque</code>ï¼Œæ’å…¥åˆ°é™¤é¦–å°¾ä½ç½®ä¹‹å¤–çš„ä»»ä½•ä½ç½®éƒ½ä¼šå¯¼è‡´æŒ‡å‘å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆã€å¼•ç”¨å¤±æ•ˆã€‚å¦‚æœåœ¨é¦–å°¾ä½ç½®æ·»åŠ å…ƒç´ ï¼Œè¿­ä»£å™¨ä¼šå¤±æ•ˆï¼Œä½†æŒ‡å‘å­˜åœ¨å…ƒç´ çš„å¼•ç”¨å’ŒæŒ‡é’ˆä¸ä¼šå¤±æ•ˆã€‚</li><li>å¯¹äº<code>list</code>å’Œ<code>forward_list</code>ï¼ŒæŒ‡å‘å®¹å™¨çš„è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨ä¾ç„¶æœ‰æ•ˆã€‚</li></ul></li><li>åœ¨ä»ä¸€ä¸ªå®¹å™¨ä¸­åˆ é™¤å…ƒç´ åï¼š<ul><li>å¯¹äº<code>list</code>å’Œ<code>forward_list</code>ï¼ŒæŒ‡å‘å®¹å™¨å…¶ä»–ä½ç½®çš„è¿­ä»£å™¨ã€å¼•ç”¨å’ŒæŒ‡é’ˆä»ç„¶æœ‰æ•ˆã€‚</li><li>å¯¹äº<code>deque</code>ï¼Œå¦‚æœåœ¨é¦–å°¾ä¹‹å¤–çš„ä»»ä½•ä½ç½®åˆ é™¤å…ƒç´ ï¼Œé‚£ä¹ˆæŒ‡å‘è¢«åˆ é™¤å…ƒç´ å¤–å…¶ä»–å…ƒç´ çš„è¿­ä»£å™¨ã€æŒ‡é’ˆã€å¼•ç”¨éƒ½ä¼šå¤±æ•ˆï¼›å¦‚æœæ˜¯åˆ é™¤<code>deque</code>çš„å°¾å…ƒç´ ï¼Œåˆ™å°¾åè¿­ä»£å™¨ä¼šå¤±æ•ˆï¼Œä½†å…¶ä»–ä¸å—å½±å“ï¼›å¦‚æœåˆ é™¤çš„æ˜¯<code>deque</code>çš„å¤´å…ƒç´ ï¼Œè¿™äº›ä¹Ÿä¸ä¼šå—å½±å“ã€‚</li><li>å¯¹äº<code>vector</code>å’Œ<code>string</code>ï¼ŒæŒ‡å‘è¢«åˆ å…ƒç´ ä¹‹å‰çš„è¿­ä»£å™¨ã€å¼•ç”¨ã€æŒ‡é’ˆä»ç„¶æœ‰æ•ˆã€‚</li><li>æ³¨æ„ï¼šå½“æˆ‘ä»¬åˆ é™¤å…ƒç´ æ—¶ï¼Œå°¾åè¿­ä»£å™¨æ€»æ˜¯ä¼šå¤±æ•ˆã€‚</li><li>æ³¨æ„ï¼šä½¿ç”¨å¤±æ•ˆçš„è¿­ä»£å™¨ã€æŒ‡é’ˆã€å¼•ç”¨æ˜¯ä¸¥é‡çš„è¿è¡Œæ—¶é”™è¯¯ï¼</li><li>å»ºè®®ï¼šå°†è¦æ±‚è¿­ä»£å™¨å¿…é¡»ä¿æŒæœ‰æ•ˆçš„ç¨‹åºç‰‡æ®µæœ€å°åŒ–ã€‚</li><li>å»ºè®®ï¼šä¸è¦ä¿å­˜<code>end</code>è¿”å›çš„è¿­ä»£å™¨ã€‚</li></ul></li></ul><h3 id="å®¹å™¨å†…å…ƒç´ çš„ç±»å‹çº¦æŸ"><a href="#å®¹å™¨å†…å…ƒç´ çš„ç±»å‹çº¦æŸ" class="headerlink" title="å®¹å™¨å†…å…ƒç´ çš„ç±»å‹çº¦æŸ"></a>å®¹å™¨å†…å…ƒç´ çš„ç±»å‹çº¦æŸ</h3><ul><li>å…ƒç´ ç±»å‹å¿…é¡»æ”¯æŒèµ‹å€¼è¿ç®—ï¼›</li><li>å…ƒç´ ç±»å‹çš„å¯¹è±¡å¿…é¡»å¯ä»¥å¤åˆ¶ã€‚</li><li>é™¤äº†è¾“å…¥è¾“å‡ºæ ‡å‡†åº“ç±»å‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰æ ‡å‡†åº“ç±»å‹éƒ½æ˜¯æœ‰æ•ˆçš„å®¹å™¨å…ƒç´ ç±»å‹ã€‚</li></ul><h2 id="vectorå¯¹è±¡æ˜¯å¦‚ä½•å¢é•¿çš„"><a href="#vectorå¯¹è±¡æ˜¯å¦‚ä½•å¢é•¿çš„" class="headerlink" title="vectorå¯¹è±¡æ˜¯å¦‚ä½•å¢é•¿çš„"></a>vectorå¯¹è±¡æ˜¯å¦‚ä½•å¢é•¿çš„</h2><p><code>vector</code>å’Œ<code>string</code>åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­ä¿å­˜çš„ï¼Œå¦‚æœåŸå…ˆåˆ†é…çš„å†…å­˜ä½ç½®å·²ç»ä½¿ç”¨å®Œï¼Œåˆ™éœ€è¦é‡æ–°åˆ†é…æ–°ç©ºé—´ï¼Œå°†å·²æœ‰å…ƒç´ ä»å°±ä½ç½®ç§»åŠ¨åˆ°æ–°ç©ºé—´ä¸­ï¼Œç„¶åæ·»åŠ æ–°å…ƒç´ ã€‚</p><h3 id="ç®¡ç†å®¹é‡çš„æˆå‘˜å‡½æ•°"><a href="#ç®¡ç†å®¹é‡çš„æˆå‘˜å‡½æ•°" class="headerlink" title="ç®¡ç†å®¹é‡çš„æˆå‘˜å‡½æ•°"></a>ç®¡ç†å®¹é‡çš„æˆå‘˜å‡½æ•°</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c.shrink_to_fit()</code></td><td>å°†<code>capacity()</code>å‡å°‘åˆ°å’Œ<code>size()</code>ç›¸åŒå¤§å°</td></tr><tr><td><code>c.capacity()</code></td><td>ä¸é‡æ–°åˆ†é…å†…å­˜ç©ºé—´çš„è¯ï¼Œ<code>c</code>å¯ä»¥ä¿å­˜å¤šå°‘ä¸ªå…ƒç´ </td></tr><tr><td><code>c.reverse(n)</code></td><td>åˆ†é…è‡³å°‘èƒ½å®¹çº³<code>n</code>ä¸ªå…ƒç´ çš„å†…å­˜ç©ºé—´</td></tr></tbody></table><ul><li><code>shrink_to_fit</code>åªé€‚ç”¨äº<code>vector</code>ã€<code>string</code>å’Œ<code>deque</code></li><li><code>capacity</code>å’Œ<code>reverse</code>åªé€‚ç”¨äº<code>vector</code>å’Œ<code>string</code>ã€‚</li></ul><h2 id="é¢å¤–çš„stringæ“ä½œ"><a href="#é¢å¤–çš„stringæ“ä½œ" class="headerlink" title="é¢å¤–çš„stringæ“ä½œ"></a>é¢å¤–çš„stringæ“ä½œ</h2><h3 id="æ„é€ stringçš„å…¶ä»–æ–¹æ³•"><a href="#æ„é€ stringçš„å…¶ä»–æ–¹æ³•" class="headerlink" title="æ„é€ stringçš„å…¶ä»–æ–¹æ³•"></a>æ„é€ stringçš„å…¶ä»–æ–¹æ³•</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>string s(cp, n)</code></td><td><code>s</code>æ˜¯<code>cp</code>æŒ‡å‘çš„æ•°ç»„ä¸­å‰<code>n</code>ä¸ªå­—ç¬¦çš„æ‹·è´ï¼Œæ­¤æ•°ç»„</td></tr><tr><td><code>string s(s2, pos2)</code></td><td><code>s</code>æ˜¯<code>string s2</code>ä»ä¸‹æ ‡<code>pos2</code>å¼€å§‹çš„å­—ç¬¦çš„æ‹·è´ã€‚è‹¥<code>pos2 &gt; s2.size()</code>ï¼Œåˆ™æ„é€ å‡½æ•°çš„è¡Œä¸ºæœªå®šä¹‰ã€‚</td></tr><tr><td><code>string s(s2, pos2, len2)</code></td><td><code>s</code>æ˜¯<code>string s2</code>ä»ä¸‹æ ‡<code>pos2</code>å¼€å§‹çš„<code>len2</code>ä¸ªå­—ç¬¦çš„æ‹·è´ã€‚</td></tr></tbody></table><ul><li><code>n</code>,<code>len2</code>,<code>pos2</code>éƒ½æ˜¯æ— ç¬¦å·å€¼ã€‚</li></ul><h3 id="substræ“ä½œ"><a href="#substræ“ä½œ" class="headerlink" title="substræ“ä½œ"></a>substræ“ä½œ</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>s.substr(pos, n)</code></td><td>è¿”å›ä¸€ä¸ª<code>string</code>ï¼ŒåŒ…å«<code>s</code>ä¸­ä»<code>pos</code>å¼€å§‹çš„<code>n</code>ä¸ªå­—ç¬¦çš„æ‹·è´ã€‚<code>pos</code>çš„é»˜è®¤å€¼æ˜¯0ï¼Œ<code>n</code>çš„é»˜è®¤å€¼æ˜¯<code>s.size() - pos</code>ï¼Œå³æ‹·è´ä»<code>pos</code>å¼€å§‹çš„æ‰€æœ‰å­—ç¬¦ã€‚</td></tr></tbody></table><h3 id="æ”¹å˜stringçš„å…¶ä»–æ–¹æ³•"><a href="#æ”¹å˜stringçš„å…¶ä»–æ–¹æ³•" class="headerlink" title="æ”¹å˜stringçš„å…¶ä»–æ–¹æ³•"></a>æ”¹å˜stringçš„å…¶ä»–æ–¹æ³•</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>s.insert(pos, args)</code></td><td>åœ¨<code>pos</code>ä¹‹å‰æ’å…¥<code>args</code>æŒ‡å®šçš„å­—ç¬¦ã€‚<code>pos</code>å¯ä»¥ä½¿æ˜¯ä¸‹æ ‡æˆ–è€…è¿­ä»£å™¨ã€‚æ¥å—ä¸‹æ ‡çš„ç‰ˆæœ¬è¿”å›æŒ‡å‘<code>s</code>çš„å¼•ç”¨ï¼›æ¥å—è¿­ä»£å™¨çš„ç‰ˆæœ¬è¿”å›æŒ‡å‘ç¬¬ä¸€ä¸ªæ’å…¥å­—ç¬¦çš„è¿­ä»£å™¨ã€‚</td></tr><tr><td><code>s.erase(pos, len)</code></td><td>åˆ é™¤ä»<code>pos</code>å¼€å§‹çš„<code>len</code>ä¸ªå­—ç¬¦ï¼Œå¦‚æœ<code>len</code>è¢«çœç•¥ï¼Œåˆ™åˆ é™¤åé¢æ‰€æœ‰å­—ç¬¦ï¼Œè¿”å›æŒ‡å‘<code>s</code>çš„å¼•ç”¨ã€‚</td></tr><tr><td><code>s.assign(args)</code></td><td>å°†<code>s</code>ä¸­çš„å­—ç¬¦æ›¿æ¢æˆ<code>args</code>æŒ‡å®šçš„å­—ç¬¦ã€‚è¿”å›ä¸€ä¸ªæŒ‡å‘<code>s</code>çš„å¼•ç”¨ã€‚</td></tr><tr><td><code>s.append(args)</code></td><td>å°†<code>args</code>æŒ‡å®šçš„å­—ç¬¦è¿½åŠ åˆ°<code>s</code>ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘<code>s</code>çš„å¼•ç”¨ã€‚</td></tr><tr><td><code>s.replace(range, args)</code></td><td>åˆ é™¤<code>s</code>ä¸­èŒƒå›´<code>range</code>ä¸­çš„å­—ç¬¦ï¼Œæ›¿æ¢æˆ<code>args</code>æŒ‡å®šçš„å­—ç¬¦ã€‚è¿”å›ä¸€ä¸ªæŒ‡å‘<code>s</code>çš„å¼•ç”¨ã€‚</td></tr></tbody></table><h3 id="stringæœç´¢æ“ä½œ"><a href="#stringæœç´¢æ“ä½œ" class="headerlink" title="stringæœç´¢æ“ä½œ"></a>stringæœç´¢æ“ä½œ</h3><ul><li><code>string</code>ç±»æä¾›äº†6ä¸ªä¸åŒçš„æœç´¢å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰4ä¸ªé‡è½½ç‰ˆæœ¬ã€‚</li><li>æ¯ä¸ªæœç´¢æ“ä½œéƒ½è¿”å›ä¸€ä¸ª<code>string::size_type</code>å€¼ï¼Œè¡¨ç¤ºåŒ¹é…å‘ç”Ÿä½ç½®çš„ä¸‹æ ‡ã€‚å¦‚æœæœç´¢å¤±è´¥åˆ™è¿”å›ä¸€ä¸ªåä¸º<code>string::npos</code>çš„<code>static</code>æˆå‘˜ï¼ˆç±»å‹æ˜¯<code>string::size_type</code>ï¼Œåˆå§‹åŒ–å€¼æ˜¯-1ï¼Œä¹Ÿå°±æ˜¯<code>string</code>æœ€å¤§çš„å¯èƒ½å¤§å°ï¼‰ã€‚</li></ul><table><thead><tr><th>æœç´¢æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>s.find(args)</code></td><td>æŸ¥æ‰¾<code>s</code>ä¸­<code>args</code>ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td><code>s.rfind(args)</code></td><td>æŸ¥æ‰¾<code>s</code>ä¸­<code>args</code>æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td><code>s.find_first_of(args)</code></td><td>åœ¨<code>s</code>ä¸­æŸ¥æ‰¾<code>args</code>ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td><code>s.find_last_of(args)</code></td><td>åœ¨<code>s</code>ä¸­æŸ¥æ‰¾<code>args</code>ä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td><code>s.find_first_not_of(args)</code></td><td>åœ¨<code>s</code>ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªä¸åœ¨<code>args</code>ä¸­çš„å­—ç¬¦</td></tr><tr><td><code>s.find_first_not_of(args)</code></td><td>åœ¨<code>s</code>ä¸­æŸ¥æ‰¾æœ€åä¸€ä¸ªä¸åœ¨<code>args</code>ä¸­çš„å­—ç¬¦</td></tr></tbody></table><p>argså¿…é¡»æ˜¯ä¸€ä¸‹çš„å½¢å¼ä¹‹ä¸€ï¼š</p><table><thead><tr><th><code>args</code>å½¢å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>c, pos</code></td><td>ä»<code>s</code>ä¸­ä½ç½®<code>pos</code>å¼€å§‹æŸ¥æ‰¾å­—ç¬¦<code>c</code>ã€‚<code>pos</code>é»˜è®¤æ˜¯0</td></tr><tr><td><code>s2, pos</code></td><td>ä»<code>s</code>ä¸­ä½ç½®<code>pos</code>å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ä¸²<code>s</code>ã€‚<code>pos</code>é»˜è®¤æ˜¯0</td></tr><tr><td><code>cp, pos</code></td><td>ä»<code>s</code>ä¸­ä½ç½®<code>pos</code>å¼€å§‹æŸ¥æ‰¾æŒ‡é’ˆ<code>cp</code>æŒ‡å‘çš„ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„Cé£æ ¼å­—ç¬¦ä¸²ã€‚<code>pos</code>é»˜è®¤æ˜¯0</td></tr><tr><td><code>cp, pos, n</code></td><td>ä»<code>s</code>ä¸­ä½ç½®<code>pos</code>å¼€å§‹æŸ¥æ‰¾æŒ‡é’ˆ<code>cp</code>æŒ‡å‘çš„å‰<code>n</code>ä¸ªå­—ç¬¦ã€‚<code>pos</code>å’Œ<code>n</code>æ— é»˜è®¤å€¼ã€‚</td></tr></tbody></table><h3 id="s-compareçš„å‡ ç§å‚æ•°å½¢å¼"><a href="#s-compareçš„å‡ ç§å‚æ•°å½¢å¼" class="headerlink" title="s.compareçš„å‡ ç§å‚æ•°å½¢å¼"></a>s.compareçš„å‡ ç§å‚æ•°å½¢å¼</h3><p>é€»è¾‘ç±»ä¼¼äºCæ ‡å‡†åº“çš„<code>strcmp</code>å‡½æ•°ï¼Œæ ¹æ®<code>s</code>æ˜¯ç­‰äºã€å¤§äºè¿˜æ˜¯å°äºå‚æ•°æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼Œ<code>s.compare</code>è¿”å›0ã€æ­£æ•°æˆ–è´Ÿæ•°ã€‚</p><table><thead><tr><th>å‚æ•°å½¢å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>s2</code></td><td>æ¯”è¾ƒ<code>s</code>å’Œ<code>s2</code></td></tr><tr><td><code>pos1, n1, s2</code></td><td>æ¯”è¾ƒ<code>s</code>ä»<code>pos1</code>å¼€å§‹çš„<code>n1</code>ä¸ªå­—ç¬¦å’Œ<code>s2</code></td></tr><tr><td><code>pos1, n1, s2, pos2, n2</code></td><td>æ¯”è¾ƒ<code>s</code>ä»<code>pos1</code>å¼€å§‹çš„<code>n1</code>ä¸ªå­—ç¬¦å’Œ<code>s2</code></td></tr><tr><td><code>cp</code></td><td>æ¯”è¾ƒ<code>s</code>å’Œ<code>cp</code>æŒ‡å‘çš„ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„</td></tr><tr><td><code>pos1, n1, cp</code></td><td>æ¯”è¾ƒ<code>s</code>ä»<code>pos1</code>å¼€å§‹çš„<code>n1</code>ä¸ªå­—ç¬¦å’Œ<code>cp</code>æŒ‡å‘çš„ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„</td></tr><tr><td><code>pos1, n1, cp, n2</code></td><td>æ¯”è¾ƒ<code>s</code>ä»<code>pos1</code>å¼€å§‹çš„<code>n1</code>ä¸ªå­—ç¬¦å’Œ<code>cp</code>æŒ‡å‘çš„åœ°å€å¼€å§‹<code>n2</code>ä¸ªå­—ç¬¦</td></tr></tbody></table><h3 id="stringå’Œæ•°å€¼è½¬æ¢"><a href="#stringå’Œæ•°å€¼è½¬æ¢" class="headerlink" title="stringå’Œæ•°å€¼è½¬æ¢"></a>stringå’Œæ•°å€¼è½¬æ¢</h3><table><thead><tr><th>è½¬æ¢</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>to_string(val)</code></td><td>ä¸€ç»„é‡è½½å‡½æ•°ï¼Œè¿”å›æ•°å€¼<code>val</code>çš„<code>string</code>è¡¨ç¤ºã€‚<code>val</code>å¯ä»¥ä½¿ä»»ä½•ç®—æœ¯ç±»å‹ã€‚å¯¹æ¯ä¸ªæµ®ç‚¹ç±»å‹å’Œ<code>int</code>æˆ–æ›´å¤§çš„æ•´å‹ï¼Œéƒ½æœ‰ç›¸åº”ç‰ˆæœ¬çš„<code>to_string()</code>ã€‚å’Œå¾€å¸¸ä¸€æ ·ï¼Œå°æ•´å‹ä¼šè¢«æå‡ã€‚</td></tr><tr><td><code>stoi(s, p, b)</code></td><td>è¿”å›<code>s</code>èµ·å§‹å­ä¸²ï¼ˆè¡¨ç¤ºæ•´æ•°å†…å®¹ï¼‰çš„æ•°å€¼ï¼Œ<code>p</code>æ˜¯<code>s</code>ä¸­ç¬¬ä¸€ä¸ªéæ•°å€¼å­—ç¬¦çš„ä¸‹æ ‡ï¼Œé»˜è®¤æ˜¯0ï¼Œ<code>b</code>æ˜¯è½¬æ¢æ‰€ç”¨çš„åŸºæ•°ã€‚è¿”å›<code>int</code></td></tr><tr><td><code>stol(s, p, b)</code></td><td>è¿”å›<code>long</code></td></tr><tr><td><code>stoul(s, p, b)</code></td><td>è¿”å›<code>unsigned long</code></td></tr><tr><td><code>stoll(s, p, b)</code></td><td>è¿”å›<code>long long</code></td></tr><tr><td><code>stoull(s, p, b)</code></td><td>è¿”å›<code>unsigned long long</code></td></tr><tr><td><code>stof(s, p)</code></td><td>è¿”å›<code>s</code>èµ·å§‹å­ä¸²ï¼ˆè¡¨ç¤ºæµ®ç‚¹æ•°å†…å®¹ï¼‰çš„æ•°å€¼ï¼Œ<code>p</code>æ˜¯<code>s</code>ä¸­ç¬¬ä¸€ä¸ªéæ•°å€¼å­—ç¬¦çš„ä¸‹æ ‡ï¼Œé»˜è®¤æ˜¯0ã€‚è¿”å›<code>float</code></td></tr><tr><td><code>stod(s, p)</code></td><td>è¿”å›<code>double</code></td></tr><tr><td><code>stold(s, p)</code></td><td>è¿”å›<code>long double</code></td></tr></tbody></table><h2 id="å®¹å™¨é€‚é…å™¨ï¼ˆadapterï¼‰"><a href="#å®¹å™¨é€‚é…å™¨ï¼ˆadapterï¼‰" class="headerlink" title="å®¹å™¨é€‚é…å™¨ï¼ˆadapterï¼‰"></a>å®¹å™¨é€‚é…å™¨ï¼ˆadapterï¼‰</h2><ul><li>é€‚é…å™¨æ˜¯ä½¿ä¸€äº‹ç‰©çš„è¡Œä¸ºç±»ä¼¼äºå¦ä¸€äº‹ç‰©çš„è¡Œä¸ºçš„ä¸€ç§æœºåˆ¶ï¼Œä¾‹å¦‚<code>stack</code>å¯ä»¥ä½¿ä»»ä½•ä¸€ç§é¡ºåºå®¹å™¨ä»¥æ ˆçš„æ–¹å¼å·¥ä½œã€‚</li><li>åˆå§‹åŒ– <code>deque&lt;int&gt; deq; stack&lt;int&gt; stk(deq);</code> ä»<code>deq</code>æ‹·è´å…ƒç´ åˆ°<code>stk</code>ã€‚</li><li>åˆ›å»ºé€‚é…å™¨æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ªé¡ºåºå®¹å™¨ï¼Œå¯ä»¥è¦†ç›–é»˜è®¤çš„åŸºç¡€å®¹å™¨ï¼š <code>stack&lt;string, vector&lt;string&gt; &gt; str_stk;</code>ã€‚</li></ul><h3 id="é€‚é…å™¨çš„é€šç”¨æ“ä½œå’Œç±»å‹"><a href="#é€‚é…å™¨çš„é€šç”¨æ“ä½œå’Œç±»å‹" class="headerlink" title="é€‚é…å™¨çš„é€šç”¨æ“ä½œå’Œç±»å‹"></a>é€‚é…å™¨çš„é€šç”¨æ“ä½œå’Œç±»å‹</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>size_type</code></td><td>ä¸€ç§ç±»å‹ï¼Œé¡»ä»¥ä¿å­˜å½“å‰ç±»å‹çš„æœ€å¤§å¯¹è±¡çš„å¤§å°</td></tr><tr><td><code>value_type</code></td><td>å…ƒç´ ç±»å‹</td></tr><tr><td><code>container_type</code></td><td>å®ç°é€‚é…å™¨çš„åº•å±‚å®¹å™¨ç±»å‹</td></tr><tr><td><code>A a;</code></td><td>åˆ›å»ºä¸€ä¸ªåä¸º<code>a</code>çš„ç©ºé€‚é…å™¨</td></tr><tr><td><code>A a(c)</code></td><td>åˆ›å»ºä¸€ä¸ªåä¸º<code>a</code>çš„é€‚é…å™¨ï¼Œå¸¦æœ‰å®¹å™¨<code>c</code>çš„ä¸€ä¸ªæ‹·è´</td></tr><tr><td>å…³ç³»è¿ç®—ç¬¦</td><td>æ¯ä¸ªé€‚é…å™¨éƒ½æ”¯æŒæ‰€æœ‰å…³ç³»è¿ç®—ç¬¦ï¼š<code>==</code>ã€<code>!=</code>ã€<code>&lt;</code>ã€ <code>&lt;=</code>ã€<code>&gt;</code>ã€<code>&gt;=</code>è¿™äº›è¿ç®—ç¬¦è¿”å›åº•å±‚å®¹å™¨çš„æ¯”è¾ƒç»“æœ</td></tr><tr><td><code>a.empty()</code></td><td>è‹¥<code>a</code>åŒ…å«ä»»ä½•å…ƒç´ ï¼Œè¿”å›<code>false</code>;å¦åˆ™è¿”å›<code>true</code></td></tr><tr><td><code>a.size()</code></td><td>è¿”å›<code>a</code>ä¸­çš„å…ƒç´ æ•°ç›®</td></tr><tr><td><code>swap(a, b)</code></td><td>äº¤æ¢<code>a</code>å’Œ<code>b</code>çš„å†…å®¹ï¼Œ<code>a</code>å’Œ<code>b</code>å¿…é¡»æœ‰ç›¸åŒç±»å‹ï¼ŒåŒ…æ‹¬åº•å±‚å®¹å™¨ç±»å‹ä¹Ÿå¿…é¡»ç›¸åŒ</td></tr><tr><td><code>a.swap(b)</code></td><td>åŒä¸Š</td></tr></tbody></table><h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a>stack</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>s.pop()</code></td><td>åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œä¸è¿”å›ã€‚</td></tr><tr><td><code>s.push(item)</code></td><td>åˆ›å»ºä¸€ä¸ªæ–°å…ƒç´ ï¼Œå‹å…¥æ ˆé¡¶ï¼Œè¯¥å…ƒç´ é€šè¿‡æ‹·è´æˆ–ç§»åŠ¨<code>item</code>è€Œæ¥</td></tr><tr><td><code>s.emplace(args)</code></td><td>åŒä¸Šï¼Œä½†å…ƒç´ ç”±<code>args</code>æ¥æ„é€ ã€‚</td></tr><tr><td><code>s.top()</code></td><td>è¿”å›æ ˆé¡¶å…ƒç´ ï¼Œä¸åˆ é™¤ã€‚</td></tr></tbody></table><ul><li>å®šä¹‰åœ¨<code>stack</code>å¤´æ–‡ä»¶ä¸­ã€‚</li><li><code>stack</code>é»˜è®¤åŸºäº<code>deque</code>å®ç°ï¼Œä¹Ÿå¯ä»¥åœ¨<code>list</code>æˆ–<code>vector</code>ä¹‹ä¸Šå®ç°ã€‚</li></ul><h3 id="queueå’Œpriority-queue"><a href="#queueå’Œpriority-queue" class="headerlink" title="queueå’Œpriority_queue"></a>queueå’Œpriority_queue</h3><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>q.pop()</code></td><td>åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œä½†ä¸è¿”å›ã€‚</td></tr><tr><td><code>q.front()</code></td><td>è¿”å›é˜Ÿé¦–å…ƒç´ çš„å€¼ï¼Œä¸åˆ é™¤ã€‚</td></tr><tr><td><code>q.back()</code></td><td>è¿”å›é˜Ÿå°¾å…ƒç´ çš„å€¼ï¼Œä¸åˆ é™¤ã€‚åªé€‚ç”¨äº<code>queue</code></td></tr><tr><td><code>q.top()</code></td><td>è¿”å›å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§çš„å…ƒç´ å€¼ï¼Œä¸åˆ é™¤ã€‚</td></tr><tr><td><code>q.push(item)</code></td><td>åœ¨é˜Ÿå°¾å‹å…¥ä¸€ä¸ªæ–°å…ƒç´ ã€‚</td></tr><tr><td><code>q.emplace(args)</code></td><td></td></tr></tbody></table><ul><li>å®šä¹‰åœ¨<code>queue</code>å¤´æ–‡ä»¶ä¸­ã€‚</li><li><code>queue</code>é»˜è®¤åŸºäº<code>deque</code>å®ç°ï¼Œ<code>priority_queue</code>é»˜è®¤åŸºäº<code>vector</code>å®ç°ã€‚</li><li><code>queue</code>å¯ä»¥åœ¨<code>list</code>æˆ–<code>vector</code>ä¹‹ä¸Šå®ç°ï¼Œ<code>priority_queue</code>ä¹Ÿå¯ä»¥ç”¨<code>deque</code>å®ç°ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerç¬”è®°17</title>
      <link href="2021/04/10/notes/ch17/"/>
      <url>2021/04/10/notes/ch17/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸ƒç« -æ ‡å‡†åº“ç‰¹æ®Šè®¾æ–½"><a href="#ç¬¬åä¸ƒç« -æ ‡å‡†åº“ç‰¹æ®Šè®¾æ–½" class="headerlink" title="ç¬¬åä¸ƒç«  æ ‡å‡†åº“ç‰¹æ®Šè®¾æ–½"></a>ç¬¬åä¸ƒç«  æ ‡å‡†åº“ç‰¹æ®Šè®¾æ–½</h1><h2 id="tupleç±»å‹"><a href="#tupleç±»å‹" class="headerlink" title="tupleç±»å‹"></a>tupleç±»å‹</h2><ul><li><code>tuple</code>æ˜¯ç±»ä¼¼<code>pair</code>çš„æ¨¡æ¿ï¼Œæ¯ä¸ªæˆå‘˜ç±»å‹éƒ½å¯ä»¥ä¸åŒï¼Œä½†<code>tuple</code>å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„æˆå‘˜ã€‚</li><li>ä½†æ¯ä¸ªç¡®å®šçš„<code>tuple</code>ç±»å‹çš„æˆå‘˜æ•°ç›®æ˜¯å›ºå®šçš„ã€‚</li><li>æˆ‘ä»¬å¯ä»¥å°†<code>tuple</code>çœ‹åšä¸€ä¸ªâ€œå¿«é€Ÿè€Œéšæ„â€çš„æ•°æ®ç»“æ„ã€‚</li></ul><p><strong>tupleæ”¯æŒçš„æ“ä½œ</strong>ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>tuple&lt;T1, T2, ..., Tn&gt; t;</code></td><td><code>t</code>æ˜¯ä¸€ä¸ª<code>tuple</code>ï¼Œæˆå‘˜æ•°ä¸º<code>n</code>ï¼Œç¬¬<code>i</code>ä¸ªæˆå‘˜çš„ç±»å‹æ˜¯<code>Ti</code>æ‰€æœ‰æˆå‘˜éƒ½è¿›è¡Œå€¼åˆå§‹åŒ–ã€‚</td></tr><tr><td><code>tuple&lt;T1, T2, ..., Tn&gt; t(v1, v2, ..., vn);</code></td><td>æ¯ä¸ªæˆå‘˜ç”¨å¯¹åº”çš„åˆå§‹å€¼<code>vi</code>è¿›è¡Œåˆå§‹åŒ–ã€‚æ­¤æ„é€ å‡½æ•°æ˜¯<code>explicit</code>çš„ã€‚</td></tr><tr><td><code>make_tuple(v1, v2, ..., vn)</code></td><td>è¿”å›ä¸€ä¸ªç”¨ç»™å®šåˆå§‹å€¼åˆå§‹åŒ–çš„<code>tuple</code>ã€‚<code>tuple</code>çš„ç±»å‹ä»åˆå§‹å€¼çš„ç±»å‹<strong>æ¨æ–­</strong>ã€‚</td></tr><tr><td><code>t1 == t2</code></td><td>å½“ä¸¤ä¸ª<code>tuple</code>å…·æœ‰ç›¸åŒæ•°é‡çš„æˆå‘˜ä¸”æˆå‘˜å¯¹åº”ç›¸ç­‰æ—¶ï¼Œä¸¤ä¸ª<code>tuple</code>ç›¸ç­‰ã€‚</td></tr><tr><td><code>t1 relop t2</code></td><td><code>tuple</code>çš„å…³ç³»è¿ç®—ä½¿ç”¨<strong>å­—å…¸åº</strong>ã€‚ä¸¤ä¸ª<code>tuple</code>å¿…é¡»å…·æœ‰ç›¸åŒæ•°é‡çš„æˆå‘˜ã€‚</td></tr><tr><td><code>get&lt;i&gt;(t)</code></td><td>è¿”å›<code>t</code>çš„ç¬¬<code>i</code>ä¸ªæ•°æ®æˆå‘˜çš„å¼•ç”¨ï¼šå¦‚æœ<code>t</code>æ˜¯ä¸€ä¸ªå·¦å€¼ï¼Œç»“æœæ˜¯ä¸€ä¸ªå·¦å€¼å¼•ç”¨ï¼›å¦åˆ™ï¼Œç»“æœæ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚<code>tuple</code>çš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯<code>public</code>çš„ã€‚</td></tr><tr><td><code>tuple_size&lt;tupleType&gt;::value</code></td><td>ä¸€ä¸ªç±»æ¨¡æ¿ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ª<code>tuple</code>ç±»å‹æ¥åˆå§‹åŒ–ã€‚å®ƒæœ‰ä¸€ä¸ªåä¸º<code>value</code>çš„<code>public constexpr static</code>æ•°æ®æˆå‘˜ï¼Œç±»å‹ä¸º<code>size_t</code>ï¼Œè¡¨ç¤ºç»™å®š<code>tuple</code>ç±»å‹ä¸­æˆå‘˜çš„æ•°é‡ã€‚</td></tr><tr><td><code>tuple_element&lt;i, tupleType&gt;::type</code></td><td>ä¸€ä¸ªç±»æ¨¡æ¿ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªæ•´å‹å¸¸é‡å’Œä¸€ä¸ª<code>tuple</code>ç±»å‹æ¥åˆå§‹åŒ–ã€‚å®ƒæœ‰ä¸€ä¸ªåä¸º<code>type</code>çš„<code>public</code>æˆå‘˜ï¼Œè¡¨ç¤ºç»™å®š<code>tuple</code>ç±»å‹ä¸­æŒ‡å®šæˆå‘˜çš„ç±»å‹ã€‚</td></tr></tbody></table><h3 id="å®šä¹‰å’Œåˆå§‹åŒ–tuple"><a href="#å®šä¹‰å’Œåˆå§‹åŒ–tuple" class="headerlink" title="å®šä¹‰å’Œåˆå§‹åŒ–tuple"></a>å®šä¹‰å’Œåˆå§‹åŒ–tuple</h3><p>å®šä¹‰å’Œåˆå§‹åŒ–ç¤ºä¾‹ï¼š</p><ul><li><code>tuple&lt;size_t, size_t, size_t&gt; threeD;</code></li><li><code>tuple&lt;size_t, size_t, size_t&gt; threeD&#123;1,2,3&#125;;</code></li><li><code>auto item = make_tuple(&quot;0-999-78345-X&quot;, 3, 2.00)ï¼›</code></li></ul><p>è®¿é—®tupleæˆå‘˜ï¼š</p><ul><li><code>auto book = get&lt;0&gt;(item);</code></li><li><code>get&lt;2&gt;(item) *= 0.8;</code></li></ul><h3 id="ä½¿ç”¨tupleè¿”å›å¤šä¸ªå€¼"><a href="#ä½¿ç”¨tupleè¿”å›å¤šä¸ªå€¼" class="headerlink" title="ä½¿ç”¨tupleè¿”å›å¤šä¸ªå€¼"></a>ä½¿ç”¨tupleè¿”å›å¤šä¸ªå€¼</h3><ul><li><code>tuple</code>æœ€å¸¸è§çš„ç”¨é€”æ˜¯ä»ä¸€ä¸ªå‡½æ•°è¿”å›å¤šä¸ªå€¼ã€‚</li></ul><h2 id="bitsetç±»å‹"><a href="#bitsetç±»å‹" class="headerlink" title="bitsetç±»å‹"></a>bitsetç±»å‹</h2><ul><li>å¤„ç†äºŒè¿›åˆ¶ä½çš„æœ‰åºé›†ï¼›</li><li><code>bitset</code>ä¹Ÿæ˜¯ç±»æ¨¡æ¿ï¼Œä½†å°–æ‹¬å·ä¸­è¾“å…¥çš„æ˜¯<code>bitset</code>çš„é•¿åº¦è€Œä¸æ˜¯å…ƒç´ ç±»å‹ï¼Œå› ä¸ºå…ƒç´ ç±»å‹æ˜¯å›ºå®šçš„ï¼Œéƒ½æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ä½ã€‚</li></ul><p>åˆå§‹åŒ–<code>bitset</code>çš„æ–¹æ³•ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>bitset&lt;n&gt; b;</code></td><td><code>b</code>æœ‰<code>n</code>ä½ï¼›æ¯ä¸€ä½å‡æ˜¯0.æ­¤æ„é€ å‡½æ•°æ˜¯ä¸€ä¸ª<code>constexpr</code>ã€‚</td></tr><tr><td><code>bitset&lt;n&gt; b(u);</code></td><td><code>b</code>æ˜¯<code>unsigned long long</code>å€¼<code>u</code>çš„ä½<code>n</code>ä½çš„æ‹·è´ã€‚å¦‚æœ<code>n</code>å¤§äº<code>unsigned long long</code>çš„å¤§å°ï¼Œåˆ™<code>b</code>ä¸­è¶…å‡º<code>unsigned long long</code>çš„é«˜ä½è¢«ç½®ä¸º0ã€‚æ­¤æ„é€ å‡½æ•°æ˜¯ä¸€ä¸ª<code>constexpr</code>ã€‚</td></tr><tr><td><code>bitset&lt;n&gt; b(s, pos, m, zero, one);</code></td><td><code>b</code>æ˜¯<code>string s</code>ä»ä½ç½®<code>pos</code>å¼€å§‹<code>m</code>ä¸ªå­—ç¬¦çš„æ‹·è´ã€‚<code>s</code>åªèƒ½åŒ…å«å­—ç¬¦<code>zero</code>æˆ–<code>one</code>ï¼šå¦‚æœ<code>s</code>åŒ…å«ä»»ä½•å…¶ä»–å­—ç¬¦ï¼Œæ„é€ å‡½æ•°ä¼šæŠ›å‡º<code>invalid_argument</code>å¼‚å¸¸ã€‚å­—ç¬¦åœ¨<code>b</code>ä¸­åˆ†åˆ«ä¿å­˜ä¸º<code>zero</code>å’Œ<code>one</code>ã€‚<code>pos</code>é»˜è®¤ä¸º0ï¼Œ<code>m</code>é»˜è®¤ä¸º<code>string::npos</code>ï¼Œ<code>zero</code>é»˜è®¤ä¸ºâ€™0â€™ï¼Œ<code>one</code>é»˜è®¤ä¸ºâ€™1â€™ã€‚</td></tr><tr><td><code>bitset&lt;n&gt; b(cp, pos, m, zero, one);</code></td><td>å’Œä¸Šä¸€ä¸ªæ„é€ å‡½æ•°ç›¸åŒï¼Œä½†ä»<code>cp</code>æŒ‡å‘çš„å­—ç¬¦æ•°ç»„ä¸­æ‹·è´å­—ç¬¦ã€‚å¦‚æœæœªæä¾›<code>m</code>ï¼Œåˆ™<code>cp</code>å¿…é¡»æŒ‡å‘ä¸€ä¸ª<code>C</code>é£æ ¼å­—ç¬¦ä¸²ã€‚å¦‚æœæä¾›äº†<code>m</code>ï¼Œåˆ™ä»<code>cp</code>å¼€å§‹å¿…é¡»è‡³å°‘æœ‰<code>m</code>ä¸ª<code>zero</code>æˆ–<code>one</code>å­—ç¬¦ã€‚</td></tr></tbody></table><p>åˆå§‹åŒ–æ¡ˆä¾‹ï¼›</p><ul><li><code>bitset&lt;13&gt; bitvec1(0xbeef);</code></li><li><code>bitset&lt;32&gt; bitvec4(&quot;1100&quot;);</code></li></ul><p><code>bitset</code>æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>b.any()</code></td><td><code>b</code>ä¸­æ˜¯å¦å­˜åœ¨1ã€‚</td></tr><tr><td><code>b.all()</code></td><td><code>b</code>ä¸­éƒ½æ˜¯1ã€‚</td></tr><tr><td><code>b.none()</code></td><td><code>b</code>ä¸­æ˜¯å¦æ²¡æœ‰1ã€‚</td></tr><tr><td><code>b.count()</code></td><td><code>b</code>ä¸­1çš„ä¸ªæ•°ã€‚</td></tr><tr><td><code>b.size()</code></td><td></td></tr><tr><td><code>b.test(pos)</code></td><td><code>pos</code>ä¸‹æ ‡æ˜¯å¦æ˜¯1</td></tr><tr><td><code>b.set(pos)</code></td><td><code>pos</code>ç½®1</td></tr><tr><td><code>b.set()</code></td><td>æ‰€æœ‰éƒ½ç½®1</td></tr><tr><td><code>b.reset(pos)</code></td><td>å°†ä½ç½®<code>pos</code>å¤„çš„ä½å¤ä½</td></tr><tr><td><code>b.reset()</code></td><td>å°†<code>b</code>ä¸­æ‰€æœ‰ä½å¤ä½</td></tr><tr><td><code>b.flip(pos)</code></td><td>å°†ä½ç½®<code>pos</code>å¤„çš„ä½å–å</td></tr><tr><td><code>b.flip()</code></td><td>å°†<code>b</code>ä¸­æ‰€æœ‰ä½å–å</td></tr><tr><td><code>b[pos]</code></td><td>è®¿é—®<code>b</code>ä¸­ä½ç½®<code>pos</code>å¤„çš„ä½ï¼›å¦‚æœ<code>b</code>æ˜¯<code>const</code>çš„ï¼Œåˆ™å½“è¯¥ä½ç½®ä½æ—¶ï¼Œè¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code>ã€‚</td></tr><tr><td><code>b.to_ulong()</code></td><td>è¿”å›ä¸€ä¸ª<code>unsigned long</code>å€¼ï¼Œå…¶ä½æ¨¡å¼å’Œ<code>b</code>ç›¸åŒã€‚å¦‚æœ<code>b</code>ä¸­ä½æ¨¡å¼ä¸èƒ½æ”¾å…¥æŒ‡å®šçš„ç»“æœç±»å‹ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª<code>overflow_error</code>å¼‚å¸¸ã€‚</td></tr><tr><td><code>b.to_ullong()</code></td><td>ç±»ä¼¼ä¸Šé¢ï¼Œè¿”å›ä¸€ä¸ª<code>unsigned long long</code>å€¼ã€‚</td></tr><tr><td><code>b.to_string(zero, one)</code></td><td>è¿”å›ä¸€ä¸ª<code>string</code>ï¼Œè¡¨ç¤º<code>b</code>ä¸­ä½æ¨¡å¼ã€‚<code>zero</code>å’Œ<code>one</code>é»˜è®¤ä¸º0å’Œ1ã€‚</td></tr><tr><td><code>os &lt;&lt; b</code></td><td>å°†<code>b</code>ä¸­äºŒè¿›åˆ¶ä½æ‰“å°ä¸ºå­—ç¬¦<code>1</code>æˆ–<code>0</code>ï¼Œæ‰“å°åˆ°æµ<code>os</code>ã€‚</td></tr><tr><td><code>is &gt;&gt; b</code></td><td>ä»<code>is</code>è¯»å–å­—ç¬¦å­˜å…¥<code>b</code>ã€‚å½“ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯1æˆ–0æ—¶ï¼Œæˆ–æ˜¯å·²ç»è¯»å…¥<code>b.size()</code>ä¸ªä½æ—¶ï¼Œè¯»å–è¿‡ç¨‹åœæ­¢ã€‚</td></tr></tbody></table><h2 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h2><ul><li>æ­£åˆ™è¡¨è¾¾å¼ï¼ˆreqular expressionï¼‰æ˜¯ä¸€ç§æè¿°å­—ç¬¦åºåˆ—çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ç§å¾ˆå¼ºå¤§çš„å·¥å…·ã€‚</li></ul><p>æ­£åˆ™è¡¨è¾¾å¼åº“ç»„ä»¶ï¼š</p><table><thead><tr><th>ç»„ä»¶</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>regex</code></td><td>è¡¨ç¤ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ç±»</td></tr><tr><td><code>regex_match</code></td><td>å°†ä¸€ä¸ªå­—ç¬¦åºåˆ—ä¸ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</td></tr><tr><td><code>regex_search</code></td><td>å¯»æ‰¾ç¬¬ä¸€ä¸ªä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„å­åºåˆ—</td></tr><tr><td><code>regex_replace</code></td><td>ä½¿ç”¨ç»™å®šæ ¼å¼æ›¿æ¢ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td><code>sregex_iterator</code></td><td>è¿­ä»£å™¨é€‚é…å™¨ï¼Œè°ƒç”¨<code>regex_searcg</code>æ¥éå†ä¸€ä¸ª<code>string</code>ä¸­æ‰€æœ‰åŒ¹é…çš„å­ä¸²</td></tr><tr><td><code>smatch</code></td><td>å®¹å™¨ç±»ï¼Œä¿å­˜åœ¨<code>string</code>ä¸­æœç´¢çš„ç»“æœ</td></tr><tr><td><code>ssub_match</code></td><td><code>string</code>ä¸­åŒ¹é…çš„å­è¡¨è¾¾å¼çš„ç»“æœ</td></tr></tbody></table><p><code>regex_match</code>å’Œ<code>regex_search</code>çš„å‚æ•°ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>(seq, m, r, mft)</code></td><td>åœ¨å­—ç¬¦åºåˆ—<code>seq</code>ä¸­æŸ¥æ‰¾<code>regex</code>å¯¹è±¡<code>r</code>ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚<code>seq</code>å¯ä»¥æ˜¯ä¸€ä¸ª<code>string</code>ã€æ ‡è¯†èŒƒå›´çš„ä¸€å¯¹è¿­ä»£å™¨ã€ä¸€ä¸ªæŒ‡å‘ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆã€‚</td></tr><tr><td><code>(seq, r, mft)</code></td><td><code>m</code>æ˜¯ä¸€ä¸ª<code>match</code>å¯¹è±¡ï¼Œç”¨æ¥ä¿å­˜åŒ¹é…ç»“æœçš„ç›¸å…³ç»†èŠ‚ã€‚<code>m</code>å’Œ<code>seq</code>å¿…é¡»å…·æœ‰å…¼å®¹çš„ç±»å‹ã€‚<code>mft</code>æ˜¯ä¸€ä¸ªå¯é€‰çš„<code>regex_constants::match_flag_type</code>å€¼ã€‚</td></tr></tbody></table><ul><li>è¿™äº›æ“ä½œä¼šè¿”å›<code>bool</code>å€¼ï¼ŒæŒ‡å‡ºæ˜¯å¦æ‰¾åˆ°åŒ¹é…ã€‚</li></ul><h3 id="ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åº“"><a href="#ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åº“" class="headerlink" title="ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åº“"></a>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åº“</h3><ul><li><code>regex</code>ä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼è¯­è¨€æ˜¯<code>ECMAScript</code>ï¼Œæ¨¡å¼<code>[[::alpha::]]</code>åŒ¹é…ä»»æ„å­—æ¯ã€‚</li><li>ç”±äºåæ–œçº¿æ˜¯C++ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œåœ¨æ¨¡å¼ä¸­æ¯æ¬¡å‡ºç°<code>\</code>çš„åœ°æ–¹ï¼Œå¿…é¡»ç”¨ä¸€ä¸ªé¢å¤–çš„åæ–œçº¿<code>\\</code>å‘ŠçŸ¥C++æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåæ–œçº¿å­—ç¬¦ã€‚</li><li>ç®€å•æ¡ˆä¾‹ï¼š<ul><li><code>string pattern(&quot;[^c]ei&quot;); pattern = &quot;[[:alpha:]]*&quot; + pattern + &quot;[[:alpha:]]*&quot;</code> æŸ¥æ‰¾ä¸åœ¨å­—ç¬¦cä¹‹åçš„å­—ç¬¦ä¸²ei</li><li><code>regex r(pattern);</code> æ„é€ ä¸€ä¸ªç”¨äºæŸ¥æ‰¾æ¨¡å¼çš„regex</li><li><code>smatch results;</code> å®šä¹‰ä¸€ä¸ªå¯¹è±¡ä¿å­˜æœç´¢ç»“æœ</li><li><code>string test_str = &quot;receipt freind theif receive&quot;;</code></li><li><code>if (regex_search(test_str, results, r)) cout &lt;&lt; results.str() &lt;&lt; endl;</code> å¦‚æœ‰åŒ¹é…å­ä¸²ï¼Œæ‰“å°åŒ¹é…çš„å•è¯ã€‚</li></ul></li></ul><p><code>regex</code>ï¼ˆå’Œ<code>wregex</code>ï¼‰é€‰é¡¹ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>regex r(re)</code> <code>regex r(re, f)</code></td><td><code>re</code>è¡¨ç¤ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ª<code>string</code>ã€ä¸€å¯¹è¡¨ç¤ºå­—ç¬¦èŒƒå›´çš„è¿­ä»£å™¨ã€ä¸€ä¸ªæŒ‡å‘ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆã€ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆå’Œä¸€ä¸ªè®¡æ•°å™¨ã€ä¸€ä¸ªèŠ±æ‹¬å·åŒ…å›´çš„å­—ç¬¦åˆ—è¡¨ã€‚<code>f</code>æ˜¯æŒ‡å‡ºå¯¹è±¡å¦‚ä½•å¤„ç†çš„æ ‡å¿—ã€‚<code>f</code>é€šè¿‡ä¸‹é¢åˆ—å‡ºæ¥çš„å€¼æ¥è®¾ç½®ã€‚å¦‚æœæœªæŒ‡å®š<code>f</code>ï¼Œå…¶é»˜è®¤å€¼ä¸º<code>ECMAScript</code>ã€‚</td></tr><tr><td><code>r1 = re</code></td><td>å°†<code>r1</code>ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢Wie<code>re</code>ã€‚<code>re</code>è¡¨ç¤ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥æ˜¯å¦ä¸€ä¸ª<code>regex</code>å¯¹è±¡ã€ä¸€ä¸ª<code>string</code>ã€ä¸€ä¸ªæŒ‡å‘ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆæˆ–æ˜¯ä¸€ä¸ªèŠ±æ‹¬å·åŒ…å›´çš„å­—ç¬¦åˆ—è¡¨ã€‚</td></tr><tr><td><code>r1.assign(re, f)</code></td><td>å’Œä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ=ï¼‰çš„æ•ˆæœç›¸åŒï¼šå¯é€‰çš„æ ‡å¿—<code>f</code>ä¹Ÿå’Œ<code>regex</code>çš„æ„é€ å‡½æ•°ä¸­å¯¹åº”çš„å‚æ•°å«ä¹‰ç›¸åŒã€‚</td></tr><tr><td><code>r.mark_count()</code></td><td><code>r</code>ä¸­å­è¡¨è¾¾å¼çš„æ•°ç›®</td></tr><tr><td><code>r.flags()</code></td><td>è¿”å›<code>r</code>çš„æ ‡å¿—é›†</td></tr></tbody></table><p>å®šä¹‰<code>regex</code>æ—¶æŒ‡å®šçš„æ ‡å¿—ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>icase</code></td><td>åœ¨åŒ¹é…è¿‡ç¨‹ä¸­å¿½ç•¥å¤§å°å†™</td></tr><tr><td><code>nosubs</code></td><td>ä¸ä¿å­˜åŒ¹é…çš„å­è¡¨è¾¾å¼</td></tr><tr><td><code>optimize</code></td><td>æ‰§è¡Œé€Ÿåº¦ä¼˜å…ˆäºæ„é€ é€Ÿåº¦</td></tr><tr><td><code>ECMAScript</code></td><td>ä½¿ç”¨<code>ECMA-262</code>æŒ‡å®šçš„è¯­æ³•</td></tr><tr><td><code>basic</code></td><td>ä½¿ç”¨<code>POSIX</code>åŸºæœ¬çš„æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•</td></tr><tr><td><code>extended</code></td><td>ä½¿ç”¨<code>POSIX</code>æ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•</td></tr><tr><td><code>awk</code></td><td>ä½¿ç”¨<code>POSIX</code>ç‰ˆæœ¬çš„<code>awk</code>è¯­è¨€çš„è¯­æ³•</td></tr><tr><td><code>grep</code></td><td>ä½¿ç”¨<code>POSIX</code>ç‰ˆæœ¬çš„<code>grep</code>çš„è¯­æ³•</td></tr><tr><td><code>egrep</code></td><td>ä½¿ç”¨<code>POSIX</code>ç‰ˆæœ¬çš„<code>egrep</code>çš„è¯­æ³•</td></tr></tbody></table><ul><li>å¯ä»¥å°†æ­£åˆ™è¡¨è¾¾å¼æœ¬èº«çœ‹åšæ˜¯ä¸€ç§ç®€å•ç¨‹åºè¯­è¨€è®¾è®¡çš„ç¨‹åºã€‚åœ¨è¿è¡Œæ—¶ï¼Œå½“ä¸€ä¸ª<code>regex</code>å¯¹è±¡è¢«åˆå§‹åŒ–æˆ–è¢«èµ‹äºˆæ–°æ¨¡å¼æ—¶ï¼Œæ‰è¢«â€œç¼–è¯‘â€ã€‚</li><li>å¦‚æœç¼–å†™çš„æ­£åˆ™è¡¨è¾¾å¼å­˜åœ¨é”™è¯¯ï¼Œä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡ºä¸€ä¸ª<code>regex_error</code>çš„å¼‚å¸¸ã€‚</li><li>é¿å…åˆ›å»ºä¸å¿…è¦çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚æ„å»ºä¸€ä¸ª<code>regex</code>å¯¹è±¡å¯èƒ½æ¯”è¾ƒè€—æ—¶ã€‚</li></ul><h3 id="åŒ¹é…ä¸regexè¿­ä»£å™¨ç±»å‹"><a href="#åŒ¹é…ä¸regexè¿­ä»£å™¨ç±»å‹" class="headerlink" title="åŒ¹é…ä¸regexè¿­ä»£å™¨ç±»å‹"></a>åŒ¹é…ä¸regexè¿­ä»£å™¨ç±»å‹</h3><p><code>sregex_iterator</code>æ“ä½œï¼ˆç”¨æ¥è·å¾—æ‰€æœ‰åŒ¹é…ï¼‰ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>sregex_iterator it(b, e, r);</code></td><td>ä¸€ä¸ª<code>sregex_iterator</code>ï¼Œéå†è¿­ä»£å™¨<code>b</code>å’Œ<code>e</code>è¡¨ç¤ºçš„<code>string</code>ã€‚å®ƒè°ƒç”¨<code>sregex_search(b, e, r)</code>å°†<code>it</code>å®šä½åˆ°è¾“å…¥ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½®ã€‚</td></tr><tr><td><code>sregex_iterator end;</code></td><td><code>sregex_iterator</code>çš„å°¾åè¿­ä»£å™¨</td></tr><tr><td><code>*it</code>ï¼Œ <code>it-&gt;</code></td><td>æ ¹æ®æœ€åä¸€ä¸ªè°ƒç”¨<code>regex_search</code>çš„ç»“æœï¼Œè¿”å›ä¸€ä¸ª<code>smatch</code>å¯¹è±¡çš„å¼•ç”¨æˆ–ä¸€ä¸ªæŒ‡å‘<code>smatch</code>å¯¹è±¡çš„æŒ‡é’ˆã€‚</td></tr><tr><td><code>++it</code> ï¼Œ <code>it++</code></td><td>ä»è¾“å…¥åºåˆ—å½“å‰åŒ¹é…ä½ç½®å¼€å§‹è°ƒç”¨<code>regex_search</code>ã€‚å‰ç½®ç‰ˆæœ¬è¿”å›é€’å¢åè¿­ä»£å™¨ï¼›åç½®ç‰ˆæœ¬è¿”å›æ—§å€¼ã€‚</td></tr><tr><td><code>it1 == it2</code></td><td>å¦‚æœä¸¤ä¸ª<code>sregex_iterator</code>éƒ½æ˜¯å°¾åè¿­ä»£å™¨ï¼Œåˆ™å®ƒä»¬ç›¸ç­‰ã€‚ä¸¤ä¸ªéå°¾åè¿­ä»£å™¨æ˜¯ä»ç›¸åŒçš„è¾“å…¥åºåˆ—å’Œ<code>regex</code>å¯¹è±¡æ„é€ ï¼Œåˆ™å®ƒä»¬ç›¸ç­‰ã€‚</td></tr></tbody></table><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// å°†å­—ç¬¦ä¸²fileä¸­æ‰€æœ‰åŒ¹é…æ¨¡å¼rçš„å­ä¸²è¾“å‡º</span><span class="token keyword">for</span> <span class="token punctuation">(</span>sregex_iterator <span class="token function">it</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span> end_it<span class="token punctuation">;</span> it <span class="token operator">!=</span> end_it<span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> it <span class="token operator">-></span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>smatch</code>æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>m.ready()</code></td><td>å¦‚æœå·²ç»é€šè¿‡è°ƒç”¨<code>regex_search</code>æˆ–<code>regex_match</code>è®¾ç½®äº†<code>m</code>ï¼Œåˆ™è¿”å›<code>true</code>ï¼›å¦åˆ™è¿”å›<code>false</code>ã€‚å¦‚æœ<code>ready</code>è¿”å›<code>false</code>ï¼Œåˆ™å¯¹<code>m</code>è¿›è¡Œæ“ä½œæ˜¯æœªå®šä¹‰çš„ã€‚</td></tr><tr><td><code>m.size()</code></td><td>å¦‚æœåŒ¹é…å¤±è´¥ï¼Œåˆ™è¿”å›0ï¼Œï¼›å¦åˆ™è¿”å›æœ€è¿‘ä¸€æ¬¡åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­å­è¡¨è¾¾å¼çš„æ•°ç›®ã€‚</td></tr><tr><td><code>m.empty()</code></td><td>ç­‰ä»·äº<code>m.size() == 0</code></td></tr><tr><td><code>m.prefix()</code></td><td>ä¸€ä¸ª<code>ssub_match</code>å¯¹è±¡ï¼Œæ ‡è¯†å½“å‰åŒ¹é…ä¹‹å‰çš„åºåˆ—</td></tr><tr><td><code>m.suffix()</code></td><td>ä¸€ä¸ª<code>ssub_match</code>å¯¹è±¡ï¼Œæ ‡è¯†å½“å‰åŒ¹é…ä¹‹åçš„éƒ¨åˆ†</td></tr><tr><td><code>m.format(...)</code></td><td></td></tr><tr><td><code>m.length(n)</code></td><td>ç¬¬<code>n</code>ä¸ªåŒ¹é…çš„å­è¡¨è¾¾å¼çš„å¤§å°</td></tr><tr><td><code>m.position(n)</code></td><td>ç¬¬<code>n</code>ä¸ªå­è¡¨è¾¾å¼è·ç¦»åºåˆ—å¼€å§‹çš„é•¿åº¦</td></tr><tr><td><code>m.str(n)</code></td><td>ç¬¬<code>n</code>ä¸ªå­è¡¨è¾¾å¼åŒ¹é…çš„<code>string</code></td></tr><tr><td><code>m[n]</code></td><td>å¯¹åº”ç¬¬<code>n</code>ä¸ªå­è¡¨è¾¾å¼çš„<code>ssub_match</code>å¯¹è±¡</td></tr><tr><td><code>m.begin(), m.end()</code></td><td>è¡¨ç¤º<code>m</code>ä¸­<code>ssub_match</code>å…ƒç´ èŒƒå›´çš„è¿­ä»£å™¨ã€‚</td></tr><tr><td><code>m.cbegin(), m.cend()</code></td><td>å¸¸é‡è¿­ä»£å™¨</td></tr></tbody></table><h3 id="ä½¿ç”¨å­è¡¨è¾¾å¼"><a href="#ä½¿ç”¨å­è¡¨è¾¾å¼" class="headerlink" title="ä½¿ç”¨å­è¡¨è¾¾å¼"></a>ä½¿ç”¨å­è¡¨è¾¾å¼</h3><ul><li>æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•é€šå¸¸ç”¨æ‹¬å·è¡¨ç¤ºå­è¡¨è¾¾å¼ã€‚</li><li>å­è¡¨è¾¾å¼çš„ç´¢å¼•ä»1å¼€å§‹ã€‚</li><li>åœ¨<code>fmt</code>ä¸­ç”¨<code>$</code>åè·Ÿå­è¡¨è¾¾å¼çš„ç´¢å¼•å·æ¥æ ‡è¯†ä¸€ä¸ªç‰¹å®šçš„å­è¡¨è¾¾å¼ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">regex_search</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> results<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">)</span>    cout <span class="token operator">&lt;&lt;</span> results<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>  <span class="token comment">// .str(1)è·å–ç¬¬ä¸€ä¸ªå­è¡¨è¾¾å¼åŒ¹é…ç»“æœ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><code>ssub_match</code>å­åŒ¹é…æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>matched</code></td><td>ä¸€ä¸ª<code>public bool</code>æ•°æ®æˆå‘˜ï¼ŒæŒ‡å‡º<code>ssub_match</code>æ˜¯å¦åŒ¹é…äº†</td></tr><tr><td><code>first</code>ï¼Œ <code>second</code></td><td><code>public</code>æ•°æ®æˆå‘˜ï¼ŒæŒ‡å‘åŒ¹é…åºåˆ—é¦–å…ƒç´ å’Œå°¾åä½ç½®çš„è¿­ä»£å™¨ã€‚å¦‚æœæœªåŒ¹é…ï¼Œåˆ™<code>first</code>å’Œ<code>second</code>æ˜¯ç›¸ç­‰çš„ã€‚</td></tr><tr><td><code>length()</code></td><td>åŒ¹é…çš„å¤§å°ï¼Œå¦‚æœ<code>matched</code>ä¸º<code>false</code>ï¼Œåˆ™è¿”å›0ã€‚</td></tr><tr><td><code>str()</code></td><td>è¿”å›ä¸€ä¸ªåŒ…å«è¾“å…¥ä¸­åŒ¹é…éƒ¨åˆ†çš„<code>string</code>ã€‚å¦‚æœ<code>matched</code>ä¸º<code>false</code>ï¼Œåˆ™è¿”å›ç©º<code>string</code>ã€‚</td></tr><tr><td><code>s = ssub</code></td><td>å°†<code>ssub_match</code>å¯¹è±¡<code>ssub</code>è½¬åŒ–ä¸º<code>string</code>å¯¹è±¡<code>s</code>ã€‚ç­‰ä»·äº<code>s=ssub.str()</code>ï¼Œè½¬æ¢è¿ç®—ç¬¦ä¸æ˜¯<code>explicit</code>çš„ã€‚</td></tr></tbody></table><h3 id="ä½¿ç”¨regex-replace"><a href="#ä½¿ç”¨regex-replace" class="headerlink" title="ä½¿ç”¨regex_replace"></a>ä½¿ç”¨regex_replace</h3><p>æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>m.format(dest, fmt, mft)</code>, <code>m.format(fmt, mft)</code></td><td>ä½¿ç”¨æ ¼å¼å­—ç¬¦ä¸²<code>fmt</code>ç”Ÿæˆæ ¼å¼åŒ–è¾“å‡ºï¼ŒåŒ¹é…åœ¨<code>m</code>ä¸­ï¼Œå¯é€‰çš„<code>match_flag_type</code>æ ‡å¿—åœ¨<code>mft</code>ä¸­ã€‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬å†™å…¥è¿­ä»£å™¨<code>dest</code>æŒ‡å‘çš„ç›®çš„ä¸ºæ­¢ï¼Œå¹¶æ¥å—<code>fmt</code>å‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ª<code>string</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæŒ‡å‘ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆã€‚<code>mft</code>çš„é»˜è®¤å€¼æ˜¯<code>format_default</code>ã€‚</td></tr><tr><td><code>rege_replace(dest, seq, r, fmt, mft)</code>ï¼Œ  <code>regex_replace(seq, r, fmt, mft)</code></td><td>éå†<code>seq</code>ï¼Œç”¨<code>regex_search</code>æŸ¥æ‰¾ä¸<code>regex</code>å¯¹è±¡<code>r</code>ç›¸åŒ¹é…çš„å­ä¸²ï¼Œä½¿ç”¨æ ¼å¼å­—ç¬¦ä¸²<code>fmt</code>å’Œå¯é€‰çš„<code>match_flag_type</code>æ ‡å¿—æ¥ç”Ÿæˆè¾“å‡ºã€‚<code>mft</code>çš„é»˜è®¤å€¼æ˜¯<code>match_default</code></td></tr></tbody></table><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string phone <span class="token operator">=</span> <span class="token string">"(\\()?(\\d&#123;3&#125;)(\\))?([-. ])?(\\d&#123;3&#125;)([-. ]?)(\\d&#123;4&#125;)"</span>string fmt <span class="token operator">=</span> <span class="token string">"$2.$5.$7"</span><span class="token punctuation">;</span>  <span class="token comment">// å°†å·ç æ ¼å¼æ”¹ä¸ºddd.ddd.dddd</span>regex <span class="token function">r</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ç”¨æ¥å¯»æ‰¾æ¨¡å¼çš„regexå¯¹è±¡</span>string number <span class="token operator">=</span> <span class="token string">"(908) 555-1800"</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">regex_replace</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> r<span class="token punctuation">,</span> fmt<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒ¹é…æ ‡å¿—ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>match_default</code></td><td>ç­‰ä»·äº<code>format_default</code></td></tr><tr><td><code>match_not_bol</code></td><td>ä¸å°†é¦–å­—ç¬¦ä½œä¸ºè¡Œé¦–å¤„ç†</td></tr><tr><td><code>match_not_eol</code></td><td>ä¸å°†å°¾å­—ç¬¦ä½œä¸ºè¡Œå°¾å¤„ç†</td></tr><tr><td><code>match_not_bow</code></td><td>ä¸å°†é¦–å­—ç¬¦ä½œä¸ºå•è¯é¦–å¤„ç†</td></tr><tr><td><code>match_not_eow</code></td><td>ä¸å°†å°¾å­—ç¬¦ä½œä¸ºå•è¯å°¾å¤„ç†</td></tr><tr><td><code>match_any</code></td><td>å¦‚æœå­˜åœ¨å¤šäºä¸€ä¸ªåŒ¹é…ï¼Œåˆ™å¯ä»¥è¿”å›ä»»æ„ä¸€ä¸ªåŒ¹é…</td></tr><tr><td><code>match_not_null</code></td><td>ä¸åŒ¹é…ä»»ä½•ç©ºåºåˆ—</td></tr><tr><td><code>match_continuous</code></td><td>åŒ¹é…å¿…é¡»ä»è¾“å…¥çš„é¦–å­—ç¬¦å¼€å§‹</td></tr><tr><td><code>match_prev_avail</code></td><td>è¾“å…¥åºåˆ—åŒ…å«ç¬¬ä¸€ä¸ªåŒ¹é…ä¹‹å‰çš„å†…å®¹</td></tr><tr><td><code>format_default</code></td><td>ç”¨<code>ECMAScript</code>è§„åˆ™æ›¿æ¢å­—ç¬¦ä¸²</td></tr><tr><td><code>format_sed</code></td><td>ç”¨<code>POSIX sed</code>è§„åˆ™æ›¿æ¢å­—ç¬¦ä¸²</td></tr><tr><td><code>format_no_copy</code></td><td>ä¸è¾“å‡ºè¾“å…¥åºåˆ—ä¸­æœªåŒ¹é…çš„éƒ¨åˆ†</td></tr><tr><td><code>format_first_only</code></td><td>åªæ›¿æ¢å­è¡¨è¾¾å¼çš„ç¬¬ä¸€æ¬¡å‡ºç°</td></tr></tbody></table><h2 id="éšæœºæ•°"><a href="#éšæœºæ•°" class="headerlink" title="éšæœºæ•°"></a>éšæœºæ•°</h2><ul><li>æ–°æ ‡å‡†ä¹‹å‰ï¼ŒCå’ŒC++éƒ½ä¾èµ–ä¸€ä¸ªç®€å•çš„Cåº“å‡½æ•°<code>rand</code>æ¥ç”Ÿæˆéšæœºæ•°ï¼Œä¸”åªç¬¦åˆå‡åŒ€åˆ†å¸ƒã€‚</li><li>æ–°æ ‡å‡†ï¼š<strong>éšæœºæ•°å¼•æ“</strong> + <strong>éšæœºæ•°åˆ†å¸ƒç±»</strong>ï¼Œ å®šä¹‰åœ¨   <code>random</code>å¤´æ–‡ä»¶ä¸­ã€‚</li><li>C++ç¨‹åºåº”è¯¥ä½¿ç”¨<code>default_random_engine</code>ç±»å’Œæ°å½“çš„åˆ†å¸ƒç±»å¯¹è±¡ã€‚</li></ul><h3 id="éšæœºæ•°å¼•æ“å’Œåˆ†å¸ƒ"><a href="#éšæœºæ•°å¼•æ“å’Œåˆ†å¸ƒ" class="headerlink" title="éšæœºæ•°å¼•æ“å’Œåˆ†å¸ƒ"></a>éšæœºæ•°å¼•æ“å’Œåˆ†å¸ƒ</h3><p>éšæœºæ•°å¼•æ“æ“ä½œ</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>Engine e;</code></td><td>é»˜è®¤æ„é€ å‡½æ•°ï¼›ä½¿ç”¨è¯¥å¼•æ“ç±»å‹é»˜è®¤çš„ç§å­</td></tr><tr><td><code>Engine e(s);</code></td><td>ä½¿ç”¨æ•´å‹å€¼<code>s</code>ä½œä¸ºç§å­</td></tr><tr><td><code>e.seed(s)</code></td><td>ä½¿ç”¨ç§å­<code>s</code>é‡ç½®å¼•æ“çš„çŠ¶æ€</td></tr><tr><td><code>e.min()</code>ï¼Œ<code>e.max()</code></td><td>æ­¤å¼•æ“å¯ç”Ÿæˆçš„æœ€å°å€¼å’Œæœ€å¤§å€¼</td></tr><tr><td><code>Engine::result_type</code></td><td>æ­¤å¼•æ“ç”Ÿæˆçš„<code>unsigned</code>æ•´å‹ç±»å‹</td></tr><tr><td><code>e.discard(u)</code></td><td>å°†å¼•æ“æ¨è¿›<code>u</code>æ­¥ï¼›<code>u</code>çš„ç±»å‹ä¸º<code>unsigned long long</code></td></tr></tbody></table><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// åˆå§‹åŒ–åˆ†å¸ƒç±»å‹</span>uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">></span> <span class="token function">u</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åˆå§‹åŒ–å¼•æ“</span>default_random_engine e<span class="token punctuation">;</span><span class="token comment">// éšæœºç”Ÿæˆ0-9çš„æ— ç¬¦å·æ•´æ•°</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">u</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è®¾ç½®éšæœºæ•°å‘ç”Ÿå™¨ç§å­</strong>ï¼š</p><ul><li>ç§å­å°±æ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œå¼•æ“å¯ä»¥åˆ©ç”¨å®ƒä»åºåˆ—ä¸­ä¸€ä¸ªæ–°ä½ç½®é‡æ–°å¼€å§‹ç”Ÿæˆéšæœºæ•°ã€‚</li><li>ç§å­å¯ä»¥ä½¿ç”¨ç³»ç»Ÿå‡½æ•°<code>time(0)</code>ã€‚</li></ul><h3 id="å…¶ä»–éšæœºæ•°åˆ†å¸ƒ"><a href="#å…¶ä»–éšæœºæ•°åˆ†å¸ƒ" class="headerlink" title="å…¶ä»–éšæœºæ•°åˆ†å¸ƒ"></a>å…¶ä»–éšæœºæ•°åˆ†å¸ƒ</h3><p>åˆ†å¸ƒç±»å‹çš„æ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>Dist d;</code></td><td>é»˜è®¤å¤Ÿèµå‡½æ•°ï¼›ä½¿<code>d</code>å‡†å¤‡å¥½è¢«ä½¿ç”¨ã€‚å…¶ä»–æ„é€ å‡½æ•°ä¾èµ–äº<code>Dist</code>çš„ç±»å‹ï¼›åˆ†å¸ƒç±»å‹çš„æ„é€ å‡½æ•°æ˜¯<code>explicit</code>çš„ã€‚</td></tr><tr><td><code>d(e)</code></td><td>ç”¨ç›¸åŒçš„<code>e</code>è¿ç»­è°ƒç”¨<code>d</code>çš„è¯ï¼Œä¼šæ ¹æ®<code>d</code>çš„åˆ†å¸ƒå¼ç±»å‹ç”Ÿæˆä¸€ä¸ªéšæœºæ•°åºåˆ—ï¼›<code>e</code>æ˜¯ä¸€ä¸ªéšæœºæ•°å¼•æ“å¯¹è±¡ã€‚</td></tr><tr><td><code>d.min()</code>,<code>d.max()</code></td><td>è¿”å›<code>d(e)</code>èƒ½ç”Ÿæˆçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚</td></tr><tr><td><code>d.reset()</code></td><td>é‡å»º<code>d</code>çš„çŠ¶æ€ï¼Œæ˜¯çš„éšåå¯¹<code>d</code>çš„ä½¿ç”¨ä¸ä¾èµ–äº<code>d</code>å·²ç»ç”Ÿæˆçš„å€¼ã€‚</td></tr></tbody></table><h2 id="IOåº“å†æ¢"><a href="#IOåº“å†æ¢" class="headerlink" title="IOåº“å†æ¢"></a>IOåº“å†æ¢</h2><h3 id="æ ¼å¼åŒ–è¾“å…¥ä¸è¾“å‡º"><a href="#æ ¼å¼åŒ–è¾“å…¥ä¸è¾“å‡º" class="headerlink" title="æ ¼å¼åŒ–è¾“å…¥ä¸è¾“å‡º"></a>æ ¼å¼åŒ–è¾“å…¥ä¸è¾“å‡º</h3><ul><li>ä½¿ç”¨æ“çºµç¬¦æ”¹å˜æ ¼å¼çŠ¶æ€ã€‚</li><li>æ§åˆ¶å¸ƒå°”å€¼çš„æ ¼å¼ï¼š <code>cout &lt;&lt; boolalpha &lt;&lt; true &lt;&lt; endl;</code></li><li>æŒ‡å®šæ•´å‹çš„è¿›åˆ¶ï¼š<code>cout &lt;&lt; dec &lt;&lt; 20 &lt;&lt; endl;</code></li></ul><p>å®šä¹‰åœ¨<code>iostream</code>ä¸­çš„æ“çºµç¬¦ï¼š</p><table><thead><tr><th>æ“çºµç¬¦</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>boolalpha</code></td><td>å°†<code>true</code>å’Œ<code>false</code>è¾“å‡ºä¸ºå­—ç¬¦ä¸²</td></tr><tr><td><code>* noboolalpha</code></td><td>å°†<code>true</code>å’Œ<code>false</code>è¾“å‡ºä¸º1,0</td></tr><tr><td><code>showbase</code></td><td>å¯¹æ•´å‹å€¼è¾“å‡ºè¡¨ç¤ºè¿›åˆ¶çš„å‰ç¼€</td></tr><tr><td><code>* noshowbase</code></td><td>ä¸ç”Ÿæˆè¡¨ç¤ºè¿›åˆ¶çš„å‰ç¼€</td></tr><tr><td><code>showpoint</code></td><td>å¯¹æµ®ç‚¹å€¼æ€»æ˜¯æ˜¾ç¤ºå°æ•°ç‚¹</td></tr><tr><td><code>* noshowpoint</code></td><td>åªæœ‰å½“æµ®ç‚¹å€¼åŒ…å«å°æ•°éƒ¨åˆ†æ—¶æ‰æ˜¾ç¤ºå°æ•°ç‚¹</td></tr><tr><td><code>showpos</code></td><td>å¯¹éè´Ÿæ•°æ˜¾ç¤º<code>+</code></td></tr><tr><td><code>* noshowpos</code></td><td>å¯¹éè´Ÿæ•°ä¸æ˜¾ç¤º<code>+</code></td></tr><tr><td><code>uppercase</code></td><td>åœ¨åå…­è¿›åˆ¶ä¸­æ‰“å°<code>0X</code>ï¼Œåœ¨ç§‘å­¦è®¡æ•°æ³•ä¸­æ‰“å°<code>E</code></td></tr><tr><td><code>* nouppercase</code></td><td>åœ¨åå…­è¿›åˆ¶ä¸­æ‰“å°<code>0x</code>ï¼Œåœ¨ç§‘å­¦è®¡æ•°æ³•ä¸­æ‰“å°<code>e</code></td></tr><tr><td><code>* dec</code></td><td>æ•´å‹å€¼æ˜¾ç¤ºä¸ºåè¿›åˆ¶</td></tr><tr><td><code>hex</code></td><td>æ•´å‹å€¼æ˜¾ç¤ºä¸ºåå…­è¿›åˆ¶</td></tr><tr><td><code>oct</code></td><td>æ•´å‹å€¼æ˜¾ç¤ºä¸ºå…«è¿›åˆ¶</td></tr><tr><td><code>left</code></td><td>åœ¨å€¼çš„å³ä¾§æ·»åŠ å¡«å……å­—ç¬¦</td></tr><tr><td><code>right</code></td><td>åœ¨å€¼çš„å·¦ä¾§æ·»åŠ å¡«å……å­—ç¬¦</td></tr><tr><td><code>internal</code></td><td>åœ¨ç¬¦å·å’Œå€¼ä¹‹é—´æ·»åŠ å¡«å……å­—ç¬¦</td></tr><tr><td><code>fixed</code></td><td>æµ®ç‚¹å€¼æ˜¾ç¤ºä¸ºå®šç‚¹åè¿›åˆ¶</td></tr><tr><td><code>scientific</code></td><td>æµ®ç‚¹å€¼æ˜¾ç¤ºä¸ºç§‘å­¦è®¡æ•°æ³•</td></tr><tr><td><code>hexfloat</code></td><td>æµ®ç‚¹å€¼æ˜¾ç¤ºä¸ºåå…­è¿›åˆ¶ï¼ˆC++11ï¼‰</td></tr><tr><td><code>defaultfloat</code></td><td>å……å€¼æµ®ç‚¹æ•°æ ¼å¼ä¸ºåè¿›åˆ¶ï¼ˆC++11ï¼‰</td></tr><tr><td><code>unitbuf</code></td><td>æ¯æ¬¡è¾“å‡ºæ“ä½œåéƒ½åˆ·æ–°ç¼“å†²åŒº</td></tr><tr><td>1</td><td><code>* nounitbuf</code></td></tr><tr><td><code>* skipws</code></td><td>è¾“å…¥è¿ç®—ç¬¦è·³è¿‡ç©ºç™½ç¬¦</td></tr><tr><td><code>noskipws</code></td><td>è¾“å…¥è¿ç®—ç¬¦ä¸è·³è¿‡ç©ºç™½ç¬¦</td></tr><tr><td><code>flush</code></td><td>åˆ·æ–°<code>ostream</code>ç¼“å†²åŒº</td></tr><tr><td><code>ends</code></td><td>æ’å…¥ç©ºå­—ç¬¦ï¼Œç„¶ååˆ·æ–°<code>ostream</code>ç¼“å†²åŒº</td></tr><tr><td><code>endl</code></td><td>æ’å…¥æ¢è¡Œï¼Œç„¶ååˆ·æ–°<code>ostream</code>ç¼“å†²åŒº</td></tr></tbody></table><p>å…¶ä¸­<code>*</code>è¡¨ç¤ºé»˜è®¤çš„æµçŠ¶æ€ã€‚</p><h3 id="æœªæ ¼å¼åŒ–çš„è¾“å…¥-è¾“å‡ºæ“ä½œ"><a href="#æœªæ ¼å¼åŒ–çš„è¾“å…¥-è¾“å‡ºæ“ä½œ" class="headerlink" title="æœªæ ¼å¼åŒ–çš„è¾“å…¥/è¾“å‡ºæ“ä½œ"></a>æœªæ ¼å¼åŒ–çš„è¾“å…¥/è¾“å‡ºæ“ä½œ</h3><p>å•å­—èŠ‚ä½å±‚IOæ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>is.get(ch)</code></td><td>ä»<code>istream is</code>è¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚å­˜å…¥å­—ç¬¦<code>cn</code>ä¸­ã€‚è¿”å›<code>is</code>ã€‚</td></tr><tr><td><code>os.put(ch)</code></td><td>å°†å­—ç¬¦<code>ch</code>è¾“å‡ºåˆ°<code>ostream os</code>ã€‚è¿”å›<code>os</code>ã€‚</td></tr><tr><td><code>is.get()</code></td><td>å°†<code>is</code>çš„ä¸‹ä¸€ä¸ªå­—èŠ‚ä½œä¸º<code>int</code>è¿”å›</td></tr><tr><td><code>is.putback(ch)</code></td><td>å°†å­—ç¬¦<code>ch</code>æ”¾å›<code>is</code>ã€‚è¿”å›<code>is</code>ã€‚</td></tr><tr><td><code>is.unget()</code></td><td>å°†<code>is</code>å‘åç§»åŠ¨ä¸€ä¸ªå­—èŠ‚ã€‚è¿”å›<code>is</code>ã€‚</td></tr><tr><td><code>is.peek()</code></td><td>å°†ä¸‹ä¸€ä¸ªå­—èŠ‚ä½œä¸º<code>int</code>è¿”å›ï¼Œä½†ä¸ä»æµä¸­åˆ é™¤å®ƒã€‚</td></tr></tbody></table><p>å¤šå­—èŠ‚ä½å±‚IOæ“ä½œï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>is.get(sink, size, delim)</code></td><td>ä»<code>is</code>ä¸­è¯»å–æœ€å¤š<code>size</code>ä¸ªå­—èŠ‚ï¼Œå¹¶ä¿å­˜åœ¨å­—ç¬¦æ•°ç»„ä¸­ï¼Œå­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€ç”±<code>sink</code>ç»™å‡ºã€‚è¯»å–è¿‡ç¨‹ç›´åˆ°é‡åˆ°å­—ç¬¦<code>delim</code>æˆ–è¯»å–äº†<code>size</code>ä¸ªå­—èŠ‚æˆ–é‡åˆ°æ–‡ä»¶å°¾æ—¶åœæ­¢ã€‚å¦‚æœé‡åˆ°äº†<code>delim</code>ï¼Œåˆ™å°†å…¶ç•™åœ¨è¾“å…¥æµä¸­ï¼Œä¸è¯»å–å‡ºæ¥å­˜å…¥<code>sink</code>ã€‚</td></tr><tr><td><code>is.getline(sink, size, delim)</code></td><td>ä¸æ¥æ”¶ä¸‰ä¸ªå‚æ•°çš„<code>get</code>ç‰ˆæœ¬ç±»ä¼¼ï¼Œä½†ä¼šè¯»å–å¹¶ä¸¢å¼ƒ<code>delim</code>ã€‚</td></tr><tr><td><code>is.read(sink, size)</code></td><td>è¯»å–æœ€å¤š<code>size</code>ä¸ªå­—èŠ‚ï¼Œå­˜å…¥å­—ç¬¦æ•°ç»„<code>sink</code>ä¸­ã€‚è¿”å›<code>is</code>ã€‚</td></tr><tr><td><code>is.gcount()</code></td><td>è¿”å›ä¸Šä¸€ä¸ªæœªæ ¼å¼åŒ–è¯»å–ä»<code>is</code>è¯»å–çš„å­—èŠ‚æ•°</td></tr><tr><td><code>os.write(source, size)</code></td><td>å°†å­—ç¬¦æ•°ç»„<code>source</code>ä¸­çš„<code>size</code>ä¸ªå­—èŠ‚å†™å…¥<code>os</code>ã€‚è¿”å›<code>os</code>ã€‚</td></tr><tr><td><code>is.ignore(size, delim)</code></td><td>è¯»å–å¹¶å¿½ç•¥æœ€å¤š<code>size</code>ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬<code>delim</code>ã€‚ä¸å…¶ä»–æœªæ ¼å¼åŒ–å‡½æ•°ä¸åŒï¼Œ<code>ignore</code>æœ‰é»˜è®¤å‚æ•°ï¼š<code>size</code>é»˜è®¤å€¼æ˜¯1ï¼Œ<code>delim</code>çš„é»˜è®¤å€¼ä¸ºæ–‡ä»¶å°¾ã€‚</td></tr></tbody></table><ul><li>æ³¨æ„ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸»å¼ ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„é«˜å±‚æŠ½è±¡ï¼Œä½å±‚å‡½æ•°å®¹æ˜“å‡ºé”™ã€‚</li></ul><h3 id="æµéšæœºè®¿é—®"><a href="#æµéšæœºè®¿é—®" class="headerlink" title="æµéšæœºè®¿é—®"></a>æµéšæœºè®¿é—®</h3><ul><li>åªé€‚ç”¨äº<code>fstream</code>å’Œ<code>sstream</code>ã€‚</li><li>é€šè¿‡å°†æ ‡è®°<code>seek</code>åˆ°ä¸€ä¸ªç»™å®šä½ç½®æ¥é‡å®šä½å®ƒã€‚</li><li><code>tell</code>å‘Šè¯‰æˆ‘ä»¬æ ‡è®°çš„å½“å‰ä½ç½®ã€‚</li></ul><table><thead><tr><th>æ“ä½œ</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td><code>tellg()</code>ï¼Œ<code>tellp</code></td><td>è¿”å›ä¸€ä¸ªè¾“å…¥æµä¸­ï¼ˆ<code>tellg</code>ï¼‰æˆ–è¾“å‡ºæµä¸­ï¼ˆ<code>tellp</code>ï¼‰æ ‡è®°çš„å½“å‰ä½ç½®ã€‚</td></tr><tr><td><code>seekg(pos)</code>ï¼Œ<code>seekp(pos)</code></td><td>åœ¨ä¸€ä¸ªè¾“å…¥æµæˆ–è¾“å‡ºæµä¸­å°†æ ‡è®°é‡å®šä½åˆ°ç»™å®šçš„ç»å¯¹åœ°å€ã€‚<code>pos</code>é€šå¸¸æ˜¯ä¸€ä¸ªå½“å‰<code>teelg</code>æˆ–<code>tellp</code>è¿”å›çš„å€¼ã€‚</td></tr><tr><td><code>seekp(off, from)</code>ï¼Œ<code>seekg(off, from)</code></td><td>åœ¨ä¸€ä¸ªè¾“å…¥æµæˆ–è¾“å‡ºæµä¸­å°†æ ‡è®°å®šä½åˆ°<code>from</code>ä¹‹å‰æˆ–ä¹‹å<code>off</code>ä¸ªå­—ç¬¦ï¼Œ<code>from</code>å¯ä»¥æ˜¯ä¸‹åˆ—å€¼ä¹‹ä¸€ï¼š<code>beg</code>ï¼Œåç§»é‡ç›¸å¯¹äºæµå¼€å§‹ä½ç½®ï¼›<code>cur</code>ï¼Œåç§»é‡ç›¸å¯¹äºæµå½“å‰ä½ç½®ï¼›<code>end</code>ï¼Œåç§»é‡ç›¸å¯¹äºæµç»“å°¾ä½ç½®ã€‚</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> cppç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ7</title>
      <link href="2021/04/10/excersize/ch07/"/>
      <url>2021/04/10/excersize/ch07/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬ä¸ƒç« -ç±»"><a href="#ç¬¬ä¸ƒç« -ç±»" class="headerlink" title="ç¬¬ä¸ƒç«  ç±»"></a>ç¬¬ä¸ƒç«  ç±»</h1><h2 id="ç»ƒä¹ 7-1"><a href="#ç»ƒä¹ 7-1" class="headerlink" title="ç»ƒä¹ 7.1"></a>ç»ƒä¹ 7.1</h2><p>ä½¿ç”¨2.6.1èŠ‚å®šä¹‰çš„<code>Sales_data</code>ç±»ä¸º1.6èŠ‚çš„äº¤æ˜“å¤„ç†ç¨‹åºç¼–å†™ä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span><span class="token punctuation">&#123;</span>    string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> total<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> total<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> total<span class="token punctuation">.</span>revenue<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> trans<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> trans<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> trans<span class="token punctuation">.</span>revenue<span class="token punctuation">)</span>         <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>bookNo <span class="token operator">==</span> trans<span class="token punctuation">.</span>bookNo<span class="token punctuation">)</span>             <span class="token punctuation">&#123;</span>                total<span class="token punctuation">.</span>units_sold <span class="token operator">+=</span> trans<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>                total<span class="token punctuation">.</span>revenue <span class="token operator">+=</span> trans<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-2"><a href="#ç»ƒä¹ 7-2" class="headerlink" title="ç»ƒä¹ 7.2"></a>ç»ƒä¹ 7.2</h2><p>æ›¾åœ¨2.6.2èŠ‚çš„ç»ƒä¹ ä¸­ç¼–å†™äº†ä¸€ä¸ª<code>Sales_data</code>ç±»ï¼Œè¯·å‘è¿™ä¸ªç±»æ·»åŠ <code>combine</code>å‡½æ•°å’Œ<code>isbn</code>æˆå‘˜ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Sales_data<span class="token operator">&amp;</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-3"><a href="#ç»ƒä¹ 7-3" class="headerlink" title="ç»ƒä¹ 7.3"></a>ç»ƒä¹ 7.3</h2><p>ä¿®æ”¹7.1.1èŠ‚çš„äº¤æ˜“å¤„ç†ç¨‹åºï¼Œä»¤å…¶ä½¿ç”¨è¿™äº›æˆå‘˜ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>cout<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> total<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> total<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> total<span class="token punctuation">.</span>revenue<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cin <span class="token operator">>></span> trans<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> trans<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> trans<span class="token punctuation">.</span>revenue<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        cout <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>bookNo <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> total<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-4"><a href="#ç»ƒä¹ 7-4" class="headerlink" title="ç»ƒä¹ 7.4"></a>ç»ƒä¹ 7.4</h2><p>ç¼–å†™ä¸€ä¸ªåä¸º<code>Person</code>çš„ç±»ï¼Œä½¿å…¶è¡¨ç¤ºäººå‘˜çš„å§“åå’Œåœ°å€ã€‚ä½¿ç”¨<code>string</code>å¯¹è±¡å­˜æ”¾è¿™äº›å…ƒç´ ï¼Œæ¥ä¸‹æ¥çš„ç»ƒä¹ å°†ä¸æ–­å……å®è¿™ä¸ªç±»çš„å…¶ä»–ç‰¹å¾ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string name<span class="token punctuation">;</span>    std<span class="token operator">::</span>string address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-5"><a href="#ç»ƒä¹ 7-5" class="headerlink" title="ç»ƒä¹ 7.5"></a>ç»ƒä¹ 7.5</h2><p>åœ¨ä½ çš„<code>Person</code>ç±»ä¸­æä¾›ä¸€äº›æ“ä½œä½¿å…¶èƒ½å¤Ÿè¿”å›å§“åå’Œåœ°å€ã€‚<br>è¿™äº›å‡½æ•°æ˜¯å¦åº”è¯¥æ˜¯<code>const</code>çš„å‘¢ï¼Ÿè§£é‡ŠåŸå› ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string name<span class="token punctuation">;</span>    std<span class="token operator">::</span>string address<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">auto</span> <span class="token function">get_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">-></span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">auto</span> <span class="token function">get_addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">-></span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> address<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åº”è¯¥æ˜¯<code>const</code>çš„ã€‚å› ä¸ºå¸¸é‡çš„<code>Person</code>å¯¹è±¡ä¹Ÿéœ€è¦ä½¿ç”¨è¿™äº›å‡½æ•°æ“ä½œã€‚</p><h2 id="ç»ƒä¹ 7-6"><a href="#ç»ƒä¹ 7-6" class="headerlink" title="ç»ƒä¹ 7.6"></a>ç»ƒä¹ 7.6</h2><p>å¯¹äºå‡½æ•°<code>add</code>ã€<code>read</code>å’Œ<code>print</code>ï¼Œå®šä¹‰ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// member functions.</span>Sales_data<span class="token operator">&amp;</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// nonmember functions</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    sum<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-7"><a href="#ç»ƒä¹ 7-7" class="headerlink" title="ç»ƒä¹ 7.7"></a>ç»ƒä¹ 7.7</h2><p>ä½¿ç”¨è¿™äº›æ–°å‡½æ•°é‡å†™7.1.2èŠ‚ç»ƒä¹ ä¸­çš„ç¨‹åºã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data total<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">,</span> total<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        Sales_data trans<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">,</span> trans<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-8"><a href="#ç»ƒä¹ 7-8" class="headerlink" title="ç»ƒä¹ 7.8"></a>ç»ƒä¹ 7.8</h2><p>ä¸ºä»€ä¹ˆ<code>read</code>å‡½æ•°å°†å…¶<code>Sales_data</code>å‚æ•°å®šä¹‰æˆæ™®é€šçš„å¼•ç”¨ï¼Œè€Œ<code>print</code>å‡½æ•°å°†å…¶å‚æ•°å®šä¹‰æˆå¸¸é‡å¼•ç”¨ï¼Ÿ</p><p>è§£ï¼š</p><p>å› ä¸º<code>read</code>å‡½æ•°ä¼šæ”¹å˜å¯¹è±¡çš„å†…å®¹ï¼Œè€Œ<code>print</code>å‡½æ•°ä¸ä¼šã€‚</p><h2 id="ç»ƒä¹ 7-9"><a href="#ç»ƒä¹ 7-9" class="headerlink" title="ç»ƒä¹ 7.9"></a>ç»ƒä¹ 7.9</h2><p>å¯¹äº7.1.2èŠ‚ç»ƒä¹ ä¸­ä»£ç ï¼Œæ·»åŠ è¯»å–å’Œæ‰“å°<code>Person</code>å¯¹è±¡çš„æ“ä½œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> address<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>string name<span class="token punctuation">;</span>    std<span class="token operator">::</span>string address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> is <span class="token operator">>></span> person<span class="token punctuation">.</span>name <span class="token operator">>></span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> os <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-10"><a href="#ç»ƒä¹ 7-10" class="headerlink" title="ç»ƒä¹ 7.10"></a>ç»ƒä¹ 7.10</h2><p>åœ¨ä¸‹é¢è¿™æ¡<code>if</code>è¯­å¥ä¸­ï¼Œæ¡ä»¶éƒ¨åˆ†çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> data1<span class="token punctuation">)</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//ç­‰ä»·read(std::cin, data1);read(std::cin, data2);</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p><code>read</code>å‡½æ•°çš„è¿”å›å€¼æ˜¯<code>istream</code>å¯¹è±¡ï¼Œ<br><code>if</code>è¯­å¥ä¸­æ¡ä»¶éƒ¨åˆ†çš„ä½œç”¨æ˜¯ä»è¾“å…¥æµä¸­è¯»å–æ•°æ®ç»™ä¸¤ä¸ª<code>data</code>å¯¹è±¡ã€‚</p><h2 id="ç»ƒä¹ 7-11"><a href="#ç»ƒä¹ 7-11" class="headerlink" title="ç»ƒä¹ 7.11 :"></a>ç»ƒä¹ 7.11 :</h2><p>åœ¨ä½ çš„<code>Sales_data</code>ç±»ä¸­æ·»åŠ æ„é€ å‡½æ•°ï¼Œ<br>ç„¶åç¼–å†™ä¸€æ®µç¨‹åºä»¤å…¶ç”¨åˆ°æ¯ä¸ªæ„é€ å‡½æ•°ã€‚</p><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// nonmember functions</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    sum<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// member functions.</span><span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data<span class="token operator">&amp;</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data item1<span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> item1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        Sales_data <span class="token function">item2</span><span class="token punctuation">(</span><span class="token string">"0-201-78345-X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> item2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        Sales_data <span class="token function">item3</span><span class="token punctuation">(</span><span class="token string">"0-201-78345-X"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">20.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> item3<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        Sales_data <span class="token function">item4</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> item4<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-12"><a href="#ç»ƒä¹ 7-12" class="headerlink" title="ç»ƒä¹ 7.12"></a>ç»ƒä¹ 7.12</h2><p>æŠŠåªæ¥å—ä¸€ä¸ª<code>istream</code>ä½œä¸ºå‚æ•°çš„æ„é€ å‡½æ•°ç§»åˆ°ç±»çš„å†…éƒ¨ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// member functions.</span>Sales_data<span class="token operator">&amp;</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// nonmember functions</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    sum<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-13"><a href="#ç»ƒä¹ 7-13" class="headerlink" title="ç»ƒä¹ 7.13"></a>ç»ƒä¹ 7.13</h2><p>ä½¿ç”¨<code>istream</code>æ„é€ å‡½æ•°é‡å†™ç¬¬229é¡µçš„ç¨‹åºã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data <span class="token function">total</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is <span class="token operator">=</span> std<span class="token operator">::</span>cin<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            Sales_data <span class="token function">trans</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>is<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> trans<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                total<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>                total <span class="token operator">=</span> trans<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">,</span> total<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"No data?!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-14"><a href="#ç»ƒä¹ 7-14" class="headerlink" title="ç»ƒä¹ 7.14"></a>ç»ƒä¹ 7.14</h2><p>ç¼–å†™ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä»¤å…¶ç”¨æˆ‘ä»¬æä¾›çš„ç±»å†…åˆå§‹å€¼æ˜¾å¼åœ°åˆå§‹åŒ–æˆå‘˜ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">units_sold</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-15"><a href="#ç»ƒä¹ 7-15" class="headerlink" title="ç»ƒä¹ 7.15"></a>ç»ƒä¹ 7.15</h2><p>ä¸ºä½ çš„<code>Person</code>ç±»æ·»åŠ æ­£ç¡®çš„æ„é€ å‡½æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">struct</span> <span class="token class-name">Person</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Person<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> sname<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> saddr<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">name</span><span class="token punctuation">(</span>sname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">address</span><span class="token punctuation">(</span>saddr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Person</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> address<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string name<span class="token punctuation">;</span>std<span class="token operator">::</span>string address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>is <span class="token operator">>></span> person<span class="token punctuation">.</span>name <span class="token operator">>></span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span><span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-16"><a href="#ç»ƒä¹ 7-16" class="headerlink" title="ç»ƒä¹ 7.16"></a>ç»ƒä¹ 7.16</h2><p>åœ¨ç±»çš„å®šä¹‰ä¸­å¯¹äºè®¿é—®è¯´æ˜ç¬¦å‡ºç°çš„ä½ç½®å’Œæ¬¡æ•°æœ‰é™å®šå—ï¼Ÿ<br>å¦‚æœæœ‰ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ ·çš„æˆå‘˜åº”è¯¥å®šä¹‰åœ¨<code>public</code>è¯´æ˜ç¬¦ä¹‹åï¼Ÿ<br>ä»€ä¹ˆæ ·çš„æˆå‘˜åº”è¯¥å®šä¹‰åœ¨<code>private</code>è¯´æ˜ç¬¦ä¹‹åï¼Ÿ</p><p>è§£ï¼š</p><p>åœ¨ç±»çš„å®šä¹‰ä¸­å¯¹äºè®¿é—®è¯´æ˜ç¬¦å‡ºç°çš„ä½ç½®å’Œæ¬¡æ•°<strong>æ²¡æœ‰é™å®š</strong>ã€‚</p><p>æ¯ä¸ªè®¿é—®è¯´æ˜ç¬¦æŒ‡å®šäº†æ¥ä¸‹æ¥çš„æˆå‘˜çš„è®¿é—®çº§åˆ«ï¼Œå…¶æœ‰æ•ˆèŒƒå›´ç›´åˆ°å‡ºç°ä¸‹ä¸€ä¸ªè®¿é—®è¯´æ˜ç¬¦æˆ–è€…è¾¾åˆ°ç±»çš„ç»“å°¾å¤„ä¸ºæ­¢ã€‚</p><p>å¦‚æœæŸä¸ªæˆå‘˜èƒ½å¤Ÿåœ¨æ•´ä¸ªç¨‹åºå†…éƒ½è¢«è®¿é—®ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å®šä¹‰ä¸º<code>public</code>;<br>å¦‚æœæŸä¸ªæˆå‘˜åªèƒ½åœ¨ç±»å†…éƒ¨è®¿é—®ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å®šä¹‰ä¸º<code>private</code>ã€‚</p><h2 id="ç»ƒä¹ 7-17"><a href="#ç»ƒä¹ 7-17" class="headerlink" title="ç»ƒä¹ 7.17"></a>ç»ƒä¹ 7.17</h2><p>ä½¿ç”¨<code>class</code>å’Œ<code>struct</code>æ—¶æœ‰åŒºåˆ«å—ï¼Ÿå¦‚æœæœ‰ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p><code>class</code>å’Œ<code>struct</code>çš„å”¯ä¸€åŒºåˆ«æ˜¯é»˜è®¤çš„è®¿é—®çº§åˆ«ä¸åŒã€‚</p><h2 id="ç»ƒä¹ 7-18"><a href="#ç»ƒä¹ 7-18" class="headerlink" title="ç»ƒä¹ 7.18"></a>ç»ƒä¹ 7.18</h2><p>å°è£…æ˜¯ä½•å«ä¹‰ï¼Ÿå®ƒæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ</p><p>è§£ï¼š</p><p>å°†ç±»å†…éƒ¨åˆ†æˆå‘˜è®¾ç½®ä¸ºå¤–éƒ¨ä¸å¯è§ï¼Œè€Œæä¾›éƒ¨åˆ†æ¥å£ç»™å¤–é¢ï¼Œè¿™æ ·çš„è¡Œä¸ºå«åšå°è£…ã€‚</p><p>ç”¨å¤„ï¼š</p><ul><li>1.ç¡®ä¿ç”¨æˆ·çš„ä»£ç ä¸ä¼šæ— æ„é—´ç ´åå°è£…å¯¹è±¡çš„çŠ¶æ€ã€‚</li><li>2.è¢«å°è£…çš„ç±»çš„å…·ä½“å®ç°ç»†èŠ‚å¯ä»¥éšæ—¶æ”¹å˜ï¼Œè€Œæ— éœ€è°ƒæ•´ç”¨æˆ·çº§åˆ«çš„ä»£ç ã€‚</li></ul><h2 id="ç»ƒä¹ 7-19"><a href="#ç»ƒä¹ 7-19" class="headerlink" title="ç»ƒä¹ 7.19"></a>ç»ƒä¹ 7.19</h2><p>åœ¨ä½ çš„<code>Person</code>ç±»ä¸­ï¼Œä½ å°†æŠŠå“ªäº›æˆå‘˜å£°æ˜æˆ<code>public</code>çš„ï¼Ÿ<br>å“ªäº›å£°æ˜æˆ<code>private</code>çš„ï¼Ÿ<br>è§£é‡Šä½ è¿™æ ·åšçš„åŸå› ã€‚</p><p>æ„é€ å‡½æ•°ã€<code>getName()</code>ã€<code>getAddress()</code>å‡½æ•°å°†è®¾ä¸º<code>public</code>ã€‚<br><code>name</code>å’Œ <code>address</code> å°†è®¾ä¸º<code>private</code>ã€‚<br>å‡½æ•°æ˜¯æš´éœ²ç»™å¤–éƒ¨çš„æ¥å£ï¼Œå› æ­¤è¦è®¾ä¸º<code>public</code>ï¼›<br>è€Œæ•°æ®åˆ™åº”è¯¥éšè—è®©å¤–éƒ¨ä¸å¯è§ã€‚</p><h2 id="ç»ƒä¹ 7-20"><a href="#ç»ƒä¹ 7-20" class="headerlink" title="ç»ƒä¹ 7.20"></a>ç»ƒä¹ 7.20</h2><p>å‹å…ƒåœ¨ä»€ä¹ˆæ—¶å€™æœ‰ç”¨ï¼Ÿè¯·åˆ†åˆ«ä¸¾å‡ºä½¿ç”¨å‹å…ƒçš„åˆ©å¼Šã€‚</p><p>è§£ï¼š</p><p>å½“å…¶ä»–ç±»æˆ–è€…å‡½æ•°æƒ³è¦è®¿é—®å½“å‰ç±»çš„ç§æœ‰å˜é‡æ—¶ï¼Œè¿™ä¸ªæ—¶å€™åº”è¯¥ç”¨å‹å…ƒã€‚</p><p>åˆ©ï¼š</p><p>ä¸å½“å‰ç±»æœ‰å…³çš„æ¥å£å‡½æ•°èƒ½ç›´æ¥è®¿é—®ç±»çš„ç§æœ‰å˜é‡ã€‚</p><p>å¼Šï¼š</p><p>ç‰ºç‰²äº†å°è£…æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</p><h2 id="ç»ƒä¹ 7-21"><a href="#ç»ƒä¹ 7-21" class="headerlink" title="ç»ƒä¹ 7.21"></a>ç»ƒä¹ 7.21</h2><p>ä¿®æ”¹ä½ çš„<code>Sales_data</code>ç±»ä½¿å…¶éšè—å®ç°çš„ç»†èŠ‚ã€‚<br>ä½ ä¹‹å‰ç¼–å†™çš„å…³äº<code>Sales_data</code>æ“ä½œçš„ç¨‹åºåº”è¯¥ç»§ç»­ä½¿ç”¨ï¼Œå€ŸåŠ©ç±»çš„æ–°å®šä¹‰é‡æ–°ç¼–è¯‘è¯¥ç¨‹åºï¼Œç¡®ä¿å…¶æ­£å¸¸å·¥ä½œã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> Sales_data <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// member functions.</span>Sales_data<span class="token operator">&amp;</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// friend functions</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    sum<span class="token punctuation">.</span><span class="token function">combine</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-22"><a href="#ç»ƒä¹ 7-22" class="headerlink" title="ç»ƒä¹ 7.22"></a>ç»ƒä¹ 7.22</h2><p>ä¿®æ”¹ä½ çš„<code>Person</code>ç±»ä½¿å…¶éšè—å®ç°çš„ç»†èŠ‚ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string sname<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string saddr<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">name</span><span class="token punctuation">(</span>sname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">address</span><span class="token punctuation">(</span>saddr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Person</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token function">getAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> address<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string name<span class="token punctuation">;</span>    std<span class="token operator">::</span>string address<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span><span class="token function">read</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    is <span class="token operator">>></span> person<span class="token punctuation">.</span>name <span class="token operator">>></span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span><span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Person <span class="token operator">&amp;</span>person<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>name <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span>address<span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-23"><a href="#ç»ƒä¹ 7-23" class="headerlink" title="ç»ƒä¹ 7.23"></a>ç»ƒä¹ 7.23</h2><p>ç¼–å†™ä½ è‡ªå·±çš„<code>Screen</code>ç±»å‹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Screen</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span><span class="token operator">:</span>        <span class="token keyword">using</span> pos <span class="token operator">=</span> std<span class="token operator">::</span>string<span class="token operator">::</span>size_type<span class="token punctuation">;</span>        <span class="token function">Screen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>        <span class="token function">Screen</span><span class="token punctuation">(</span>pos ht<span class="token punctuation">,</span> pos wd<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">height</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">width</span><span class="token punctuation">(</span>wd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">contents</span><span class="token punctuation">(</span>ht<span class="token operator">*</span>wd<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>r<span class="token operator">*</span>width<span class="token operator">+</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span><span class="token operator">:</span>        pos cursor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        pos height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string contents<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç»ƒä¹ 7-24"><a href="#ç»ƒä¹ 7-24" class="headerlink" title="ç»ƒä¹ 7.24"></a>ç»ƒä¹ 7.24</h1><p>ç»™ä½ çš„<code>Screen</code>ç±»æ·»åŠ ä¸‰ä¸ªæ„é€ å‡½æ•°ï¼šä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼›å¦ä¸€ä¸ªæ„é€ å‡½æ•°æ¥å—å®½å’Œé«˜çš„å€¼ï¼Œç„¶åå°†<code>contents</code>åˆå§‹åŒ–æˆç»™å®šæ•°é‡çš„ç©ºç™½ï¼›ç¬¬ä¸‰ä¸ªæ„é€ å‡½æ•°æ¥å—å®½å’Œé«˜çš„å€¼ä»¥åŠä¸€ä¸ªå­—ç¬¦ï¼Œè¯¥å­—ç¬¦ä½œä¸ºåˆå§‹åŒ–åå±å¹•çš„å†…å®¹ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Screen</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span><span class="token operator">:</span>        <span class="token keyword">using</span> pos <span class="token operator">=</span> std<span class="token operator">::</span>string<span class="token operator">::</span>size_type<span class="token punctuation">;</span>        <span class="token function">Screen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>        <span class="token function">Screen</span><span class="token punctuation">(</span>pos ht<span class="token punctuation">,</span> pos wd<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">height</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">width</span><span class="token punctuation">(</span>wd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">contents</span><span class="token punctuation">(</span>ht<span class="token operator">*</span>wd<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 2</span>        <span class="token function">Screen</span><span class="token punctuation">(</span>pos ht<span class="token punctuation">,</span> pos wd<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">height</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">width</span><span class="token punctuation">(</span>wd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">contents</span><span class="token punctuation">(</span>ht<span class="token operator">*</span>wd<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 3</span>        <span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>r<span class="token operator">*</span>width<span class="token operator">+</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span><span class="token operator">:</span>        pos cursor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        pos height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>string contents<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-25"><a href="#ç»ƒä¹ 7-25" class="headerlink" title="ç»ƒä¹ 7.25"></a>ç»ƒä¹ 7.25</h2><p><code>Screen</code>èƒ½å®‰å…¨åœ°ä¾èµ–äºæ‹·è´å’Œèµ‹å€¼æ“ä½œçš„é»˜è®¤ç‰ˆæœ¬å—ï¼Ÿ<br>å¦‚æœèƒ½ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¦‚æœä¸èƒ½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>èƒ½ã€‚ <code>Screen</code>çš„æˆå‘˜åªæœ‰å†…ç½®ç±»å‹å’Œ<code>string</code>ï¼Œå› æ­¤èƒ½å®‰å…¨åœ°ä¾èµ–äºæ‹·è´å’Œèµ‹å€¼æ“ä½œçš„é»˜è®¤ç‰ˆæœ¬ã€‚</p><p>ç®¡ç†åŠ¨æ€å†…å­˜çš„ç±»åˆ™ä¸èƒ½ä¾èµ–äºæ‹·è´å’Œèµ‹å€¼æ“ä½œçš„é»˜è®¤ç‰ˆæœ¬ï¼Œè€Œä¸”ä¹Ÿåº”è¯¥å°½é‡ä½¿ç”¨<code>string</code>å’Œ<code>vector</code>æ¥é¿å…åŠ¨æ€ç®¡ç†å†…å­˜çš„å¤æ‚æ€§ã€‚</p><h2 id="ç»ƒä¹ 7-26"><a href="#ç»ƒä¹ 7-26" class="headerlink" title="ç»ƒä¹ 7.26"></a>ç»ƒä¹ 7.26</h2><p>å°†<code>Sales_data::avg_price</code>å®šä¹‰æˆå†…è”å‡½æ•°ã€‚</p><p>è§£ï¼š</p><p>åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> units_sold <span class="token operator">?</span> revenue<span class="token operator">/</span>units_sold <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-27"><a href="#ç»ƒä¹ 7-27" class="headerlink" title="ç»ƒä¹ 7.27"></a>ç»ƒä¹ 7.27</h2><p>ç»™ä½ è‡ªå·±çš„<code>Screen</code>ç±»æ·»åŠ <code>move</code>ã€<code>set</code> å’Œ<code>display</code>å‡½æ•°ï¼Œé€šè¿‡æ‰§è¡Œä¸‹é¢çš„ä»£ç æ£€éªŒä½ çš„ç±»æ˜¯å¦æ­£ç¡®ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Screen <span class="token function">myScreen</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>myScreen<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>myScreen<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å¢åŠ ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Screen</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">set</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> Screen<span class="token operator">&amp;</span> <span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token function">do_display</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    Screen<span class="token operator">&amp;</span> <span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">do_display</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">do_display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> os <span class="token operator">&lt;&lt;</span> contents<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cursor <span class="token operator">=</span> r<span class="token operator">*</span>width <span class="token operator">+</span> c<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">set</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    contents<span class="token punctuation">[</span>r<span class="token operator">*</span>width<span class="token operator">+</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Screen <span class="token function">myScreen</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    myScreen<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>    myScreen<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-28"><a href="#ç»ƒä¹ 7-28" class="headerlink" title="ç»ƒä¹ 7.28"></a>ç»ƒä¹ 7.28</h2><p>å¦‚æœ<code>move</code>ã€<code>set</code>å’Œ<code>display</code>å‡½æ•°çš„è¿”å›ç±»å‹ä¸æ˜¯<code>Screen&amp;</code> è€Œæ˜¯<code>Screen</code>ï¼Œåˆ™åœ¨ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>å¦‚æœè¿”å›ç±»å‹æ˜¯<code>Screen</code>ï¼Œé‚£ä¹ˆ<code>move</code>è¿”å›çš„æ˜¯<code>*this</code>çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå› æ­¤<code>set</code>å‡½æ•°åªèƒ½æ”¹å˜ä¸´æ—¶å‰¯æœ¬è€Œä¸èƒ½æ”¹å˜<code>myScreen</code>çš„å€¼ã€‚</p><h2 id="ç»ƒä¹ 7-29"><a href="#ç»ƒä¹ 7-29" class="headerlink" title="ç»ƒä¹ 7.29"></a>ç»ƒä¹ 7.29</h2><p>ä¿®æ”¹ä½ çš„<code>Screen</code>ç±»ï¼Œä»¤<code>move</code>ã€<code>set</code>å’Œ<code>display</code>å‡½æ•°è¿”å›<code>Screen</code>å¹¶æ£€æŸ¥ç¨‹åºçš„è¿è¡Œç»“æœï¼Œåœ¨ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­ä½ çš„æ¨æµ‹æ­£ç¡®å—ï¼Ÿ</p><p>è§£ï¼š</p><p>æ¨æµ‹æ­£ç¡®ã€‚</p><pre class="line-numbers language-none"><code class="language-none">#with &#39;&amp;&#39;XXXXXXXXXXXXXXXXXXXX#XXXXXXXXXXXXXXXXXXXXXXXX#XXXX                    ^# without &#39;&amp;&#39;XXXXXXXXXXXXXXXXXXXX#XXXXXXXXXXXXXXXXXXXXXXXXXXXXX                    ^<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-30"><a href="#ç»ƒä¹ 7-30" class="headerlink" title="ç»ƒä¹ 7.30"></a>ç»ƒä¹ 7.30</h2><p>é€šè¿‡<code>this</code>æŒ‡é’ˆä½¿ç”¨æˆå‘˜çš„åšæ³•è™½ç„¶åˆæ³•ï¼Œä½†æ˜¯æœ‰ç‚¹å¤šä½™ã€‚è®¨è®ºæ˜¾ç¤ºä½¿ç”¨æŒ‡é’ˆè®¿é—®æˆå‘˜çš„ä¼˜ç¼ºç‚¹ã€‚</p><p>è§£ï¼š</p><p>ä¼˜ç‚¹ï¼š</p><p>ç¨‹åºçš„æ„å›¾æ›´æ˜ç¡®</p><p>å‡½æ•°çš„å‚æ•°å¯ä»¥ä¸æˆå‘˜åŒåï¼Œå¦‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">setAddr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>addr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">this</span><span class="token operator">-></span>addr <span class="token operator">=</span> addr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼ºç‚¹ï¼š</p><p>æœ‰æ—¶å€™æ˜¾å¾—æœ‰ç‚¹å¤šä½™ï¼Œå¦‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>string <span class="token function">getAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-></span>addr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-31"><a href="#ç»ƒä¹ 7-31" class="headerlink" title="ç»ƒä¹ 7.31"></a>ç»ƒä¹ 7.31</h2><p>å®šä¹‰ä¸€å¯¹ç±»<code>X</code>å’Œ<code>Y</code>ï¼Œå…¶ä¸­<code>X</code>åŒ…å«ä¸€ä¸ªæŒ‡å‘<code>Y</code>çš„æŒ‡é’ˆï¼Œè€Œ<code>Y</code>åŒ…å«ä¸€ä¸ªç±»å‹ä¸º<code>X</code>çš„å¯¹è±¡ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Y</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">X</span><span class="token punctuation">&#123;</span>    Y<span class="token operator">*</span> y <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Y</span><span class="token punctuation">&#123;</span>    X x<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-32"><a href="#ç»ƒä¹ 7-32" class="headerlink" title="ç»ƒä¹ 7.32"></a>ç»ƒä¹ 7.32</h2><p>å®šä¹‰ä½ è‡ªå·±çš„<code>Screen</code>å’Œ<code>Window_mgr</code>ï¼Œå…¶ä¸­<code>clear</code>æ˜¯<code>Window_mgr</code>çš„æˆå‘˜ï¼Œæ˜¯<code>Screen</code>çš„å‹å…ƒã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Screen</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Window_mgr</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> ScreenIndex <span class="token operator">=</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Screen<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span>ScreenIndex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Screen<span class="token operator">></span> screens<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Screen</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token class-name">Window_mgr</span><span class="token operator">::</span><span class="token function">clear</span><span class="token punctuation">(</span>ScreenIndex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">using</span> pos <span class="token operator">=</span> std<span class="token operator">::</span>string<span class="token operator">::</span>size_type<span class="token punctuation">;</span><span class="token function">Screen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Screen</span><span class="token punctuation">(</span>pos ht<span class="token punctuation">,</span> pos wd<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">height</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">width</span><span class="token punctuation">(</span>wd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">contents</span><span class="token punctuation">(</span>ht<span class="token operator">*</span>wd<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Screen</span><span class="token punctuation">(</span>pos ht<span class="token punctuation">,</span> pos wd<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">height</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">width</span><span class="token punctuation">(</span>wd<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">contents</span><span class="token punctuation">(</span>ht<span class="token operator">*</span>wd<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> contents<span class="token punctuation">[</span>r<span class="token operator">*</span>width <span class="token operator">+</span> c<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token function">set</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> Screen<span class="token operator">&amp;</span> <span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token function">do_display</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>Screen<span class="token operator">&amp;</span> <span class="token function">display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">do_display</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token function">do_display</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> os <span class="token operator">&lt;&lt;</span> contents<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>pos cursor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>pos width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>std<span class="token operator">::</span>string contents<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token class-name">Window_mgr</span><span class="token operator">::</span><span class="token function">clear</span><span class="token punctuation">(</span>ScreenIndex i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Screen<span class="token operator">&amp;</span> s <span class="token operator">=</span> screens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>contents <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>height<span class="token operator">*</span>s<span class="token punctuation">.</span>width<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>cursor <span class="token operator">=</span> r<span class="token operator">*</span>width <span class="token operator">+</span> c<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> Screen<span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">set</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>contents<span class="token punctuation">[</span>r<span class="token operator">*</span>width <span class="token operator">+</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-33"><a href="#ç»ƒä¹ 7-33" class="headerlink" title="ç»ƒä¹ 7.33"></a>ç»ƒä¹ 7.33</h2><p>å¦‚æœæˆ‘ä»¬ç»™<code>Screen</code>æ·»åŠ ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„<code>size</code>æˆå‘˜å°†å‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿå¦‚æœå‡ºç°äº†é—®é¢˜ï¼Œè¯·å°è¯•ä¿®æ”¹å®ƒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">pos <span class="token class-name">Screen</span><span class="token operator">::</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> height <span class="token operator">*</span> width<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>çº æ­£ï¼šé”™è¯¯ä¸º error: extra qualification â€˜Screen::â€™ on member â€˜sizeâ€™ [-fpermissive]<br>åˆ™åº”è¯¥å»æ‰Screen::,æ”¹ä¸º<br> <pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">pos <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> height <span class="token operator">*</span> width<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></p><h2 id="ç»ƒä¹ 7-34"><a href="#ç»ƒä¹ 7-34" class="headerlink" title="ç»ƒä¹ 7.34"></a>ç»ƒä¹ 7.34</h2><p>å¦‚æœæˆ‘ä»¬æŠŠç¬¬256é¡µ<code>Screen</code>ç±»çš„<code>pos</code>çš„<code>typedef</code>æ”¾åœ¨ç±»çš„æœ€åä¸€è¡Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><p>è§£ï¼š</p><p>åœ¨ dummy_fcn(pos height) å‡½æ•°ä¸­ä¼šå‡ºç° æœªå®šä¹‰çš„æ ‡è¯†ç¬¦posã€‚</p><p>ç±»å‹åçš„å®šä¹‰é€šå¸¸å‡ºç°åœ¨ç±»çš„å¼€å§‹å¤„ï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿æ‰€æœ‰ä½¿ç”¨è¯¥ç±»å‹çš„æˆå‘˜éƒ½å‡ºç°åœ¨ç±»åçš„å®šä¹‰ä¹‹åã€‚</p><h2 id="ç»ƒä¹ 7-35"><a href="#ç»ƒä¹ 7-35" class="headerlink" title="ç»ƒä¹ 7.35"></a>ç»ƒä¹ 7.35</h2><p>è§£é‡Šä¸‹é¢ä»£ç çš„å«ä¹‰ï¼Œè¯´æ˜å…¶ä¸­çš„<code>Type</code>å’Œ<code>initVal</code>åˆ†åˆ«ä½¿ç”¨äº†å“ªä¸ªå®šä¹‰ã€‚å¦‚æœä»£ç å­˜åœ¨é”™è¯¯ï¼Œå°è¯•ä¿®æ”¹å®ƒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">typedef</span> string Type<span class="token punctuation">;</span>Type <span class="token function">initVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">class</span> <span class="token class-name">Exercise</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">typedef</span> <span class="token keyword">double</span> Type<span class="token punctuation">;</span>    Type <span class="token function">setVal</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span><span class="token punctuation">;</span>    Type <span class="token function">initVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">int</span> val<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Type <span class="token class-name">Exercise</span><span class="token operator">::</span><span class="token function">setVal</span><span class="token punctuation">(</span>Type parm<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     val <span class="token operator">=</span> parm <span class="token operator">+</span> <span class="token function">initVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> val<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¹¦ä¸Š255é¡µä¸­è¯´ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ç„¶è€Œåœ¨ç±»ä¸­ï¼Œå¦‚æœæˆå‘˜ä½¿ç”¨äº†å¤–å±‚ä½œç”¨åŸŸä¸­çš„æŸä¸ªåå­—ï¼Œè€Œè¯¥åå­—ä»£è¡¨ä¸€ç§ç±»å‹ï¼Œåˆ™ç±»ä¸èƒ½åœ¨ä¹‹åé‡æ–°å®šä¹‰è¯¥åå­—ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› æ­¤é‡å¤å®šä¹‰<code>Type</code>æ˜¯é”™è¯¯çš„è¡Œä¸ºã€‚</p><p>è™½ç„¶é‡å¤å®šä¹‰ç±»å‹åå­—æ˜¯é”™è¯¯çš„è¡Œä¸ºï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¹¶ä¸ä¸ºæ­¤è´Ÿè´£ã€‚æ‰€ä»¥æˆ‘ä»¬è¦äººä¸ºåœ°éµå®ˆä¸€äº›åŸåˆ™ï¼Œåœ¨è¿™é‡Œæœ‰ä¸€äº›è®¨è®ºã€‚</p><h2 id="ç»ƒä¹ 7-36"><a href="#ç»ƒä¹ 7-36" class="headerlink" title="ç»ƒä¹ 7.36"></a>ç»ƒä¹ 7.36</h2><p>ä¸‹é¢çš„åˆå§‹å€¼æ˜¯é”™è¯¯çš„ï¼Œè¯·æ‰¾å‡ºé—®é¢˜æ‰€åœ¨å¹¶å°è¯•ä¿®æ”¹å®ƒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span><span class="token function">X</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rem</span><span class="token punctuation">(</span>base <span class="token operator">%</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> rem<span class="token punctuation">,</span> base<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åº”è¯¥æ”¹ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span><span class="token function">X</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rem</span><span class="token punctuation">(</span>base <span class="token operator">%</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> base<span class="token punctuation">,</span> rem<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-37"><a href="#ç»ƒä¹ 7-37" class="headerlink" title="ç»ƒä¹ 7.37"></a>ç»ƒä¹ 7.37</h2><p>ä½¿ç”¨æœ¬èŠ‚æä¾›çš„<code>Sales_data</code>ç±»ï¼Œç¡®å®šåˆå§‹åŒ–ä¸‹é¢çš„å˜é‡æ—¶åˆ†åˆ«ä½¿ç”¨äº†å“ªä¸ªæ„é€ å‡½æ•°ï¼Œç„¶åç½—åˆ—å‡ºæ¯ä¸ªå¯¹è±¡æ‰€æœ‰çš„æ•°æ®æˆå‘˜çš„å€¼ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Sales_data <span class="token function">first_item</span><span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨ Sales_data(std::istream &amp;is) ; å„æˆå‘˜å€¼ä»è¾“å…¥æµä¸­è¯»å–</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°  bookNo = "", cnt = 0, revenue = 0.0</span>    Sales_data next<span class="token punctuation">;</span>    <span class="token comment">// ä½¿ç”¨ Sales_data(std::string s = "");   bookNo = "9-999-99999-9", cnt = 0, revenue = 0.0</span>    Sales_data <span class="token function">last</span><span class="token punctuation">(</span><span class="token string">"9-999-99999-9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-38"><a href="#ç»ƒä¹ 7-38" class="headerlink" title="ç»ƒä¹ 7.38"></a>ç»ƒä¹ 7.38</h2><p>æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›æä¾›<code>cin</code>ä½œä¸ºæ¥å—<code>istream&amp;</code>å‚æ•°çš„æ„é€ å‡½æ•°çš„é»˜è®¤å®å‚ï¼Œè¯·å£°æ˜è¿™æ ·çš„æ„é€ å‡½æ•°ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is <span class="token operator">=</span> std<span class="token operator">::</span>cin<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-39"><a href="#ç»ƒä¹ 7-39" class="headerlink" title="ç»ƒä¹ 7.39"></a>ç»ƒä¹ 7.39</h2><p>å¦‚æœæ¥å—<code>string</code>çš„æ„é€ å‡½æ•°å’Œæ¥å—<code>istream&amp;</code>çš„æ„é€ å‡½æ•°éƒ½ä½¿ç”¨é»˜è®¤å®å‚ï¼Œè¿™ç§è¡Œä¸ºåˆæ³•å—ï¼Ÿå¦‚æœä¸ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>ä¸åˆæ³•ã€‚å½“ä½ è°ƒç”¨<code>Sales_data()</code>æ„é€ å‡½æ•°æ—¶ï¼Œæ— æ³•åŒºåˆ†æ˜¯å“ªä¸ªé‡è½½ã€‚</p><h2 id="ç»ƒä¹ 7-40"><a href="#ç»ƒä¹ 7-40" class="headerlink" title="ç»ƒä¹ 7.40"></a>ç»ƒä¹ 7.40</h2><p>ä»ä¸‹é¢çš„æŠ½è±¡æ¦‚å¿µä¸­é€‰æ‹©ä¸€ä¸ªï¼ˆæˆ–è€…ä½ è‡ªå·±æŒ‡å®šä¸€ä¸ªï¼‰ï¼Œæ€è€ƒè¿™æ ·çš„ç±»éœ€è¦å“ªäº›æ•°æ®æˆå‘˜ï¼Œæä¾›ä¸€ç»„åˆç†çš„æ„é€ å‡½æ•°å¹¶é˜æ˜è¿™æ ·åšçš„åŸå› ã€‚</p><pre class="line-numbers language-none"><code class="language-none">(a) Book(b) Data(c) Employee(d) Vehicle(e) Object(f) Tree<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>(a) Book.</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Book</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> isbn<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> name<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> author<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> pubdate<span class="token punctuation">)</span>        <span class="token operator">:</span><span class="token function">isbn_</span><span class="token punctuation">(</span>isbn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">author_</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pubdate_</span><span class="token punctuation">(</span>pubdate<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">explicit</span> <span class="token function">Book</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>         in <span class="token operator">>></span> isbn_ <span class="token operator">>></span> name_ <span class="token operator">>></span> author_ <span class="token operator">>></span> pubdate_<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">unsigned</span> isbn_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string author_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string pubdate_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-41"><a href="#ç»ƒä¹ 7-41" class="headerlink" title="ç»ƒä¹ 7.41"></a>ç»ƒä¹ 7.41</h2><p>ä½¿ç”¨å§”æ‰˜æ„é€ å‡½æ•°é‡æ–°ç¼–å†™ä½ çš„<code>Sales_data</code>ç±»ï¼Œç»™æ¯ä¸ªæ„é€ å‡½æ•°ä½“æ·»åŠ ä¸€æ¡è¯­å¥ï¼Œä»¤å…¶ä¸€æ—¦æ‰§è¡Œå°±æ‰“å°ä¸€æ¡ä¿¡æ¯ã€‚ç”¨å„ç§å¯èƒ½çš„æ–¹å¼åˆ†åˆ«åˆ›å»º<code>Sales_data</code>å¯¹è±¡ï¼Œè®¤çœŸç ”ç©¶æ¯æ¬¡è¾“å‡ºçš„ä¿¡æ¯ç›´åˆ°ä½ ç¡®å®ç†è§£äº†å§”æ‰˜æ„é€ å‡½æ•°çš„æ‰§è¡Œé¡ºåºã€‚</p><p>è§£ï¼š</p><ul><li><a href="https://github.com/jinbaotang/Cpp_Primer_Practice/tree/master/cpp_source/ch07/ex_7_41.h">å¤´æ–‡ä»¶</a></li><li><a href="https://github.com/jinbaotang/Cpp_Primer_Practice/tree/master/cpp_source/ch07/ex_7_41.cpp">æºæ–‡ä»¶</a></li><li><a href="https://github.com/jinbaotang/Cpp_Primer_Practice/tree/master/cpp_source/ch07/ex_7_41_main.cpp">ä¸»å‡½æ•°</a></li></ul><p>æ€»ç»“ï¼šä½¿ç”¨å§”æ‰˜æ„é€ å‡½æ•°ï¼Œè°ƒç”¨é¡ºåºæ˜¯ï¼š</p><ul><li>1.å®é™…çš„æ„é€ å‡½æ•°çš„å‡½æ•°ä½“ã€‚</li><li>2.å§”æ‰˜æ„é€ å‡½æ•°çš„å‡½æ•°ä½“ã€‚</li></ul><h2 id="ç»ƒä¹ 7-42"><a href="#ç»ƒä¹ 7-42" class="headerlink" title="ç»ƒä¹ 7.42"></a>ç»ƒä¹ 7.42</h2><p>å¯¹äºä½ åœ¨ç»ƒä¹ 7.40ä¸­ç¼–å†™çš„ç±»ï¼Œç¡®å®šå“ªäº›æ„é€ å‡½æ•°å¯ä»¥ä½¿ç”¨å§”æ‰˜ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œç¼–å†™å§”æ‰˜æ„é€ å‡½æ•°ã€‚å¦‚æœä¸å¯ä»¥ï¼Œä»æŠ½è±¡æ¦‚å¿µåˆ—è¡¨ä¸­é‡æ–°é€‰æ‹©ä¸€ä¸ªä½ è®¤ä¸ºå¯ä»¥ä½¿ç”¨å§”æ‰˜æ„é€ å‡½æ•°çš„ï¼Œä¸ºæŒ‘é€‰å‡ºçš„è¿™ä¸ªæ¦‚å¿µç¼–å†™ç±»å®šä¹‰ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Book</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> isbn<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> name<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> author<span class="token punctuation">,</span> std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> pubdate<span class="token punctuation">)</span>        <span class="token operator">:</span><span class="token function">isbn_</span><span class="token punctuation">(</span>isbn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">author_</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pubdate_</span><span class="token punctuation">(</span>pubdate<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Book</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> isbn<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Book</span><span class="token punctuation">(</span>isbn<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">explicit</span> <span class="token function">Book</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>         in <span class="token operator">>></span> isbn_ <span class="token operator">>></span> name_ <span class="token operator">>></span> author_ <span class="token operator">>></span> pubdate_<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">unsigned</span> isbn_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string author_<span class="token punctuation">;</span>    std<span class="token operator">::</span>string pubdate_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-43"><a href="#ç»ƒä¹ 7-43" class="headerlink" title="ç»ƒä¹ 7.43"></a>ç»ƒä¹ 7.43</h2><p>å‡å®šæœ‰ä¸€ä¸ªåä¸º<code>NoDefault</code>çš„ç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªæ¥å—<code>int</code>çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ã€‚å®šä¹‰ç±»<code>C</code>ï¼Œ<code>C</code>æœ‰ä¸€ä¸ª <code>NoDefault</code>ç±»å‹çš„æˆå‘˜ï¼Œå®šä¹‰<code>C</code>çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">NoDefault</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">NoDefault</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">def</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">private</span><span class="token operator">:</span>    NoDefault def<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-44"><a href="#ç»ƒä¹ 7-44" class="headerlink" title="ç»ƒä¹ 7.44"></a>ç»ƒä¹ 7.44</h2><p>ä¸‹é¢è¿™æ¡å£°æ˜åˆæ³•å—ï¼Ÿå¦‚æœä¸ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">vector<span class="token operator">&lt;</span>NoDefault<span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//vecåˆå§‹åŒ–æœ‰10ä¸ªå…ƒç´ </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆæ³•ã€‚å› ä¸º<code>NoDefault</code>æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 7-45"><a href="#ç»ƒä¹ 7-45" class="headerlink" title="ç»ƒä¹ 7.45"></a>ç»ƒä¹ 7.45</h2><p>å¦‚æœåœ¨ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­å®šä¹‰çš„vectorçš„å…ƒç´ ç±»å‹æ˜¯Cï¼Œåˆ™å£°æ˜åˆæ³•å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>åˆæ³•ã€‚å› ä¸º<code>C</code>æœ‰é»˜è®¤æ„é€ å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 7-46"><a href="#ç»ƒä¹ 7-46" class="headerlink" title="ç»ƒä¹ 7.46"></a>ç»ƒä¹ 7.46</h2><p>ä¸‹é¢å“ªäº›è®ºæ–­æ˜¯ä¸æ­£ç¡®çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><ul><li>(a) ä¸€ä¸ªç±»å¿…é¡»è‡³å°‘æä¾›ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚</li><li>(b) é»˜è®¤æ„é€ å‡½æ•°æ˜¯å‚æ•°åˆ—è¡¨ä¸ºç©ºçš„æ„é€ å‡½æ•°ã€‚</li><li>(c) å¦‚æœå¯¹äºç±»æ¥è¯´ä¸å­˜åœ¨æœ‰æ„ä¹‰çš„é»˜è®¤å€¼ï¼Œåˆ™ç±»ä¸åº”è¯¥æä¾›é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>(d) å¦‚æœç±»æ²¡æœ‰å®šä¹‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨å°†ä¸ºå…¶ç”Ÿæˆä¸€ä¸ªå¹¶æŠŠæ¯ä¸ªæ•°æ®æˆå‘˜åˆå§‹åŒ–æˆç›¸åº”ç±»å‹çš„é»˜è®¤å€¼ã€‚</li></ul><p>è§£ï¼š</p><ul><li>(a) ä¸æ­£ç¡®ã€‚å¦‚æœæˆ‘ä»¬çš„ç±»æ²¡æœ‰æ˜¾å¼åœ°å®šä¹‰æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šä¸ºæˆ‘ä»¬éšå¼åœ°å®šä¹‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼Œå¹¶ç§°ä¹‹ä¸ºåˆæˆçš„é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>(b) ä¸å®Œå…¨æ­£ç¡®ã€‚ä¸ºæ¯ä¸ªå‚æ•°éƒ½æä¾›äº†é»˜è®¤å€¼çš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>(c) ä¸æ­£ç¡®ã€‚å“ªæ€•æ²¡æœ‰æ„ä¹‰çš„å€¼ä¹Ÿéœ€è¦åˆå§‹åŒ–ã€‚</li><li>(d) ä¸æ­£ç¡®ã€‚åªæœ‰å½“ä¸€ä¸ªç±»æ²¡æœ‰å®šä¹‰<strong>ä»»ä½•æ„é€ å‡½æ•°</strong>çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨æ‰ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€‚</li></ul><h2 id="ç»ƒä¹ 7-47"><a href="#ç»ƒä¹ 7-47" class="headerlink" title="ç»ƒä¹ 7.47"></a>ç»ƒä¹ 7.47</h2><p>è¯´æ˜æ¥å—ä¸€ä¸ª<code>string</code>å‚æ•°çš„<code>Sales_data</code>æ„é€ å‡½æ•°æ˜¯å¦åº”è¯¥æ˜¯<code>explicit</code>çš„ï¼Œå¹¶è§£é‡Šè¿™æ ·åšçš„ä¼˜ç¼ºç‚¹ã€‚</p><p>è§£ï¼š</p><p>æ˜¯å¦éœ€è¦ä»<code>string</code>åˆ°<code>Sales_data</code>çš„è½¬æ¢ä¾èµ–äºæˆ‘ä»¬å¯¹ç”¨æˆ·ä½¿ç”¨è¯¥è½¬æ¢çš„çœ‹æ³•ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œè¿™ç§è½¬æ¢å¯èƒ½æ˜¯å¯¹çš„ã€‚<code>null_book</code>ä¸­çš„<code>string</code>å¯èƒ½è¡¨ç¤ºäº†ä¸€ä¸ªä¸å­˜åœ¨çš„<code>ISBN</code>ç¼–å·ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><p>å¯ä»¥æŠ‘åˆ¶æ„é€ å‡½æ•°å®šä¹‰çš„éšå¼è½¬æ¢</p><p>ç¼ºç‚¹ï¼š</p><p>ä¸ºäº†è½¬æ¢è¦æ˜¾å¼åœ°ä½¿ç”¨æ„é€ å‡½æ•°</p><h2 id="ç»ƒä¹ 7-48"><a href="#ç»ƒä¹ 7-48" class="headerlink" title="ç»ƒä¹ 7.48"></a>ç»ƒä¹ 7.48</h2><p>å‡å®š<code>Sales_data</code>çš„æ„é€ å‡½æ•°ä¸æ˜¯<code>explicit</code>çš„ï¼Œåˆ™ä¸‹è¿°å®šä¹‰å°†æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œï¼Ÿ</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">string <span class="token function">null_isbn</span><span class="token punctuation">(</span><span class="token string">"9-999-9999-9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data <span class="token function">item1</span><span class="token punctuation">(</span>null_isbn<span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data <span class="token function">item2</span><span class="token punctuation">(</span><span class="token string">"9-999-99999-9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™äº›å®šä¹‰å’Œæ˜¯ä¸æ˜¯<code>explicit</code>çš„æ— å…³ã€‚</p><h2 id="ç»ƒä¹ 7-49"><a href="#ç»ƒä¹ 7-49" class="headerlink" title="ç»ƒä¹ 7.49"></a>ç»ƒä¹ 7.49</h2><p>å¯¹äº<code>combine</code>å‡½æ•°çš„ä¸‰ç§ä¸åŒå£°æ˜ï¼Œå½“æˆ‘ä»¬è°ƒç”¨<code>i.combine(s)</code>æ—¶åˆ†åˆ«å‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿå…¶ä¸­<code>i</code>æ˜¯ä¸€ä¸ª<code>Sales_data</code>ï¼Œè€Œ<code> s</code>æ˜¯ä¸€ä¸ª<code>string</code>å¯¹è±¡ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> Sales_data <span class="token operator">&amp;</span><span class="token function">combine</span><span class="token punctuation">(</span>Sales_data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> Sales_data <span class="token operator">&amp;</span><span class="token function">combine</span><span class="token punctuation">(</span>Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error C2664: æ— æ³•å°†å‚æ•° 1 ä»â€œstd::stringâ€è½¬æ¢ä¸ºâ€œSales_data &amp;â€å› ä¸ºéšå¼è½¬æ¢åªæœ‰ä¸€æ¬¡</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> Sales_data <span class="token operator">&amp;</span><span class="token function">combine</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span> <span class="token comment">// è¯¥æˆå‘˜å‡½æ•°æ˜¯const çš„ï¼Œæ„å‘³ç€ä¸èƒ½æ”¹å˜å¯¹è±¡ã€‚è€Œ combineå‡½æ•°çš„æœ¬æ„å°±æ˜¯è¦æ”¹å˜å¯¹è±¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-50"><a href="#ç»ƒä¹ 7-50" class="headerlink" title="ç»ƒä¹ 7.50"></a>ç»ƒä¹ 7.50</h2><p>ç¡®å®šåœ¨ä½ çš„<code>Person</code>ç±»ä¸­æ˜¯å¦æœ‰ä¸€äº›æ„é€ å‡½æ•°åº”è¯¥æ˜¯<code>explicit</code> çš„ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">explicit</span> <span class="token function">Person</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-51"><a href="#ç»ƒä¹ 7-51" class="headerlink" title="ç»ƒä¹ 7.51"></a>ç»ƒä¹ 7.51</h2><p><code>vector</code>å°†å…¶å•å‚æ•°çš„æ„é€ å‡½æ•°å®šä¹‰æˆ<code>explicit</code>çš„ï¼Œè€Œ<code>string</code>åˆ™ä¸æ˜¯ï¼Œä½ è§‰å¾—åŸå› ä½•åœ¨ï¼Ÿ</p><p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœ<code>vector</code>æ²¡æœ‰å°†å•å‚æ•°æ„é€ å‡½æ•°å®šä¹‰æˆ<code>explicit</code>çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾è¿™æ ·è°ƒç”¨ä¼šè®©äººå›°æƒ‘ï¼Œå‡½æ•°å®é™…ä¸Šä¼šåˆå§‹åŒ–ä¸€ä¸ªæ‹¥æœ‰34ä¸ªå…ƒç´ çš„<code>vecto</code>rçš„ä¸´æ—¶é‡ï¼Œç„¶åè¿”å›34ã€‚ä½†æ˜¯è¿™æ ·æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚è€Œ<code>string</code>åˆ™ä¸åŒï¼Œ<code>string</code>çš„å•å‚æ•°æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯<code>const char *</code>ï¼Œå› æ­¤å‡¡æ˜¯åœ¨éœ€è¦ç”¨åˆ°<code>string</code>çš„åœ°æ–¹éƒ½å¯ä»¥ç”¨<code> const char *</code>æ¥ä»£æ›¿ï¼ˆå­—é¢å€¼å°±æ˜¯<code>const char *</code>ï¼‰ã€‚å¦‚ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-52"><a href="#ç»ƒä¹ 7-52" class="headerlink" title="ç»ƒä¹ 7.52"></a>ç»ƒä¹ 7.52</h2><p>ä½¿ç”¨2.6.1èŠ‚çš„ <code>Sales_data</code> ç±»ï¼Œè§£é‡Šä¸‹é¢çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚å¦‚æœå­˜åœ¨é—®é¢˜ï¼Œå°è¯•ä¿®æ”¹å®ƒã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Sales_data item <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"987-0590353403"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15.99</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p><code>Sales_data</code> ç±»ä¸æ˜¯èšåˆç±»ï¼Œåº”è¯¥ä¿®æ”¹æˆå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold<span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-53"><a href="#ç»ƒä¹ 7-53" class="headerlink" title="ç»ƒä¹ 7.53"></a>ç»ƒä¹ 7.53</h2><p>å®šä¹‰ä½ è‡ªå·±çš„<code>Debug</code>ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Debug</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">constexpr</span> <span class="token function">Debug</span><span class="token punctuation">(</span><span class="token keyword">bool</span> b <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">hw</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">io</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">other</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">constexpr</span> <span class="token function">Debug</span><span class="token punctuation">(</span><span class="token keyword">bool</span> h<span class="token punctuation">,</span> <span class="token keyword">bool</span> i<span class="token punctuation">,</span> <span class="token keyword">bool</span> o<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">hw</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">io</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">other</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">constexpr</span> <span class="token keyword">bool</span> <span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> hw <span class="token operator">||</span> io <span class="token operator">||</span> other<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">set_hw</span><span class="token punctuation">(</span><span class="token keyword">bool</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> hw <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">set_io</span><span class="token punctuation">(</span><span class="token keyword">bool</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> io <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">set_other</span><span class="token punctuation">(</span><span class="token keyword">bool</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> other <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">bool</span> hw<span class="token punctuation">;</span>        <span class="token comment">// runtime error</span>    <span class="token keyword">bool</span> io<span class="token punctuation">;</span>        <span class="token comment">// I/O error</span>    <span class="token keyword">bool</span> other<span class="token punctuation">;</span>     <span class="token comment">// the others</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-54"><a href="#ç»ƒä¹ 7-54" class="headerlink" title="ç»ƒä¹ 7.54"></a>ç»ƒä¹ 7.54</h2><p><code>Debug</code>ä¸­ä»¥ <code>set_</code> å¼€å¤´çš„æˆå‘˜åº”è¯¥è¢«å£°æ˜æˆ<code>constexpr</code> å—ï¼Ÿå¦‚æœä¸ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>è§£ï¼š</p><p>ä¸èƒ½ã€‚<code>constexpr</code>å‡½æ•°å¿…é¡»åŒ…å«ä¸€ä¸ªè¿”å›è¯­å¥ã€‚</p><h2 id="ç»ƒä¹ 7-55"><a href="#ç»ƒä¹ 7-55" class="headerlink" title="ç»ƒä¹ 7.55"></a>ç»ƒä¹ 7.55</h2><p>7.5.5èŠ‚çš„<code>Data</code>ç±»æ˜¯å­—é¢å€¼å¸¸é‡ç±»å—ï¼Ÿè¯·è§£é‡ŠåŸå› ã€‚</p><p>è§£ï¼š</p><p>ä¸æ˜¯ã€‚å› ä¸º<code>std::string</code>ä¸æ˜¯å­—é¢å€¼ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 7-56"><a href="#ç»ƒä¹ 7-56" class="headerlink" title="ç»ƒä¹ 7.56"></a>ç»ƒä¹ 7.56</h2><p>ä»€ä¹ˆæ˜¯ç±»çš„é™æ€æˆå‘˜ï¼Ÿå®ƒæœ‰ä½•ä¼˜ç‚¹ï¼Ÿé™æ€æˆå‘˜ä¸æ™®é€šæˆå‘˜æœ‰ä½•åŒºåˆ«ï¼Ÿ</p><p>è§£ï¼š</p><p>ä¸ç±»æœ¬èº«ç›¸å…³ï¼Œè€Œä¸æ˜¯ä¸ç±»çš„å„ä¸ªå¯¹è±¡ç›¸å…³çš„æˆå‘˜æ˜¯é™æ€æˆå‘˜ã€‚é™æ€æˆå‘˜èƒ½ç”¨äºæŸäº›åœºæ™¯ï¼Œè€Œæ™®é€šæˆå‘˜ä¸èƒ½ã€‚</p><h2 id="ç»ƒä¹ 7-57"><a href="#ç»ƒä¹ 7-57" class="headerlink" title="ç»ƒä¹ 7.57"></a>ç»ƒä¹ 7.57</h2><p>ç¼–å†™ä½ è‡ªå·±çš„<code>Account</code>ç±»ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> amount <span class="token operator">+=</span> amount <span class="token operator">*</span> interestRate<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">rate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> interestRate<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rate</span><span class="token punctuation">(</span><span class="token keyword">double</span> newRate<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> interestRate <span class="token operator">=</span> newRate<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string owner<span class="token punctuation">;</span>    <span class="token keyword">double</span> amount<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">double</span> interestRate<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">constexpr</span> <span class="token keyword">double</span> todayRate <span class="token operator">=</span> <span class="token number">42.42</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">initRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> todayRate<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">double</span> Account<span class="token operator">::</span>interestRate <span class="token operator">=</span> <span class="token function">initRate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 7-58"><a href="#ç»ƒä¹ 7-58" class="headerlink" title="ç»ƒä¹ 7.58"></a>ç»ƒä¹ 7.58</h2><p>ä¸‹é¢çš„é™æ€æ•°æ®æˆå‘˜çš„å£°æ˜å’Œå®šä¹‰æœ‰é”™è¯¯å—ï¼Ÿè¯·è§£é‡ŠåŸå› ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//example.h</span><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">static</span> <span class="token keyword">double</span> rate <span class="token operator">=</span> <span class="token number">6.5</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> vecSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">static</span> vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span>vecSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//example.c</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"example.h"</span></span><span class="token keyword">double</span> Example<span class="token operator">::</span>rate<span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> Example<span class="token operator">::</span>vec<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>rate</code>åº”è¯¥æ˜¯ä¸€ä¸ª<strong>å¸¸é‡è¡¨è¾¾å¼</strong>ã€‚è€Œç±»å†…åªèƒ½åˆå§‹åŒ–æ•´å‹ç±»å‹çš„é™æ€å¸¸é‡ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨ç±»å†…åˆå§‹åŒ–<code>vec</code>ã€‚ä¿®æ”¹åå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// example.h</span><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> <span class="token keyword">constexpr</span> <span class="token keyword">double</span> rate <span class="token operator">=</span> <span class="token number">6.5</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> vecSize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> vec<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// example.C</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"example.h"</span></span><span class="token keyword">constexpr</span> <span class="token keyword">double</span> Example<span class="token operator">::</span>rate<span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token class-name">Example</span><span class="token operator">::</span><span class="token function">vec</span><span class="token punctuation">(</span>Example<span class="token operator">::</span>vecSize<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ14</title>
      <link href="2021/04/10/excersize/ch14/"/>
      <url>2021/04/10/excersize/ch14/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå››ç« -é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢"><a href="#ç¬¬åå››ç« -é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢" class="headerlink" title="ç¬¬åå››ç«  é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢"></a>ç¬¬åå››ç«  é‡è½½è¿ç®—ä¸ç±»å‹è½¬æ¢</h1><h2 id="ç»ƒä¹ 14-1"><a href="#ç»ƒä¹ 14-1" class="headerlink" title="ç»ƒä¹ 14.1"></a>ç»ƒä¹ 14.1</h2><blockquote><p>åœ¨ä»€ä¹ˆæƒ…å†µä¸‹é‡è½½çš„è¿ç®—ç¬¦ä¸å†…ç½®è¿ç®—ç¬¦æœ‰æ‰€åŒºåˆ«ï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹é‡è½½çš„è¿ç®—ç¬¦åˆä¸å†…ç½®è¿ç®—ç¬¦ä¸€æ ·ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨é‡è½½è¿ç®—ç¬¦å‡½æ•°ã€‚é‡ç½®è¿ç®—ç¬¦ä¸å†…ç½®è¿ç®—ç¬¦æœ‰ä¸€æ ·çš„ä¼˜å…ˆçº§ä¸ç»“åˆæ€§ã€‚</p><h2 id="ç»ƒä¹ 14-2"><a href="#ç»ƒä¹ 14-2" class="headerlink" title="ç»ƒä¹ 14.2"></a>ç»ƒä¹ 14.2</h2><blockquote><p>ä¸º <code>Sales_data</code> ç¼–å†™é‡è½½çš„è¾“å…¥ã€è¾“å‡ºã€åŠ æ³•å’Œå¤åˆèµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Sales_data</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// input</span>    <span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output</span>    <span class="token keyword">friend</span> Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// addition</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>    Sales_data<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// compound-assignment</span>    std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> units_sold <span class="token operator">?</span> revenue<span class="token operator">/</span>units_sold <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_02.h"</span></span><span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    is <span class="token operator">>></span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data<span class="token operator">&amp;</span> Sales_data<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>    is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span>        item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>    <span class="token keyword">else</span>        item <span class="token operator">=</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>    sum <span class="token operator">+=</span> rhs<span class="token punctuation">;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-3"><a href="#ç»ƒä¹ 14-3" class="headerlink" title="ç»ƒä¹ 14.3"></a>ç»ƒä¹ 14.3</h2><blockquote><p><code>string</code> å’Œ <code>vector</code> éƒ½å®šä¹‰äº†é‡è½½çš„<code>==</code>ä»¥æ¯”è¾ƒå„è‡ªçš„å¯¹è±¡ï¼Œå‡è®¾ <code>svec1</code> å’Œ <code>svec2</code> æ˜¯å­˜æ”¾ <code>string</code> çš„ <code>vector</code>ï¼Œç¡®å®šåœ¨ä¸‹é¢çš„è¡¨è¾¾å¼ä¸­åˆ†åˆ«ä½¿ç”¨äº†å“ªä¸ªç‰ˆæœ¬çš„<code>==</code>ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token string">"cobble"</span> <span class="token operator">==</span> <span class="token string">"stone"</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> svec1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> svec2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> svec1 <span class="token operator">==</span> <span class="token function">svec2</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> svec1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"stone"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) éƒ½ä¸æ˜¯ã€‚</li><li>(b) <code>string</code> </li><li>(c) <code>vector</code> </li><li>(d) <code>string</code></li></ul><h2 id="ç»ƒä¹ 14-4"><a href="#ç»ƒä¹ 14-4" class="headerlink" title="ç»ƒä¹ 14.4"></a>ç»ƒä¹ 14.4</h2><blockquote><p>å¦‚ä½•ç¡®å®šä¸‹åˆ—è¿ç®—ç¬¦æ˜¯å¦åº”è¯¥æ˜¯ç±»çš„æˆå‘˜ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">%=</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">++</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">-></span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ä¸éœ€è¦æ˜¯æˆå‘˜ã€‚</li><li>(b) æ˜¯æˆå‘˜ã€‚</li><li>(c) æ˜¯æˆå‘˜ã€‚</li><li>(d) å¿…é¡»æ˜¯æˆå‘˜ã€‚</li><li>(e) ä¸éœ€è¦æ˜¯æˆå‘˜ã€‚</li><li>(f) ä¸éœ€è¦æ˜¯æˆå‘˜ã€‚</li><li>(g) ä¸éœ€è¦æ˜¯æˆå‘˜ã€‚</li><li>(h) å¿…é¡»æ˜¯æˆå‘˜ã€‚</li></ul><h2 id="ç»ƒä¹ 14-5"><a href="#ç»ƒä¹ 14-5" class="headerlink" title="ç»ƒä¹ 14.5"></a>ç»ƒä¹ 14.5</h2><blockquote><p>åœ¨7.5.1èŠ‚ä¸­çš„ç»ƒä¹ 7.40ä¸­ï¼Œç¼–å†™äº†ä¸‹åˆ—ç±»ä¸­æŸä¸€ä¸ªçš„æ¡†æ¶ï¼Œè¯·é—®åœ¨è¿™ä¸ªç±»ä¸­åº”è¯¥å®šä¹‰é‡è½½çš„è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å†™å‡ºæ¥ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">Book</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">Date</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">Employee</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">Vehicle</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token function">Object</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> Tree<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>Book</code>ï¼Œåº”è¯¥é‡è½½ã€‚</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> no<span class="token punctuation">,</span> std<span class="token operator">::</span>string name<span class="token punctuation">,</span> std<span class="token operator">::</span>string author<span class="token punctuation">,</span> std<span class="token operator">::</span>string pubdate<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">no_</span><span class="token punctuation">(</span>no<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">author_</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pubdate_</span><span class="token punctuation">(</span>pubdate<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Book</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> in <span class="token operator">>></span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">unsigned</span> no_<span class="token punctuation">;</span>std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>std<span class="token operator">::</span>string author_<span class="token punctuation">;</span>std<span class="token operator">::</span>string pubdate_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_5.h"</span></span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">,</span> Book <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>in <span class="token operator">>></span> book<span class="token punctuation">.</span>no_ <span class="token operator">>></span> book<span class="token punctuation">.</span>name_ <span class="token operator">>></span> book<span class="token punctuation">.</span>author_ <span class="token operator">>></span> book<span class="token punctuation">.</span>pubdate_<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>in<span class="token punctuation">)</span>book <span class="token operator">=</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> in<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>out<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>out <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>no_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>name_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>author_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>pubdate_<span class="token punctuation">;</span><span class="token keyword">return</span> out<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>no_ <span class="token operator">==</span> rhs<span class="token punctuation">.</span>no_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_5.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Book <span class="token function">book1</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span><span class="token punctuation">,</span> <span class="token string">"Lippman"</span><span class="token punctuation">,</span> <span class="token string">"2012"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Book <span class="token function">book2</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span><span class="token punctuation">,</span> <span class="token string">"Lippman"</span><span class="token punctuation">,</span> <span class="token string">"2012"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>book1 <span class="token operator">==</span> book2<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> book1 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-6"><a href="#ç»ƒä¹ 14-6" class="headerlink" title="ç»ƒä¹ 14.6"></a>ç»ƒä¹ 14.6</h2><blockquote><p>ä¸ºä½ çš„ <code>Sales_data</code> ç±»å®šä¹‰è¾“å‡ºè¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.2ã€‚</p><h2 id="ç»ƒä¹ 14-7"><a href="#ç»ƒä¹ 14-7" class="headerlink" title="ç»ƒä¹ 14.7"></a>ç»ƒä¹ 14.7</h2><blockquote><p>ä½ åœ¨13.5èŠ‚çš„ç»ƒä¹ ä¸­æ›¾ç»ç¼–å†™äº†ä¸€ä¸ª<code>String</code>ç±»ï¼Œä¸ºå®ƒå®šä¹‰ä¸€ä¸ªè¾“å‡ºè¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">String</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> end <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>size_t <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> end <span class="token operator">-</span> elements <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">range_initializer</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">char</span> <span class="token operator">*</span>elements<span class="token punctuation">;</span><span class="token keyword">char</span> <span class="token operator">*</span>end<span class="token punctuation">;</span>std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> alloc<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_7.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> str <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>e <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">&#123;</span> str<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">uninitialized_copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">range_initializer</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>first<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>last<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> newstr <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> newstr<span class="token punctuation">.</span>first<span class="token punctuation">;</span>end <span class="token operator">=</span> newstr<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> <span class="token operator">*</span>sl <span class="token operator">=</span> <span class="token keyword">const_cast</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>sl<span class="token punctuation">)</span><span class="token operator">++</span>sl<span class="token punctuation">;</span><span class="token function">range_initializer</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">++</span>sl<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">range_initializer</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>elements<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"copy constructor"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>elements<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span><span class="token function">for_each</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> end<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> end <span class="token operator">-</span> elements<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>String<span class="token operator">&amp;</span> String<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> newstr <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>elements<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> newstr<span class="token punctuation">.</span>first<span class="token punctuation">;</span>end <span class="token operator">=</span> newstr<span class="token punctuation">.</span>second<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"copy-assignment"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> String <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token keyword">const_cast</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>c<span class="token punctuation">)</span>os <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>c<span class="token operator">++</span><span class="token punctuation">;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_7.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>String <span class="token function">str</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-8"><a href="#ç»ƒä¹ 14-8" class="headerlink" title="ç»ƒä¹ 14.8"></a>ç»ƒä¹ 14.8</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚ä¸­çš„ç»ƒä¹ ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä¸ºå®ƒå®šä¹‰ä¸€ä¸ªè¾“å‡ºè¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.5ã€‚</p><h2 id="ç»ƒä¹ 14-9"><a href="#ç»ƒä¹ 14-9" class="headerlink" title="ç»ƒä¹ 14.9"></a>ç»ƒä¹ 14.9</h2><blockquote><p>ä¸ºä½ çš„ <code>Sales_data</code> ç±»å®šä¹‰è¾“å…¥è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.2ã€‚</p><h2 id="ç»ƒä¹ 14-10"><a href="#ç»ƒä¹ 14-10" class="headerlink" title="ç»ƒä¹ 14.10"></a>ç»ƒä¹ 14.10</h2><blockquote><p>å¯¹äº <code>Sales_data</code> çš„è¾“å…¥è¿ç®—ç¬¦æ¥è¯´å¦‚æœç»™å®šäº†ä¸‹é¢çš„è¾“å…¥å°†å‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">201</span><span class="token operator">-</span><span class="token number">99999</span><span class="token operator">-</span><span class="token number">9</span> <span class="token number">10</span> <span class="token number">24.95</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token number">10</span> <span class="token number">24.95</span> <span class="token number">0</span><span class="token operator">-</span><span class="token number">210</span><span class="token operator">-</span><span class="token number">99999</span><span class="token operator">-</span><span class="token number">9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) æ ¼å¼æ­£ç¡®ã€‚</li><li>(b) ä¸åˆæ³•çš„è¾“å…¥ã€‚å› ä¸ºç¨‹åºè¯•å›¾å°† <code>0-210-99999-9</code> è½¬æ¢ä¸º <code>float</code>ã€‚</li></ul><h2 id="ç»ƒä¹ 14-11"><a href="#ç»ƒä¹ 14-11" class="headerlink" title="ç»ƒä¹ 14.11"></a>ç»ƒä¹ 14.11</h2><blockquote><p>ä¸‹é¢çš„ <code>Sales_data</code> è¾“å…¥è¿ç®—ç¬¦å­˜åœ¨é”™è¯¯å—ï¼Ÿå¦‚æœæœ‰ï¼Œè¯·æŒ‡å‡ºæ¥ã€‚å¯¹äºè¿™ä¸ªè¾“å…¥è¿ç®—ç¬¦å¦‚æœä»ç„¶ç»™å®šä¸Šä¸ªç»ƒä¹ çš„è¾“å…¥å°†ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">double</span> price<span class="token punctuation">;</span>in <span class="token operator">>></span> s<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> s<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span>s<span class="token punctuation">.</span>revence <span class="token operator">=</span> s<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span><span class="token keyword">return</span> in<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ²¡æœ‰è¾“å…¥æ£€æŸ¥ï¼Œä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚</p><h2 id="ç»ƒä¹ 14-12"><a href="#ç»ƒä¹ 14-12" class="headerlink" title="ç»ƒä¹ 14.12"></a>ç»ƒä¹ 14.12</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚çš„ç»ƒä¹ ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä¸ºå®ƒå®šä¹‰ä¸€ä¸ªè¾“å…¥è¿ç®—ç¬¦å¹¶ç¡®ä¿è¯¥è¿ç®—ç¬¦å¯ä»¥å¤„ç†è¾“å…¥é”™è¯¯ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.5ã€‚</p><h2 id="ç»ƒä¹ 14-13"><a href="#ç»ƒä¹ 14-13" class="headerlink" title="ç»ƒä¹ 14.13"></a>ç»ƒä¹ 14.13</h2><blockquote><p>ä½ è®¤ä¸º <code>Sales_data</code> ç±»è¿˜åº”è¯¥æ”¯æŒå“ªäº›å…¶ä»–ç®—æœ¯è¿ç®—ç¬¦ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œè¯·ç»™å‡ºå®ƒä»¬çš„å®šä¹‰ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ²¡æœ‰å…¶ä»–äº†ã€‚</p><h2 id="ç»ƒä¹ 14-14"><a href="#ç»ƒä¹ 14-14" class="headerlink" title="ç»ƒä¹ 14.14"></a>ç»ƒä¹ 14.14</h2><blockquote><p>ä½ è§‰å¾—ä¸ºä»€ä¹ˆè°ƒç”¨ <code>operator+=</code> æ¥å®šä¹‰<code>operator+</code> æ¯”å…¶ä»–æ–¹æ³•æ›´æœ‰æ•ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºç”¨ <code>operator+=</code> ä¼šé¿å…ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œè€Œä½¿å¾—æ›´æœ‰æ•ˆã€‚</p><h2 id="ç»ƒä¹ 14-15"><a href="#ç»ƒä¹ 14-15" class="headerlink" title="ç»ƒä¹ 14.15"></a>ç»ƒä¹ 14.15</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚çš„ç»ƒä¹ 7.40ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä½ è®¤ä¸ºå®ƒåº”è¯¥å«æœ‰å…¶ä»–ç®—æœ¯è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å®ç°å®ƒä»¬ï¼›å¦‚æœä¸æ˜¯ï¼Œè§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> Book <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> no<span class="token punctuation">,</span> std<span class="token operator">::</span>string name<span class="token punctuation">,</span> std<span class="token operator">::</span>string author<span class="token punctuation">,</span> std<span class="token operator">::</span>string pubdate<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> number<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">no_</span><span class="token punctuation">(</span>no<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">name_</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">author_</span><span class="token punctuation">(</span>author<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">pubdate_</span><span class="token punctuation">(</span>pubdate<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">number_</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Book</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> in <span class="token operator">>></span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>Book<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">unsigned</span> no_<span class="token punctuation">;</span>std<span class="token operator">::</span>string name_<span class="token punctuation">;</span>std<span class="token operator">::</span>string author_<span class="token punctuation">;</span>std<span class="token operator">::</span>string pubdate_<span class="token punctuation">;</span><span class="token keyword">unsigned</span> number_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Book <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Book<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_15.h"</span></span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>in<span class="token punctuation">,</span> Book <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>in <span class="token operator">>></span> book<span class="token punctuation">.</span>no_ <span class="token operator">>></span> book<span class="token punctuation">.</span>name_ <span class="token operator">>></span> book<span class="token punctuation">.</span>author_ <span class="token operator">>></span> book<span class="token punctuation">.</span>pubdate_ <span class="token operator">>></span> book<span class="token punctuation">.</span>number_<span class="token punctuation">;</span><span class="token keyword">return</span> in<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>out<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>book<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>out <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>no_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>name_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>author_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>pubdate_ <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> book<span class="token punctuation">.</span>number_ <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> out<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>no_ <span class="token operator">==</span> rhs<span class="token punctuation">.</span>no_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>no_ <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span>no_<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> rhs <span class="token operator">&lt;</span> lhs<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Book<span class="token operator">&amp;</span> Book<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>rhs <span class="token operator">==</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-></span>number_ <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>number_<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Book <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Book <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Book <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Book book <span class="token operator">=</span> lhs<span class="token punctuation">;</span>book <span class="token operator">+=</span> rhs<span class="token punctuation">;</span><span class="token keyword">return</span> book<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_15.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Book <span class="token function">cp5_1</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span><span class="token punctuation">,</span> <span class="token string">"Lippmen"</span><span class="token punctuation">,</span> <span class="token string">"2012"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Book <span class="token function">cp5_2</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">,</span> <span class="token string">"CP5"</span><span class="token punctuation">,</span> <span class="token string">"Lippmen"</span><span class="token punctuation">,</span> <span class="token string">"2012"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> cp5_1 <span class="token operator">+</span> cp5_2 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-16"><a href="#ç»ƒä¹ 14-16" class="headerlink" title="ç»ƒä¹ 14.16"></a>ç»ƒä¹ 14.16</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlob</code> ç±»ã€<code>StrBlobPtr</code> ç±»ã€<code>StrVec</code> ç±»å’Œ <code>String</code> ç±»åˆ†åˆ«å®šä¹‰ç›¸ç­‰è¿ç®—ç¬¦å’Œä¸ç›¸ç­‰è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 14-17"><a href="#ç»ƒä¹ 14-17" class="headerlink" title="ç»ƒä¹ 14.17"></a>ç»ƒä¹ 14.17</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚ä¸­çš„ç»ƒä¹ 7.40ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä½ è®¤ä¸ºå®ƒåº”è¯¥å«æœ‰ç›¸ç­‰è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å®ç°å®ƒï¼›å¦‚æœä¸æ˜¯ï¼Œè§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.15ã€‚</p><h2 id="ç»ƒä¹ 14-18"><a href="#ç»ƒä¹ 14-18" class="headerlink" title="ç»ƒä¹ 14.18"></a>ç»ƒä¹ 14.18</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlob</code> ç±»ã€<code>StrBlobPtr</code> ç±»ã€<code>StrVec</code> ç±»å’Œ <code>String</code> ç±»åˆ†åˆ«å®šä¹‰å…³ç³»è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 14-19"><a href="#ç»ƒä¹ 14-19" class="headerlink" title="ç»ƒä¹ 14.19"></a>ç»ƒä¹ 14.19</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚çš„ç»ƒä¹ 7.40ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä½ è®¤ä¸ºå®ƒåº”è¯¥å«æœ‰å…³ç³»è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å®ç°å®ƒï¼›å¦‚æœä¸æ˜¯ï¼Œè§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.15ã€‚</p><h2 id="ç»ƒä¹ 14-20"><a href="#ç»ƒä¹ 14-20" class="headerlink" title="ç»ƒä¹ 14.20"></a>ç»ƒä¹ 14.20</h2><blockquote><p>ä¸ºä½ çš„ <code>Sales_data</code> ç±»å®šä¹‰åŠ æ³•å’Œå¤åˆèµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.2ã€‚</p><h2 id="ç»ƒä¹ 14-21"><a href="#ç»ƒä¹ 14-21" class="headerlink" title="ç»ƒä¹ 14.21"></a>ç»ƒä¹ 14.21</h2><blockquote><p>ç¼–å†™ <code>Sales_data</code> ç±»çš„<code>+</code> å’Œ<code>+=</code> è¿ç®—ç¬¦ï¼Œä½¿å¾— <code>+</code> æ‰§è¡Œå®é™…çš„åŠ æ³•æ“ä½œè€Œ <code>+=</code> è°ƒç”¨<code>+</code>ã€‚ç›¸æ¯”14.3èŠ‚å’Œ14.4èŠ‚å¯¹è¿™ä¸¤ä¸ªè¿ç®—ç¬¦çš„å®šä¹‰ï¼Œæœ¬é¢˜çš„å®šä¹‰æœ‰ä½•ç¼ºç‚¹ï¼Ÿè¯•è®¨è®ºä¹‹ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç¼ºç‚¹ï¼šä½¿ç”¨äº†ä¸€ä¸ª <code>Sales_data</code> çš„ä¸´æ—¶å¯¹è±¡ï¼Œä½†å®ƒå¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚</p><h2 id="ç»ƒä¹ 14-22"><a href="#ç»ƒä¹ 14-22" class="headerlink" title="ç»ƒä¹ 14.22"></a>ç»ƒä¹ 14.22</h2><blockquote><p>å®šä¹‰èµ‹å€¼è¿ç®—ç¬¦çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½æŠŠä¸€ä¸ªè¡¨ç¤º <code>ISBN</code> çš„ <code>string</code> èµ‹ç»™ä¸€ä¸ª <code>Sales_data</code> å¯¹è±¡ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Sales_data</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span><span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> units_sold <span class="token operator">?</span> revenue <span class="token operator">/</span> units_sold <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_22.h"</span></span><span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>is <span class="token operator">>></span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data<span class="token operator">&amp;</span> Sales_data<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>units_sold <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span>revenue <span class="token operator">+=</span> rhs<span class="token punctuation">.</span>revenue<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">double</span> price <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>is <span class="token operator">>></span> item<span class="token punctuation">.</span>bookNo <span class="token operator">>></span> item<span class="token punctuation">.</span>units_sold <span class="token operator">>></span> price<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span>item<span class="token punctuation">.</span>revenue <span class="token operator">=</span> price <span class="token operator">*</span> item<span class="token punctuation">.</span>units_sold<span class="token punctuation">;</span><span class="token keyword">else</span>item <span class="token operator">=</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>item<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>units_sold <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span>revenue <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> item<span class="token punctuation">.</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Sales_data sum <span class="token operator">=</span> lhs<span class="token punctuation">;</span>sum <span class="token operator">+=</span> rhs<span class="token punctuation">;</span><span class="token keyword">return</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Sales_data<span class="token operator">&amp;</span> Sales_data<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>isbn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>isbn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_4_22.h"</span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string <span class="token function">strCp5</span><span class="token punctuation">(</span><span class="token string">"cpp-primer 5th"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data cp5 <span class="token operator">=</span> strCp5<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> cp5 <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-23"><a href="#ç»ƒä¹ 14-23" class="headerlink" title="ç»ƒä¹ 14.23"></a>ç»ƒä¹ 14.23</h2><blockquote><p>ä¸ºä½ çš„<code>StrVec</code> ç±»å®šä¹‰ä¸€ä¸ª <code>initializer_list</code> èµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_MSC_VER</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NOEXCEPT</span> <span class="token expression"><span class="token keyword">noexcept</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NOEXCEPT</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span class="token keyword">class</span> <span class="token class-name">StrVec</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">>=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">elements</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first_free</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">StrVec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>StrVec<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">StrVec</span><span class="token punctuation">(</span>StrVec<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span> NOEXCEPT<span class="token punctuation">;</span>StrVec<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>StrVec<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span>NOEXCEPT<span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>StrVec<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> cap <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">at</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>elements <span class="token operator">+</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">at</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>elements <span class="token operator">+</span> pos<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token operator">></span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">alloc_n_move</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">range_initialize</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>string <span class="token operator">*</span>elements<span class="token punctuation">;</span>std<span class="token operator">::</span>string <span class="token operator">*</span>first_free<span class="token punctuation">;</span>std<span class="token operator">::</span>string <span class="token operator">*</span>cap<span class="token punctuation">;</span>std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> alloc<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">>=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_23.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token operator">></span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> data <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>e <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">&#123;</span> data<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">uninitialized_copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>elements<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">for_each</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> first_free<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> cap <span class="token operator">-</span> elements<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">range_initialize</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>first<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>last<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> newdata <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> newdata<span class="token punctuation">.</span>first<span class="token punctuation">;</span>first_free <span class="token operator">=</span> cap <span class="token operator">=</span> newdata<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">range_initialize</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">range_initialize</span><span class="token punctuation">(</span>il<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> il<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrVec<span class="token operator">&amp;</span> StrVec<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> data <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> data<span class="token punctuation">.</span>first<span class="token punctuation">;</span>first_free <span class="token operator">=</span> cap <span class="token operator">=</span> data<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">alloc_n_move</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> newdata <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> dest <span class="token operator">=</span> newdata<span class="token punctuation">;</span><span class="token keyword">auto</span> elem <span class="token operator">=</span> elements<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>dest<span class="token operator">++</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span>elem<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> newdata<span class="token punctuation">;</span>first_free <span class="token operator">=</span> dest<span class="token punctuation">;</span>cap <span class="token operator">=</span> elements <span class="token operator">+</span> new_cap<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> newcapacity <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token function">alloc_n_move</span><span class="token punctuation">(</span>newcapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>new_cap <span class="token operator">&lt;=</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token function">alloc_n_move</span><span class="token punctuation">(</span>new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">resize</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">reserve</span><span class="token punctuation">(</span>count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> count<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>first_free <span class="token operator">!=</span> elements <span class="token operator">+</span> count<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">--</span>first_free<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span>StrVec <span class="token operator">&amp;&amp;</span>s<span class="token punctuation">)</span> NOEXCEPT <span class="token operator">:</span> <span class="token function">elements</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first_free</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>first_free<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>cap<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// leave s in a state in which it is safe to run the destructor.</span>s<span class="token punctuation">.</span>elements <span class="token operator">=</span> s<span class="token punctuation">.</span>first_free <span class="token operator">=</span> s<span class="token punctuation">.</span>cap <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrVec<span class="token operator">&amp;</span> StrVec<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span>StrVec <span class="token operator">&amp;&amp;</span>rhs<span class="token punctuation">)</span> NOEXCEPT<span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>elements <span class="token operator">=</span> rhs<span class="token punctuation">.</span>elements<span class="token punctuation">;</span>first_free <span class="token operator">=</span> rhs<span class="token punctuation">.</span>first_free<span class="token punctuation">;</span>cap <span class="token operator">=</span> rhs<span class="token punctuation">.</span>cap<span class="token punctuation">;</span>rhs<span class="token punctuation">.</span>elements <span class="token operator">=</span> rhs<span class="token punctuation">.</span>first_free <span class="token operator">=</span> rhs<span class="token punctuation">.</span>cap <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> rhs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> std<span class="token operator">::</span><span class="token function">equal</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> std<span class="token operator">::</span><span class="token function">lexicographical_compare</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> rhs <span class="token operator">&lt;</span> lhs<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>rhs <span class="token operator">&lt;</span> lhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">>=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">&lt;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrVec<span class="token operator">&amp;</span> StrVec<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">StrVec</span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_23.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>StrVec vec<span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"capacity(reserve to 6): "</span> <span class="token operator">&lt;&lt;</span> vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"capacity(reserve to 4): "</span> <span class="token operator">&lt;&lt;</span> vec<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"-EOF-"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>vec<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>i <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"-EOF-"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>StrVec vec_list<span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"pezy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> vec_list<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> vec_list<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token comment">// Test operator==</span><span class="token keyword">const</span> StrVec const_vec_list <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">,</span> <span class="token string">"pezy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>vec_list <span class="token operator">==</span> const_vec_list<span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>str <span class="token operator">:</span> const_vec_list<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token comment">// Test operator&lt;</span><span class="token keyword">const</span> StrVec const_vec_list_small <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"pezy"</span><span class="token punctuation">,</span> <span class="token string">"ok"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>const_vec_list_small <span class="token operator">&lt;</span> const_vec_list<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-24"><a href="#ç»ƒä¹ 14-24" class="headerlink" title="ç»ƒä¹ 14.24"></a>ç»ƒä¹ 14.24</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚çš„ç»ƒä¹ 7.40ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä½ è®¤ä¸ºå®ƒåº”è¯¥å«æœ‰æ‹·è´èµ‹å€¼å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å®ç°å®ƒä»¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">DATE_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DATE_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_MSC_VER</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NOEXCEPT</span> <span class="token expression"><span class="token keyword">noexcept</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NOEXCEPT</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span>  <span class="token keyword">bool</span>            <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span>  <span class="token keyword">bool</span>            <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span>  <span class="token keyword">bool</span>            <span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span>  std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span>   <span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">typedef</span> std<span class="token operator">::</span>size_t Size<span class="token punctuation">;</span><span class="token comment">// default constructor</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token comment">// constructor taking Size as days</span><span class="token keyword">explicit</span> <span class="token function">Date</span><span class="token punctuation">(</span>Size days<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// constructor taking three Size</span><span class="token function">Date</span><span class="token punctuation">(</span>Size d<span class="token punctuation">,</span> Size m<span class="token punctuation">,</span> Size y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">day</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">month</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">year</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">// constructor taking iostream</span><span class="token function">Date</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// copy constructor</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// move constructor</span><span class="token function">Date</span><span class="token punctuation">(</span>Date<span class="token operator">&amp;&amp;</span> d<span class="token punctuation">)</span> NOEXCEPT<span class="token punctuation">;</span><span class="token comment">// copy operator=</span>Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// move operator=</span>Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span> <span class="token punctuation">(</span>Date<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> NOEXCEPT<span class="token punctuation">;</span><span class="token comment">// destructor  --  in this case, user-defined destructor is not nessary.</span><span class="token operator">~</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"destroying\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// members</span>Size <span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>  <span class="token comment">//not implemented yet.</span>Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">+=</span><span class="token punctuation">(</span>Size offset<span class="token punctuation">)</span><span class="token punctuation">;</span>Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">-=</span><span class="token punctuation">(</span>Size offset<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>Size    day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>Size    month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>Size    year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">const</span> Date<span class="token operator">::</span>Size YtoD_400 <span class="token operator">=</span> <span class="token number">146097</span><span class="token punctuation">;</span>    <span class="token comment">//365*400 + 400/4 -3 == 146097</span><span class="token keyword">static</span> <span class="token keyword">const</span> Date<span class="token operator">::</span>Size YtoD_100 <span class="token operator">=</span> <span class="token number">36524</span><span class="token punctuation">;</span>    <span class="token comment">//365*100 + 100/4 -1 ==  36524</span><span class="token keyword">static</span> <span class="token keyword">const</span> Date<span class="token operator">::</span>Size YtoD_4 <span class="token operator">=</span> <span class="token number">1461</span><span class="token punctuation">;</span>    <span class="token comment">//365*4 + 1          ==   1461</span><span class="token keyword">static</span> <span class="token keyword">const</span> Date<span class="token operator">::</span>Size YtoD_1 <span class="token operator">=</span> <span class="token number">365</span><span class="token punctuation">;</span>    <span class="token comment">//365</span><span class="token comment">// normal year</span><span class="token keyword">static</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Date<span class="token operator">::</span>Size<span class="token operator">></span> monthsVec_n <span class="token operator">=</span><span class="token punctuation">&#123;</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// leap year</span><span class="token keyword">static</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Date<span class="token operator">::</span>Size<span class="token operator">></span> monthsVec_l <span class="token operator">=</span><span class="token punctuation">&#123;</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// non-member operators:  &lt;&lt;  >>  -   ==  !=  &lt;   &lt;=  >   >=</span><span class="token comment">//</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token keyword">operator</span> <span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span> <span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span> <span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span>  <span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">bool</span><span class="token keyword">operator</span> <span class="token operator">>=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>Date<span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> Date<span class="token operator">::</span>Size  rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>Date<span class="token keyword">operator</span>  <span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> Date<span class="token operator">::</span>Size  rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  utillities:</span><span class="token keyword">bool</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">bool</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>Date<span class="token operator">::</span>Size y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// check if the date object passed in is valid</span><span class="token keyword">inline</span> <span class="token keyword">bool</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">></span><span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//    month == 1 3 5 7 8 10 12</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">5</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">7</span> <span class="token operator">||</span>d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">8</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">10</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>day <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>day <span class="token operator">></span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//    month == 4 6 9 11</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">6</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">9</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>month <span class="token operator">==</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>day <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>day <span class="token operator">></span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//    month == 2</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>day <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>day <span class="token operator">></span><span class="token number">29</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">.</span>day <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> d<span class="token punctuation">.</span>day <span class="token operator">></span><span class="token number">28</span><span class="token punctuation">)</span>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> <span class="token keyword">bool</span><span class="token function">isLeapYear</span><span class="token punctuation">(</span>Date<span class="token operator">::</span>Size y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>y <span class="token operator">%</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>y <span class="token operator">%</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>y <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// DATE_H</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_24.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token comment">// constructor taking Size as days</span><span class="token comment">// the argument must be within (0, 2^32)</span><span class="token class-name">Date</span><span class="token operator">::</span><span class="token function">Date</span><span class="token punctuation">(</span>Size days<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// calculate the year</span>Size y400 <span class="token operator">=</span> days <span class="token operator">/</span> YtoD_400<span class="token punctuation">;</span>Size y100 <span class="token operator">=</span> <span class="token punctuation">(</span>days <span class="token operator">-</span> y400<span class="token operator">*</span>YtoD_400<span class="token punctuation">)</span> <span class="token operator">/</span> YtoD_100<span class="token punctuation">;</span>Size y4 <span class="token operator">=</span> <span class="token punctuation">(</span>days <span class="token operator">-</span> y400<span class="token operator">*</span>YtoD_400 <span class="token operator">-</span> y100<span class="token operator">*</span>YtoD_100<span class="token punctuation">)</span> <span class="token operator">/</span> YtoD_4<span class="token punctuation">;</span>Size y <span class="token operator">=</span> <span class="token punctuation">(</span>days <span class="token operator">-</span> y400<span class="token operator">*</span>YtoD_400 <span class="token operator">-</span> y100<span class="token operator">*</span>YtoD_100 <span class="token operator">-</span> y4<span class="token operator">*</span>YtoD_4<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">365</span><span class="token punctuation">;</span>Size d <span class="token operator">=</span> days <span class="token operator">-</span> y400<span class="token operator">*</span>YtoD_400 <span class="token operator">-</span> y100<span class="token operator">*</span>YtoD_100 <span class="token operator">-</span> y4<span class="token operator">*</span>YtoD_4 <span class="token operator">-</span> y <span class="token operator">*</span> <span class="token number">365</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">=</span> y400 <span class="token operator">*</span> <span class="token number">400</span> <span class="token operator">+</span> y100 <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> y4 <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> y<span class="token punctuation">;</span><span class="token comment">// check if leap and choose the months vector accordingly</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Size<span class="token operator">></span>currYear<span class="token operator">=</span> <span class="token function">isLeapYear</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year<span class="token punctuation">)</span> <span class="token operator">?</span> monthsVec_l <span class="token operator">:</span> monthsVec_n<span class="token punctuation">;</span><span class="token comment">// calculate day and month using find_if + lambda</span>Size D_accumu <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> M_accumu <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// @bug    fixed:  the variabbles above hade been declared inside the find_if as static</span><span class="token comment">//                 which caused the bug. It works fine now after being move outside.</span>std<span class="token operator">::</span><span class="token function">find_if</span><span class="token punctuation">(</span>currYear<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currYear<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>Size m<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>D_accumu <span class="token operator">+=</span> m<span class="token punctuation">;</span>M_accumu<span class="token operator">++</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>d <span class="token operator">&lt;</span> D_accumu<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token operator">-></span>month <span class="token operator">=</span> M_accumu<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>day <span class="token operator">=</span> d <span class="token operator">+</span> m <span class="token operator">-</span> D_accumu<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// construcotr taking iostream</span><span class="token class-name">Date</span><span class="token operator">::</span><span class="token function">Date</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>is <span class="token operator">>></span> day <span class="token operator">>></span> month <span class="token operator">>></span> year<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"Invalid input! Object is default initialized."</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"Invalid input! Object is default initialized."</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// copy constructor</span><span class="token class-name">Date</span><span class="token operator">::</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>d<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">day</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>day<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">month</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">year</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">// move constructor</span><span class="token class-name">Date</span><span class="token operator">::</span><span class="token function">Date</span><span class="token punctuation">(</span>Date<span class="token operator">&amp;&amp;</span> d<span class="token punctuation">)</span> NOEXCEPT <span class="token operator">:</span><span class="token function">day</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>day<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">month</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>month<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">year</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"copy moving"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// copy operator=</span>Date <span class="token operator">&amp;</span>Date<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token operator">-></span>day <span class="token operator">=</span> d<span class="token punctuation">.</span>day<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>month <span class="token operator">=</span> d<span class="token punctuation">.</span>month<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">=</span> d<span class="token punctuation">.</span>year<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move operator=</span>Date <span class="token operator">&amp;</span>Date<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>Date<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> NOEXCEPT<span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token operator">-></span>day <span class="token operator">=</span> rhs<span class="token punctuation">.</span>day<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>month <span class="token operator">=</span> rhs<span class="token punctuation">.</span>month<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">=</span> rhs<span class="token punctuation">.</span>year<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"moving ="</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// conver to days</span>Date<span class="token operator">::</span>Size <span class="token class-name">Date</span><span class="token operator">::</span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>Size result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-></span>day<span class="token punctuation">;</span><span class="token comment">// check if leap and choose the months vector accordingly</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>Size<span class="token operator">></span>currYear<span class="token operator">=</span> <span class="token function">isLeapYear</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year<span class="token punctuation">)</span> <span class="token operator">?</span> monthsVec_l <span class="token operator">:</span> monthsVec_n<span class="token punctuation">;</span><span class="token comment">// calculate result + days by months</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> currYear<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> currYear<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token operator">-></span>month <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>result <span class="token operator">+=</span> <span class="token operator">*</span>it<span class="token punctuation">;</span><span class="token comment">// calculate result + days by years</span>result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">/</span> <span class="token number">400</span><span class="token punctuation">)</span>      <span class="token operator">*</span> YtoD_400<span class="token punctuation">;</span>result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">)</span>  <span class="token operator">*</span> YtoD_100<span class="token punctuation">;</span>result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span>    <span class="token operator">*</span> YtoD_4<span class="token punctuation">;</span>result <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>year <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token operator">*</span> YtoD_1<span class="token punctuation">;</span><span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// member operators:   +=  -=</span>Date <span class="token operator">&amp;</span>Date<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">+=</span><span class="token punctuation">(</span>Date<span class="token operator">::</span>Size offset<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Date <span class="token operator">&amp;</span>Date<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">-=</span><span class="token punctuation">(</span>Date<span class="token operator">::</span>Size offset<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> offset<span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token operator">*</span><span class="token keyword">this</span> <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// non-member operators:  &lt;&lt;  >>  -   ==  !=  &lt;   &lt;=  >   >=</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token keyword">operator</span> <span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>day <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>month <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>year<span class="token punctuation">;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token keyword">operator</span> <span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Date input <span class="token operator">=</span> <span class="token function">Date</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> std<span class="token operator">::</span>cout<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> input<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token keyword">operator</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> rhs<span class="token punctuation">.</span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>day <span class="token operator">==</span> rhs<span class="token punctuation">.</span>day<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>month <span class="token operator">==</span> rhs<span class="token punctuation">.</span>month<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>year <span class="token operator">==</span> rhs<span class="token punctuation">.</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span><span class="token function">toDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>lhs <span class="token operator">&lt;</span> rhs<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">&lt;=</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">>=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> Date <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">&lt;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Date <span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> Date<span class="token operator">::</span>Size rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                       <span class="token comment">//  ^^^ rhs must not be larger than 2^32-1</span><span class="token comment">// copy lhs</span>Date <span class="token function">result</span><span class="token punctuation">(</span>lhs<span class="token punctuation">)</span><span class="token punctuation">;</span>result <span class="token operator">-=</span> rhs<span class="token punctuation">;</span><span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Date <span class="token keyword">operator</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Date <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> Date<span class="token operator">::</span>Size rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                       <span class="token comment">//  ^^^ rhs must not be larger than 2^32-1</span><span class="token comment">// copy lhs</span>Date <span class="token function">result</span><span class="token punctuation">(</span>lhs<span class="token punctuation">)</span><span class="token punctuation">;</span>result <span class="token operator">+=</span> rhs<span class="token punctuation">;</span><span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_24.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Date <span class="token function">lhs</span><span class="token punctuation">(</span><span class="token number">9999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rhs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>lhs <span class="token operator">-=</span> <span class="token number">12000</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-25"><a href="#ç»ƒä¹ 14-25" class="headerlink" title="ç»ƒä¹ 14.25"></a>ç»ƒä¹ 14.25</h2><blockquote><p>ä¸Šé¢˜çš„è¿™ä¸ªç±»è¿˜éœ€è¦å®šä¹‰å…¶ä»–èµ‹å€¼è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å®ç°å®ƒä»¬ï¼›åŒæ—¶è¯´æ˜è¿ç®—å¯¹è±¡åº”è¯¥æ˜¯ä»€ä¹ˆç±»å‹å¹¶è§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ˜¯ã€‚å¦‚ä¸Šé¢˜ã€‚</p><h2 id="ç»ƒä¹ 14-26"><a href="#ç»ƒä¹ 14-26" class="headerlink" title="ç»ƒä¹ 14.26"></a>ç»ƒä¹ 14.26</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlob</code> ç±»ã€<code>StrBlobPtr</code> ç±»ã€<code>StrVec</code> ç±»å’Œ <code>String</code> ç±»å®šä¹‰ä¸‹æ ‡è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 14-27"><a href="#ç»ƒä¹ 14-27" class="headerlink" title="ç»ƒä¹ 14.27"></a>ç»ƒä¹ 14.27</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlobPtr</code> ç±»æ·»åŠ é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>åªæ˜¾ç¤ºæ·»åŠ çš„ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">StrBlobPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string<span class="token operator">&amp;</span> <span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    StrBlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span>size_t<span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span>size_t<span class="token punctuation">)</span><span class="token punctuation">;</span>    StrBlobPtr <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>size_t<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    StrBlobPtr <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span>size_t<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">inline</span> StrBlobPtr<span class="token operator">&amp;</span> StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">++</span>curr<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr<span class="token operator">&amp;</span> StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token operator">--</span>curr<span class="token punctuation">,</span> <span class="token string">"decrement past begin of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    StrBlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token operator">++</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    StrBlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token operator">--</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr<span class="token operator">&amp;</span> StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    curr <span class="token operator">+=</span> n<span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr<span class="token operator">&amp;</span> StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">-=</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    curr <span class="token operator">-=</span> n<span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    StrBlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    ret <span class="token operator">+=</span> n<span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> StrBlobPtr StrBlobPtr<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    StrBlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    ret <span class="token operator">-=</span> n<span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-28"><a href="#ç»ƒä¹ 14-28" class="headerlink" title="ç»ƒä¹ 14.28"></a>ç»ƒä¹ 14.28</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlobPtr</code> ç±»æ·»åŠ åŠ æ³•å’Œå‡æ³•è¿ç®—ç¬¦ï¼Œä½¿å…¶å¯ä»¥å®ç°æŒ‡é’ˆçš„ç®—æœ¯è¿ç®—ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.27ã€‚</p><h2 id="ç»ƒä¹ 14-29"><a href="#ç»ƒä¹ 14-29" class="headerlink" title="ç»ƒä¹ 14.29"></a>ç»ƒä¹ 14.29</h2><blockquote><p>ä¸ºä»€ä¹ˆä¸å®šä¹‰<code>const</code> ç‰ˆæœ¬çš„é€’å¢å’Œé€’å‡è¿ç®—ç¬¦ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºé€’å¢å’Œé€’å‡ä¼šæ”¹å˜å¯¹è±¡æœ¬èº«ï¼Œæ‰€ä»¥å®šä¹‰ <code>const</code> ç‰ˆæœ¬çš„æ¯«æ— æ„ä¹‰ã€‚</p><h2 id="ç»ƒä¹ 14-30"><a href="#ç»ƒä¹ 14-30" class="headerlink" title="ç»ƒä¹ 14.30"></a>ç»ƒä¹ 14.30</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlobPtr</code> ç±»å’Œåœ¨12.1.6èŠ‚ç»ƒä¹ 12.22ä¸­å®šä¹‰çš„ <code>ConstStrBlobPtr</code> çš„ç±»åˆ†åˆ«æ·»åŠ è§£å¼•ç”¨è¿ç®—ç¬¦å’Œç®­å¤´è¿ç®—ç¬¦ã€‚æ³¨æ„ï¼šå› ä¸º <code>ConstStrBlobPtr</code> çš„æ•°æ®æˆå‘˜æŒ‡å‘<code>const vector</code>ï¼Œæ‰€ä»¥<code>ConstStrBlobPtr</code> ä¸­çš„è¿ç®—ç¬¦å¿…é¡»è¿”å›å¸¸é‡å¼•ç”¨ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥ã€‚</p><h2 id="ç»ƒä¹ 14-31"><a href="#ç»ƒä¹ 14-31" class="headerlink" title="ç»ƒä¹ 14.31"></a>ç»ƒä¹ 14.31</h2><blockquote><p>æˆ‘ä»¬çš„ <code>StrBlobPtr</code> ç±»æ²¡æœ‰å®šä¹‰æ‹·è´æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦ä»¥åŠææ„å‡½æ•°ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºä½¿ç”¨åˆæˆçš„è¶³å¤Ÿäº†ã€‚</p><h2 id="ç»ƒä¹ 14-32"><a href="#ç»ƒä¹ 14-32" class="headerlink" title="ç»ƒä¹ 14.32"></a>ç»ƒä¹ 14.32</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªç±»ä»¤å…¶å«æœ‰æŒ‡å‘ <code>StrBlobPtr</code> å¯¹è±¡çš„æŒ‡é’ˆï¼Œä¸ºè¿™ä¸ªç±»å®šä¹‰é‡è½½çš„ç®­å¤´è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">StrBlobPtr</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlobPtr_pointer</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">StrBlobPtr_pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">StrBlobPtr_pointer</span><span class="token punctuation">(</span>StrBlobPtr<span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">pointer</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    StrBlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    StrBlobPtr<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    StrBlobPtr<span class="token operator">*</span> pointer <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_32.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_14_30_StrBlob.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>StrBlobPtr<span class="token operator">&amp;</span>StrBlobPtr_pointer<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">*</span>pointer<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrBlobPtr<span class="token operator">*</span>StrBlobPtr_pointer<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">-></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> pointer<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-33"><a href="#ç»ƒä¹ 14-33" class="headerlink" title="ç»ƒä¹ 14.33"></a>ç»ƒä¹ 14.33</h2><blockquote><p>ä¸€ä¸ªé‡è½½çš„å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦åº”è¯¥æ¥å—å‡ ä¸ªè¿ç®—å¯¹è±¡ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸€ä¸ªé‡è½½çš„å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦æ¥å—çš„è¿ç®—å¯¹è±¡åº”è¯¥å’Œè¯¥è¿ç®—ç¬¦æ‹¥æœ‰çš„æ“ä½œæ•°ä¸€æ ·å¤šã€‚</p><h2 id="ç»ƒä¹ 14-34"><a href="#ç»ƒä¹ 14-34" class="headerlink" title="ç»ƒä¹ 14.34"></a>ç»ƒä¹ 14.34</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°å¯¹è±¡ç±»ï¼Œä»¤å…¶æ‰§è¡Œ<code>if-then-else</code> çš„æ“ä½œï¼šè¯¥ç±»çš„è°ƒç”¨è¿ç®—ç¬¦æ¥å—ä¸‰ä¸ªå½¢å‚ï¼Œå®ƒé¦–å…ˆæ£€æŸ¥ç¬¬ä¸€ä¸ªå½¢å‚ï¼Œå¦‚æœæˆåŠŸè¿”å›ç¬¬äºŒä¸ªå½¢å‚å€¼ï¼›å¦‚æœä¸æˆåŠŸè¿”å›ç¬¬ä¸‰ä¸ªå½¢å‚çš„å€¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">bool</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> iA<span class="token punctuation">,</span> <span class="token keyword">int</span> iB<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> b <span class="token operator">?</span> iA <span class="token operator">:</span> iB<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-35"><a href="#ç»ƒä¹ 14-35" class="headerlink" title="ç»ƒä¹ 14.35"></a>ç»ƒä¹ 14.35</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç±»ä¼¼äº <code>PrintString</code> çš„ç±»ï¼Œä»¤å…¶ä» <code>istream</code> ä¸­è¯»å–ä¸€è¡Œè¾“å…¥ï¼Œç„¶åè¿”å›ä¸€ä¸ªè¡¨ç¤ºæˆ‘ä»¬æ‰€è¯»å†…å®¹çš„<code>string</code>ã€‚å¦‚æœè¯»å–å¤±è´¥ï¼Œè¿”å›ç©º<code>string</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">GetInput</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">GetInput</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>i <span class="token operator">=</span> std<span class="token operator">::</span>cin<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">is</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string str<span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">getline</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> is <span class="token operator">?</span> str <span class="token operator">:</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>GetInput getInput<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">getInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-36"><a href="#ç»ƒä¹ 14-36" class="headerlink" title="ç»ƒä¹ 14.36"></a>ç»ƒä¹ 14.36</h2><blockquote><p>ä½¿ç”¨å‰ä¸€ä¸ªç»ƒä¹ å®šä¹‰çš„ç±»è¯»å–æ ‡å‡†è¾“å…¥ï¼Œå°†æ¯ä¸€è¡Œä¿å­˜ä¸º <code>vector</code> çš„ä¸€ä¸ªå…ƒç´ ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">class</span> <span class="token class-name">GetInput</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">GetInput</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>i <span class="token operator">=</span> std<span class="token operator">::</span>cin<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">is</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>string str<span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">getline</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> is <span class="token operator">?</span> str <span class="token operator">:</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>GetInput getInput<span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> vec<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>string tmp<span class="token punctuation">;</span> <span class="token operator">!</span><span class="token punctuation">(</span>tmp <span class="token operator">=</span> <span class="token function">getInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>str <span class="token operator">:</span> vec<span class="token punctuation">)</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-37"><a href="#ç»ƒä¹ 14-37" class="headerlink" title="ç»ƒä¹ 14.37"></a>ç»ƒä¹ 14.37</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç±»ä»¤å…¶æ£€æŸ¥ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ã€‚ä½¿ç”¨è¯¥å¯¹è±¡åŠæ ‡å‡†åº“ç®—æ³•ç¼–å†™ç¨‹åºï¼Œä»¤å…¶æ›¿æ¢æŸä¸ªåºåˆ—ä¸­å…·æœ‰ç»™å®šå€¼çš„æ‰€æœ‰å®ä¾‹ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">class</span> <span class="token class-name">IsEqual</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> value<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">IsEqual</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">value</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> elem<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> elem <span class="token operator">==</span> value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> vec <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">replace_if</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">IsEqual</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> vec<span class="token punctuation">)</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-38"><a href="#ç»ƒä¹ 14-38" class="headerlink" title="ç»ƒä¹ 14.38"></a>ç»ƒä¹ 14.38</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç±»ä»¤å…¶æ£€æŸ¥æŸä¸ªç»™å®šçš„ <code>string</code> å¯¹è±¡çš„é•¿åº¦æ˜¯å¦ä¸ä¸€ä¸ªé˜ˆå€¼ç›¸ç­‰ã€‚ä½¿ç”¨è¯¥å¯¹è±¡ç¼–å†™ç¨‹åºï¼Œç»Ÿè®¡å¹¶æŠ¥å‘Šåœ¨è¾“å…¥çš„æ–‡ä»¶ä¸­é•¿åº¦ä¸º1çš„å•è¯æœ‰å¤šå°‘ä¸ªï¼Œé•¿åº¦ä¸º2çš„å•è¯æœ‰å¤šå°‘ä¸ªã€â€¦â€¦ã€é•¿åº¦ä¸º10çš„å•è¯æœ‰å¤šå°‘ä¸ªã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token keyword">struct</span> <span class="token class-name">IsInRange</span><span class="token punctuation">&#123;</span><span class="token function">IsInRange</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t lower<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t upper<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">_lower</span><span class="token punctuation">(</span>lower<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_upper</span><span class="token punctuation">(</span>upper<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> str<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> _lower <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> _upper<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>size_t <span class="token function">lower_limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> _lower<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>std<span class="token operator">::</span>size_t <span class="token function">upper_limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> _upper<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>size_t _lower<span class="token punctuation">;</span>std<span class="token operator">::</span>size_t _upper<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//create predicates with various upper limits.</span>std<span class="token operator">::</span>size_t lower <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">auto</span> uppers <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">3u</span><span class="token punctuation">,</span> <span class="token number">4u</span><span class="token punctuation">,</span> <span class="token number">5u</span><span class="token punctuation">,</span> <span class="token number">6u</span><span class="token punctuation">,</span> <span class="token number">7u</span><span class="token punctuation">,</span> <span class="token number">8u</span><span class="token punctuation">,</span> <span class="token number">9u</span><span class="token punctuation">,</span> <span class="token number">10u</span><span class="token punctuation">,</span> <span class="token number">11u</span><span class="token punctuation">,</span> <span class="token number">12u</span><span class="token punctuation">,</span> <span class="token number">13u</span><span class="token punctuation">,</span> <span class="token number">14u</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>IsInRange<span class="token operator">></span> predicates<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> upper <span class="token operator">:</span> uppers<span class="token punctuation">)</span>predicates<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>IsInRange<span class="token punctuation">&#123;</span> lower<span class="token punctuation">,</span> upper <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//create count_table to store counts </span>std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>size_t<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t<span class="token operator">></span> count_table<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> upper <span class="token operator">:</span> uppers<span class="token punctuation">)</span>count_table<span class="token punctuation">[</span>upper<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//read file and count</span>std<span class="token operator">::</span>ifstream <span class="token function">fin</span><span class="token punctuation">(</span><span class="token string">"storyDataFile.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>string word<span class="token punctuation">;</span> fin <span class="token operator">>></span> word<span class="token punctuation">;</span> <span class="token comment">/* */</span><span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> is_size_in_range <span class="token operator">:</span> predicates<span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_size_in_range</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">++</span>count_table<span class="token punctuation">[</span>is_size_in_range<span class="token punctuation">.</span><span class="token function">upper_limit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//print</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> pair <span class="token operator">:</span> count_table<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"count in range [1, "</span> <span class="token operator">&lt;&lt;</span> pair<span class="token punctuation">.</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">"] : "</span> <span class="token operator">&lt;&lt;</span> pair<span class="token punctuation">.</span>second <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-39"><a href="#ç»ƒä¹ 14-39" class="headerlink" title="ç»ƒä¹ 14.39"></a>ç»ƒä¹ 14.39</h2><blockquote><p>ä¿®æ”¹ä¸Šä¸€é¢˜çš„ç¨‹åºä»¤å…¶æŠ¥å‘Šé•¿åº¦åœ¨1åˆ°9ä¹‹é—´çš„å•è¯æœ‰å¤šå°‘ä¸ªã€é•¿åº¦åœ¨10ä»¥ä¸Šçš„å•è¯æœ‰å¤šå°‘ä¸ªã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ14.38ã€‚</p><h2 id="ç»ƒä¹ 14-40"><a href="#ç»ƒä¹ 14-40" class="headerlink" title="ç»ƒä¹ 14.40"></a>ç»ƒä¹ 14.40</h2><blockquote><p>é‡æ–°ç¼–å†™10.3.2èŠ‚çš„<code>biggies</code> å‡½æ•°ï¼Œä½¿ç”¨å‡½æ•°å¯¹è±¡æ›¿æ¢å…¶ä¸­çš„ <code>lambda</code> è¡¨è¾¾å¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ShorterString</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> s1<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> s2<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> s1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> s2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">BiggerEqual</span><span class="token punctuation">&#123;</span>size_t sz_<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">BiggerEqual</span><span class="token punctuation">(</span>size_t sz<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">sz_</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> sz_<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Print</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>string <span class="token function">make_plural</span><span class="token punctuation">(</span>size_t ctr<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> word<span class="token punctuation">,</span> string <span class="token keyword">const</span><span class="token operator">&amp;</span> ending<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">(</span>ctr <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> word <span class="token operator">+</span> ending <span class="token operator">:</span> word<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">elimDups</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>words<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">sort</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> end_unique <span class="token operator">=</span> <span class="token function">unique</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>words<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>end_unique<span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">biggies</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>words<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>size_type sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">elimDups</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">stable_sort</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ShorterString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> wc <span class="token operator">=</span> <span class="token function">find_if</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">BiggerEqual</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> count <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> wc<span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> count <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">make_plural</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token string">"word"</span><span class="token punctuation">,</span> <span class="token string">"s"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" of length "</span> <span class="token operator">&lt;&lt;</span> sz <span class="token operator">&lt;&lt;</span> <span class="token string">" or longer"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token function">for_each</span><span class="token punctuation">(</span>wc<span class="token punctuation">,</span> words<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span> vec<span class="token punctuation">&#123;</span> <span class="token string">"fox"</span><span class="token punctuation">,</span> <span class="token string">"jumps"</span><span class="token punctuation">,</span> <span class="token string">"over"</span><span class="token punctuation">,</span> <span class="token string">"quick"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"slow"</span><span class="token punctuation">,</span> <span class="token string">"the"</span><span class="token punctuation">,</span> <span class="token string">"turtle"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">biggies</span><span class="token punctuation">(</span>vec<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-41"><a href="#ç»ƒä¹ 14-41" class="headerlink" title="ç»ƒä¹ 14.41"></a>ç»ƒä¹ 14.41</h2><blockquote><p>ä½ è®¤ä¸º C++ 11 æ ‡å‡†ä¸ºä»€ä¹ˆè¦å¢åŠ  <code>lambda</code>ï¼Ÿå¯¹äºä½ è‡ªå·±æ¥è¯´ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šä½¿ç”¨ <code>lambda</code>ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šä½¿ç”¨ç±»ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä½¿ç”¨ <code>lambda</code> æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œå½“éœ€è¦ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°ä¸å¸¸ä½¿ç”¨å¹¶ä¸”ç®€å•æ—¶ï¼Œä½¿ç”¨<code>lambda</code> æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„é€‰æ‹©ã€‚</p><h2 id="ç»ƒä¹ 14-42"><a href="#ç»ƒä¹ 14-42" class="headerlink" title="ç»ƒä¹ 14.42"></a>ç»ƒä¹ 14.42</h2><blockquote><p>ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°å¯¹è±¡åŠé€‚é…å™¨å®šä¹‰ä¸€æ¡è¡¨è¾¾å¼ï¼Œä»¤å…¶</p></blockquote><pre class="line-numbers language-none"><code class="language-none">(a) ç»Ÿè®¡å¤§äº1024çš„å€¼æœ‰å¤šå°‘ä¸ªã€‚ (b) æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸ç­‰äºpoohçš„å­—ç¬¦ä¸²ã€‚(c) å°†æ‰€æœ‰çš„å€¼ä¹˜ä»¥2ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span><span class="token function">count_if</span><span class="token punctuation">(</span>ivec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ivec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span>std<span class="token operator">::</span>greater<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _1<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">find_if</span><span class="token punctuation">(</span>svec<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> svec<span class="token punctuation">.</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span>std<span class="token operator">::</span>not_equal_to<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _1<span class="token punctuation">,</span> <span class="token string">"pooh"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span><span class="token function">transform</span><span class="token punctuation">(</span>ivec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ivec<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ivec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span>std<span class="token operator">::</span>multiplies<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-43"><a href="#ç»ƒä¹ 14-43" class="headerlink" title="ç»ƒä¹ 14.43"></a>ç»ƒä¹ 14.43</h2><blockquote><p>ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°å¯¹è±¡åˆ¤æ–­ä¸€ä¸ªç»™å®šçš„<code>int</code>å€¼æ˜¯å¦èƒ½è¢« <code>int</code> å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ æ•´é™¤ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> input<span class="token punctuation">;</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> input<span class="token punctuation">;</span>std<span class="token operator">::</span>modulus<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> mod<span class="token punctuation">;</span><span class="token keyword">auto</span> predicator <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token function">mod</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">auto</span> is_divisible <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">any_of</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> predicator<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>is_divisible <span class="token operator">?</span> <span class="token string">"Yes!"</span> <span class="token operator">:</span> <span class="token string">"No!"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-44"><a href="#ç»ƒä¹ 14-44" class="headerlink" title="ç»ƒä¹ 14.44"></a>ç»ƒä¹ 14.44</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„æ¡Œé¢è®¡ç®—å™¨ä½¿å…¶èƒ½å¤„ç†äºŒå…ƒè¿ç®—ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span> </span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span> </span><span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">auto</span> mod <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">%</span> j<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">Div</span> <span class="token punctuation">&#123;</span> <span class="token keyword">int</span> <span class="token keyword">operator</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i <span class="token operator">/</span> j<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">auto</span> binops <span class="token operator">=</span> std<span class="token operator">::</span>map<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token punctuation">,</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token string">"+"</span><span class="token punctuation">,</span> add <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                               <span class="token comment">// function pointer </span><span class="token punctuation">&#123;</span> <span class="token string">"-"</span><span class="token punctuation">,</span> std<span class="token operator">::</span>minus<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                 <span class="token comment">// library functor </span><span class="token punctuation">&#123;</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token function">Div</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                             <span class="token comment">// user-defined functor </span><span class="token punctuation">&#123;</span> <span class="token string">"*"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> i<span class="token operator">*</span>j<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment">// unnamed lambda </span><span class="token punctuation">&#123;</span> <span class="token string">"%"</span><span class="token punctuation">,</span> mod <span class="token punctuation">&#125;</span>                                <span class="token comment">// named lambda object </span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Pls enter as: num operator num :\n"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> lhs<span class="token punctuation">,</span> rhs<span class="token punctuation">;</span> std<span class="token operator">::</span>string op<span class="token punctuation">;</span>std<span class="token operator">::</span>cin <span class="token operator">>></span> lhs <span class="token operator">>></span> op <span class="token operator">>></span> rhs<span class="token punctuation">;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> binops<span class="token punctuation">[</span>op<span class="token punctuation">]</span><span class="token punctuation">(</span>lhs<span class="token punctuation">,</span> rhs<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-45"><a href="#ç»ƒä¹ 14-45" class="headerlink" title="ç»ƒä¹ 14.45"></a>ç»ƒä¹ 14.45</h2><blockquote><p>ç¼–å†™ç±»å‹è½¬æ¢è¿ç®—ç¬¦å°†ä¸€ä¸ª <code>Sales_data</code> å¯¹è±¡åˆ†åˆ«è½¬æ¢æˆ <code>string</code> å’Œ <code>double</code>ï¼Œä½ è®¤ä¸ºè¿™äº›è¿ç®—ç¬¦çš„è¿”å›å€¼åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">Sales_data</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> n<span class="token punctuation">,</span> <span class="token keyword">double</span> p<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">bookNo</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">units_sold</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">revenue</span><span class="token punctuation">(</span>n<span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Sales_data</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">explicit</span> <span class="token keyword">operator</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">explicit</span> <span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>string <span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> bookNo<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>std<span class="token operator">::</span>string bookNo<span class="token punctuation">;</span><span class="token keyword">unsigned</span> units_sold <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">double</span> revenue <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span><span class="token punctuation">(</span>std<span class="token operator">::</span>istream<span class="token operator">&amp;</span><span class="token punctuation">,</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Sales_data <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> Sales_data<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">inline</span> <span class="token keyword">double</span> <span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">avg_price</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> units_sold <span class="token operator">?</span> revenue <span class="token operator">/</span> units_sold <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-46"><a href="#ç»ƒä¹ 14-46" class="headerlink" title="ç»ƒä¹ 14.46"></a>ç»ƒä¹ 14.46</h2><blockquote><p>ä½ è®¤ä¸ºåº”è¯¥ä¸º <code>Sales_data</code> ç±»å®šä¹‰ä¸Šé¢ä¸¤ç§ç±»å‹è½¬æ¢è¿ç®—ç¬¦å—ï¼Ÿåº”è¯¥æŠŠå®ƒä»¬å£°æ˜æˆ <code>explicit</code> çš„å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸Šé¢çš„ä¸¤ç§ç±»å‹è½¬æ¢æœ‰æ­§ä¹‰ï¼Œåº”è¯¥å£°æ˜æˆ <code>explicit</code> çš„ã€‚</p><h2 id="ç»ƒä¹ 14-47"><a href="#ç»ƒä¹ 14-47" class="headerlink" title="ç»ƒä¹ 14.47"></a>ç»ƒä¹ 14.47</h2><blockquote><p>è¯´æ˜ä¸‹é¢è¿™ä¸¤ä¸ªç±»å‹è½¬æ¢è¿ç®—ç¬¦çš„åŒºåˆ«ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Integral</span> <span class="token punctuation">&#123;</span><span class="token keyword">operator</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ç¬¬ä¸€ä¸ªæ— æ„ä¹‰ï¼Œä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ã€‚ç¬¬äºŒä¸ªåˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 14-48"><a href="#ç»ƒä¹ 14-48" class="headerlink" title="ç»ƒä¹ 14.48"></a>ç»ƒä¹ 14.48</h2><blockquote><p>ä½ åœ¨7.5.1èŠ‚çš„ç»ƒä¹ 7.40ä¸­æ›¾ç»é€‰æ‹©å¹¶ç¼–å†™äº†ä¸€ä¸ªç±»ï¼Œä½ è®¤ä¸ºå®ƒåº”è¯¥å«æœ‰å‘ <code>bool</code> çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè§£é‡ŠåŸå› å¹¶è¯´æ˜è¯¥è¿ç®—ç¬¦æ˜¯å¦åº”è¯¥æ˜¯ <code>explicit</code>çš„ï¼›å¦‚æœä¸æ˜¯ï¼Œä¹Ÿè¯·è§£é‡ŠåŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>Date</code> ç±»åº”è¯¥å«æœ‰å‘ <code>bool</code> çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œå¹¶ä¸”åº”è¯¥å£°æ˜ä¸º <code>explicit</code> çš„ã€‚</p><h2 id="ç»ƒä¹ 14-49"><a href="#ç»ƒä¹ 14-49" class="headerlink" title="ç»ƒä¹ 14.49"></a>ç»ƒä¹ 14.49</h2><blockquote><p>ä¸ºä¸Šä¸€é¢˜æåˆ°çš„ç±»å®šä¹‰ä¸€ä¸ªè½¬æ¢ç›®æ ‡æ˜¯ <code>bool</code> çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œå…ˆä¸ç”¨åœ¨æ„è¿™ä¹ˆåšæ˜¯å¦åº”è¯¥ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">explicit</span> <span class="token keyword">operator</span> <span class="token keyword">bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token punctuation">(</span>year<span class="token operator">&lt;</span><span class="token number">4000</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 14-50"><a href="#ç»ƒä¹ 14-50" class="headerlink" title="ç»ƒä¹ 14.50"></a>ç»ƒä¹ 14.50</h2><blockquote><p>åœ¨åˆå§‹åŒ– <code>ex1</code> å’Œ <code>ex2</code> çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”¨åˆ°å“ªäº›ç±»ç±»å‹çš„è½¬æ¢åºåˆ—å‘¢ï¼Ÿè¯´æ˜åˆå§‹åŒ–æ˜¯å¦æ­£ç¡®å¹¶è§£é‡ŠåŸå› ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">LongDouble</span> <span class="token punctuation">&#123;</span><span class="token function">LongDouble</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">operator</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">operator</span> <span class="token keyword">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>LongDouble ldObj<span class="token punctuation">;</span><span class="token keyword">int</span> ex1 <span class="token operator">=</span> ldObj<span class="token punctuation">;</span><span class="token keyword">float</span> ex2 <span class="token operator">=</span> ldObj<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>ex1</code> è½¬æ¢ä¸åˆæ³•ï¼Œæ²¡æœ‰å®šä¹‰ä» <code>LongDouble</code> åˆ° <code>int</code> çš„è½¬æ¢ï¼Œä»<code>double</code>è½¬æ¢è¿˜æ˜¯<code>float</code>è½¬æ¢å­˜åœ¨äºŒä¹‰æ€§ã€‚<code>ex2</code> åˆæ³•ã€‚</p><h2 id="ç»ƒä¹ 14-51"><a href="#ç»ƒä¹ 14-51" class="headerlink" title="ç»ƒä¹ 14.51"></a>ç»ƒä¹ 14.51</h2><blockquote><p>åœ¨è°ƒç”¨ <code>calc</code> çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç”¨åˆ°å“ªäº›ç±»å‹è½¬æ¢åºåˆ—å‘¢ï¼Ÿè¯´æ˜æœ€ä½³å¯è¡Œå‡½æ•°æ˜¯å¦‚ä½•è¢«é€‰å‡ºæ¥çš„ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">calc</span><span class="token punctuation">(</span>LongDouble<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> dval<span class="token punctuation">;</span><span class="token function">calc</span><span class="token punctuation">(</span>dval<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è°ƒç”¨äº†å“ªä¸ªcalcï¼Ÿ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æœ€ä½³å¯è¡Œå‡½æ•°æ˜¯ <code>void calc(int)</code>ã€‚</p><p>è½¬æ¢çš„ä¼˜å…ˆçº§å¦‚ä¸‹ï¼š</p><ol><li>ç²¾ç¡®åŒ¹é…</li><li><code>const</code> è½¬æ¢ã€‚</li><li>ç±»å‹æå‡</li><li>ç®—æœ¯è½¬æ¢</li><li>ç±»ç±»å‹è½¬æ¢</li></ol><h2 id="ç»ƒä¹ 14-52"><a href="#ç»ƒä¹ 14-52" class="headerlink" title="ç»ƒä¹ 14.52"></a>ç»ƒä¹ 14.52</h2><blockquote><p>åœ¨ä¸‹é¢çš„åŠ æ³•è¡¨è¾¾å¼ä¸­åˆ†åˆ«é€‰ç”¨äº†å“ªä¸ª<code>operator+</code>ï¼Ÿåˆ—å‡ºå€™é€‰å‡½æ•°ã€å¯è¡Œå‡½æ•°åŠä¸ºæ¯ä¸ªå¯è¡Œå‡½æ•°çš„å®å‚æ‰§è¡Œçš„ç±»å‹è½¬æ¢ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Longdouble</span> <span class="token punctuation">&#123;</span><span class="token comment">//ç”¨äºæ¼”ç¤ºçš„æˆå‘˜operator+;åœ¨é€šå¸¸æƒ…å†µä¸‹æ˜¯ä¸ªéæˆå‘˜</span>LongDouble <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> SmallInt<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…¶ä»–æˆå‘˜ä¸14.9.2èŠ‚ä¸€è‡´</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>LongDouble <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>LongDouble<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>SmallInt si<span class="token punctuation">;</span>LongDouble ld<span class="token punctuation">;</span>ld <span class="token operator">=</span> si <span class="token operator">+</span> ld<span class="token punctuation">;</span>ld <span class="token operator">=</span> ld <span class="token operator">+</span> si<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p><code>ld = si + ld;</code> ä¸åˆæ³•ã€‚<code>ld = ld + si</code> ä¸¤ä¸ªéƒ½å¯ä»¥è°ƒç”¨ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªè°ƒç”¨æ›´ç²¾ç¡®ä¸€äº›ã€‚</p><h2 id="ç»ƒä¹ 14-53"><a href="#ç»ƒä¹ 14-53" class="headerlink" title="ç»ƒä¹ 14.53"></a>ç»ƒä¹ 14.53</h2><blockquote><p>å‡è®¾æˆ‘ä»¬å·²ç»å®šä¹‰äº†å¦‚ç¬¬522é¡µæ‰€ç¤ºçš„<code>SmallInt</code>ï¼Œåˆ¤æ–­ä¸‹é¢çš„åŠ æ³•è¡¨è¾¾å¼æ˜¯å¦åˆæ³•ã€‚å¦‚æœåˆæ³•ï¼Œä½¿ç”¨äº†å“ªä¸ªåŠ æ³•è¿ç®—ç¬¦ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œåº”è¯¥æ€æ ·ä¿®æ”¹ä»£ç æ‰èƒ½ä½¿å…¶åˆæ³•ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">SmallInt si<span class="token punctuation">;</span><span class="token keyword">double</span> d <span class="token operator">=</span> si <span class="token operator">+</span> <span class="token number">3.14</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸åˆæ³•ï¼Œå­˜åœ¨äºŒä¹‰æ€§ã€‚</p><p>åº”è¯¥è¯¥ä¸ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">SmallInt s1<span class="token punctuation">;</span><span class="token keyword">double</span> d <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token function">SmallInt</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ13</title>
      <link href="2021/04/10/excersize/ch13/"/>
      <url>2021/04/10/excersize/ch13/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åä¸‰ç« -æ‹·è´æ§åˆ¶"><a href="#ç¬¬åä¸‰ç« -æ‹·è´æ§åˆ¶" class="headerlink" title="ç¬¬åä¸‰ç«  æ‹·è´æ§åˆ¶"></a>ç¬¬åä¸‰ç«  æ‹·è´æ§åˆ¶</h1><h2 id="ç»ƒä¹ 13-1"><a href="#ç»ƒä¹ 13-1" class="headerlink" title="ç»ƒä¹ 13.1"></a>ç»ƒä¹ 13.1</h2><blockquote><p>æ‹·è´æ„é€ å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™ä½¿ç”¨å®ƒï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœä¸€ä¸ªæ„é€ å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è‡ªèº«ç±»ç±»å‹çš„å¼•ç”¨ï¼Œä¸”ä»»ä½•é¢å¤–å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œåˆ™æ­¤æ„é€ å‡½æ•°æ˜¯æ‹·è´æ„é€ å‡½æ•°ã€‚å½“ä½¿ç”¨<strong>æ‹·è´åˆå§‹åŒ–</strong>æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°æ‹·è´æ„é€ å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-2"><a href="#ç»ƒä¹ 13-2" class="headerlink" title="ç»ƒä¹ 13.2"></a>ç»ƒä¹ 13.2</h2><blockquote><p>è§£é‡Šä¸ºä»€ä¹ˆä¸‹é¢çš„å£°æ˜æ˜¯éæ³•çš„ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token class-name">Sales_data</span><span class="token operator">::</span><span class="token function">Sales_data</span><span class="token punctuation">(</span>Sales_data rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å‚æ•°ç±»å‹åº”è¯¥æ˜¯å¼•ç”¨ç±»å‹ã€‚</p><h2 id="ç»ƒä¹ 13-3"><a href="#ç»ƒä¹ 13-3" class="headerlink" title="ç»ƒä¹ 13.3"></a>ç»ƒä¹ 13.3</h2><blockquote><p>å½“æˆ‘ä»¬æ‹·è´ä¸€ä¸ª<code>StrBlob</code>æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ‹·è´ä¸€ä¸ª<code>StrBlobPtr</code>å‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å½“æˆ‘ä»¬æ‹·è´<code>StrBlob</code>æ—¶ï¼Œä¼šä½¿ <code>shared_ptr</code> çš„å¼•ç”¨è®¡æ•°åŠ 1ã€‚å½“æˆ‘ä»¬æ‹·è´ <code>StrBlobPtr</code> æ—¶ï¼Œå¼•ç”¨è®¡æ•°ä¸ä¼šå˜åŒ–ã€‚</p><h2 id="ç»ƒä¹ 13-4"><a href="#ç»ƒä¹ 13-4" class="headerlink" title="ç»ƒä¹ 13.4"></a>ç»ƒä¹ 13.4</h2><blockquote><p>å‡å®š <code>Point</code> æ˜¯ä¸€ä¸ªç±»ç±»å‹ï¼Œå®ƒæœ‰ä¸€ä¸ª<code>public</code>çš„æ‹·è´æ„é€ å‡½æ•°ï¼ŒæŒ‡å‡ºä¸‹é¢ç¨‹åºç‰‡æ®µä¸­å“ªäº›åœ°æ–¹ä½¿ç”¨äº†æ‹·è´æ„é€ å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Point global<span class="token punctuation">;</span>Point <span class="token function">foo_bar</span><span class="token punctuation">(</span>Point arg<span class="token punctuation">)</span> <span class="token comment">// 1</span><span class="token punctuation">&#123;</span>Point local <span class="token operator">=</span> arg<span class="token punctuation">,</span> <span class="token operator">*</span>heap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Point</span><span class="token punctuation">(</span>global<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2: Point local = arg,  3: Point *heap = new Point(global) </span><span class="token operator">*</span>heap <span class="token operator">=</span> local<span class="token punctuation">;</span> Point pa<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> local<span class="token punctuation">,</span> <span class="token operator">*</span>heap <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// 4, 5</span><span class="token keyword">return</span> <span class="token operator">*</span>heap<span class="token punctuation">;</span>  <span class="token comment">// 6</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸Šé¢æœ‰6å¤„åœ°æ–¹ä½¿ç”¨äº†æ‹·è´æ„é€ å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-5"><a href="#ç»ƒä¹ 13-5" class="headerlink" title="ç»ƒä¹ 13.5"></a>ç»ƒä¹ 13.5</h2><blockquote><p>ç»™å®šä¸‹é¢çš„ç±»æ¡†æ¶ï¼Œç¼–å†™ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œæ‹·è´æ‰€æœ‰æˆå‘˜ã€‚ä½ çš„æ„é€ å‡½æ•°åº”è¯¥åŠ¨æ€åˆ†é…ä¸€ä¸ªæ–°çš„<code>string</code>ï¼Œå¹¶å°†å¯¹è±¡æ‹·è´åˆ°<code>ps</code>æ‰€æŒ‡å‘çš„ä½ç½®ï¼Œè€Œä¸æ˜¯æ‹·è´psæœ¬èº«ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span><span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr<span class="token operator">&amp;</span> hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-6"><a href="#ç»ƒä¹ 13-6" class="headerlink" title="ç»ƒä¹ 13.6"></a>ç»ƒä¹ 13.6</h2><blockquote><p>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ—¶å€™ä½¿ç”¨å®ƒï¼Ÿåˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦å®Œæˆä»€ä¹ˆå·¥ä½œï¼Ÿä»€ä¹ˆæ—¶å€™ä¼šç”Ÿæˆåˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªåä¸º <code>operator=</code> çš„å‡½æ•°ã€‚å½“èµ‹å€¼è¿ç®—å‘ç”Ÿæ—¶å°±ä¼šç”¨åˆ°å®ƒã€‚åˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦å¯ä»¥ç”¨æ¥ç¦æ­¢è¯¥ç±»å‹å¯¹è±¡çš„èµ‹å€¼ã€‚å¦‚æœä¸€ä¸ªç±»æœªå®šä¹‰è‡ªå·±çš„æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå®ƒç”Ÿæˆä¸€ä¸ªåˆæˆæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€‚</p><h2 id="ç»ƒä¹ 13-7"><a href="#ç»ƒä¹ 13-7" class="headerlink" title="ç»ƒä¹ 13.7"></a>ç»ƒä¹ 13.7</h2><blockquote><p>å½“æˆ‘ä»¬å°†ä¸€ä¸ª <code>StrBlob</code> èµ‹å€¼ç»™å¦ä¸€ä¸ª <code>StrBlob</code> æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿèµ‹å€¼ <code>StrBlobPtr</code> å‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šå‘ç”Ÿæµ…å±‚å¤åˆ¶ã€‚</p><h2 id="ç»ƒä¹ 13-8"><a href="#ç»ƒä¹ 13-8" class="headerlink" title="ç»ƒä¹ 13.8"></a>ç»ƒä¹ 13.8</h2><blockquote><p>ä¸º13.1.1èŠ‚ç»ƒä¹ 13.5ä¸­çš„ <code>HasPtr</code> ç±»ç¼–å†™èµ‹å€¼è¿ç®—ç¬¦ã€‚ç±»ä¼¼æ‹·è´æ„é€ å‡½æ•°ï¼Œä½ çš„èµ‹å€¼è¿ç®—ç¬¦åº”è¯¥å°†å¯¹è±¡æ‹·è´åˆ°<code>ps</code>æŒ‡å‘çš„ä½ç½®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>rhs_hp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>rhs_hp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            std<span class="token operator">::</span>string <span class="token operator">*</span>temp_ps <span class="token operator">=</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>rhs_hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>            ps <span class="token operator">=</span> temp_ps<span class="token punctuation">;</span>            i <span class="token operator">=</span> rhs_hp<span class="token punctuation">.</span>i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-9"><a href="#ç»ƒä¹ 13-9" class="headerlink" title="ç»ƒä¹ 13.9"></a>ç»ƒä¹ 13.9</h2><blockquote><p>ææ„å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿåˆæˆææ„å‡½æ•°å®Œæˆä»€ä¹ˆå·¥ä½œï¼Ÿä»€ä¹ˆæ—¶å€™ä¼šç”Ÿæˆåˆæˆææ„å‡½æ•°ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ææ„å‡½æ•°æ˜¯ç±»çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œåå­—ç”±æ³¢æµªå·æ¥ç±»åæ„æˆã€‚å®ƒæ²¡æœ‰è¿”å›å€¼ï¼Œä¹Ÿä¸æ¥å—å‚æ•°ã€‚åˆæˆææ„å‡½æ•°å¯è¢«ç”¨æ¥é˜»æ­¢è¯¥ç±»å‹çš„å¯¹è±¡è¢«é”€æ¯ã€‚å½“ä¸€ä¸ªç±»æœªå®šä¹‰è‡ªå·±çš„ææ„å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå®ƒç”Ÿæˆä¸€ä¸ªåˆæˆææ„å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-10"><a href="#ç»ƒä¹ 13-10" class="headerlink" title="ç»ƒä¹ 13.10"></a>ç»ƒä¹ 13.10</h2><blockquote><p>å½“ä¸€ä¸ª <code>StrBlob</code> å¯¹è±¡é”€æ¯æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¸€ä¸ª <code>StrBlobPtr</code> å¯¹è±¡é”€æ¯æ—¶å‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å½“ä¸€ä¸ª <code>StrBlob</code> å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œ<code>shared_ptr</code> çš„å¼•ç”¨è®¡æ•°ä¼šå‡å°‘ã€‚å½“ <code>StrBlobPtr</code> å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œä¸å½±å“å¼•ç”¨è®¡æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-11"><a href="#ç»ƒä¹ 13-11" class="headerlink" title="ç»ƒä¹ 13.11"></a>ç»ƒä¹ 13.11</h2><blockquote><p>ä¸ºå‰é¢ç»ƒä¹ ä¸­çš„ <code>HasPtr</code> ç±»æ·»åŠ ä¸€ä¸ªææ„å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>string <span class="token operator">*</span>new_ps <span class="token operator">=</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>        ps <span class="token operator">=</span> new_ps<span class="token punctuation">;</span>        i <span class="token operator">=</span> hp<span class="token punctuation">.</span>i<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-12"><a href="#ç»ƒä¹ 13-12" class="headerlink" title="ç»ƒä¹ 13.12"></a>ç»ƒä¹ 13.12</h2><blockquote><p>åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­ä¼šå‘ç”Ÿå‡ æ¬¡ææ„å‡½æ•°è°ƒç”¨ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">fcn</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sales_data <span class="token operator">*</span>trans<span class="token punctuation">,</span> Sales_data accum<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>Sales_data <span class="token function">item1</span><span class="token punctuation">(</span><span class="token operator">*</span>trans<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">item2</span><span class="token punctuation">(</span>accum<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> item1<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> item2<span class="token punctuation">.</span><span class="token function">isbn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¸‰æ¬¡ï¼Œåˆ†åˆ«æ˜¯ <code>accum</code>ã€<code>item1</code>å’Œ<code>item2</code>ã€‚</p><h2 id="ç»ƒä¹ 13-13"><a href="#ç»ƒä¹ 13-13" class="headerlink" title="ç»ƒä¹ 13.13"></a>ç»ƒä¹ 13.13</h2><blockquote><p>ç†è§£æ‹·è´æ§åˆ¶æˆå‘˜å’Œæ„é€ å‡½æ•°çš„ä¸€ä¸ªå¥½æ–¹æ³•çš„å®šä¹‰ä¸€ä¸ªç®€å•çš„ç±»ï¼Œä¸ºè¯¥ç±»å®šä¹‰è¿™äº›æˆå‘˜ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ‰“å°å‡ºè‡ªå·±çš„åå­—ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">struct</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"X()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token keyword">const</span> X<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"X(const X&amp;)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç»™ <code>X</code> æ·»åŠ æ‹·è´èµ‹å€¼è¿ç®—ç¬¦å’Œææ„å‡½æ•°ï¼Œå¹¶ç¼–å†™ä¸€ä¸ªç¨‹åºä»¥ä¸åŒçš„æ–¹å¼ä½¿ç”¨ <code>X</code> çš„å¯¹è±¡ï¼šå°†å®ƒä»¬ä½œä¸ºéå¼•ç”¨å‚æ•°ä¼ é€’ï¼›åŠ¨æ€åˆ†é…å®ƒä»¬ï¼›å°†å®ƒä»¬å­˜æ”¾äºå®¹å™¨ä¸­ï¼›è¯¸å¦‚æ­¤ç±»ã€‚è§‚å¯Ÿç¨‹åºçš„è¾“å‡ºï¼Œç›´åˆ°ä½ ç¡®è®¤ç†è§£äº†ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨æ‹·è´æ§åˆ¶æˆå‘˜ï¼Œä»¥åŠä¸ºä»€ä¹ˆä¼šä½¿ç”¨å®ƒä»¬ã€‚å½“ä½ è§‚å¯Ÿç¨‹åºè¾“å‡ºæ—¶ï¼Œè®°ä½ç¼–è¯‘å™¨å¯ä»¥ç•¥è¿‡å¯¹æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚</p><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token keyword">struct</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span>    <span class="token function">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"X()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token function">X</span><span class="token punctuation">(</span><span class="token keyword">const</span> X<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"X(const X&amp;)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    X<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> X<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"X&amp; operator=(const X&amp;)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"~X()"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">const</span> X <span class="token operator">&amp;</span>rx<span class="token punctuation">,</span> X x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>X<span class="token operator">></span> vec<span class="token punctuation">;</span>    vec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>rx<span class="token punctuation">)</span><span class="token punctuation">;</span>    vec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    X <span class="token operator">*</span>px <span class="token operator">=</span> <span class="token keyword">new</span> X<span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">*</span>px<span class="token punctuation">,</span> <span class="token operator">*</span>px<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">delete</span> px<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-14"><a href="#ç»ƒä¹ 13-14" class="headerlink" title="ç»ƒä¹ 13.14"></a>ç»ƒä¹ 13.14</h2><blockquote><p>å‡å®š <code>numbered</code> æ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒæœ‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼Œèƒ½ä¸ºæ¯ä¸ªå¯¹è±¡ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„åºå·ï¼Œä¿å­˜åœ¨åä¸º <code>mysn</code> çš„æ•°æ®æˆå‘˜ä¸­ã€‚å‡å®š <code>numbered</code> ä½¿ç”¨åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜ï¼Œå¹¶ç»™å®šå¦‚ä¸‹å‡½æ•°ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">f</span> <span class="token punctuation">(</span>numbered s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>mysn <span class="token operator">&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ™ä¸‹é¢ä»£ç è¾“å‡ºä»€ä¹ˆå†…å®¹ï¼Ÿ</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">numbered a<span class="token punctuation">,</span> b <span class="token operator">=</span> a<span class="token punctuation">,</span> c <span class="token operator">=</span> b<span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">f</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">f</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>è¾“å‡º3ä¸ªå®Œå…¨ä¸€æ ·çš„æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-15"><a href="#ç»ƒä¹ 13-15" class="headerlink" title="ç»ƒä¹ 13.15"></a>ç»ƒä¹ 13.15</h2><blockquote><p>å‡å®š<code>numbered</code> å®šä¹‰äº†ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œèƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„åºåˆ—å·ã€‚è¿™ä¼šæ”¹å˜ä¸Šä¸€é¢˜ä¸­è°ƒç”¨çš„è¾“å‡ºç»“æœå—ï¼Ÿå¦‚æœä¼šæ”¹å˜ï¼Œä¸ºä»€ä¹ˆï¼Ÿæ–°çš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šè¾“å‡º3ä¸ªä¸åŒçš„æ•°ã€‚å¹¶ä¸”è¿™3ä¸ªæ•°å¹¶ä¸æ˜¯aã€bã€cå½“ä¸­çš„æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-16"><a href="#ç»ƒä¹ 13-16" class="headerlink" title="ç»ƒä¹ 13.16"></a>ç»ƒä¹ 13.16</h2><blockquote><p>å¦‚æœ <code>f</code> ä¸­çš„å‚æ•°æ˜¯ <code>const numbered&amp;</code>ï¼Œå°†ä¼šæ€æ ·ï¼Ÿè¿™ä¼šæ”¹å˜è¾“å‡ºç»“æœå—ï¼Ÿå¦‚æœä¼šæ”¹å˜ï¼Œä¸ºä»€ä¹ˆï¼Ÿæ–°çš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šè¾“å‡º aã€bã€cçš„æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-17"><a href="#ç»ƒä¹ 13-17" class="headerlink" title="ç»ƒä¹ 13.17"></a>ç»ƒä¹ 13.17</h2><blockquote><p>åˆ†åˆ«ç¼–å†™å‰ä¸‰é¢˜ä¸­æ‰€æè¿°çš„ <code>numbered</code> å’Œ <code>f</code>ï¼ŒéªŒè¯ä½ æ˜¯å¦æ­£ç¡®é¢„æµ‹äº†è¾“å‡ºç»“æœã€‚</p></blockquote><p>è§£ï¼š</p><p>13.14ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">numbered</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">numbered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>mysn <span class="token operator">=</span> unique<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> mysn<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">int</span> unique<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> numbered<span class="token operator">::</span>unique <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>numbered s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>mysn <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>numbered a<span class="token punctuation">,</span> b <span class="token operator">=</span> a<span class="token punctuation">,</span> c <span class="token operator">=</span> b<span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>13.15ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">numbered</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">numbered</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        mysn <span class="token operator">=</span> unique<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token function">numbered</span><span class="token punctuation">(</span><span class="token keyword">const</span> numbered<span class="token operator">&amp;</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>mysn <span class="token operator">=</span> unique<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> mysn<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> unique<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> numbered<span class="token operator">::</span>unique <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>numbered s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>mysn <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    numbered a<span class="token punctuation">,</span> b <span class="token operator">=</span> a<span class="token punctuation">,</span> c <span class="token operator">=</span> b<span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">f</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>13.16ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">numbered</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">numbered</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>mysn <span class="token operator">=</span> unique<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">numbered</span><span class="token punctuation">(</span><span class="token keyword">const</span> numbered<span class="token operator">&amp;</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>mysn <span class="token operator">=</span> unique<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> mysn<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">int</span> unique<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> numbered<span class="token operator">::</span>unique <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">const</span> numbered<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>mysn <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>numbered a<span class="token punctuation">,</span> b <span class="token operator">=</span> a<span class="token punctuation">,</span> c <span class="token operator">=</span> b<span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-18"><a href="#ç»ƒä¹ 13-18" class="headerlink" title="ç»ƒä¹ 13.18"></a>ç»ƒä¹ 13.18</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª <code>Employee</code> ç±»ï¼Œå®ƒåŒ…å«é›‡å‘˜çš„å§“åå’Œå”¯ä¸€çš„é›‡å‘˜è¯å·ã€‚ä¸ºè¿™ä¸ªç±»å®šä¹‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œä»¥åŠæ¥å—ä¸€ä¸ªè¡¨ç¤ºé›‡å‘˜å§“åçš„ <code>string</code> çš„æ„é€ å‡½æ•°ã€‚æ¯ä¸ªæ„é€ å‡½æ•°åº”è¯¥é€šè¿‡é€’å¢ä¸€ä¸ª <code>static</code> æ•°æ®æˆå‘˜æ¥ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„è¯å·ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Employee</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> id_<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>string name_<span class="token punctuation">;</span><span class="token keyword">int</span> id_<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">int</span> s_increment<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> Employee<span class="token operator">::</span>s_increment <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>id_ <span class="token operator">=</span> s_increment<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">Employee</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>id_ <span class="token operator">=</span> s_increment<span class="token operator">++</span><span class="token punctuation">;</span>name_ <span class="token operator">=</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-19"><a href="#ç»ƒä¹ 13-19" class="headerlink" title="ç»ƒä¹ 13.19"></a>ç»ƒä¹ 13.19</h2><blockquote><p>ä½ çš„ <code>Employee</code> ç±»éœ€è¦å®šä¹‰å®ƒè‡ªå·±çš„æ‹·è´æ§åˆ¶æˆå‘˜å—ï¼Ÿå¦‚æœéœ€è¦ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¦‚æœä¸éœ€è¦ï¼Œä¸ºä»€ä¹ˆï¼Ÿå®ç°ä½ è®¤ä¸º <code>Employee</code> éœ€è¦çš„æ‹·è´æ§åˆ¶æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¯ä»¥æ˜¾å¼åœ°é˜»æ­¢æ‹·è´ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Employee</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Employee</span><span class="token punctuation">(</span><span class="token keyword">const</span> Employee<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>    Employee<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Employee<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> id_<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    string name_<span class="token punctuation">;</span>    <span class="token keyword">int</span> id_<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> s_increment<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-20"><a href="#ç»ƒä¹ 13-20" class="headerlink" title="ç»ƒä¹ 13.20"></a>ç»ƒä¹ 13.20</h2><blockquote><p>è§£é‡Šå½“æˆ‘ä»¬æ‹·è´ã€èµ‹å€¼æˆ–é”€æ¯ <code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»å¯¹è±¡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æˆå‘˜ä¼šè¢«å¤åˆ¶ã€‚</p><h2 id="ç»ƒä¹ 13-21"><a href="#ç»ƒä¹ 13-21" class="headerlink" title="ç»ƒä¹ 13.21"></a>ç»ƒä¹ 13.21</h2><blockquote><p>ä½ è®¤ä¸º <code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»éœ€è¦å®šä¹‰å®ƒä»¬è‡ªå·±ç‰ˆæœ¬çš„æ‹·è´æ§åˆ¶æˆå‘˜å—ï¼Ÿå¦‚æœéœ€è¦ï¼Œä¸ºä»€ä¹ˆï¼Ÿå®ç°ä½ è®¤ä¸ºè¿™ä¸¤ä¸ªç±»éœ€è¦çš„æ‹·è´æ§åˆ¶æ“ä½œã€‚</p></blockquote><p>è§£ï¼š</p><p>åˆæˆçš„ç‰ˆæœ¬æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚ã€‚å› æ­¤ä¸éœ€è¦è‡ªå®šä¹‰æ‹·è´æ§åˆ¶æˆå‘˜ã€‚</p><h2 id="ç»ƒä¹ 13-22"><a href="#ç»ƒä¹ 13-22" class="headerlink" title="ç»ƒä¹ 13.22"></a>ç»ƒä¹ 13.22</h2><blockquote><p>å‡å®šæˆ‘ä»¬å¸Œæœ› <code>HasPtr</code> çš„è¡Œä¸ºåƒä¸€ä¸ªå€¼ã€‚å³ï¼Œå¯¹äºå¯¹è±¡æ‰€æŒ‡å‘çš„ <code>string</code> æˆå‘˜ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä»½è‡ªå·±çš„æ‹·è´ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä»‹ç»æ‹·è´æ§åˆ¶æˆå‘˜çš„å®šä¹‰ã€‚ä½†æ˜¯ï¼Œä½ å·²ç»å­¦ä¹ äº†å®šä¹‰è¿™äº›æˆå‘˜æ‰€éœ€çš„æ‰€æœ‰çŸ¥è¯†ã€‚åœ¨ç»§ç»­å­¦ä¹ ä¸‹ä¸€èŠ‚ä¹‹å‰ï¼Œä¸º <code>HasPtr</code> ç¼–å†™æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> new_p <span class="token operator">=</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>        ps <span class="token operator">=</span> new_p<span class="token punctuation">;</span>        i <span class="token operator">=</span> hp<span class="token punctuation">.</span>i<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-23"><a href="#ç»ƒä¹ 13-23" class="headerlink" title="ç»ƒä¹ 13.23"></a>ç»ƒä¹ 13.23</h2><blockquote><p>æ¯”è¾ƒä¸Šä¸€èŠ‚ç»ƒä¹ ä¸­ä½ ç¼–å†™çš„æ‹·è´æ§åˆ¶æˆå‘˜å’Œè¿™ä¸€èŠ‚ä¸­çš„ä»£ç ã€‚ç¡®å®šä½ ç†è§£äº†ä½ çš„ä»£ç å’Œæˆ‘ä»¬çš„ä»£ç ä¹‹é—´çš„å·®å¼‚ã€‚</p></blockquote><p>è§£ï¼š<br><br>æŸ¥çœ‹13.22ä»£ç ã€‚</p><h2 id="ç»ƒä¹ 13-24"><a href="#ç»ƒä¹ 13-24" class="headerlink" title="ç»ƒä¹ 13.24"></a>ç»ƒä¹ 13.24</h2><blockquote><p>å¦‚æœæœ¬èŠ‚çš„ <code>HasPtr</code> ç‰ˆæœ¬æœªå®šä¹‰ææ„å‡½æ•°ï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœæœªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœæœªå®šä¹‰ææ„å‡½æ•°ï¼Œå°†ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚å¦‚æœæœªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œå°†ä¼šæ‹·è´æŒ‡é’ˆçš„å€¼ï¼ŒæŒ‡å‘åŒä¸€ä¸ªåœ°å€ã€‚</p><h2 id="ç»ƒä¹ 13-25"><a href="#ç»ƒä¹ 13-25" class="headerlink" title="ç»ƒä¹ 13.25"></a>ç»ƒä¹ 13.25</h2><blockquote><p>å‡å®šå¸Œæœ›å®šä¹‰ <code>StrBlob</code> çš„ç±»å€¼ç‰ˆæœ¬ï¼Œè€Œä¸”å¸Œæœ›ç»§ç»­ä½¿ç”¨ <code>shared_ptr</code>ï¼Œè¿™æ ·æˆ‘ä»¬çš„ <code>StrBlobPtr</code> ç±»å°±ä»èƒ½ä½¿ç”¨æŒ‡å‘<code>vector</code>çš„ <code>weak_ptr</code> äº†ã€‚ä½ ä¿®æ”¹åçš„ç±»å°†éœ€è¦ä¸€ä¸ªæ‹·è´çš„æ„é€ å‡½æ•°å’Œä¸€ä¸ªæ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼Œä½†ä¸éœ€è¦ææ„å‡½æ•°ã€‚è§£é‡Šæ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦å¿…é¡»è¦åšä»€ä¹ˆã€‚è§£é‡Šä¸ºä»€ä¹ˆä¸éœ€è¦ææ„å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><p>æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦è¦é‡æ–°åŠ¨æ€åˆ†é…å†…å­˜ã€‚å› ä¸º <code>StrBlob</code> ä½¿ç”¨çš„æ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶ä¼šè‡ªåŠ¨é‡Šæ”¾å¯¹è±¡ï¼Œå› æ­¤ä¸éœ€è¦ææ„å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 13-26"><a href="#ç»ƒä¹ 13-26" class="headerlink" title="ç»ƒä¹ 13.26"></a>ç»ƒä¹ 13.26</h2><blockquote><p>å¯¹ä¸Šä¸€é¢˜ä¸­æè¿°çš„ <code>strBlob</code> ç±»ï¼Œç¼–å†™ä½ è‡ªå·±çš„ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;exception></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ConstStrBlobPtr</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">StrBlob</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">using</span> size_type <span class="token operator">=</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>size_type<span class="token punctuation">;</span>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">ConstStrBlobPtr</span><span class="token punctuation">;</span>    ConstStrBlobPtr <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    ConstStrBlobPtr <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>    <span class="token function">StrBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">StrBlob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token comment">// copy constructor</span>    <span class="token function">StrBlob</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrBlob<span class="token operator">&amp;</span> sb<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">*</span>sb<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token comment">// copy-assignment operators</span>    StrBlob<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrBlob<span class="token operator">&amp;</span> sb<span class="token punctuation">)</span><span class="token punctuation">;</span>    size_type <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"pop_back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        data<span class="token operator">-></span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">const</span> string<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"front on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">const</span> string<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> data<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ConstStrBlobPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">ConstStrBlobPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">curr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">ConstStrBlobPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrBlob <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> size_t sz <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">wptr</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">curr</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// should add const</span>    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span>ConstStrBlobPtr<span class="token operator">&amp;</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> p<span class="token punctuation">.</span>curr <span class="token operator">!=</span> curr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">const</span> string<span class="token operator">&amp;</span> <span class="token function">deref</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token comment">// return value should add const</span>        <span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"dereference past end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    ConstStrBlobPtr<span class="token operator">&amp;</span> <span class="token function">incr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">++</span>curr<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> <span class="token function">check</span><span class="token punctuation">(</span>size_t i<span class="token punctuation">,</span> <span class="token keyword">const</span> string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> ret <span class="token operator">=</span> wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ret<span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"unbound StrBlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> ret<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>weak_ptr<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> wptr<span class="token punctuation">;</span>    size_t curr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_13_26.h"</span></span>ConstStrBlobPtr <span class="token class-name">StrBlob</span><span class="token operator">::</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">// should add const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">ConstStrBlobPtr</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>ConstStrBlobPtr <span class="token class-name">StrBlob</span><span class="token operator">::</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token comment">// should add const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">ConstStrBlobPtr</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrBlob<span class="token operator">&amp;</span> StrBlob<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrBlob<span class="token operator">&amp;</span> sb<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    data <span class="token operator">=</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token punctuation">(</span><span class="token operator">*</span>sb<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-27"><a href="#ç»ƒä¹ 13-27" class="headerlink" title="ç»ƒä¹ 13.27"></a>ç»ƒä¹ 13.27</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±çš„ä½¿ç”¨å¼•ç”¨è®¡æ•°ç‰ˆæœ¬çš„ <code>HasPtr</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">size_t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">use</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>use<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">++</span><span class="token operator">*</span>use<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token operator">++</span><span class="token operator">*</span>rhs<span class="token punctuation">.</span>use<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">*</span>use <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>            <span class="token keyword">delete</span> use<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        ps <span class="token operator">=</span> rhs<span class="token punctuation">.</span>ps<span class="token punctuation">;</span>        i <span class="token operator">=</span> rhs<span class="token punctuation">.</span>i<span class="token punctuation">;</span>        use <span class="token operator">=</span> rhs<span class="token punctuation">.</span>use<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">*</span>use <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>            <span class="token keyword">delete</span> use<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    size_t <span class="token operator">*</span>use<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-28"><a href="#ç»ƒä¹ 13-28" class="headerlink" title="ç»ƒä¹ 13.28"></a>ç»ƒä¹ 13.28</h2><blockquote><p>ç»™å®šä¸‹é¢çš„ç±»ï¼Œä¸ºå…¶å®ç°ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°å’Œå¿…è¦çš„æ‹·è´æ§åˆ¶æˆå‘˜ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>pravite<span class="token operator">:</span>std<span class="token operator">::</span>string value<span class="token punctuation">;</span><span class="token keyword">int</span> count<span class="token punctuation">;</span>TreeNode <span class="token operator">*</span>left<span class="token punctuation">;</span>TreeNode <span class="token operator">*</span>right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">BinStrTree</span><span class="token punctuation">&#123;</span>pravite<span class="token operator">:</span>TreeNode <span class="token operator">*</span>root<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>string<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">right</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token keyword">const</span> TreeNode <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">value</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">left</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">right</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">++</span><span class="token operator">*</span>count<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    TreeNode<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> TreeNode <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">*</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">delete</span> left<span class="token punctuation">;</span>            <span class="token keyword">delete</span> right<span class="token punctuation">;</span>            <span class="token keyword">delete</span> count<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string value<span class="token punctuation">;</span>    <span class="token keyword">int</span>         <span class="token operator">*</span>count<span class="token punctuation">;</span>    TreeNode    <span class="token operator">*</span>left<span class="token punctuation">;</span>    TreeNode    <span class="token operator">*</span>right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">BinStrTree</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">BinStrTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">BinStrTree</span><span class="token punctuation">(</span><span class="token keyword">const</span> BinStrTree <span class="token operator">&amp;</span>bst<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token operator">*</span>bst<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    BinStrTree<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> BinStrTree <span class="token operator">&amp;</span>bst<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">BinStrTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> root<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    TreeNode <span class="token operator">*</span>root<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°å’Œä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_13_28.h"</span></span>TreeNode<span class="token operator">&amp;</span> TreeNode<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> TreeNode <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token operator">++</span><span class="token operator">*</span>rhs<span class="token punctuation">.</span>count<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span><span class="token operator">*</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> left<span class="token punctuation">;</span>        <span class="token keyword">delete</span> right<span class="token punctuation">;</span>        <span class="token keyword">delete</span> count<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    value <span class="token operator">=</span> rhs<span class="token punctuation">.</span>value<span class="token punctuation">;</span>    left <span class="token operator">=</span> rhs<span class="token punctuation">.</span>left<span class="token punctuation">;</span>    right <span class="token operator">=</span> rhs<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    count <span class="token operator">=</span> rhs<span class="token punctuation">.</span>count<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>BinStrTree<span class="token operator">&amp;</span> BinStrTree<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> BinStrTree <span class="token operator">&amp;</span>bst<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    TreeNode <span class="token operator">*</span>new_root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TreeNode</span><span class="token punctuation">(</span><span class="token operator">*</span>bst<span class="token punctuation">.</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">delete</span> root<span class="token punctuation">;</span>    root <span class="token operator">=</span> new_root<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-29"><a href="#ç»ƒä¹ 13-29" class="headerlink" title="ç»ƒä¹ 13.29"></a>ç»ƒä¹ 13.29</h2><blockquote><p>è§£é‡Š <code>swap(HasPtr&amp;, HasPtr&amp;)</code>ä¸­å¯¹ <code>swap</code> çš„è°ƒç”¨ä¸ä¼šå¯¼è‡´é€’å½’å¾ªç¯ã€‚</p></blockquote><p>è§£ï¼š</p><p>è¿™å…¶å®æ˜¯3ä¸ªä¸åŒçš„å‡½æ•°ï¼Œå‚æ•°ç±»å‹ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸ä¼šå¯¼è‡´é€’å½’å¾ªç¯ã€‚</p><h2 id="ç»ƒä¹ 13-30"><a href="#ç»ƒä¹ 13-30" class="headerlink" title="ç»ƒä¹ 13.30"></a>ç»ƒä¹ 13.30</h2><blockquote><p>ä¸ºä½ çš„ç±»å€¼ç‰ˆæœ¬çš„ <code>HasPtr</code> ç¼–å†™ <code>swap</code> å‡½æ•°ï¼Œå¹¶æµ‹è¯•å®ƒã€‚ä¸ºä½ çš„ <code>swap</code> å‡½æ•°æ·»åŠ ä¸€ä¸ªæ‰“å°è¯­å¥ï¼ŒæŒ‡å‡ºå‡½æ•°ä»€ä¹ˆæ—¶å€™æ‰§è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HasPtr<span class="token operator">&amp;</span><span class="token punctuation">,</span> HasPtr<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> new_p <span class="token operator">=</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>        ps <span class="token operator">=</span> new_p<span class="token punctuation">;</span>        i <span class="token operator">=</span> hp<span class="token punctuation">.</span>i<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>         <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ps <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">inline</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HasPtr<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> HasPtr<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span>    <span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>ps<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>i<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"call swap(HasPtr&amp; lhs, HasPtr&amp; rhs)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-31"><a href="#ç»ƒä¹ 13-31" class="headerlink" title="ç»ƒä¹ 13.31"></a>ç»ƒä¹ 13.31</h2><blockquote><p>ä¸ºä½ çš„ <code>HasPtr</code> ç±»å®šä¹‰ä¸€ä¸ª <code>&lt;</code> è¿ç®—ç¬¦ï¼Œå¹¶å®šä¹‰ä¸€ä¸ª <code>HasPtr</code> çš„ <code>vector</code>ã€‚ä¸ºè¿™ä¸ª <code>vector</code> æ·»åŠ ä¸€äº›å…ƒç´ ï¼Œå¹¶å¯¹å®ƒæ‰§è¡Œ <code>sort</code>ã€‚æ³¨æ„ä½•æ—¶ä¼šè°ƒç”¨ <code>swap</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">HasPtr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HasPtr<span class="token operator">&amp;</span><span class="token punctuation">,</span> HasPtr<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>hp<span class="token punctuation">)</span>         <span class="token operator">:</span> <span class="token function">ps</span><span class="token punctuation">(</span><span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token operator">*</span>hp<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">i</span><span class="token punctuation">(</span>hp<span class="token punctuation">.</span>i<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    HasPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>HasPtr tmp<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">HasPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token keyword">delete</span> ps<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HasPtr <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span>        <span class="token function">swap</span><span class="token punctuation">(</span>ps<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">swap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"call swap(HasPtr &amp;rhs)"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>    <span class="token punctuation">&#123;</span>         std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ps <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>ps<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>HasPtr<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> HasPtr<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    lhs<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> HasPtr <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">*</span>lhs<span class="token punctuation">.</span>ps <span class="token operator">&lt;</span> <span class="token operator">*</span>rhs<span class="token punctuation">.</span>ps<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-32"><a href="#ç»ƒä¹ 13-32" class="headerlink" title="ç»ƒä¹ 13.32"></a>ç»ƒä¹ 13.32</h2><blockquote><p>ç±»æŒ‡é’ˆçš„ <code>HasPtr</code> ç‰ˆæœ¬ä¼šä» <code>swap</code> å‡½æ•°æ”¶ç›Šå—ï¼Ÿå¦‚æœä¼šï¼Œå¾—åˆ°äº†ä»€ä¹ˆç›Šå¤„ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸ä¼šã€‚ç±»å€¼çš„ç‰ˆæœ¬åˆ©ç”¨<code>swap</code>äº¤æ¢æŒ‡é’ˆä¸ç”¨è¿›è¡Œå†…å­˜åˆ†é…ï¼Œå› æ­¤å¾—åˆ°äº†æ€§èƒ½ä¸Šçš„æå‡ã€‚ç±»æŒ‡é’ˆçš„ç‰ˆæœ¬æœ¬æ¥å°±ä¸ç”¨è¿›è¡Œå†…å­˜åˆ†é…ï¼Œæ‰€ä»¥ä¸ä¼šå¾—åˆ°æ€§èƒ½æå‡ã€‚</p><h2 id="ç»ƒä¹ 13-33"><a href="#ç»ƒä¹ 13-33" class="headerlink" title="ç»ƒä¹ 13.33"></a>ç»ƒä¹ 13.33</h2><blockquote><p>ä¸ºä»€ä¹ˆ<code>Message</code>çš„æˆå‘˜<code>save</code>å’Œ<code>remove</code>çš„å‚æ•°æ˜¯ä¸€ä¸ª <code>Folder&amp;</code>ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½å°†å‚æ•°å®šä¹‰ä¸º <code>Folder</code> æˆ–æ˜¯ <code>const Folder</code>ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å› ä¸º <code>save</code> å’Œ <code>remove</code> æ“ä½œéœ€è¦æ›´æ–°æŒ‡å®š <code>Folder</code>ã€‚</p><h2 id="ç»ƒä¹ 13-34"><a href="#ç»ƒä¹ 13-34" class="headerlink" title="ç»ƒä¹ 13.34"></a>ç»ƒä¹ 13.34</h2><blockquote><p>ç¼–å†™æœ¬èŠ‚æ‰€æè¿°çš„ <code>Message</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;set></span></span><span class="token keyword">class</span> <span class="token class-name">Folder</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Message</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Message <span class="token operator">&amp;</span><span class="token punctuation">,</span> Message <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Folder</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">explicit</span> <span class="token function">Message</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">contents</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">Message</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Message<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span>Folder<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span>Folder<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">print_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string contents<span class="token punctuation">;</span>    std<span class="token operator">::</span>set<span class="token operator">&lt;</span>Folder<span class="token operator">*</span><span class="token operator">></span> folders<span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">add_to_Folders</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">addFldr</span><span class="token punctuation">(</span>Folder <span class="token operator">*</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> folders<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">remFldr</span><span class="token punctuation">(</span>Folder <span class="token operator">*</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> folders<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Message<span class="token operator">&amp;</span><span class="token punctuation">,</span> Message<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Folder</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Folder <span class="token operator">&amp;</span><span class="token punctuation">,</span> Folder <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Message</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>    <span class="token function">Folder</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Folder<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">print_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>set<span class="token operator">&lt;</span>Message<span class="token operator">*</span><span class="token operator">></span> msgs<span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">add_to_Message</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">addMsg</span><span class="token punctuation">(</span>Message <span class="token operator">*</span>m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> msgs<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">remMsg</span><span class="token punctuation">(</span>Message <span class="token operator">*</span>m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> msgs<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Folder <span class="token operator">&amp;</span><span class="token punctuation">,</span> Folder <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°å’Œä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex13_34_36_37.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Message <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> Message <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span>    lhs<span class="token punctuation">.</span><span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span>    rhs<span class="token punctuation">.</span><span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span>        <span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>folders<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>folders<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>contents<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>        lhs<span class="token punctuation">.</span><span class="token function">add_to_Folders</span><span class="token punctuation">(</span>lhs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span>    rhs<span class="token punctuation">.</span><span class="token function">add_to_Folders</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span><span class="token punctuation">&#125;</span><span class="token comment">// Message Implementation</span><span class="token keyword">void</span> <span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">save</span><span class="token punctuation">(</span>Folder <span class="token operator">&amp;</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">addFldr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span>    f<span class="token punctuation">.</span><span class="token function">addMsg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">remove</span><span class="token punctuation">(</span>Folder <span class="token operator">&amp;</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">remFldr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Use existing member function to avoid duplicate code.</span>    f<span class="token punctuation">.</span><span class="token function">remMsg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">add_to_Folders</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message <span class="token operator">&amp;</span>m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> f <span class="token operator">:</span> m<span class="token punctuation">.</span>folders<span class="token punctuation">)</span>        f<span class="token operator">-></span><span class="token function">addMsg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">Message</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message <span class="token operator">&amp;</span>m<span class="token punctuation">)</span>     <span class="token operator">:</span> <span class="token function">contents</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>contents<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">folders</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>folders<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">add_to_Folders</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> f <span class="token operator">:</span> folders<span class="token punctuation">)</span>        f<span class="token operator">-></span><span class="token function">remMsg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// The book added one line here: folders.clear(); but I think it is redundant and more importantly, it will cause a bug:</span>    <span class="token comment">// - In Message::operator=, in the case of self-assignment, it first calls remove_from_Folders() and its folders.clear() </span>    <span class="token comment">//   clears the data member of lhs(rhs), and there is no way we can assign it back to lhs.</span>    <span class="token comment">//   Refer to: http://stackoverflow.com/questions/29308115/protection-again-self-assignment</span>    <span class="token comment">// - Why is it redundant? As its analogous function Message::add_to_Folders(), Message::remove_from_Folders() should ONLY</span>    <span class="token comment">//   take care of the bookkeeping in Folders but not touch the Message's own data members - makes it much clearer and easier</span>    <span class="token comment">//   to use. As you can see in the 2 places where we call Message::remove_from_Folders(): in Message::operator=, folders.clear()</span>    <span class="token comment">//   introduces a bug as illustrated above; in the destructor ~Message(), the member "folders" will be destroyed anyways, why do</span>    <span class="token comment">//   we need to clear it first?</span><span class="token punctuation">&#125;</span><span class="token class-name">Message</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>Message <span class="token operator">&amp;</span>Message<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Message <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">remove_from_Folders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    contents <span class="token operator">=</span> rhs<span class="token punctuation">.</span>contents<span class="token punctuation">;</span>    folders <span class="token operator">=</span> rhs<span class="token punctuation">.</span>folders<span class="token punctuation">;</span>    <span class="token function">add_to_Folders</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Message</span><span class="token operator">::</span><span class="token function">print_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> contents <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// Folder Implementation</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>Folder <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> Folder <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span>    lhs<span class="token punctuation">.</span><span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    rhs<span class="token punctuation">.</span><span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>msgs<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>msgs<span class="token punctuation">)</span><span class="token punctuation">;</span>        lhs<span class="token punctuation">.</span><span class="token function">add_to_Message</span><span class="token punctuation">(</span>lhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    rhs<span class="token punctuation">.</span><span class="token function">add_to_Message</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Folder</span><span class="token operator">::</span><span class="token function">add_to_Message</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder <span class="token operator">&amp;</span>f<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> m <span class="token operator">:</span> f<span class="token punctuation">.</span>msgs<span class="token punctuation">)</span>        m<span class="token operator">-></span><span class="token function">addFldr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Folder</span><span class="token operator">::</span><span class="token function">Folder</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder <span class="token operator">&amp;</span>f<span class="token punctuation">)</span>     <span class="token operator">:</span> <span class="token function">msgs</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>msgs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">add_to_Message</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Folder</span><span class="token operator">::</span><span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> m <span class="token operator">:</span> msgs<span class="token punctuation">)</span>        m<span class="token operator">-></span><span class="token function">remFldr</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Folder</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">Folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>Folder <span class="token operator">&amp;</span>Folder<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Folder <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">remove_from_Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    msgs <span class="token operator">=</span> rhs<span class="token punctuation">.</span>msgs<span class="token punctuation">;</span>    <span class="token function">add_to_Message</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Folder</span><span class="token operator">::</span><span class="token function">print_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> m <span class="token operator">:</span> msgs<span class="token punctuation">)</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> m<span class="token operator">-></span>contents <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-35"><a href="#ç»ƒä¹ 13-35" class="headerlink" title="ç»ƒä¹ 13.35"></a>ç»ƒä¹ 13.35</h2><blockquote><p>å¦‚æœ<code>Message</code> ä½¿ç”¨åˆæˆçš„æ‹·è´æ§åˆ¶æˆå‘˜ï¼Œå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>åœ¨èµ‹å€¼åä¸€äº›å·²å­˜åœ¨çš„ <code>Folders</code> å°†ä¼šä¸ <code>Message</code> ä¸åŒæ­¥ã€‚</p><h2 id="ç»ƒä¹ 13-36"><a href="#ç»ƒä¹ 13-36" class="headerlink" title="ç»ƒä¹ 13.36"></a>ç»ƒä¹ 13.36</h2><blockquote><p>è®¾è®¡å¹¶å®ç°å¯¹åº”çš„ <code>Folder</code> ç±»ã€‚æ­¤ç±»åº”è¯¥ä¿å­˜ä¸€ä¸ªæŒ‡å‘ <code>Folder</code> ä¸­åŒ…å«  <code>Message</code> çš„ <code>set</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ13.34ã€‚</p><h2 id="ç»ƒä¹ 13-37"><a href="#ç»ƒä¹ 13-37" class="headerlink" title="ç»ƒä¹ 13.37"></a>ç»ƒä¹ 13.37</h2><blockquote><p>ä¸º <code>Message</code> ç±»æ·»åŠ æˆå‘˜ï¼Œå®ç°å‘ <code>folders</code> æ·»åŠ å’Œåˆ é™¤ä¸€ä¸ªç»™å®šçš„ <code>Folder*</code>ã€‚è¿™ä¸¤ä¸ªæˆå‘˜ç±»ä¼¼<code>Folder</code> ç±»çš„ <code>addMsg</code> å’Œ <code>remMsg</code> æ“ä½œã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ13.34ã€‚</p><h2 id="ç»ƒä¹ 13-38"><a href="#ç»ƒä¹ 13-38" class="headerlink" title="ç»ƒä¹ 13.38"></a>ç»ƒä¹ 13.38</h2><blockquote><p>æˆ‘ä»¬å¹¶æœªä½¿ç”¨æ‹·è´äº¤æ¢æ–¹å¼æ¥è®¾è®¡ <code>Message</code> çš„èµ‹å€¼è¿ç®—ç¬¦ã€‚ä½ è®¤ä¸ºå…¶åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>å¯¹äºåŠ¨æ€åˆ†é…å†…å­˜çš„ä¾‹å­æ¥è¯´ï¼Œæ‹·è´äº¤æ¢æ–¹å¼æ˜¯ä¸€ç§ç®€æ´çš„è®¾è®¡ã€‚è€Œè¿™é‡Œçš„ <code>Message</code> ç±»å¹¶ä¸éœ€è¦åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç”¨æ‹·è´äº¤æ¢æ–¹å¼åªä¼šå¢åŠ å®ç°çš„å¤æ‚åº¦ã€‚</p><h2 id="ç»ƒä¹ 13-39"><a href="#ç»ƒä¹ 13-39" class="headerlink" title="ç»ƒä¹ 13.39"></a>ç»ƒä¹ 13.39</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>StrVec</code>ï¼ŒåŒ…æ‹¬è‡ªå·±ç‰ˆæœ¬çš„ <code>reserve</code>ã€<code>capacity</code> å’Œ<code>resize</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token comment">// ç±»vectorç±»å†…å­˜åˆ†é…ç­–ç•¥çš„ç®€åŒ–å®ç°</span><span class="token keyword">class</span> <span class="token class-name">StrVec</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">elements</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first_free</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ‹·è´æ„é€ å‡½æ•°</span>    StrVec<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ‹·è´èµ‹å€¼è¿ç®—ç¬¦</span>    <span class="token operator">~</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ææ„å‡½æ•°</span>    <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ·»åŠ å…ƒç´ æ—¶æ‹·è´å…ƒç´ </span>    size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> cap <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    std<span class="token operator">::</span>string <span class="token operator">*</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token comment">// å·¥å…·å‡½æ•°ï¼Œè¢«æ‹·è´æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦å’Œææ„å‡½æ•°æ‰€ä½¿ç”¨</span>    std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token operator">></span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é”€æ¯å…ƒç´ å¹¶é‡Šæ”¾å†…å­˜</span><span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å·¥å…·å‡½æ•°ï¼Œè¢«æ·»åŠ å…ƒç´ çš„å‡½æ•°ä½¿ç”¨</span>    <span class="token keyword">void</span> <span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">//è·å¾—æ›´å¤šå†…å­˜å¹¶æ‹·è´å·²æœ‰å…ƒç´ </span>    <span class="token keyword">void</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">alloc_n_move</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>elements<span class="token punctuation">;</span>  <span class="token comment">// æŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„æŒ‡é’ˆ</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>first_free<span class="token punctuation">;</span>  <span class="token comment">// æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªç©ºé—²å…ƒç´ çš„æŒ‡é’ˆ</span>    std<span class="token operator">::</span>string <span class="token operator">*</span>cap<span class="token punctuation">;</span>  <span class="token comment">// æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªç©ºé—²å…ƒç´ çš„æŒ‡é’ˆ</span>    std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> alloc<span class="token punctuation">;</span>  <span class="token comment">// åˆ†é…å…ƒç´ </span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°å’Œä¸»å‡½æ•°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_13_39.h"</span></span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥ä¿å­˜ç»™å®šèŒƒå›´çš„å…ƒç´ ï¼Œå¹¶å°†è¿™äº›å…ƒç´ æ‹·è´åˆ°æ–°åˆ†é…çš„å†…å­˜ä¸­</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token punctuation">,</span> std<span class="token operator">::</span>string<span class="token operator">*</span><span class="token operator">></span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// åˆ†é…ç©ºé—´ä¿å­˜ç»™å®šèŒƒå›´ä¸­çš„å…ƒç´ </span><span class="token keyword">auto</span> data <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>e <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åˆå§‹åŒ–å¹¶è¿”å›ä¸€ä¸ªpairï¼Œè¯¥pairç”±dataå’Œuninitialized_copyçš„è¿”å›å€¼æ„æˆ</span>    <span class="token keyword">return</span><span class="token punctuation">&#123;</span> data<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">uninitialized_copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸èƒ½ä¼ é€’ç»™deallocateä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œå¦‚æœelementsä¸º0ï¼Œå‡½æ•°ä»€ä¹ˆä¹Ÿä¸åš</span><span class="token keyword">if</span> <span class="token punctuation">(</span>elements<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// é€†åºé”€æ¯å…ƒç´ </span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">=</span> first_free<span class="token punctuation">;</span> p <span class="token operator">!=</span> elements<span class="token punctuation">;</span><span class="token punctuation">)</span>            alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">--</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> cap <span class="token operator">-</span> elements<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// è°ƒç”¨alloc_n_copyåˆ†é…ç©ºé—´ä»¥å®¹çº³ä¸rhsä¸­ä¸€æ ·å¤šçš„å…ƒç´ </span><span class="token keyword">auto</span> newdata <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> newdata<span class="token punctuation">.</span>first<span class="token punctuation">;</span>    first_free <span class="token operator">=</span> cap <span class="token operator">=</span> newdata<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">StrVec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>StrVec<span class="token operator">&amp;</span> StrVec<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> StrVec <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// è°ƒç”¨alloc_n_copyåˆ†é…ç©ºé—´ä»¥å®¹çº³ä¸rhsä¸­ä¸€æ ·å¤šçš„å…ƒç´ </span><span class="token keyword">auto</span> data <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> data<span class="token punctuation">.</span>first<span class="token punctuation">;</span>    first_free <span class="token operator">=</span> cap <span class="token operator">=</span> data<span class="token punctuation">.</span>second<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">alloc_n_move</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> newdata <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> dest <span class="token operator">=</span> newdata<span class="token punctuation">;</span>    <span class="token keyword">auto</span> elem <span class="token operator">=</span> elements<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>dest<span class="token operator">++</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span>elem<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> newdata<span class="token punctuation">;</span>    first_free <span class="token operator">=</span> dest<span class="token punctuation">;</span>    cap <span class="token operator">=</span> elements <span class="token operator">+</span> new_cap<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> newcapacity <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">alloc_n_move</span><span class="token punctuation">(</span>newcapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t new_cap<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>new_cap <span class="token operator">&lt;=</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token function">alloc_n_move</span><span class="token punctuation">(</span>new_cap<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">resize</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>size_t count<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">reserve</span><span class="token punctuation">(</span>count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> count<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>first_free <span class="token operator">!=</span> elements <span class="token operator">+</span> count<span class="token punctuation">)</span>            alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">--</span>first_free<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-40"><a href="#ç»ƒä¹ 13-40" class="headerlink" title="ç»ƒä¹ 13.40"></a>ç»ƒä¹ 13.40</h2><blockquote><p>ä¸ºä½ çš„ <code>StrVec</code> ç±»æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ª <code>initializer_list&lt;string&gt;</code> å‚æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">StrVec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">range_initialize</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>first<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">*</span>last<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> newdata <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> newdata<span class="token punctuation">.</span>first<span class="token punctuation">;</span>    first_free <span class="token operator">=</span> cap <span class="token operator">=</span> newdata<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">StrVec</span><span class="token operator">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">range_initialize</span><span class="token punctuation">(</span>il<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> il<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-41"><a href="#ç»ƒä¹ 13-41" class="headerlink" title="ç»ƒä¹ 13.41"></a>ç»ƒä¹ 13.41</h2><blockquote><p>åœ¨ <code>push_back</code> ä¸­ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆåœ¨ <code>construct</code> è°ƒç”¨ä¸­ä½¿ç”¨åç½®é€’å¢è¿ç®—ï¼Ÿå¦‚æœä½¿ç”¨å‰ç½®é€’å¢è¿ç®—çš„è¯ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¼šå‡ºç° <code>unconstructed</code>ã€‚</p><h2 id="ç»ƒä¹ 13-42"><a href="#ç»ƒä¹ 13-42" class="headerlink" title="ç»ƒä¹ 13.42"></a>ç»ƒä¹ 13.42</h2><blockquote><p>åœ¨ä½ çš„ <code>TextQuery</code> å’Œ <code>QueryResult</code> ç±»ä¸­ç”¨ä½ çš„ <code>StrVec</code> ç±»ä»£æ›¿<code>vector&lt;string&gt;</code>ï¼Œä»¥æ­¤æ¥æµ‹è¯•ä½ çš„ <code>StrVec</code> ç±»ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 13-43"><a href="#ç»ƒä¹ 13-43" class="headerlink" title="ç»ƒä¹ 13.43"></a>ç»ƒä¹ 13.43</h2><blockquote><p>é‡å†™ <code>free</code> æˆå‘˜ï¼Œç”¨ <code>for_each</code> å’Œ <code>lambda</code> æ¥ä»£æ›¿ <code>for</code> å¾ªç¯ <code>destroy</code> å…ƒç´ ã€‚ä½ æ›´å€¾å‘äºå“ªç§å®ç°ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p><strong>é‡å†™</strong>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">for_each</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> first_free<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ›´å€¾å‘äºå‡½æ•°å¼å†™æ³•ã€‚</p><h2 id="ç»ƒä¹ 13-44"><a href="#ç»ƒä¹ 13-44" class="headerlink" title="ç»ƒä¹ 13.44"></a>ç»ƒä¹ 13.44</h2><blockquote><p>ç¼–å†™æ ‡å‡†åº“ <code>string</code> ç±»çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå‘½åä¸º <code>String</code>ã€‚ä½ çš„ç±»åº”è¯¥è‡³å°‘æœ‰ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°å’Œä¸€ä¸ªæ¥å— C é£æ ¼å­—ç¬¦ä¸²æŒ‡é’ˆå‚æ•°çš„æ„é€ å‡½æ•°ã€‚ä½¿ç”¨ <code>allocator</code> ä¸ºä½ çš„ <code>String</code>ç±»åˆ†é…æ‰€éœ€å†…å­˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¤´æ–‡ä»¶ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token keyword">class</span> <span class="token class-name">String</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>    <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> end <span class="token operator">-</span> elements<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    size_t <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> end <span class="token operator">-</span> elements <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>    std<span class="token operator">::</span>pair<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">range_initializer</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">char</span> <span class="token operator">*</span>elements<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>end<span class="token punctuation">;</span>    std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> alloc<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_13_44_47.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">alloc_n_copy</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> str <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>e <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">&#123;</span> str<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">uninitialized_copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">range_initializer</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>first<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>last<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> newstr <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>first<span class="token punctuation">,</span> last<span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> newstr<span class="token punctuation">.</span>first<span class="token punctuation">;</span>    end <span class="token operator">=</span> newstr<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>sl <span class="token operator">=</span> <span class="token keyword">const_cast</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>sl<span class="token punctuation">)</span>        <span class="token operator">++</span>sl<span class="token punctuation">;</span>    <span class="token function">range_initializer</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">++</span>sl<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">range_initializer</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>elements<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"copy constructor"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>elements<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span><span class="token function">for_each</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> end<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> end <span class="token operator">-</span> elements<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>String<span class="token operator">&amp;</span> String<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> newstr <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>elements<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    elements <span class="token operator">=</span> newstr<span class="token punctuation">.</span>first<span class="token punctuation">;</span>    end <span class="token operator">=</span> newstr<span class="token punctuation">.</span>second<span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"copy-assignment"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex13_44_47.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token comment">// Test reference to http://coolshell.cn/articles/10478.html</span><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span>String x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>String <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    String <span class="token function">ret</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> text<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"world"</span><span class="token punctuation">;</span>    String s0<span class="token punctuation">;</span>    String <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String <span class="token function">s2</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span><span class="token punctuation">;</span>    String s3 <span class="token operator">=</span> s1<span class="token punctuation">;</span>    String <span class="token function">s4</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">bar</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"temporary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token string">"temporary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String s5 <span class="token operator">=</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>String<span class="token operator">></span> svec<span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"good job"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>s <span class="token operator">:</span> svec<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒï¼š<a href="https://github.com/chenshuo/recipes/blob/fcf9486f5155117fb8c36b6b0944c5486c71c421/string/StringTrivial.h">A trivial String class that designed for write-on-paper in an interview</a></p><h2 id="ç»ƒä¹ 13-45"><a href="#ç»ƒä¹ 13-45" class="headerlink" title="ç»ƒä¹ 13.45"></a>ç»ƒä¹ 13.45</h2><blockquote><p>è§£é‡Šå·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨çš„åŒºåˆ«ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å®šä¹‰ï¼š</p><ul><li>å¸¸è§„å¼•ç”¨è¢«ç§°ä¸ºå·¦å€¼å¼•ç”¨</li><li>ç»‘å®šåˆ°å³å€¼çš„å¼•ç”¨è¢«ç§°ä¸ºå³å€¼å¼•ç”¨ã€‚</li></ul><h2 id="ç»ƒä¹ 13-46"><a href="#ç»ƒä¹ 13-46" class="headerlink" title="ç»ƒä¹ 13.46"></a>ç»ƒä¹ 13.46</h2><blockquote><p>ä»€ä¹ˆç±»å‹çš„å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸‹é¢çš„åˆå§‹åŒ–å™¨ä¸Šï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vi</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">?</span> r1 <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">?</span> r2 <span class="token operator">=</span> vi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">?</span> r3 <span class="token operator">=</span> r1<span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">?</span> r4 <span class="token operator">=</span> vi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vi</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">&amp;&amp;</span> r1 <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">&amp;</span> r2 <span class="token operator">=</span> vi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">&amp;</span> r3 <span class="token operator">=</span> r1<span class="token punctuation">;</span><span class="token keyword">int</span><span class="token operator">&amp;&amp;</span> r4 <span class="token operator">=</span> vi<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-47"><a href="#ç»ƒä¹ 13-47" class="headerlink" title="ç»ƒä¹ 13.47"></a>ç»ƒä¹ 13.47</h2><blockquote><p>å¯¹ä½ åœ¨ç»ƒä¹ 13.44ä¸­å®šä¹‰çš„ <code>String</code>ç±»ï¼Œä¸ºå®ƒçš„æ‹·è´æ„é€ å‡½æ•°å’Œæ‹·è´èµ‹å€¼è¿ç®—ç¬¦æ·»åŠ ä¸€æ¡è¯­å¥ï¼Œåœ¨æ¯æ¬¡å‡½æ•°æ‰§è¡Œæ—¶æ‰“å°ä¸€æ¡ä¿¡æ¯ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ13.44ã€‚</p><h2 id="ç»ƒä¹ 13-48"><a href="#ç»ƒä¹ 13-48" class="headerlink" title="ç»ƒä¹ 13.48"></a>ç»ƒä¹ 13.48</h2><blockquote><p>å®šä¹‰ä¸€ä¸ª<code>vector&lt;String&gt;</code> å¹¶åœ¨å…¶ä¸Šå¤šæ¬¡è°ƒç”¨ <code>push_back</code>ã€‚è¿è¡Œä½ çš„ç¨‹åºï¼Œå¹¶è§‚å¯Ÿ <code>String</code> è¢«æ‹·è´äº†å¤šå°‘æ¬¡ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ex_13_44_47.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token comment">// Test reference to http://coolshell.cn/articles/10478.html</span><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span>String x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>String <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    String <span class="token function">ret</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> text<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"world"</span><span class="token punctuation">;</span>    String s0<span class="token punctuation">;</span>    String <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String <span class="token function">s2</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span><span class="token punctuation">;</span>    String s3 <span class="token operator">=</span> s1<span class="token punctuation">;</span>    String <span class="token function">s4</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">bar</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"temporary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token string">"temporary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String s5 <span class="token operator">=</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>String<span class="token operator">></span> svec<span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s3<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    svec<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">"good job"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>s <span class="token operator">:</span> svec<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-49"><a href="#ç»ƒä¹ 13-49" class="headerlink" title="ç»ƒä¹ 13.49"></a>ç»ƒä¹ 13.49</h2><blockquote><p>ä¸ºä½ çš„ <code>StrVec</code>ã€<code>String</code> å’Œ <code>Message</code> ç±»æ·»åŠ ä¸€ä¸ªç§»åŠ¨æ„é€ å‡½æ•°å’Œä¸€ä¸ªç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 13-50"><a href="#ç»ƒä¹ 13-50" class="headerlink" title="ç»ƒä¹ 13.50"></a>ç»ƒä¹ 13.50</h2><blockquote><p>åœ¨ä½ çš„ <code>String</code> ç±»çš„ç§»åŠ¨æ“ä½œä¸­æ·»åŠ æ‰“å°è¯­å¥ï¼Œå¹¶é‡æ–°è¿è¡Œ13.6.1èŠ‚çš„ç»ƒä¹ 13.48ä¸­çš„ç¨‹åºï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ª<code>vector&lt;String&gt;</code>ï¼Œè§‚å¯Ÿä»€ä¹ˆæ—¶å€™ä¼šé¿å…æ‹·è´ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">String <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    String <span class="token function">ret</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span> <span class="token comment">// first avoided</span><span class="token punctuation">&#125;</span>String s5 <span class="token operator">=</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// second avoided</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-51"><a href="#ç»ƒä¹ 13-51" class="headerlink" title="ç»ƒä¹ 13.51"></a>ç»ƒä¹ 13.51</h2><blockquote><p>è™½ç„¶ <code>unique_ptr</code> ä¸èƒ½æ‹·è´ï¼Œä½†æˆ‘ä»¬åœ¨12.1.5èŠ‚ä¸­ç¼–å†™äº†ä¸€ä¸ª <code>clone</code> å‡½æ•°ï¼Œå®ƒä»¥å€¼çš„æ–¹å¼è¿”å›ä¸€ä¸ª <code>unique_ptr</code>ã€‚è§£é‡Šä¸ºä»€ä¹ˆå‡½æ•°æ˜¯åˆæ³•çš„ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒèƒ½æ­£ç¡®å·¥ä½œã€‚</p></blockquote><p>è§£ï¼š</p><p>åœ¨è¿™é‡Œæ˜¯ç§»åŠ¨çš„æ“ä½œè€Œä¸æ˜¯æ‹·è´æ“ä½œï¼Œå› æ­¤æ˜¯åˆæ³•çš„ã€‚</p><h2 id="ç»ƒä¹ 13-52"><a href="#ç»ƒä¹ 13-52" class="headerlink" title="ç»ƒä¹ 13.52"></a>ç»ƒä¹ 13.52</h2><blockquote><p>è¯¦ç»†è§£é‡Šç¬¬478é¡µä¸­çš„ <code>HasPtr</code> å¯¹è±¡çš„èµ‹å€¼å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿç‰¹åˆ«æ˜¯ï¼Œä¸€æ­¥ä¸€æ­¥æè¿° <code>hp</code>ã€<code>hp2</code> ä»¥åŠ <code>HasPtr</code> çš„èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„å‚æ•° <code>rhs</code> çš„å€¼å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ã€‚</p></blockquote><p>è§£ï¼š</p><p>å·¦å€¼è¢«æ‹·è´ï¼Œå³å€¼è¢«ç§»åŠ¨ã€‚</p><h2 id="ç»ƒä¹ 13-53"><a href="#ç»ƒä¹ 13-53" class="headerlink" title="ç»ƒä¹ 13.53"></a>ç»ƒä¹ 13.53</h2><blockquote><p>ä»åº•å±‚æ•ˆç‡çš„è§’åº¦çœ‹ï¼Œ<code>HasPtr</code> çš„èµ‹å€¼è¿ç®—ç¬¦å¹¶ä¸ç†æƒ³ï¼Œè§£é‡Šä¸ºä»€ä¹ˆï¼Ÿä¸º <code>HasPtr</code> å®ç°ä¸€ä¸ªæ‹·è´èµ‹å€¼è¿ç®—ç¬¦å’Œä¸€ä¸ªç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œå¹¶æ¯”è¾ƒä½ çš„æ–°çš„ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä¸­æ‰§è¡Œçš„æ“ä½œå’Œæ‹·è´å¹¶äº¤æ¢ç‰ˆæœ¬ä¸­çš„æ‰§è¡Œçš„æ“ä½œã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/21010371/why-is-it-not-efficient-to-use-a-single-assignment-operator-handling-both-copy-a">https://stackoverflow.com/questions/21010371/why-is-it-not-efficient-to-use-a-single-assignment-operator-handling-both-copy-a</a></p><h2 id="ç»ƒä¹ 13-54"><a href="#ç»ƒä¹ 13-54" class="headerlink" title="ç»ƒä¹ 13.54"></a>ç»ƒä¹ 13.54</h2><blockquote><p>å¦‚æœæˆ‘ä»¬ä¸º <code>HasPtr</code> å®šä¹‰äº†ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œä½†æœªæ”¹å˜æ‹·è´å¹¶äº¤æ¢è¿ç®—ç¬¦ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç¼–å†™ä»£ç éªŒè¯ä½ çš„ç­”æ¡ˆã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">error<span class="token operator">:</span> ambiguous overload <span class="token keyword">for</span> <span class="token string">'operator='</span> <span class="token punctuation">(</span>operand types are <span class="token string">'HasPtr'</span> <span class="token operator">and</span> <span class="token string">'std::remove_reference&lt;HasPtr&amp;>::type &#123; aka HasPtr &#125;'</span><span class="token punctuation">)</span>hp1 <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span>pH<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">^</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-55"><a href="#ç»ƒä¹ 13-55" class="headerlink" title="ç»ƒä¹ 13.55"></a>ç»ƒä¹ 13.55</h2><blockquote><p>ä¸ºä½ çš„ <code>StrBlob</code> æ·»åŠ ä¸€ä¸ªå³å€¼å¼•ç”¨ç‰ˆæœ¬çš„ <code>push_back</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span>string <span class="token operator">&amp;&amp;</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 13-56"><a href="#ç»ƒä¹ 13-56" class="headerlink" title="ç»ƒä¹ 13.56"></a>ç»ƒä¹ 13.56</h2><blockquote><p>å¦‚æœ <code>sorted</code> å®šä¹‰å¦‚ä¸‹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Foo <span class="token class-name">Foo</span><span class="token operator">::</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>Foo <span class="token function">ret</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>ä¼šäº§ç”Ÿé€’å½’å¹¶ä¸”æœ€ç»ˆæº¢å‡ºã€‚</p><h2 id="ç»ƒä¹ 13-57"><a href="#ç»ƒä¹ 13-57" class="headerlink" title="ç»ƒä¹ 13.57"></a>ç»ƒä¹ 13.57</h2><blockquote><p>å¦‚æœ <code>sorted</code>å®šä¹‰å¦‚ä¸‹ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Foo <span class="token class-name">Foo</span><span class="token operator">::</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>æ²¡é—®é¢˜ã€‚ä¼šè°ƒç”¨ç§»åŠ¨ç‰ˆæœ¬ã€‚</p><h2 id="ç»ƒä¹ 13-58"><a href="#ç»ƒä¹ 13-58" class="headerlink" title="ç»ƒä¹ 13.58"></a>ç»ƒä¹ 13.58</h2><blockquote><p>ç¼–å†™æ–°ç‰ˆæœ¬çš„ <code>Foo</code> ç±»ï¼Œå…¶ <code>sorted</code> å‡½æ•°ä¸­æœ‰æ‰“å°è¯­å¥ï¼Œæµ‹è¯•è¿™ä¸ªç±»ï¼Œæ¥éªŒè¯ä½ å¯¹å‰ä¸¤é¢˜çš„ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm></span></span><span class="token keyword">using</span> std<span class="token operator">::</span>vector<span class="token punctuation">;</span> <span class="token keyword">using</span> std<span class="token operator">::</span>sort<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    Foo <span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><span class="token punctuation">;</span>    Foo <span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> data<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>Foo <span class="token class-name">Foo</span><span class="token operator">::</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">&#123;</span>    <span class="token function">sort</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"&amp;&amp;"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// debug</span>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Foo <span class="token class-name">Foo</span><span class="token operator">::</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span><span class="token comment">//    Foo ret(*this);</span><span class="token comment">//    sort(ret.data.begin(), ret.data.end());</span><span class="token comment">//    return ret;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"const &amp;"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// debug</span><span class="token comment">//    Foo ret(*this);</span><span class="token comment">//    ret.sorted();     // Exercise 13.56</span><span class="token comment">//    return ret;</span>    <span class="token keyword">return</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Exercise 13.57</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// call "&amp;&amp;"</span>    Foo f<span class="token punctuation">;</span>    f<span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// call "const &amp;"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cpp-primerè¯¾åç­”æ¡ˆ17</title>
      <link href="2021/04/10/excersize/ch16/"/>
      <url>2021/04/10/excersize/ch16/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¬åå…­ç« -æ¨¡æ¿ç¼–ç¨‹ä¸æ³›å‹ç¼–ç¨‹"><a href="#ç¬¬åå…­ç« -æ¨¡æ¿ç¼–ç¨‹ä¸æ³›å‹ç¼–ç¨‹" class="headerlink" title="ç¬¬åå…­ç«  æ¨¡æ¿ç¼–ç¨‹ä¸æ³›å‹ç¼–ç¨‹"></a>ç¬¬åå…­ç«  æ¨¡æ¿ç¼–ç¨‹ä¸æ³›å‹ç¼–ç¨‹</h1><h2 id="ç»ƒä¹ 16-1"><a href="#ç»ƒä¹ 16-1" class="headerlink" title="ç»ƒä¹ 16.1"></a>ç»ƒä¹ 16.1</h2><blockquote><p>ç»™å‡ºå®ä¾‹åŒ–çš„å®šä¹‰ã€‚</p></blockquote><p>è§£ï¼š</p><p>å½“ç¼–è¯‘å™¨å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡ç‰ˆæ—¶ï¼Œå®ƒä½¿ç”¨å®é™…çš„æ¨¡ç‰ˆå‚æ•°ä»£æ›¿å¯¹åº”çš„æ¨¡ç‰ˆå‚æ•°æ¥åˆ›å»ºå‡ºæ¨¡ç‰ˆçš„ä¸€ä¸ªæ–°â€œå®ä¾‹â€ã€‚</p><h2 id="ç»ƒä¹ 16-2"><a href="#ç»ƒä¹ 16-2" class="headerlink" title="ç»ƒä¹ 16.2"></a>ç»ƒä¹ 16.2</h2><blockquote><p>ç¼–å†™å¹¶æµ‹è¯•ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>compare</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>lhs <span class="token operator">&lt;</span> rhs<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>rhs <span class="token operator">&lt;</span> lhs<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-3"><a href="#ç»ƒä¹ 16-3" class="headerlink" title="ç»ƒä¹ 16.3"></a>ç»ƒä¹ 16.3</h2><blockquote><p>å¯¹ä¸¤ä¸ª <code>Sales_data</code> å¯¹è±¡è°ƒç”¨ä½ çš„ <code>compare</code> å‡½æ•°ï¼Œè§‚å¯Ÿç¼–è¯‘å™¨åœ¨å®ä¾‹åŒ–è¿‡ç¨‹ä¸­å¦‚ä½•å¤„ç†é”™è¯¯ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>error: no match for &#39;operator&lt;&#39; </code></p><h2 id="ç»ƒä¹ 16-4"><a href="#ç»ƒä¹ 16-4" class="headerlink" title="ç»ƒä¹ 16.4"></a>ç»ƒä¹ 16.4</h2><blockquote><p>ç¼–å†™è¡Œä¸ºç±»ä¼¼æ ‡å‡†åº“ <code>find</code> ç®—æ³•çš„æ¨¡ç‰ˆã€‚å‡½æ•°éœ€è¦ä¸¤ä¸ªæ¨¡ç‰ˆç±»å‹å‚æ•°ï¼Œä¸€ä¸ªè¡¨ç¤ºå‡½æ•°çš„è¿­ä»£å™¨å‚æ•°ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºå€¼çš„ç±»å‹ã€‚ä½¿ç”¨ä½ çš„å‡½æ•°åœ¨ä¸€ä¸ª <code>vector&lt;int&gt;</code> å’Œä¸€ä¸ª<code>list&lt;string&gt;</code>ä¸­æŸ¥æ‰¾ç»™å®šå€¼ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Iterator</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">Value</span><span class="token operator">></span>Iterator <span class="token function">find</span><span class="token punctuation">(</span>Iterator first<span class="token punctuation">,</span> Iterator last<span class="token punctuation">,</span> <span class="token keyword">const</span> Value<span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token punctuation">;</span> first <span class="token operator">!=</span> last <span class="token operator">&amp;&amp;</span> <span class="token operator">*</span>first <span class="token operator">!=</span> value<span class="token punctuation">;</span> <span class="token operator">++</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> first<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-5"><a href="#ç»ƒä¹ 16-5" class="headerlink" title="ç»ƒä¹ 16.5"></a>ç»ƒä¹ 16.5</h2><blockquote><p>ä¸º6.2.4èŠ‚ä¸­çš„<code>print</code>å‡½æ•°ç¼–å†™æ¨¡ç‰ˆç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„çš„å¼•ç”¨ï¼Œèƒ½å¤„ç†ä»»æ„å¤§å°ã€ä»»æ„å…ƒç´ ç±»å‹çš„æ•°ç»„ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Array</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> Array<span class="token operator">&amp;</span> arr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> elem <span class="token operator">:</span> arr<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> elem <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-6"><a href="#ç»ƒä¹ 16-6" class="headerlink" title="ç»ƒä¹ 16.6"></a>ç»ƒä¹ 16.6</h2><blockquote><p>ä½ è®¤ä¸ºæ¥å—ä¸€ä¸ªæ•°ç»„å®å‚çš„æ ‡å‡†åº“å‡½æ•° <code>begin</code> å’Œ <code>end</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå®šä¹‰ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>begin</code> å’Œ <code>end</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> N<span class="token operator">></span>T<span class="token operator">*</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> arr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> N<span class="token operator">></span>T<span class="token operator">*</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> arr <span class="token operator">+</span> N<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-7"><a href="#ç»ƒä¹ 16-7" class="headerlink" title="ç»ƒä¹ 16.7"></a>ç»ƒä¹ 16.7</h2><blockquote><p>ç¼–å†™ä¸€ä¸ª <code>constexpr</code> æ¨¡ç‰ˆï¼Œè¿”å›ç»™å®šæ•°ç»„çš„å¤§å°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">N</span><span class="token operator">></span> <span class="token keyword">constexpr</span><span class="token keyword">unsigned</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token function">T</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> N<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-8"><a href="#ç»ƒä¹ 16-8" class="headerlink" title="ç»ƒä¹ 16.8"></a>ç»ƒä¹ 16.8</h2><blockquote><p>åœ¨ç¬¬97é¡µçš„â€œå…³é”®æ¦‚å¿µâ€ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒC++ç¨‹åºå‘˜å–œæ¬¢ä½¿ç”¨ <code>!=</code> è€Œä¸å–œæ¬¢ <code>&lt;</code> ã€‚è§£é‡Šè¿™ä¸ªä¹ æƒ¯çš„åŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>å› ä¸ºå¤§å¤šæ•°ç±»åªå®šä¹‰äº† <code>!=</code> æ“ä½œè€Œæ²¡æœ‰å®šä¹‰ <code>&lt;</code> æ“ä½œï¼Œä½¿ç”¨ <code>!=</code> å¯ä»¥é™ä½å¯¹è¦å¤„ç†çš„ç±»å‹çš„è¦æ±‚ã€‚</p><h2 id="ç»ƒä¹ 16-9"><a href="#ç»ƒä¹ 16-9" class="headerlink" title="ç»ƒä¹ 16.9"></a>ç»ƒä¹ 16.9</h2><blockquote><p>ä»€ä¹ˆæ˜¯å‡½æ•°æ¨¡ç‰ˆï¼Œä»€ä¹ˆæ˜¯ç±»æ¨¡ç‰ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸€ä¸ªå‡½æ•°æ¨¡ç‰ˆå°±æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œå¯ç”¨æ¥ç”Ÿæˆé’ˆå¯¹ç‰¹å®šç±»å‹çš„å‡½æ•°ç‰ˆæœ¬ã€‚ç±»æ¨¡ç‰ˆæ˜¯ç”¨æ¥ç”Ÿæˆç±»çš„è“å›¾çš„ï¼Œä¸å‡½æ•°æ¨¡ç‰ˆçš„ä¸åŒä¹‹å¤„æ˜¯ï¼Œç¼–è¯‘å™¨ä¸èƒ½ä¸ºç±»æ¨¡ç‰ˆæ¨æ–­æ¨¡ç‰ˆå‚æ•°ç±»å‹ã€‚å¦‚æœæˆ‘ä»¬å·²ç»å¤šæ¬¡çœ‹åˆ°ï¼Œä¸ºäº†ä½¿ç”¨ç±»æ¨¡ç‰ˆï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ¨¡ç‰ˆååçš„å°–æ‹¬å·ä¸­æä¾›é¢å¤–ä¿¡æ¯ã€‚</p><h2 id="ç»ƒä¹ 16-10"><a href="#ç»ƒä¹ 16-10" class="headerlink" title="ç»ƒä¹ 16.10"></a>ç»ƒä¹ 16.10</h2><blockquote><p>å½“ä¸€ä¸ªç±»æ¨¡ç‰ˆè¢«å®ä¾‹åŒ–æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸€ä¸ªç±»æ¨¡ç‰ˆçš„æ¯ä¸ªå®ä¾‹éƒ½å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„ç±»ã€‚</p><h2 id="ç»ƒä¹ 16-11"><a href="#ç»ƒä¹ 16-11" class="headerlink" title="ç»ƒä¹ 16.11"></a>ç»ƒä¹ 16.11</h2><blockquote><p>ä¸‹é¢ <code>List</code> çš„å®šä¹‰æ˜¯é”™è¯¯çš„ã€‚åº”å¦‚ä½•ä¿®æ”¹å®ƒï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">elemType</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">ListItem</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">elemType</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">List</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> List<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> List<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>ListItem <span class="token operator">*</span>ptr<span class="token punctuation">,</span> elemType value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>ListItem <span class="token operator">*</span>front<span class="token punctuation">,</span> <span class="token operator">*</span>end<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>æ¨¡ç‰ˆéœ€è¦æ¨¡ç‰ˆå‚æ•°ï¼Œåº”è¯¥ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">elemType</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">ListItem</span><span class="token punctuation">;</span>  <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">elemType</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">List</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span><span class="token operator">:</span>    List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> List<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>elemType<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> List<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>ListItem<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> elemType value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">private</span><span class="token operator">:</span>    ListItem<span class="token operator">&lt;</span>elemType<span class="token operator">></span> <span class="token operator">*</span>front<span class="token punctuation">,</span> <span class="token operator">*</span>end<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-12"><a href="#ç»ƒä¹ 16-12" class="headerlink" title="ç»ƒä¹ 16.12"></a>ç»ƒä¹ 16.12</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>Blob</code> å’Œ <code>BlobPtr</code> æ¨¡ç‰ˆï¼ŒåŒ…å«ä¹¦ä¸­æœªå®šä¹‰çš„å¤šä¸ª<code>const</code>æˆå‘˜ã€‚</p></blockquote><p>è§£ï¼š</p><p>Blobï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">Blob</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">typedef</span> T value_type<span class="token punctuation">;</span><span class="token keyword">typedef</span> <span class="token keyword">typename</span> <span class="token class-name">std</span><span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span>size_type size_type<span class="token punctuation">;</span><span class="token comment">// constructors</span><span class="token function">Blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Blob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">></span> il<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// number of elements in the Blob</span>size_type <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">bool</span>      <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span>T<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> data<span class="token operator">-></span><span class="token function">push_back</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// element access</span>T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> data<span class="token punctuation">;</span><span class="token comment">// throw msg if data[i] isn't valid</span><span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// constructors</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Blob</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">></span> il<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">check</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> data<span class="token operator">-></span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">out_of_range</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>T<span class="token operator">&amp;</span> <span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty Blob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"back on empty Blob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> data<span class="token operator">-></span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>T<span class="token operator">&amp;</span> Blob<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// if i is too big, check function will throw, preventing access to a nonexistent element</span><span class="token function">check</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"subscript out of range"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> Blob<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_type i<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token comment">// if i is too big, check function will throw, preventing access to a nonexistent element</span><span class="token function">check</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"subscript out of range"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"pop_back on empty Blob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>data<span class="token operator">-></span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>BlobPtrï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Blob.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">BlobPtr</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">BlobPtr</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">BlobPtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">curr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">BlobPtr</span><span class="token punctuation">(</span>Blob<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span> std<span class="token operator">::</span>size_t sz <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">wptr</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">curr</span><span class="token punctuation">(</span>sz<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">auto</span> p <span class="token operator">=</span> <span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"dereference past end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// prefix</span>BlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>BlobPtr<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// postfix</span>BlobPtr <span class="token keyword">operator</span> <span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>BlobPtr <span class="token keyword">operator</span> <span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// returns  a shared_ptr to the vector if the check succeeds</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token function">check</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>std<span class="token operator">::</span>weak_ptr<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span> wptr<span class="token punctuation">;</span>std<span class="token operator">::</span>size_t curr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// prefix ++</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// if curr already points past the end of the container, can't increment it</span><span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"increment past end of StrBlob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>curr<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// prefix --</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">--</span>curr<span class="token punctuation">;</span><span class="token function">check</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> <span class="token string">"decrement past begin of BlobPtr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// postfix ++</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>BlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token operator">++</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// postfix --</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>BlobPtr ret <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token operator">--</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> rhs<span class="token punctuation">.</span>wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">throw</span> <span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"ptrs to different Blobs!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>i <span class="token operator">==</span> rhs<span class="token punctuation">.</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> BlobPtr<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> rhs<span class="token punctuation">.</span>wptr<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">throw</span> <span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"ptrs to different Blobs!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> lhs<span class="token punctuation">.</span>i <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-13"><a href="#ç»ƒä¹ 16-13" class="headerlink" title="ç»ƒä¹ 16.13"></a>ç»ƒä¹ 16.13</h2><blockquote><p>è§£é‡Šä½ ä¸º <code>BlobPtr</code> çš„ç›¸ç­‰å’Œå…³ç³»è¿ç®—ç¬¦é€‰æ‹©å“ªç§ç±»å‹çš„å‹å¥½å…³ç³»ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>è¿™é‡Œéœ€è¦ä¸ç±»å‹ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥å°±é€‰æ‹©ä¸€å¯¹ä¸€å‹å¥½å…³ç³»ã€‚</p><h2 id="ç»ƒä¹ 16-14"><a href="#ç»ƒä¹ 16-14" class="headerlink" title="ç»ƒä¹ 16.14"></a>ç»ƒä¹ 16.14</h2><blockquote><p>ç¼–å†™ <code>Screen</code> ç±»æ¨¡ç‰ˆï¼Œç”¨éç±»å‹å‚æ•°å®šä¹‰ <code>Screen</code> çš„é«˜å’Œå®½ã€‚</p></blockquote><p>è§£ï¼š</p><p>Screen</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">unsigned</span> H<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> W<span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">Screen</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token keyword">typedef</span> std<span class="token operator">::</span>string<span class="token operator">::</span>size_type pos<span class="token punctuation">;</span><span class="token function">Screen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> <span class="token comment">// needed because Screen has another constructor</span><span class="token comment">// cursor initialized to 0 by its in-class initializer</span><span class="token function">Screen</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">contents</span><span class="token punctuation">(</span>H <span class="token operator">*</span> W<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">char</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>              <span class="token comment">// get the character at the cursor</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> contents<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>       <span class="token comment">// implicitly inline</span>Screen <span class="token operator">&amp;</span><span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// can be made inline later</span><span class="token keyword">friend</span> std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>ostream <span class="token operator">&amp;</span>os<span class="token punctuation">,</span> <span class="token keyword">const</span> Screen<span class="token operator">&lt;</span>H<span class="token punctuation">,</span> W<span class="token operator">></span> <span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>c<span class="token punctuation">.</span>height<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">.</span>contents<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> W<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">friend</span> std<span class="token operator">::</span>istream <span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">>></span> <span class="token punctuation">(</span>std<span class="token operator">::</span>istream <span class="token operator">&amp;</span>is<span class="token punctuation">,</span> Screen <span class="token operator">&amp;</span>  c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> a<span class="token punctuation">;</span>is <span class="token operator">>></span> a<span class="token punctuation">;</span>std<span class="token operator">::</span>string <span class="token function">temp</span><span class="token punctuation">(</span>H<span class="token operator">*</span>W<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token punctuation">.</span>contents <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token keyword">return</span> is<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>pos cursor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>pos height <span class="token operator">=</span> H<span class="token punctuation">,</span> width <span class="token operator">=</span> W<span class="token punctuation">;</span>std<span class="token operator">::</span>string contents<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">unsigned</span> H<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> W<span class="token operator">></span><span class="token keyword">inline</span> Screen<span class="token operator">&lt;</span>H<span class="token punctuation">,</span> W<span class="token operator">></span><span class="token operator">&amp;</span> <span class="token class-name">Screen</span><span class="token operator">&lt;</span>H<span class="token punctuation">,</span> W<span class="token operator">></span><span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>pos r<span class="token punctuation">,</span> pos c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>pos row <span class="token operator">=</span> r <span class="token operator">*</span> width<span class="token punctuation">;</span>cursor <span class="token operator">=</span> row <span class="token operator">+</span> c<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-15"><a href="#ç»ƒä¹ 16-15" class="headerlink" title="ç»ƒä¹ 16.15"></a>ç»ƒä¹ 16.15</h2><blockquote><p>ä¸ºä½ çš„ <code>Screen</code> æ¨¡ç‰ˆå®ç°è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦ã€‚<code>Screen</code> ç±»éœ€è¦å“ªäº›å‹å…ƒï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰æ¥ä»¤è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦æ­£ç¡®å·¥ä½œï¼Ÿè§£é‡Šæ¯ä¸ªå‹å…ƒå£°æ˜ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¸ºä»€ä¹ˆæ˜¯å¿…è¦çš„ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç±»çš„ <code>operator&lt;&lt;</code> å’Œ <code>operator&gt;&gt;</code> åº”è¯¥æ˜¯ç±»çš„å‹å…ƒã€‚</p><h2 id="ç»ƒä¹ 16-16"><a href="#ç»ƒä¹ 16-16" class="headerlink" title="ç»ƒä¹ 16.16"></a>ç»ƒä¹ 16.16</h2><blockquote><p>å°† <code>StrVec</code> ç±»é‡å†™ä¸ºæ¨¡ç‰ˆï¼Œå‘½åä¸º <code>Vec</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>Vec:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory></span></span><span class="token comment">/***  @brief a vector like class*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">Vec</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">Vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">element</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">first_free</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token function">Vec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">></span> l<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">Vec</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vec<span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>Vec<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vec<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">Vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// memmbers</span><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free <span class="token operator">-</span> element<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>std<span class="token operator">::</span>size_t <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> cap <span class="token operator">-</span> element<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>T<span class="token operator">*</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> element<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>T<span class="token operator">*</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> first_free<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span><span class="token comment">// data members</span>T<span class="token operator">*</span> element<span class="token punctuation">;</span>T<span class="token operator">*</span> first_free<span class="token punctuation">;</span>T<span class="token operator">*</span> cap<span class="token punctuation">;</span>std<span class="token operator">::</span>allocator<span class="token operator">&lt;</span>T<span class="token operator">></span> alloc<span class="token punctuation">;</span><span class="token comment">// utillities</span><span class="token keyword">void</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">wy_alloc_n_move</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">;</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>T<span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">></span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>T<span class="token operator">*</span> b<span class="token punctuation">,</span> T<span class="token operator">*</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// copy constructor</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Vec</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vec <span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">/*** @brief newData is a pair of pointers pointing to newly allocated and copied*        from range : [b, e)*/</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>T<span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">></span> newData <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>element <span class="token operator">=</span> newData<span class="token punctuation">.</span>first<span class="token punctuation">;</span>first_free <span class="token operator">=</span> cap <span class="token operator">=</span> newData<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// constructor that takes initializer_list&lt;T></span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Vec</span><span class="token punctuation">(</span>std<span class="token operator">::</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">></span> l<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// allocate memory as large as l.size()</span>T<span class="token operator">*</span> <span class="token keyword">const</span> newData <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// copy elements from l to the address allocated</span>T<span class="token operator">*</span> p <span class="token operator">=</span> newData<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span>t <span class="token operator">:</span> l<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>p<span class="token operator">++</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// build data structure</span>element <span class="token operator">=</span> newData<span class="token punctuation">;</span>first_free <span class="token operator">=</span> cap <span class="token operator">=</span> element <span class="token operator">+</span> l<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// operator =</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>Vec<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> Vec<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vec<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// allocate and copy first to protect against self_assignment</span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>T<span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">></span> newData <span class="token operator">=</span> <span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// destroy and deallocate</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// update data structure</span>element <span class="token operator">=</span> newData<span class="token punctuation">.</span>first<span class="token punctuation">;</span>first_free <span class="token operator">=</span> cap <span class="token operator">=</span> newData<span class="token punctuation">.</span>second<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// destructor</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>Vec<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">Vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   allocate new memeory if nessary and push back the new T* @param t new T*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   preallocate enough memory for specified number of elements* @param n number of elements required*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// if n too small, just return without doing anything</span><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">// allocate new memory and move data from old address to the new one</span><span class="token function">wy_alloc_n_move</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/***  @brief  Resizes to the specified number of elements.*  @param  n  Number of elements the %vector should contain.**  This function will resize it to the specified*  number of elements.  If the number is smaller than the*  current size it is truncated, otherwise*  default constructed elements are appended.*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">resize</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/***  @brief  Resizes it to the specified number of elements.*  @param  __new_size  Number of elements it should contain.*  @param  __x  Data with which new elements should be populated.**  This function will resize it to the specified*  number of elements.  If the number is smaller than the*  current size the it is truncated, otherwise*  the it is extended and new elements are populated with*  given data.*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">resize</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">const</span> T <span class="token operator">&amp;</span>t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// destroy the range [element+n, first_free) using destructor</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">=</span> element <span class="token operator">+</span> n<span class="token punctuation">;</span> p <span class="token operator">!=</span> first_free<span class="token punctuation">;</span><span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span>p<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// update first_free to point to the new address</span>first_free <span class="token operator">=</span> element <span class="token operator">+</span> n<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> i <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token function">push_back</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   allocate new space for the given range and copy them into it* @param b* @param e* @return  a pair of pointers pointing to [first element , one past the last) in the new space*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>std<span class="token operator">::</span>pair<span class="token operator">&lt;</span>T<span class="token operator">*</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">></span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">alloc_n_copy</span><span class="token punctuation">(</span>T <span class="token operator">*</span>b<span class="token punctuation">,</span> T <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// calculate the size needed and allocate space accordingly</span>T<span class="token operator">*</span> data <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>e <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">&#123;</span> data<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">uninitialized_copy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="token comment">// which copies the range[first, last) to the space to which</span><span class="token comment">// the starting address data is pointing.</span><span class="token comment">// This function returns a pointer to one past the last element</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   destroy the elements and deallocate the space previously allocated.*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// if not nullptr</span><span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// destroy it in reverse order.</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> p <span class="token operator">=</span> first_free<span class="token punctuation">;</span> p <span class="token operator">!=</span> element<span class="token punctuation">;</span><span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token operator">--</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>alloc<span class="token punctuation">.</span><span class="token function">deallocate</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   allocate memory for spicified number of elements* @param n* @note    it's user's responsibility to ensure that @param n is greater than*          the current capacity.*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">wy_alloc_n_move</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// allocate as required.</span>std<span class="token operator">::</span>size_t newCapacity <span class="token operator">=</span> n<span class="token punctuation">;</span>T<span class="token operator">*</span> newData <span class="token operator">=</span> alloc<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// move the data from old place to the new one</span>T<span class="token operator">*</span> dest <span class="token operator">=</span> newData<span class="token punctuation">;</span>T<span class="token operator">*</span> old <span class="token operator">=</span> element<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>dest<span class="token operator">++</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span>old<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// update data structure</span>element <span class="token operator">=</span> newData<span class="token punctuation">;</span>first_free <span class="token operator">=</span> dest<span class="token punctuation">;</span>cap <span class="token operator">=</span> element <span class="token operator">+</span> newCapacity<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** @brief   Double the capacity and using std::move move the original data to the newly*          allocated memory*/</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">reallocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// calculate the new capacity required</span>std<span class="token operator">::</span>size_t newCapacity <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// allocate and move old data to the new space</span><span class="token function">wy_alloc_n_move</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-17"><a href="#ç»ƒä¹ 16-17" class="headerlink" title="ç»ƒä¹ 16.17"></a>ç»ƒä¹ 16.17</h2><blockquote><p>å£°æ˜ä¸º <code>typename</code> çš„ç±»å‹å‚æ•°å’Œå£°æ˜ä¸º <code>class</code> çš„ç±»å‹å‚æ•°æœ‰ä»€ä¹ˆä¸åŒï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Ÿä»€ä¹ˆæ—¶å€™å¿…é¡»ä½¿ç”¨<code>typename</code>ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚å½“æˆ‘ä»¬å¸Œæœ›é€šçŸ¥ç¼–è¯‘å™¨ä¸€ä¸ªåå­—è¡¨ç¤ºç±»å‹æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å…³é”®å­— <code>typename</code>ï¼Œè€Œä¸èƒ½ä½¿ç”¨ <code>class</code>ã€‚</p><h2 id="ç»ƒä¹ 16-18"><a href="#ç»ƒä¹ 16-18" class="headerlink" title="ç»ƒä¹ 16.18"></a>ç»ƒä¹ 16.18</h2><blockquote><p>è§£é‡Šä¸‹é¢æ¯ä¸ªå‡½æ•°æ¨¡ç‰ˆå£°æ˜å¹¶æŒ‡å‡ºå®ƒä»¬æ˜¯å¦éæ³•ã€‚æ›´æ­£ä½ å‘ç°çš„æ¯ä¸ªé”™è¯¯ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> U<span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">V</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> T <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">inline</span> <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> T <span class="token function">foo</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token function">f4</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token keyword">typedef</span> <span class="token keyword">char</span> Ctype<span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Ctype</span><span class="token operator">></span> Ctype <span class="token function">f5</span><span class="token punctuation">(</span>Ctype a<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) éæ³•ã€‚åº”è¯¥ä¸º <code>template &lt;typename T, typename U, typename V&gt; void f1(T, U, V);</code>ã€‚</li><li>(b) éæ³•ã€‚åº”è¯¥ä¸º <code>template &lt;typename T&gt; T f2(int &amp;t);</code></li><li>(c) éæ³•ã€‚åº”è¯¥ä¸º <code>template &lt;typename T&gt; inline T foo(T, unsigned int*);</code></li><li>(d) éæ³•ã€‚åº”è¯¥ä¸º <code>template &lt;typename T&gt; T f4(T, T);</code></li><li>(e) éæ³•ã€‚<code>Ctype</code> è¢«éšè—äº†ã€‚</li></ul><h2 id="ç»ƒä¹ 16-19"><a href="#ç»ƒä¹ 16-19" class="headerlink" title="ç»ƒä¹ 16.19"></a>ç»ƒä¹ 16.19</h2><blockquote><p>ç¼–å†™å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå®¹å™¨çš„å¼•ç”¨ï¼Œæ‰“å°å®¹å™¨ä¸­çš„å…ƒç´ ã€‚ä½¿ç”¨å®¹å™¨çš„ <code>size_type</code> å’Œ <code>size</code>æˆå‘˜æ¥æ§åˆ¶æ‰“å°å…ƒç´ çš„å¾ªç¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Container</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> Container<span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">typename</span> <span class="token class-name">Container</span><span class="token operator">::</span>size_type i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> c<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-20"><a href="#ç»ƒä¹ 16-20" class="headerlink" title="ç»ƒä¹ 16.20"></a>ç»ƒä¹ 16.20</h2><blockquote><p>é‡å†™ä¸Šä¸€é¢˜çš„å‡½æ•°ï¼Œä½¿ç”¨<code>begin</code> å’Œ <code>end</code> è¿”å›çš„è¿­ä»£å™¨æ¥æ§åˆ¶å¾ªç¯ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Container</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> Container<span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> c<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span>std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-21"><a href="#ç»ƒä¹ 16-21" class="headerlink" title="ç»ƒä¹ 16.21"></a>ç»ƒä¹ 16.21</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±çš„ <code>DebugDelete</code> ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>DebugDelete</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">class</span> <span class="token class-name">DebugDelete</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token function">DebugDelete</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> s <span class="token operator">=</span> std<span class="token operator">::</span>cerr<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">os</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>T<span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>os <span class="token operator">&lt;&lt;</span> <span class="token string">"deleting unique_ptr"</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span><span class="token keyword">delete</span> p<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-22"><a href="#ç»ƒä¹ 16-22" class="headerlink" title="ç»ƒä¹ 16.22"></a>ç»ƒä¹ 16.22</h2><blockquote><p>ä¿®æ”¹12.3èŠ‚ä¸­ä½ çš„ <code>TextQuery</code> ç¨‹åºï¼Œä»¤ <code>shared_ptr</code> æˆå‘˜ä½¿ç”¨ <code>DebugDelete</code> ä½œä¸ºå®ƒä»¬çš„åˆ é™¤å™¨ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-23"><a href="#ç»ƒä¹ 16-23" class="headerlink" title="ç»ƒä¹ 16.23"></a>ç»ƒä¹ 16.23</h2><blockquote><p>é¢„æµ‹åœ¨ä½ çš„æŸ¥è¯¢ä¸»ç¨‹åºä¸­ä½•æ—¶ä¼šæ‰§è¡Œè°ƒç”¨è¿ç®—ç¬¦ã€‚å¦‚æœä½ çš„é¢„æµ‹å’Œå®é™…ä¸ç¬¦ï¼Œç¡®è®¤ä½ ç†è§£äº†åŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-24"><a href="#ç»ƒä¹ 16-24" class="headerlink" title="ç»ƒä¹ 16.24"></a>ç»ƒä¹ 16.24</h2><blockquote><p>ä¸ºä½ çš„ <code>Blob</code> æ¨¡ç‰ˆæ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªè¿­ä»£å™¨ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>    <span class="token comment">//for class</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">It</span><span class="token operator">></span>   <span class="token comment">//for this member</span><span class="token class-name">Blob</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">Blob</span><span class="token punctuation">(</span>It b<span class="token punctuation">,</span> It e<span class="token punctuation">)</span> <span class="token operator">:</span>    <span class="token function">data</span><span class="token punctuation">(</span>std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-25"><a href="#ç»ƒä¹ 16-25" class="headerlink" title="ç»ƒä¹ 16.25"></a>ç»ƒä¹ 16.25</h2><blockquote><p>è§£é‡Šä¸‹é¢è¿™äº›å£°æ˜çš„å«ä¹‰ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">extern</span> <span class="token keyword">template</span> <span class="token keyword">class</span> <span class="token class-name">vector</span><span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token keyword">class</span> <span class="token class-name">vector</span><span class="token operator">&lt;</span>Sales_data<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>å‰è€…æ˜¯æ¨¡ç‰ˆå£°æ˜ï¼Œåè€…æ˜¯å®ä¾‹åŒ–å®šä¹‰ã€‚</p><h2 id="ç»ƒä¹ 16-26"><a href="#ç»ƒä¹ 16-26" class="headerlink" title="ç»ƒä¹ 16.26"></a>ç»ƒä¹ 16.26</h2><blockquote><p>å‡è®¾ <code>NoDefault</code> æ˜¯ä¸€ä¸ªæ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°çš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼å®ä¾‹åŒ– <code>vector&lt;NoDefualt&gt;</code>å—ï¼Ÿå¦‚æœä¸å¯ä»¥ï¼Œè§£é‡Šä¸ºä»€ä¹ˆã€‚</p></blockquote><p>è§£ï¼š</p><p>ä¸å¯ä»¥ã€‚å¦‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>NoDefault<span class="token operator">></span> <span class="token function">vec</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¼šä½¿ç”¨ <code>NoDefault</code> çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè€Œ <code>NoDefault</code> æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œå› æ­¤æ˜¯ä¸å¯ä»¥çš„ã€‚</p><h2 id="ç»ƒä¹ 16-27"><a href="#ç»ƒä¹ 16-27" class="headerlink" title="ç»ƒä¹ 16.27"></a>ç»ƒä¹ 16.27</h2><blockquote><p>å¯¹ä¸‹é¢æ¯æ¡å¸¦æ ‡ç­¾çš„è¯­å¥ï¼Œè§£é‡Šå‘ç”Ÿäº†ä»€ä¹ˆæ ·çš„å®ä¾‹åŒ–ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªæ¨¡ç‰ˆè¢«å®ä¾‹åŒ–ï¼Œè§£é‡Šä¸ºä»€ä¹ˆ;å¦‚æœæœªå®ä¾‹åŒ–ï¼Œè§£é‡Šä¸ºä»€ä¹ˆæ²¡æœ‰ã€‚</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">Stack</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span>Stack<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//(a)</span><span class="token keyword">class</span> <span class="token class-name">Exercise</span> <span class="token punctuation">&#123;</span>Stack<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token operator">&amp;</span>rds<span class="token punctuation">;</span><span class="token comment">//(b)</span>Stack<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> si<span class="token punctuation">;</span><span class="token comment">//(c)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>Stack<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> <span class="token operator">*</span>sc<span class="token punctuation">;</span><span class="token comment">//(d)</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token operator">*</span>sc<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(e)</span><span class="token keyword">int</span> iObj <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Stack<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(f)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>(a)ã€(b)ã€(c)ã€(f) éƒ½å‘ç”Ÿäº†å®ä¾‹åŒ–ï¼Œ(d)ã€(e) æ²¡æœ‰å®ä¾‹åŒ–ã€‚</p><h2 id="ç»ƒä¹ 16-28"><a href="#ç»ƒä¹ 16-28" class="headerlink" title="ç»ƒä¹ 16.28"></a>ç»ƒä¹ 16.28</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>shared_ptr</code> å’Œ <code>unique_ptr</code>ã€‚</p></blockquote><p>è§£ï¼š</p><p>shared_ptr</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"delete.h"</span></span><span class="token keyword">namespace</span> cp5<span class="token punctuation">&#123;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">SharedPointer</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">auto</span> <span class="token function">swap</span><span class="token punctuation">(</span>SharedPointer<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> SharedPointer<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>ptr<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>ref_count<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>ref_count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>deleter<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>deleter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">SharedPointer</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token comment">//</span><span class="token comment">//  Default Ctor</span><span class="token comment">//</span><span class="token function">SharedPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ptr<span class="token punctuation">&#123;</span> <span class="token keyword">nullptr</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> ref_count<span class="token punctuation">&#123;</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">size_t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> deleter<span class="token punctuation">&#123;</span> cp5<span class="token operator">::</span>Delete<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Ctor that takes raw pointer</span><span class="token comment">//</span><span class="token keyword">explicit</span> <span class="token function">SharedPointer</span><span class="token punctuation">(</span>T<span class="token operator">*</span> raw_ptr<span class="token punctuation">)</span><span class="token operator">:</span> ptr<span class="token punctuation">&#123;</span> raw_ptr <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> ref_count<span class="token punctuation">&#123;</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">size_t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> deleter<span class="token punctuation">&#123;</span> cp5<span class="token operator">::</span>Delete<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Copy Ctor</span><span class="token comment">//</span><span class="token function">SharedPointer</span><span class="token punctuation">(</span>SharedPointer <span class="token keyword">const</span><span class="token operator">&amp;</span> other<span class="token punctuation">)</span><span class="token operator">:</span> ptr<span class="token punctuation">&#123;</span> other<span class="token punctuation">.</span>ptr <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> ref_count<span class="token punctuation">&#123;</span> other<span class="token punctuation">.</span>ref_count <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> deleter<span class="token punctuation">&#123;</span> other<span class="token punctuation">.</span>deleter <span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">++</span><span class="token operator">*</span>ref_count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Move Ctor</span><span class="token comment">//</span><span class="token function">SharedPointer</span><span class="token punctuation">(</span>SharedPointer <span class="token operator">&amp;&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token operator">:</span> ptr<span class="token punctuation">&#123;</span> other<span class="token punctuation">.</span>ptr <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> ref_count<span class="token punctuation">&#123;</span> other<span class="token punctuation">.</span>ref_count <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> deleter<span class="token punctuation">&#123;</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>deleter<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>other<span class="token punctuation">.</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>other<span class="token punctuation">.</span>ref_count <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Copy assignment</span><span class="token comment">//</span>SharedPointer<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>SharedPointer <span class="token keyword">const</span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//increment first to ensure safty for self-assignment</span><span class="token operator">++</span><span class="token operator">*</span>rhs<span class="token punctuation">.</span>ref_count<span class="token punctuation">;</span><span class="token function">decrement_and_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ptr <span class="token operator">=</span> rhs<span class="token punctuation">.</span>ptr<span class="token punctuation">,</span> ref_count <span class="token operator">=</span> rhs<span class="token punctuation">.</span>ref_count<span class="token punctuation">,</span> deleter <span class="token operator">=</span> rhs<span class="token punctuation">.</span>deleter<span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Move assignment</span><span class="token comment">//</span>SharedPointer<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>SharedPointer <span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span>cp5<span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>rhs<span class="token punctuation">.</span><span class="token function">decrement_and_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Conversion operator</span><span class="token comment">//</span><span class="token keyword">operator</span> <span class="token keyword">bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> ptr <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Dereference</span><span class="token comment">//</span>T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Arrow</span><span class="token comment">//</span>T<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Use count</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">use_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token operator">*</span>ref_count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Get underlying pointer</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> ptr<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Check if the unique user</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token operator">*</span>refCount<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Swap</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">swap</span><span class="token punctuation">(</span>SharedPointer<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">// Free the object pointed to, if unique</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">decrement_and_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">// Reset with the new raw pointer</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">reset</span><span class="token punctuation">(</span>T<span class="token operator">*</span> pointer<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">!=</span> pointer<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">decrement_n_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ptr <span class="token operator">=</span> pointer<span class="token punctuation">;</span>ref_count <span class="token operator">=</span> <span class="token keyword">new</span> std<span class="token operator">::</span><span class="token function">size_t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Reset with raw pointer and deleter</span><span class="token comment">//</span><span class="token keyword">auto</span> <span class="token function">reset</span><span class="token punctuation">(</span>T <span class="token operator">*</span>pointer<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span>T<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">reset</span><span class="token punctuation">(</span>pointer<span class="token punctuation">)</span><span class="token punctuation">;</span>deleter <span class="token operator">=</span> d<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//</span><span class="token comment">//  Dtor</span><span class="token comment">//</span><span class="token operator">~</span><span class="token function">SharedPointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">decrement_and_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>T<span class="token operator">*</span> ptr<span class="token punctuation">;</span>std<span class="token operator">::</span>size_t<span class="token operator">*</span> ref_count<span class="token punctuation">;</span>std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span>T<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">></span> deleter<span class="token punctuation">;</span><span class="token keyword">auto</span> <span class="token function">decrement_and_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">&amp;&amp;</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token operator">--</span><span class="token operator">*</span>ref_count<span class="token punctuation">)</span><span class="token keyword">delete</span> ref_count<span class="token punctuation">,</span><span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ptr<span class="token punctuation">)</span><span class="token keyword">delete</span> ref_count<span class="token punctuation">;</span>ref_count <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//namespace</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>unique_ptr:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"debugDelete.h"</span></span><span class="token comment">// forward declarations for friendship</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span><span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">unique_pointer</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token function">swap</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/***  @brief  std::unique_ptr like class template.*/</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span> <span class="token operator">=</span> DebugDelete<span class="token operator">></span><span class="token keyword">class</span> <span class="token class-name">unique_pointer</span><span class="token punctuation">&#123;</span><span class="token keyword">friend</span> <span class="token keyword">void</span> swap<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span><span class="token comment">// preventing copy and assignment</span><span class="token function">unique_pointer</span><span class="token punctuation">(</span><span class="token keyword">const</span> unique_pointer<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>unique_pointer<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> unique_pointer<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span><span class="token comment">// default constructor and one taking T*</span><span class="token function">unique_pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span><span class="token keyword">explicit</span> <span class="token function">unique_pointer</span><span class="token punctuation">(</span>T<span class="token operator">*</span> up<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ptr</span><span class="token punctuation">(</span>up<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token comment">// move constructor</span><span class="token function">unique_pointer</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&amp;&amp;</span> up<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token operator">:</span> <span class="token function">ptr</span><span class="token punctuation">(</span>up<span class="token punctuation">.</span>ptr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> up<span class="token punctuation">.</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// move assignment</span>unique_pointer<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">;</span><span class="token comment">// std::nullptr_t assignment</span>unique_pointer<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span>nullptr_t n<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">;</span><span class="token comment">// operator overloaded :  *  ->  bool</span>T<span class="token operator">&amp;</span> <span class="token keyword">operator</span>  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>T<span class="token operator">*</span> <span class="token keyword">operator</span> <span class="token operator">-></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token keyword">this</span><span class="token operator">-></span><span class="token keyword">operator</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">operator</span> <span class="token keyword">bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> ptr <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// return the underlying pointer</span>T<span class="token operator">*</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span> <span class="token keyword">return</span> ptr<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// swap member using swap friend</span><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span> <span class="token operator">&amp;</span>rhs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// free and make it point to nullptr or to p's pointee.</span><span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span> <span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span>T<span class="token operator">*</span> p<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span> <span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span> ptr <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// return ptr and make ptr point to nullptr.</span>T<span class="token operator">*</span> <span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">~</span><span class="token function">unique_pointer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span><span class="token operator">:</span>T<span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>D  deleter <span class="token operator">=</span> <span class="token function">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// swap</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span><span class="token operator">></span><span class="token keyword">inline</span> <span class="token keyword">void</span><span class="token function">swap</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">using</span> std<span class="token operator">::</span>swap<span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>ptr<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">swap</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span>deleter<span class="token punctuation">,</span> rhs<span class="token punctuation">.</span>deleter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// move assignment</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span><span class="token operator">></span><span class="token keyword">inline</span> unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>unique_pointer<span class="token operator">&amp;&amp;</span> rhs<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span><span class="token comment">// prevent self-assignment</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>ptr <span class="token operator">!=</span> rhs<span class="token punctuation">.</span>ptr<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// std::nullptr_t assignment</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span><span class="token operator">></span><span class="token keyword">inline</span> unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">&amp;</span>unique_pointer<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>std<span class="token operator">::</span>nullptr_t n<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">deleter</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>   ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// relinquish contrul by returnning ptr and making ptr point to nullptr.</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">D</span><span class="token operator">></span><span class="token keyword">inline</span> T<span class="token operator">*</span><span class="token class-name">unique_pointer</span><span class="token operator">&lt;</span>T<span class="token punctuation">,</span> D<span class="token operator">></span><span class="token operator">::</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>T<span class="token operator">*</span> ret <span class="token operator">=</span> ptr<span class="token punctuation">;</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-29"><a href="#ç»ƒä¹ 16-29" class="headerlink" title="ç»ƒä¹ 16.29"></a>ç»ƒä¹ 16.29</h2><blockquote><p>ä¿®æ”¹ä½ çš„ <code>Blob</code> ç±»ï¼Œç”¨ä½ è‡ªå·±çš„ <code>shared_ptr</code> ä»£æ›¿æ ‡å‡†åº“ä¸­çš„ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-30"><a href="#ç»ƒä¹ 16-30" class="headerlink" title="ç»ƒä¹ 16.30"></a>ç»ƒä¹ 16.30</h2><blockquote><p>é‡æ–°è¿è¡Œä½ çš„ä¸€äº›ç¨‹åºï¼ŒéªŒè¯ä½ çš„ <code>shared_ptr</code> ç±»å’Œä¿®æ”¹åçš„ <code>Blob</code> ç±»ã€‚ï¼ˆæ³¨æ„ï¼šå®ç° <code>weak_ptr</code> ç±»å‹è¶…å‡ºäº†æœ¬ä¹¦èŒƒå›´ï¼Œå› æ­¤ä½ ä¸èƒ½å°†<code>BlobPtr</code>ç±»ä¸ä½ ä¿®æ”¹åçš„<code>Blob</code>ä¸€èµ·ä½¿ç”¨ã€‚ï¼‰</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-31"><a href="#ç»ƒä¹ 16-31" class="headerlink" title="ç»ƒä¹ 16.31"></a>ç»ƒä¹ 16.31</h2><blockquote><p>å¦‚æœæˆ‘ä»¬å°† <code>DebugDelete</code> ä¸ <code>unique_ptr</code> ä¸€èµ·ä½¿ç”¨ï¼Œè§£é‡Šç¼–è¯‘å™¨å°†åˆ é™¤å™¨å¤„ç†ä¸ºå†…è”å½¢å¼çš„å¯èƒ½æ–¹å¼ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-32"><a href="#ç»ƒä¹ 16-32" class="headerlink" title="ç»ƒä¹ 16.32"></a>ç»ƒä¹ 16.32</h2><blockquote><p>åœ¨æ¨¡ç‰ˆå®å‚æ¨æ–­è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>åœ¨æ¨¡ç‰ˆå®å‚æ¨æ–­è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨ä½¿ç”¨å‡½æ•°è°ƒç”¨ä¸­çš„å®å‚ç±»å‹æ¥å¯»æ‰¾æ¨¡ç‰ˆå®å‚ï¼Œç”¨è¿™äº›æ¨¡ç‰ˆå®å‚ç”Ÿæˆçš„å‡½æ•°ç‰ˆæœ¬ä¸ç»™å®šçš„å‡½æ•°è°ƒç”¨æœ€ä¸ºåŒ¹é…ã€‚</p><h2 id="ç»ƒä¹ 16-33"><a href="#ç»ƒä¹ 16-33" class="headerlink" title="ç»ƒä¹ 16.33"></a>ç»ƒä¹ 16.33</h2><blockquote><p>æŒ‡å‡ºåœ¨æ¨¡ç‰ˆå®å‚æ¨æ–­è¿‡ç¨‹ä¸­å…è®¸å¯¹å‡½æ•°å®å‚è¿›è¡Œçš„ä¸¤ç§ç±»å‹è½¬æ¢ã€‚</p></blockquote><p>è§£ï¼š</p><ul><li><code>const</code> è½¬æ¢ï¼šå¯ä»¥å°†ä¸€ä¸ªé <code>const</code> å¯¹è±¡çš„å¼•ç”¨ï¼ˆæˆ–æŒ‡é’ˆï¼‰ä¼ é€’ç»™ä¸€ä¸ª <code>const</code> çš„å¼•ç”¨ï¼ˆæˆ–æŒ‡é’ˆï¼‰å½¢å‚ã€‚</li><li>æ•°ç»„æˆ–å‡½æ•°æŒ‡é’ˆè½¬æ¢ï¼šå¦‚æœå‡½æ•°å½¢å‚ä¸æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™å¯ä»¥å¯¹æ•°ç»„æˆ–å‡½æ•°ç±»å‹çš„å®å‚åº”ç”¨æ­£å¸¸çš„æŒ‡é’ˆè½¬æ¢ã€‚ä¸€ä¸ªæ•°ç»„å®å‚å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªæŒ‡å‘å…¶é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚ç±»ä¼¼çš„ï¼Œä¸€ä¸ªå‡½æ•°å®å‚å¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªè¯¥å‡½æ•°ç±»å‹çš„æŒ‡é’ˆã€‚</li></ul><h2 id="ç»ƒä¹ 16-34"><a href="#ç»ƒä¹ 16-34" class="headerlink" title="ç»ƒä¹ 16.34"></a>ç»ƒä¹ 16.34</h2><blockquote><p>å¯¹ä¸‹é¢çš„ä»£ç è§£é‡Šæ¯ä¸ªè°ƒç”¨æ˜¯å¦åˆæ³•ã€‚å¦‚æœåˆæ³•ï¼Œ<code>T</code> çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">"bye"</span><span class="token punctuation">,</span> <span class="token string">"dad"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) ä¸åˆæ³•ã€‚<code>compare(const char [3], const char [6])</code>, ä¸¤ä¸ªå®å‚ç±»å‹ä¸ä¸€è‡´ã€‚</li><li>(b) åˆæ³•ã€‚<code>compare(const char [4], const char [4])</code>.</li></ul><h2 id="ç»ƒä¹ 16-35"><a href="#ç»ƒä¹ 16-35" class="headerlink" title="ç»ƒä¹ 16.35"></a>ç»ƒä¹ 16.35</h2><blockquote><p>ä¸‹é¢è°ƒç”¨ä¸­å“ªäº›æ˜¯é”™è¯¯çš„ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Ÿå¦‚æœè°ƒç”¨åˆæ³•ï¼Œ<code>T</code> çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœè°ƒç”¨ä¸åˆæ³•ï¼Œé—®é¢˜ä½•åœ¨ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> T <span class="token function">calc</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>tempalte <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> T <span class="token function">fcn</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">double</span> d<span class="token punctuation">;</span> <span class="token keyword">float</span> f<span class="token punctuation">;</span> <span class="token keyword">char</span> c<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">calc</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">calc</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">fcn</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">fcn</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><ul><li>(a) åˆæ³•ï¼Œç±»å‹ä¸º<code>char</code></li><li>(b) åˆæ³•ï¼Œç±»å‹ä¸º<code>double</code></li><li>(c) åˆæ³•ï¼Œç±»å‹ä¸º<code>char</code></li><li>(d) ä¸åˆæ³•ï¼Œè¿™é‡Œæ— æ³•ç¡®å®šTçš„ç±»å‹æ˜¯<code>float</code>è¿˜æ˜¯<code>double</code></li></ul><h2 id="ç»ƒä¹ 16-36"><a href="#ç»ƒä¹ 16-36" class="headerlink" title="ç»ƒä¹ 16.36"></a>ç»ƒä¹ 16.36</h2><blockquote><p>è¿›è¡Œä¸‹é¢çš„è°ƒç”¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token function">f1</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T1</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">T2</span><span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span>T1<span class="token punctuation">,</span> T2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">,</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>j<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>cp1 <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">,</span> <span class="token operator">*</span>cp2 <span class="token operator">=</span> <span class="token operator">&amp;</span>j<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span>cp1<span class="token punctuation">,</span> cp2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span>cp1<span class="token punctuation">,</span> cp2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> cp1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> cp1<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> è¿™ä¸ªä½¿ç”¨å°±ä¸åˆæ³•<span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-37"><a href="#ç»ƒä¹ 16-37" class="headerlink" title="ç»ƒä¹ 16.37"></a>ç»ƒä¹ 16.37</h2><blockquote><p>æ ‡å‡†åº“ <code>max</code> å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå®ƒè¿”å›å®å‚ä¸­çš„è¾ƒå¤§è€…ã€‚æ­¤å‡½æ•°æœ‰ä¸€ä¸ªæ¨¡ç‰ˆç±»å‹å‚æ•°ã€‚ä½ èƒ½åœ¨è°ƒç”¨ <code>max</code> æ—¶ä¼ é€’ç»™å®ƒä¸€ä¸ª <code>int</code> å’Œä¸€ä¸ª <code>double</code> å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œå¦‚ä½•åšï¼Ÿå¦‚æœä¸å¯ä»¥ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¯ä»¥ã€‚æä¾›æ˜¾å¼çš„æ¨¡ç‰ˆå®å‚ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">double</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>std<span class="token operator">::</span>max<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-38"><a href="#ç»ƒä¹ 16-38" class="headerlink" title="ç»ƒä¹ 16.38"></a>ç»ƒä¹ 16.38</h2><blockquote><p>å½“æˆ‘ä»¬è°ƒç”¨ <code>make_shared</code> æ—¶ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªæ˜¾ç¤ºæ¨¡ç‰ˆå®å‚ã€‚è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦æ˜¾å¼æ¨¡ç‰ˆå®å‚ä»¥åŠå®ƒæ˜¯å¦‚æœä½¿ç”¨çš„ã€‚</p></blockquote><p>è§£ï¼š</p><p>å¦‚æœä¸æ˜¾ç¤ºæä¾›æ¨¡ç‰ˆå®å‚ï¼Œé‚£ä¹ˆ <code>make_shared</code> æ— æ³•æ¨æ–­è¦åˆ†é…å¤šå¤§å†…å­˜ç©ºé—´ã€‚</p><h2 id="ç»ƒä¹ 16-39"><a href="#ç»ƒä¹ 16-39" class="headerlink" title="ç»ƒä¹ 16.39"></a>ç»ƒä¹ 16.39</h2><blockquote><p>å¯¹16.1.1èŠ‚ ä¸­çš„åŸå§‹ç‰ˆæœ¬çš„ <code>compare</code> å‡½æ•°ï¼Œä½¿ç”¨ä¸€ä¸ªæ˜¾å¼æ¨¡ç‰ˆå®å‚ï¼Œä½¿å¾—å¯ä»¥å‘å‡½æ•°ä¼ é€’ä¸¤ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ã€‚</p></blockquote><p>è§£ï¼š </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">compare<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token string">"world"</span><span class="token punctuation">)</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-40"><a href="#ç»ƒä¹ 16-40" class="headerlink" title="ç»ƒä¹ 16.40"></a>ç»ƒä¹ 16.40</h2><blockquote><p>ä¸‹é¢çš„å‡½æ•°æ˜¯å¦åˆæ³•ï¼Ÿå¦‚æœä¸åˆæ³•ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¦‚æœåˆæ³•ï¼Œå¯¹å¯ä»¥ä¼ é€’çš„å®å‚ç±»å‹æœ‰ä»€ä¹ˆé™åˆ¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Ÿè¿”å›ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">It</span><span class="token operator">></span><span class="token keyword">auto</span> <span class="token function">fcn3</span><span class="token punctuation">(</span>It beg<span class="token punctuation">,</span> It end<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token operator">*</span>beg <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¤„ç†åºåˆ—</span><span class="token keyword">return</span> <span class="token operator">*</span>beg<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åˆæ³•ã€‚è¯¥ç±»å‹éœ€è¦æ”¯æŒ <code>+</code> æ“ä½œã€‚</p><h2 id="ç»ƒä¹ 16-41"><a href="#ç»ƒä¹ 16-41" class="headerlink" title="ç»ƒä¹ 16.41"></a>ç»ƒä¹ 16.41</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªæ–°çš„ <code>sum</code> ç‰ˆæœ¬ï¼Œå®ƒè¿”å›ç±»å‹ä¿è¯è¶³å¤Ÿå¤§ï¼Œè¶³ä»¥å®¹çº³åŠ æ³•ç»“æœã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span><span class="token keyword">auto</span> <span class="token function">sum</span><span class="token punctuation">(</span>T lhs<span class="token punctuation">,</span> T rhs<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">decltype</span><span class="token punctuation">(</span> lhs <span class="token operator">+</span> rhs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> lhs <span class="token operator">+</span> rhs<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-42"><a href="#ç»ƒä¹ 16-42" class="headerlink" title="ç»ƒä¹ 16.42"></a>ç»ƒä¹ 16.42</h2><blockquote><p>å¯¹ä¸‹é¢æ¯ä¸ªè°ƒç”¨ï¼Œç¡®å®š <code>T</code> å’Œ <code>val</code> çš„ç±»å‹ï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span>T<span class="token operator">&amp;&amp;</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">const</span> <span class="token keyword">int</span> ci <span class="token operator">=</span> i<span class="token punctuation">;</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token function">g</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token function">g</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token function">g</span><span class="token punctuation">(</span>i <span class="token operator">*</span> ci<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">int</span><span class="token operator">&amp;&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-43"><a href="#ç»ƒä¹ 16-43" class="headerlink" title="ç»ƒä¹ 16.43"></a>ç»ƒä¹ 16.43</h2><blockquote><p>ä½¿ç”¨ä¸Šä¸€é¢˜å®šä¹‰çš„å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬è°ƒç”¨<code>g(i = ci)</code>,<code>g</code> çš„æ¨¡ç‰ˆå‚æ•°å°†æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p><code>i = ci</code> è¿”å›çš„æ˜¯å·¦å€¼ï¼Œå› æ­¤ <code>g</code> çš„æ¨¡ç‰ˆå‚æ•°æ˜¯ <code>int&amp;</code></p><h2 id="ç»ƒä¹ 16-44"><a href="#ç»ƒä¹ 16-44" class="headerlink" title="ç»ƒä¹ 16.44"></a>ç»ƒä¹ 16.44</h2><blockquote><p>ä½¿ç”¨ä¸ç¬¬ä¸€é¢˜ä¸­ç›¸åŒçš„ä¸‰ä¸ªè°ƒç”¨ï¼Œå¦‚æœ <code>g</code> çš„å‡½æ•°å‚æ•°å£°æ˜ä¸º <code>T</code>ï¼ˆè€Œä¸æ˜¯<code>T&amp;&amp;</code>ï¼‰ï¼Œç¡®å®šTçš„ç±»å‹ã€‚å¦‚æœ<code>g</code>çš„å‡½æ•°å‚æ•°æ˜¯ <code>const T&amp;</code>å‘¢ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å½“å£°æ˜ä¸º<code>T</code>çš„æ—¶å€™ï¼Œ<code>T</code>çš„ç±»å‹ä¸º<code>int&amp;</code>ã€‚<br>å½“å£°æ˜ä¸º<code>const T&amp;</code>çš„æ—¶å€™ï¼ŒTçš„ç±»å‹ä¸º<code>int&amp;</code>ã€‚</p><h2 id="ç»ƒä¹ 16-45"><a href="#ç»ƒä¹ 16-45" class="headerlink" title="ç»ƒä¹ 16.45"></a>ç»ƒä¹ 16.45</h2><blockquote><p>å¦‚æœä¸‹é¢çš„æ¨¡ç‰ˆï¼Œå¦‚æœæˆ‘ä»¬å¯¹ä¸€ä¸ªåƒ42è¿™æ ·çš„å­—é¢å¸¸é‡è°ƒç”¨<code>g</code>ï¼Œè§£é‡Šä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬å¯¹ä¸€ä¸ª<code>int</code> ç±»å‹çš„å˜é‡è°ƒç”¨<code>g</code> å‘¢ï¼Ÿ</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span>T<span class="token operator">&amp;&amp;</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> vector<span class="token operator">&lt;</span>T<span class="token operator">></span> v<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§£ï¼š</p><p>å½“ä½¿ç”¨å­—é¢å¸¸é‡ï¼Œ<code>T</code>å°†ä¸º<code>int</code>ã€‚<br>å½“ä½¿ç”¨<code>int</code>å˜é‡ï¼Œ<code>T</code>å°†ä¸º<code>int&amp;</code>ã€‚ç¼–è¯‘çš„æ—¶å€™å°†ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•å¯¹è¿™ç§ç±»å‹è¿›è¡Œå†…å­˜åˆ†é…ï¼Œæ— æ³•åˆ›å»º<code>vector&lt;int&amp;&gt;</code>ã€‚</p><h2 id="ç»ƒä¹ 16-46"><a href="#ç»ƒä¹ 16-46" class="headerlink" title="ç»ƒä¹ 16.46"></a>ç»ƒä¹ 16.46</h2><blockquote><p>è§£é‡Šä¸‹é¢çš„å¾ªç¯ï¼Œå®ƒæ¥è‡ª13.5èŠ‚ä¸­çš„ <code>StrVec::reallocate</code>:</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>dest<span class="token operator">++</span><span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span>elem<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è§£ï¼š</p><p>åœ¨æ¯ä¸ªå¾ªç¯ä¸­ï¼Œå¯¹ <code>elem</code> çš„è§£å¼•ç”¨æ“ä½œ <code>*</code> å½“ä¸­ï¼Œä¼šè¿”å›ä¸€ä¸ªå·¦å€¼ï¼Œ<code>std::move</code> å‡½æ•°å°†è¯¥å·¦å€¼è½¬æ¢ä¸ºå³å€¼ï¼Œæä¾›ç»™ <code>construct</code> å‡½æ•°ã€‚</p><h2 id="ç»ƒä¹ 16-47"><a href="#ç»ƒä¹ 16-47" class="headerlink" title="ç»ƒä¹ 16.47"></a>ç»ƒä¹ 16.47</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ç¿»è½¬å‡½æ•°ï¼Œé€šè¿‡è°ƒç”¨æ¥å—å·¦å€¼å’Œå³å€¼å¼•ç”¨å‚æ•°çš„å‡½æ•°æ¥æµ‹è¯•å®ƒã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">T1</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token class-name">T2</span><span class="token operator">></span><span class="token keyword">void</span> <span class="token function">flip</span><span class="token punctuation">(</span>F f<span class="token punctuation">,</span> T1<span class="token operator">&amp;&amp;</span> t1<span class="token punctuation">,</span> T2<span class="token operator">&amp;&amp;</span> t2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">f</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>T2<span class="token operator">></span><span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>T1<span class="token operator">></span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-48"><a href="#ç»ƒä¹ 16-48" class="headerlink" title="ç»ƒä¹ 16.48"></a>ç»ƒä¹ 16.48</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>debug_rep</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>ostringstream ret<span class="token punctuation">;</span>    ret <span class="token operator">&lt;&lt;</span> t<span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span>T<span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>ostringstream ret<span class="token punctuation">;</span>    ret <span class="token operator">&lt;&lt;</span> <span class="token string">"pointer: "</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>        ret <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">debug_rep</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        ret <span class="token operator">&lt;&lt;</span> <span class="token string">" null pointer"</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-49"><a href="#ç»ƒä¹ 16-49" class="headerlink" title="ç»ƒä¹ 16.49"></a>ç»ƒä¹ 16.49</h2><blockquote><p>è§£é‡Šä¸‹é¢æ¯ä¸ªè°ƒç”¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p></blockquote><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span> <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span>T<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> ci <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>ci<span class="token punctuation">;</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">g</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">g</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">g</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">f</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">f</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">f</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//g(T )</span><span class="token function">g</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//g(T*)</span><span class="token function">g</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//g(T)   </span><span class="token function">g</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//g(T*)    </span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//f(T)</span><span class="token function">f</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//f(T)</span><span class="token function">f</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//f(T)</span><span class="token function">f</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//f(const T*)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-50"><a href="#ç»ƒä¹ 16-50" class="headerlink" title="ç»ƒä¹ 16.50"></a>ç»ƒä¹ 16.50</h2><blockquote><p>å®šä¹‰ä¸Šä¸€ä¸ªç»ƒä¹ ä¸­çš„å‡½æ•°ï¼Œä»¤å®ƒä»¬æ‰“å°ä¸€æ¡èº«ä»½ä¿¡æ¯ã€‚è¿è¡Œè¯¥ç»ƒä¹ ä¸­çš„ä»£ç ã€‚å¦‚æœå‡½æ•°è°ƒç”¨çš„è¡Œä¸ºä¸ä½ é¢„æœŸä¸ç¬¦ï¼Œç¡®å®šä½ ç†è§£äº†åŸå› ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-51"><a href="#ç»ƒä¹ 16-51" class="headerlink" title="ç»ƒä¹ 16.51"></a>ç»ƒä¹ 16.51</h2><blockquote><p>è°ƒç”¨æœ¬èŠ‚ä¸­çš„æ¯ä¸ª <code>foo</code>ï¼Œç¡®å®š <code>sizeof...(Args)</code> å’Œ <code>sizeof...(rest)</code>åˆ†åˆ«è¿”å›ä»€ä¹ˆã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> T <span class="token operator">&amp;</span>t<span class="token punctuation">,</span> <span class="token keyword">const</span> Args<span class="token operator">&amp;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> rest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"sizeof...(Args): "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>Args<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"sizeof...(rest): "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">test_param_packet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> d <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>    string s <span class="token operator">=</span> <span class="token string">"how now brown cow"</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> s<span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">test_param_packet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-none"><code class="language-none">sizeof...(Args): 3sizeof...(rest): 3sizeof...(Args): 2sizeof...(rest): 2sizeof...(Args): 1sizeof...(rest): 1sizeof...(Args): 0sizeof...(rest): 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-52"><a href="#ç»ƒä¹ 16-52" class="headerlink" title="ç»ƒä¹ 16.52"></a>ç»ƒä¹ 16.52</h2><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºéªŒè¯ä¸Šä¸€é¢˜çš„ç­”æ¡ˆã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ16.51ã€‚</p><h2 id="ç»ƒä¹ 16-53"><a href="#ç»ƒä¹ 16-53" class="headerlink" title="ç»ƒä¹ 16.53"></a>ç»ƒä¹ 16.53</h2><blockquote><p>ç¼–å†™ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>print</code> å‡½æ•°ï¼Œå¹¶æ‰“å°ä¸€ä¸ªã€ä¸¤ä¸ªåŠäº”ä¸ªå®å‚æ¥æµ‹è¯•å®ƒï¼Œè¦æ‰“å°çš„æ¯ä¸ªå®å‚éƒ½åº”æœ‰ä¸åŒçš„ç±»å‹ã€‚ </p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Printable</span><span class="token operator">></span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Printable <span class="token keyword">const</span><span class="token operator">&amp;</span> printable<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> os <span class="token operator">&lt;&lt;</span> printable<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// recursion</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">Printable</span><span class="token punctuation">,</span> <span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> Printable <span class="token keyword">const</span><span class="token operator">&amp;</span> printable<span class="token punctuation">,</span> Args <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> rest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">print</span><span class="token punctuation">(</span>os <span class="token operator">&lt;&lt;</span> printable <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span><span class="token punctuation">,</span> rest<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-54"><a href="#ç»ƒä¹ 16-54" class="headerlink" title="ç»ƒä¹ 16.54"></a>ç»ƒä¹ 16.54</h2><blockquote><p>å¦‚æœæˆ‘ä»¬å¯¹ä¸€ä¸ªæ²¡ <code>&lt;&lt;</code> è¿ç®—ç¬¦çš„ç±»å‹è°ƒç”¨ <code>print</code>ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>æ— æ³•é€šè¿‡ç¼–è¯‘ã€‚</p><h2 id="ç»ƒä¹ 16-55"><a href="#ç»ƒä¹ 16-55" class="headerlink" title="ç»ƒä¹ 16.55"></a>ç»ƒä¹ 16.55</h2><blockquote><p>å¦‚æœæˆ‘ä»¬çš„å¯å˜å‚æ•°ç‰ˆæœ¬ <code>print</code> çš„å®šä¹‰ä¹‹åå£°æ˜éå¯å˜å‚æ•°ç‰ˆæœ¬ï¼Œè§£é‡Šå¯å˜å‚æ•°çš„ç‰ˆæœ¬ä¼šå¦‚ä½•æ‰§è¡Œã€‚</p></blockquote><p>è§£ï¼š</p><p><code>error: no matching function for call to &#39;print(std::ostream&amp;)&#39;</code></p><h2 id="ç»ƒä¹ 16-56"><a href="#ç»ƒä¹ 16-56" class="headerlink" title="ç»ƒä¹ 16.56"></a>ç»ƒä¹ 16.56</h2><blockquote><p>ç¼–å†™å¹¶æµ‹è¯•å¯å˜å‚æ•°ç‰ˆæœ¬çš„ <code>errorMsg</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> <span class="token function">errorMsg</span><span class="token punctuation">(</span>std<span class="token operator">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> Args<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> rest<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">print</span><span class="token punctuation">(</span>os<span class="token punctuation">,</span> <span class="token function">debug_rep</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-57"><a href="#ç»ƒä¹ 16-57" class="headerlink" title="ç»ƒä¹ 16.57"></a>ç»ƒä¹ 16.57</h2><blockquote><p>æ¯”è¾ƒä½ çš„å¯å˜å‚æ•°ç‰ˆæœ¬çš„ <code>errorMsg</code> å’Œ6.2.6èŠ‚ä¸­çš„ <code>error_msg</code>å‡½æ•°ã€‚ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹å„æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>å¯å˜å‚æ•°ç‰ˆæœ¬æœ‰æ›´å¥½çš„çµæ´»æ€§ã€‚</p><h2 id="ç»ƒä¹ 16-58"><a href="#ç»ƒä¹ 16-58" class="headerlink" title="ç»ƒä¹ 16.58"></a>ç»ƒä¹ 16.58</h2><blockquote><p>ä¸ºä½ çš„ <code>StrVec</code> ç±»åŠä½ ä¸º16.1.2èŠ‚ç»ƒä¹ ä¸­ç¼–å†™çš„ <code>Vec</code> ç±»æ·»åŠ  <code>emplace_back</code> å‡½æ•°ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>        <span class="token comment">//for the class  template</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span>  <span class="token comment">//for the member template</span><span class="token keyword">inline</span> <span class="token keyword">void</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token operator">::</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">chk_n_alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    alloc<span class="token punctuation">.</span><span class="token function">construct</span><span class="token punctuation">(</span>first_free<span class="token operator">++</span><span class="token punctuation">,</span> std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-59"><a href="#ç»ƒä¹ 16-59" class="headerlink" title="ç»ƒä¹ 16.59"></a>ç»ƒä¹ 16.59</h2><blockquote><p>å‡å®š <code>s</code> æ˜¯ä¸€ä¸ª <code>string</code>ï¼Œè§£é‡Šè°ƒç”¨ <code>svec.emplace_back(s)</code>ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p></blockquote><p>è§£ï¼š</p><p>ä¼šåœ¨ <code>construst</code> å‡½æ•°ä¸­è½¬å‘æ‰©å±•åŒ…ã€‚</p><h2 id="ç»ƒä¹ 16-60"><a href="#ç»ƒä¹ 16-60" class="headerlink" title="ç»ƒä¹ 16.60"></a>ç»ƒä¹ 16.60</h2><blockquote><p>è§£é‡Š <code>make_shared</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p></blockquote><p>è§£ï¼š</p><p><code>make_shared</code> æ˜¯ä¸€ä¸ªå¯å˜æ¨¡ç‰ˆå‡½æ•°ï¼Œå®ƒå°†å‚æ•°åŒ…è½¬å‘ç„¶åæ„é€ ä¸€ä¸ªå¯¹è±¡ï¼Œå†ç„¶åä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æ™ºèƒ½æŒ‡é’ˆã€‚</p><h2 id="ç»ƒä¹ 16-61"><a href="#ç»ƒä¹ 16-61" class="headerlink" title="ç»ƒä¹ 16.61"></a>ç»ƒä¹ 16.61</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>make_shared</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">typename</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Args<span class="token operator">></span><span class="token keyword">auto</span> <span class="token function">make_shared</span><span class="token punctuation">(</span>Args<span class="token operator">&amp;&amp;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token operator">-></span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">T</span><span class="token punctuation">(</span>std<span class="token operator">::</span>forward<span class="token operator">&lt;</span>Args<span class="token operator">></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-62"><a href="#ç»ƒä¹ 16-62" class="headerlink" title="ç»ƒä¹ 16.62"></a>ç»ƒä¹ 16.62</h2><blockquote><p>å®šä¹‰ä½ è‡ªå·±ç‰ˆæœ¬çš„ <code>hash&lt;Sales_data&gt;</code>, å¹¶å®šä¹‰ä¸€ä¸ª <code>Sales_data</code> å¯¹è±¡çš„ <code>unorder_multise</code>ã€‚å°†å¤šæ¡äº¤æ˜“è®°å½•ä¿å­˜åˆ°å®¹å™¨ä¸­ï¼Œå¹¶æ‰“å°å…¶å†…å®¹ã€‚</p></blockquote><p>è§£ï¼š</p><p>ç•¥</p><h2 id="ç»ƒä¹ 16-63"><a href="#ç»ƒä¹ 16-63" class="headerlink" title="ç»ƒä¹ 16.63"></a>ç»ƒä¹ 16.63</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¨¡ç‰ˆï¼Œç»Ÿè®¡ä¸€ä¸ªç»™å®šå€¼åœ¨ä¸€ä¸ª<code>vecor</code>ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚æµ‹è¯•ä½ çš„å‡½æ•°ï¼Œåˆ†åˆ«ä¼ é€’ç»™å®ƒä¸€ä¸ª<code>double</code>çš„<code>vector</code>ï¼Œä¸€ä¸ª<code>int</code>çš„<code>vector</code>ä»¥åŠä¸€ä¸ª<code>string</code>çš„<code>vector</code>ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token comment">// template</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>std<span class="token operator">::</span>size_t  <span class="token function">count</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> vec<span class="token punctuation">,</span> T value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> count <span class="token operator">=</span> <span class="token number">0u</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> elem  <span class="token operator">:</span> vec<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">==</span> elem<span class="token punctuation">)</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>    <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// template specialization</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">></span>std<span class="token operator">::</span>size_t <span class="token function">count</span> <span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span> <span class="token keyword">const</span><span class="token operator">&amp;</span> vec<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> count <span class="token operator">=</span> <span class="token number">0u</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> elem <span class="token operator">:</span> vec<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> elem<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">++</span>count<span class="token punctuation">;</span>    <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// for ex16.63</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> vd <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">2.3</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span>vd<span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>        <span class="token comment">// for ex16.64</span>    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">></span> vcc <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">,</span> <span class="token string">"moophy"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span>vcc<span class="token punctuation">,</span> <span class="token string">"alan"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-64"><a href="#ç»ƒä¹ 16-64" class="headerlink" title="ç»ƒä¹ 16.64"></a>ç»ƒä¹ 16.64</h2><blockquote><p>ä¸ºä¸Šä¸€é¢˜çš„æ¨¡ç‰ˆç¼–å†™ç‰¹ä¾‹åŒ–ç‰ˆæœ¬æ¥å¤„ç†<code>vector&lt;const char*&gt;</code>ã€‚ç¼–å†™ç¨‹åºä½¿ç”¨è¿™ä¸ªç‰¹ä¾‹åŒ–ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><p>å‚è€ƒ16.64ã€‚</p><h2 id="ç»ƒä¹ 16-65"><a href="#ç»ƒä¹ 16-65" class="headerlink" title="ç»ƒä¹ 16.65"></a>ç»ƒä¹ 16.65</h2><blockquote><p>åœ¨16.3èŠ‚ä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªé‡è½½çš„ <code>debug_rep</code> ç‰ˆæœ¬ï¼Œä¸€ä¸ªæ¥å— <code>const char*</code> å‚æ•°ï¼Œå¦ä¸€ä¸ªæ¥å— <code>char *</code> å‚æ•°ã€‚å°†è¿™ä¸¤ä¸ªå‡½æ•°é‡å†™ä¸ºç‰¹ä¾‹åŒ–ç‰ˆæœ¬ã€‚</p></blockquote><p>è§£ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span><span class="token comment">// template</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span>T<span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// template specialization T=const char*  ,  char*  respectively.</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span>      <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> p<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"alan"</span><span class="token punctuation">;</span>    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">debug_rep</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span>T<span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>ostringstream ret<span class="token punctuation">;</span>    ret <span class="token operator">&lt;&lt;</span> t<span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// template specialization</span><span class="token comment">// T = const char*</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token function">ret</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> str<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// template specialization</span><span class="token comment">// T =       char*</span><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token operator">></span>std<span class="token operator">::</span>string <span class="token function">debug_rep</span><span class="token punctuation">(</span>      <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    std<span class="token operator">::</span>string <span class="token function">ret</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> ret<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ƒä¹ 16-66"><a href="#ç»ƒä¹ 16-66" class="headerlink" title="ç»ƒä¹ 16.66"></a>ç»ƒä¹ 16.66</h2><blockquote><p>é‡è½½<code>debug_rep</code> å‡½æ•°ä¸ç‰¹ä¾‹åŒ–å®ƒç›¸æ¯”ï¼Œæœ‰ä½•ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>é‡è½½å‡½æ•°ä¼šæ”¹å˜å‡½æ•°åŒ¹é…ã€‚</p><h2 id="ç»ƒä¹ 16-67"><a href="#ç»ƒä¹ 16-67" class="headerlink" title="ç»ƒä¹ 16.67"></a>ç»ƒä¹ 16.67</h2><blockquote><p>å®šä¹‰ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ä¼šå½±å“ <code>debug_rep</code> çš„å‡½æ•°åŒ¹é…å—ï¼Ÿå¦‚æœä¸å½±å“ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è§£ï¼š</p><p>ä¸å½±å“ï¼Œç‰¹ä¾‹åŒ–æ˜¯æ¨¡æ¿çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æ²¡æœ‰é‡è½½å‡½æ•°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> cpp-primerç­”æ¡ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> exclude </tag>
            
            <tag> c++ </tag>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
